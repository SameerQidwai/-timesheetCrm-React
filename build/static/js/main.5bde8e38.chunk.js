(this["webpackJsonponelm-crm"]=this["webpackJsonponelm-crm"]||[]).push([[0],{267:function(e,t,a){},286:function(e,t,a){},314:function(e,t,a){e.exports=a(560)},319:function(e,t,a){},320:function(e,t,a){},321:function(e,t,a){},393:function(e,t,a){},394:function(e,t,a){},417:function(e,t,a){},418:function(e,t,a){},423:function(e,t,a){},424:function(e,t,a){},425:function(e,t,a){},521:function(e,t,a){},522:function(e,t,a){},523:function(e,t,a){},524:function(e,t,a){},525:function(e,t,a){},526:function(e,t,a){},538:function(e,t,a){},558:function(e,t,a){},559:function(e,t,a){},560:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),i=a(54),r=a.n(i),o=(a(319),a(53)),s=a(19),c=a(9),d=a(10),u=a(12),m=a(11),f=a(567),p=a(562),b=a(563),g=a(605),y=a(606),h=(a(320),a(72)),v=a(89),E=a(585),k=a(202),S=a(199),C=a(586),j=a(203),D=a(587),O=a(588),I=a(589),P=a(590),x=(a(321),a(17)),T=a.n(x),z=a(303),A="http://54.91.49.138:8000/api/v1",R={L:"Lead",TR:"Tender Released",BS:"Bid Submitted",BD:"Bid Development"},w={O:"Open",L:"Lost",P:"Open",NB:"Not Bid",DNP:"Did Not Proceed",C:"Completed"},F={false:"Close",true:"Open"},N={CM:"Completed",AP:"Approved",SB:"Submitted",R:"Rejected",RJ:"Rejected"},M={CM:"geekblue",AP:"green",SB:"cyan",RJ:"red",R:"red"},L={1:"Milestone",2:"Time"},B={1:"Casual",2:"Part Time",3:"Full Time"},q={1:"Hourly",2:"Daily",3:"Weekly",4:"Fortnightly",5:"Monthly"},V={M:"Male",F:"Female",O:"Other"},Y={"Australian Capital Territory":"ACT","New South Wales":"NSW",Victoria:"VIC",Queensland:"QLD","South Australia":"SA","Western Australia":"WA","Northern Territory":"NT",Tasmania:"TSA"},H=function(e,t){var a;return isNaN(e)?"0.00":(null===(a=e.toString().match(new RegExp("^-?\\d+(?:.\\d{0,"+(t||-1)+"})?")))||void 0===a?void 0:a[0])||"0.00"},_=function(e){var t=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});return e=H(e,2),t.format(e).replace(/^(\D+)/,"$1 ")},U=function(e,t,a){return a?isNaN(parseFloat(e))?"0.00":parseFloat(e).toFixed(2):H(e,t||2)},W=function(e,t,a){return e&&(t?a?T.a.utc(e).format(!0===a?"ddd DD MMM yyyy":a):T()(e).utcOffset(0,!0).format():T.a.utc(e))},K=function(e){localStorage.setItem("accessToken",null!==e&&void 0!==e?e:G().accessToken),localStorage.setItem("jwtTimer",(new Date).getTime())},G=function(){for(var e={},t=Object.keys(localStorage),a=t.length;a--;)e[t[a]]=localStorage.getItem(t[a]);return e},$=function(e){"Authentication Expired or Invalid"===e&&(G().jwtExpired?(localStorage.clear(),window.location.href="/login"):localStorage.setItem("jwtExpired",!0))},J=function(){return{"content-type":"application/json",Authorization:"".concat(G().accessToken)}},X=function(e){return"pdf"===e?"/icons/pdf.png":"doc"===e||"docx"===e?"/icons/doc.png":"xls"===e||"xlsx"===e?"/icons/xls.png":"ppt"===e||"pptx"===e?"/icons/ppt.png":"csv"===e?"/icons/csv.png":/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico)$/i.test(e)?"/icons/img.png":"/icons/default.png"},Q=function(e,t,a,l){var n,i=null!==(n=null===e||void 0===e?void 0:e.response)&&void 0!==n?n:{},r=i.status,o=void 0!==r&&r,s=i.data,c=void 0===s?{}:s,d=c.message,u=c.success;return z.b.error({content:400===o?d:"Something Went Wrong!",duration:400===o?a:5,key:t,style:null!==l&&void 0!==l?l:{}}),{error:e.message,status:o,message:d,success:u}},Z=function(e,t,a,l){if(e){var n,i,r=null!==(n=null===l||void 0===l?void 0:l.startDate)&&void 0!==n?n:W(new Date).subtract(10,"years"),o=null!==(i=null===l||void 0===l?void 0:l.endDate)&&void 0!==i?i:W(new Date).add(10,"years");return("start"===a&&t?e>=t:"end"===a&&t&&e<=t)||!e.isBetween(W(r),W(o),"day","[]")}},ee=function(e){var t=void 0;return t=parseInt(T()().format("M"))<7?T()().subtract(1,"y").format("YYYY"):T()().format("YYYY"),{dates:{start:T()().set({month:6,date:1,year:t}),end:T()().set({month:5,date:30,year:parseInt(t)+1})},years:{start:t,end:parseInt(t)+1}}[e]},te=function(e,t,a){if(e){var l,n,i=null!==(l=null===a||void 0===a?void 0:a.startDate)&&void 0!==l?l:T()().subtract(10,"years"),r=null!==(n=null===a||void 0===a?void 0:a.endDate)&&void 0!==n?n:T()().add(10,"years");return t&&e>=t||!e.isBetween(T()(i),T()(r),"day","[]")}},ae=function(e,t,a){if(e){var l,n,i=null!==(l=null===a||void 0===a?void 0:a.startDate)&&void 0!==l?l:T()().subtract(10,"years"),r=null!==(n=null===a||void 0===a?void 0:a.endDate)&&void 0!==n?n:T()().add(10,"years");return t&&e<=t||!e.isBetween(T()(i),T()(r),"day","[]")}},le=function(e,t){return e.sort((function(e,a){var l,n,i,r;return(null!==(l=null===e||void 0===e||null===(n=e[t])||void 0===n?void 0:n.toLowerCase())&&void 0!==l?l:"").localeCompare(null!==(i=null===a||void 0===a||null===(r=a[t])||void 0===r?void 0:r.toLowerCase())&&void 0!==i?i:"")}))},ne=v.a.SubMenu,ie=[{text:"Dashboard",icon:n.a.createElement(E.a,null),link:"/calender",key:"/calender"},{text:"Timesheet Submission",icon:n.a.createElement(k.a,null),link:"/time-sheet",key:"TIMESHEETS",permissions:{module:"TIMESHEETS",key:"READ"}},{text:"Timesheet Approval",icon:n.a.createElement(S.a,null),link:"/time-sheet-approval",key:"TIMESHEETS APPROVAl",permissions:{module:"TIMESHEETS",key:"APPROVAL,UNAPPROVAL"}},{text:"Milestone Approval",icon:n.a.createElement(C.a,null),link:"/milestones-certificate",key:"MILESTONE APPROVAl",permissions:{module:"TIMESHEETS",key:"APPROVAL,UNAPPROVAL"}},{text:"Leave Requests",icon:n.a.createElement(j.a,null),link:"/leave-request",key:"LEAVE REQUEST",permissions:{module:"LEAVE_REQUESTS",key:"READ"}},{text:"Leave Approval",icon:n.a.createElement(D.a,null),link:"/approve-request",key:"APPROVE REQUEST",permissions:{module:"LEAVE_REQUESTS",key:"APPROVAL,UNAPPROVAL"}},{text:"Training",icon:n.a.createElement(O.a,null),link:"/training",key:"Training",permissions:{module:"TIMESHEETS",key:"READ"}},{text:"Expense Sheet",icon:n.a.createElement(I.a,null),link:"/expense-sheets",key:"EXPENSE SHEET ",permissions:{module:"EXPENSES",key:"READ"}},{text:"Expense",icon:n.a.createElement(P.a,null),link:"/expense",key:"EXPENSE",permissions:{module:"EXPENSES",key:"READ"}},{text:"Expense Approval",icon:n.a.createElement(O.a,null),link:"/expense-sheet-approval",key:"EXPENSE Approval",permissions:{module:"EXPENSES",key:"APPROVAL,UNAPPROVAL"}}],re=(k.a,S.a,D.a,C.a,O.a,k.a,k.a,j.a,I.a,P.a,O.a,function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getAllowedMenu()},e.getAllowedMenu=function(){var t=G().permissions;t=t?JSON.parse(t):[];var a=e.state.allowedMenu;ie.map((function(e){var l,n;if(e.subMenu){var i=[];e.subMenu.map((function(e){var a,l;if(null===(a=t)||void 0===a?void 0:a[null===e||void 0===e||null===(l=e.permissions)||void 0===l?void 0:l.module]){var n,r,o,s=null===e||void 0===e||null===(n=e.permissions)||void 0===n||null===(r=n.key)||void 0===r?void 0:r.split(","),c=Object(h.a)(s);try{for(c.s();!(o=c.n()).done;){var d,u,m=o.value;if(null===(d=t[null===e||void 0===e||null===(u=e.permissions)||void 0===u?void 0:u.module])||void 0===d?void 0:d[m]){i.push(e);break}}}catch(f){c.e(f)}finally{c.f()}}})),i.length?(e.subMenu=i,a.push(e)):(delete e.subMenu,a.push(e))}else if(null===(l=t)||void 0===l?void 0:l[null===e||void 0===e||null===(n=e.permissions)||void 0===n?void 0:n.module]){var r,o=e.permissions.key.split(","),s=Object(h.a)(o);try{for(s.s();!(r=s.n()).done;){var c=r.value;if(t[e.permissions.module][c]){a.push(e);break}}}catch(d){s.e(d)}finally{s.f()}}})),e.setState({allowedMenu:a})},e.onSelect=function(e){var t=e.item,a=e.key,l=e.keyPath,n=e.selectedKeys;console.log({item:t,key:a,keyPath:l,selectedKeys:n})},e.MenuRender=function(){return e.state.allowedMenu.map((function(e,t){return e.subMenu?n.a.createElement(ne,{key:e.key,icon:e.icon,title:e.text},e.subMenu.map((function(e,t){return n.a.createElement(v.a.Item,{key:e.link,icon:e.icon},n.a.createElement(s.b,{to:e.link,className:"nav-link"},e.text))}))):n.a.createElement(v.a.Item,{key:e.link,icon:e.icon},n.a.createElement(s.b,{to:e.link,className:"nav-link"},e.text))}))},e.state={allowedMenu:[]},e}return Object(d.a)(a,[{key:"highlightRow",value:function(e){return this.props.location.pathname===e?"ant-menu-item-selected":""}},{key:"render",value:function(){return n.a.createElement(v.a,{theme:"light",mode:"inline",selectedKeys:[this.props.activatePath],style:{fontSize:12}},this.MenuRender())}}]),a}(l.Component)),oe=Object(o.i)(re),se=a(182),ce=a(582),de=a(306),ue=a(591),me=a(592),fe=a(593),pe=a(106),be=(a(393),[{text:"Contacts",items:[{text:"Organisations",link:"/organisations",key:"ORGANIZATIONS"},{text:"Contact",link:"/contacts",key:"CONTACT_PERSONS"}],key:"CHILDRENS"},{text:"Resources",items:[{text:"Employees",link:"/Employees",key:"USERS"},{text:"Sub Contractors",link:"/sub-contractors",key:"USERS"}],key:"CHILDRENS"},{text:"Opportunities",link:"/opportunities",key:"OPPORTUNITIES"},{text:"Projects",link:"/projects",key:"PROJECTS"}]),ge=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getAllowedItems()},e.getAllowedItems=function(){var t=G().permissions;t=t?JSON.parse(t):[];var a=e.state.allowedNavItem;be.map((function(e){if("CHILDRENS"===e.key){var l=[];e.items.map((function(e){t[e.key]&&t[e.key].READ&&l.push(e)})),l.length>0&&(e.items=l,a.push(e))}else t[e.key]&&t[e.key].READ&&a.push(e)})),e.setState({allowedNavItem:a,permissions:t})},e.getNavMenuItems=function(t){return t?t.map((function(t,a){return e.getSubMenuOrItem(t,a)})):[]},e.getDropMenu=function(e,t){return n.a.createElement(v.a,null,e.map((function(e,a){return n.a.createElement(v.a.Item,{key:"".concat(a+t),icon:e.icon},n.a.createElement(s.b,{to:e.link,className:"nav-link"},e.text))})))},e.getSubMenuOrItem=function(t,a){return t.items?n.a.createElement(se.a,{overlay:e.getDropMenu(t.items,a),key:a},n.a.createElement("span",{className:"navItem"},t.text," ",n.a.createElement("span",null," ",n.a.createElement(de.a,null)," "))):n.a.createElement("span",{className:"navItem",key:a},n.a.createElement(s.b,{to:t.link,className:"nav-link"},t.text))},e.logOut=function(){z.b.loading({content:"Loading...",key:"logout"}),localStorage.clear(),e.setState({logout:!0},(function(){z.b.info({content:"Logout successfully!",key:"logout"})}))},e.state={logout:!1,allowedNavItem:[],permissions:{}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=e.logout,a=e.allowedNavItem,l=e.permissions,i=n.a.createElement(v.a,{onClick:this.handleMenuClick},n.a.createElement(v.a.Item,{key:"profile"},n.a.createElement(s.b,{to:"/profile",className:"nav-link"},"Profile ",n.a.createElement(ue.a,null))),n.a.createElement(v.a.Item,{key:"logout",onClick:this.logOut},"Logout ",n.a.createElement(me.a,null)));return n.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark rounded "},n.a.createElement("div",{className:"collapse navbar-collapse justify-content-md-center",id:"navbarsExample10"},n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,this.getNavMenuItems(a)),l.ADMIN_OPTIONS&&l.ADMIN_OPTIONS.READ?n.a.createElement(b.a,{xs:{span:2},md:{span:2}},n.a.createElement(ce.b,{size:"large"},n.a.createElement(s.b,{to:"/admin/global-settings"},n.a.createElement(fe.a,null)),n.a.createElement(se.a,{overlay:i,placement:"bottomCenter"},n.a.createElement(pe.a,{style:{color:"#1890ff",cursor:"pointer"}})))):n.a.createElement(b.a,{xs:{span:1},md:{span:1}},n.a.createElement(se.a,{overlay:i,placement:"bottomCenter"},n.a.createElement(pe.a,{style:{color:"#1890ff",cursor:"pointer"}}))))),t&&n.a.createElement(o.a,{to:{pathname:"/"}}))}}]),a}(l.Component),ye=Object(o.i)(ge),he=a(16),ve=a(570);a(394),ve.a.Text,ve.a.Title;var Ee=function(){return n.a.createElement("div",{className:"landing-placeholder",style:{backgroundImage:"url(".concat("/Z_Landing.png",")")}})},ke=a(594),Se=a(595),Ce=a(596),je=a(597),De=a(598),Oe=a(599),Ie=a(600),Pe=a(601),xe=v.a.SubMenu,Te=[{text:"Global Settings",icon:n.a.createElement(ke.a,null),link:"/admin/global-settings",key:"/admin/global-settings"},{text:"Holidays Types",icon:n.a.createElement(j.a,null),link:"/admin/holiday-types",key:"/admin/holiday-types"},{text:"Calendars",icon:n.a.createElement(j.a,null),link:"/admin/calendars",key:"/admin/calendars"},{text:"Leave Categories",icon:n.a.createElement(Se.a,null),link:"/admin/leave-categories",key:"/admin/leave-categories"},{text:"Leave Policies",icon:n.a.createElement(Ce.a,null),link:"/admin/leave-policies",key:"/admin/leave-policies"},{text:"Role & Permissions",icon:n.a.createElement(je.a,null),link:"/admin/roles",key:"/admin/roles"},{text:"Standard Levels",icon:n.a.createElement(De.a,null),link:"/admin/standard-levels",key:"/admin/standard-levels"},{text:"Standard Skills",icon:n.a.createElement(Oe.a,null),link:"/admin/skills",key:"/admin/skills"},{text:"Panels",icon:n.a.createElement(Ie.a,null),link:"/admin/panels",key:"/admin/panels"},{text:"Expense Types",icon:n.a.createElement(Ie.a,null),link:"/admin/expense-types",key:"/admin/expense-types"},{text:"Import/Export",icon:n.a.createElement(Pe.a,null),link:"/admin/import-export",key:"/admin/import-export"}],ze=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var l=arguments.length,i=new Array(l),r=0;r<l;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).componentDidMount=function(){},e.MenuRender=function(){return Te.map((function(e,t){return e.subMenu?n.a.createElement(xe,{key:e.key,icon:e.icon,title:e.text},e.subMenu.map((function(e,t){return n.a.createElement(v.a.Item,{key:e.key,icon:e.icon},n.a.createElement(s.b,{to:e.link,className:"nav-link"},e.text))}))):n.a.createElement(v.a.Item,{key:e.key,icon:e.icon},n.a.createElement(s.b,{to:e.link,className:"nav-link"},e.text))}))},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props.location.pathname;return n.a.createElement(v.a,{theme:"light",mode:"inline",defaultSelectedKeys:[e]},this.MenuRender())}}]),a}(l.Component),Ae=Object(o.i)(ze),Re=a(578),we=a(13),Fe=a(4),Ne=a(68),Me=a(571),Le=a(566),Be=a(60),qe=a(7),Ve=a.n(qe),Ye="".concat(A,"/global-setting"),He="".concat(A,"/global-variables"),_e=function(){return Ve.a.get(Ye,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Ue=function(e){return z.b.loading({content:"Loading...",key:1},5),Ve.a.post("".concat(He,"/create-update"),e,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message,i=a.data;$(n),z.b.success({content:n,key:1},5),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization);var r={};return l&&i.forEach((function(e){var t=e.name,a=Object(he.a)(e.values,1)[0],l=a.globalVariableId,n=a.value,i=a.startDate,o=a.endDate;r[t]={globalVariableId:l,value:n,startDate:W(i),endDate:W(o)}})),{success:l,data:r}})).catch((function(e){return Q(e,1,5)}))},We=a(575),Ke=a(239),Ge=a(564),$e=a(66),Je=a(302),Xe=a(574),Qe=a(110),Ze=a(583),et=a(147),tt=a(142),at=a(565),lt=a(140),nt=a(84),it=Me.a.Item,rt=We.a.Dragger,ot=Ke.a.RangePicker,st=Ge.a.RangePicker,ct=ve.a.Title,dt=ve.a.Text,ut=function(e,t){return"$"===t?"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","):"ABN"===t?"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g," "):t?"".concat(e).concat(t):"".concat(e)},mt=function(e,t){return"$"===t?e.replace(/\$\s?|(,*)/g,""):"ABN"===t?e.replace(/\$\s?|(\s*)/g,""):t?e.replace(t,""):e},ft=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).multipleUpload=function(e,t,a,n){console.log(e,t,a,n);var i=l.state.uploadKeys;return console.log("multipleUpload",e,a,n,i),l.state.uploadKeys[a]=e,l.setState({uploadKeys:Object(Fe.a)({},i)},(function(){console.log(l.state)})),!1},l.onFinish=function(e){l.props.Callback(e)},l.content=function(){var e=l.props,t=e.FormFields,a=e.listName;return t.map((function(e,t){return n.a.createElement(b.a,{span:e.fieldCol,offset:e.filedOffset,key:t+1,style:e.style},n.a.createElement(it,Object.assign({},e.layout,{name:[null!==a&&void 0!==a?a:e.object,e.key],initialValue:e.initialValue,extra:e.hint,help:e.help,labelAlign:e.labelAlign,label:e.label,labelCol:e.labelCol,wrapperCol:e.wrapperCol,rules:e.rules,valuePropName:e.valuePropName,getValueFromEvent:e.customValue,hidden:!0===e.hidden,style:e.itemStyle,noStyle:e.noStyle}),l.filedformat(e.type,e.Placeholder,e.data,e.mode,e.rangeMin,e.rangeMax,e.showTime,e.shape,e.size,e.fieldStyle,e.disabled,e.readOnly,e.onChange,e.onClick,e.onBlur,e.onClear,e.tooltip,e.tooltipTitle,e.tooltipTrigger,e.fieldNames,e.suggestion)))}))},l.filedformat=function(e,t,a,l,i,r,o,s,c,d,u,m,f,p,b,g,y,h,v,E,k){var S,C,j=null;switch(e){case"Title":j=n.a.createElement(ct,{level:l,size:c,style:d},y?n.a.createElement($e.a,{title:h,trigger:v}," ",t):t);break;case"Text":j=n.a.createElement(dt,{strong:l,onClick:p,style:d,disabled:u},y?n.a.createElement($e.a,{title:h,trigger:v}," ",t):t,i&&n.a.createElement("span",{style:{color:"red"}}," * "),k&&n.a.createElement("span",{style:{float:"right",color:"#747474"}}," ",k," "));break;case"Password":j=n.a.createElement(Je.a.Password,{placeholder:t,visibilityToggle:l,size:c,style:d});break;case"Textarea":j=n.a.createElement(Je.a.TextArea,{placeholder:t,allowClear:!0,autoSize:l,asize:c,style:Object(Fe.a)({marginBottom:"5px"},d),prefix:l,disabled:u,readOnly:m});break;case"InputNumber":j=n.a.createElement(Xe.a,{placeholder:t,min:i,max:r,size:c,formatter:function(e){return ut(e,s)},parser:function(e){return mt(e,s)},style:Object(Fe.a)({marginBottom:"5px",width:"100%"},d),onBlur:b,onChange:f,disabled:u,readOnly:m});break;case"Select":j=n.a.createElement(Qe.a,{placeholder:t,options:a,mode:l,showArrow:!0,size:c,allowClear:!0,fieldNames:E,onChange:f,onClear:g,style:Object(Fe.a)({marginBottom:"5px"},d),optionFilterProp:[null!==(S=null===E||void 0===E?void 0:E.label)&&void 0!==S?S:"label",null!==(C=null===E||void 0===E?void 0:E.value)&&void 0!==C?C:"value"],showSearch:!0,filterOption:function(e,t){var a,l,n=null!==(a=null===E||void 0===E?void 0:E.label)&&void 0!==a?a:"label",i=null!==(l=null===E||void 0===E?void 0:E.value)&&void 0!==l?l:"value",r=t[n].toLowerCase().indexOf(e.toLowerCase())>=0,o=t[i].toString().toLowerCase().indexOf(e.toLowerCase())>=0;return r||o},disabled:u});break;case"Switch":j=n.a.createElement(Ze.a,{size:c,style:d,checkedChildren:null!==s&&void 0!==s?s:n.a.createElement(lt.a,null),unCheckedChildren:null!==s&&void 0!==s?s:n.a.createElement(nt.a,null)});break;case"Radio":j=n.a.createElement(et.a.Group,{options:a,optionType:l,buttonStyle:s,size:c,style:d});break;case"Checkbox":j=n.a.createElement(tt.a,{options:a,size:c,style:d,disabled:u,onChange:f});break;case"CheckboxGroup":j=n.a.createElement(tt.a.Group,{options:a,size:c,style:d,disabled:u,onChange:f});break;case"DatePicker":j=n.a.createElement(Ke.a,{picker:l,showTime:o,disabledDate:null!==i&&void 0!==i?i:r,size:c,style:Object(Fe.a)({marginBottom:"5px",width:"100%"},d),onBlur:b,onChange:f,format:"ddd DD MMM yyyy",disabled:u});break;case"TimePicker":j=n.a.createElement(Ge.a,{format:o,use12Hours:"use12Hours"===l,size:c,style:Object(Fe.a)({width:"100%"},d),disabled:u});break;case"TimeRange":j=n.a.createElement(st,{format:o,use12Hours:"use12Hours"===l,size:c,style:d});break;case"RangePicker":j=n.a.createElement(ot,{picker:l,showTime:o,disabledDate:null!==i&&void 0!==i?i:r,size:c,style:d,onBlur:b,onChange:f,format:"ddd DD MMM yyyy",disabled:u});break;case"Divider":j=n.a.createElement(at.a,{type:l,style:d});break;case"Button":j=n.a.createElement(Be.a,{type:l,shape:s,block:r,style:d,onClick:p,size:c},t);break;case"Upload":j=n.a.createElement(We.a,{name:"logo",action:l,listType:"text",multiple:r,style:d},t);break;case"Dragger":j=n.a.createElement(rt,{name:"logo",action:l,listType:"text",multiple:!0,style:d,beforeUpload:function(){return!1}},t);break;default:j=n.a.createElement(Je.a,{placeholder:t,style:Object(Fe.a)({marginBottom:"5px"},d),size:c,disabled:u,readOnly:m,onBlur:b,onChange:f})}return j},l}return Object(d.a)(a,[{key:"render",value:function(){return this.content()}}]),a}(l.Component),pt=function(){return Ve.a.get("".concat(A,"/states"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=[];if(n.map((function(e){i.push({value:e.id,label:e.label})})),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:le(i,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},bt=function(){return Ve.a.get("".concat(A,"/leave-request-types"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data.map((function(e){return{value:e.id,label:e.label}}));if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:le(n,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},gt=function(){return Ve.a.get("".concat(A,"/standard-skills"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=[];if(n.map((function(e){i.push({value:e.id,label:e.label,levels:e.standardSkillStandardLevels.map((function(e){return{value:e.id,label:e.standardLevel.label}}))})})),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:le(i,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},yt=function(){return Ve.a.get("".concat(A,"/contactpersons"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=[];if(n.map((function(e){i.push({value:e.id,label:e.firstName+" "+e.lastName})})),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:le(i,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},ht=function(e){return Ve.a.get("".concat(A,"/").concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:le(n,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},vt=function(e){return Ve.a.get("".concat(A,"/Organizations"),{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.data,r=[];if(i.map((function(t){r.push({value:t.id,label:t.name,disabled:t.id===e&&!0})})),K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),n)return{success:n,data:le(r,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Et=function(){return Ve.a.get("".concat(A,"/panels"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=[];if(n.map((function(e){i.push({value:e.id,label:e.label})})),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:le(i,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},kt=function(e){return Ve.a.get("".concat(A,"/panel-skills?panelId=").concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=[];if(n.map((function(e){i.push({value:e.id,label:e.label,levels:e.panelSkillStandardLevels.map((function(e){return{value:e.id,label:e.levelLabel,stceil:e.shortTermCeil,ltceil:e.longTermCeil}}))})})),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:le(i,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},St=function(){return Ve.a.get("".concat(A,"/projects"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=[];l&&(n.map((function(e){i.push({value:e.id,label:e.title})})),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization));return{success:l,data:le(i,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Ct=function(e,t,a){return Ve.a.get("".concat(A,"/helpers/projects?userId=").concat(e,"&mod=").concat(t,"&phase=").concat(a),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization);return{success:l,data:le(n,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},jt=function(e){return Ve.a.get("".concat(A,"/helpers/levels-by-skill?").concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(l)return K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:le(n,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Dt=function(){return Ve.a.get("".concat(A,"/helpers/roles"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(l)return K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:le(n,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Ot=function(e){return Ve.a.get("".concat(A,"/").concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},It=function(){return Ve.a.get("".concat(A,"/leave-request-policies"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=[];if(n.map((function(e){i.push({value:e.id,label:e.label})})),i.push({value:0,label:"Unpaid"}),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:le(i,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Pt=function(){return Ve.a.get("".concat(A,"/leave-request-types/getOwn"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l){var i=n.holidays,r=n.contractDetails,o=n.LeaveRequestTypes,s=[{id:0,name:"Unpaid",include_off_days:!1}];return(void 0===o?[]:o).forEach((function(e,t){var a={};Object.entries(e).forEach((function(e){var t=Object(he.a)(e,2),l=t[0],n=t[1],i=l.replace(/([A-Z])/g,"_$1").toLowerCase();a[i]=n})),s.push(a)})),{success:l,data:n,holidays:i,contractDetails:r,LeaveRequestTypes:s}}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},xt=function(e){return Ve.a.get("".concat(A,"/auth/projects?resource=").concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:le(n,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Tt=function(e,t,a){return Ve.a.get("".concat(A,"/").concat(e,"/").concat(t,"/buy-cost?searchIn=").concat(a),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))};var zt=function(e){var t=Me.a.useForm(),a=Object(he.a)(t,1)[0],i=Object(l.useState)({settings:{},variables:{}}),r=Object(he.a)(i,2),o=r[0],s=r[1],c=Object(l.useState)([{fieldCol:6,Placeholder:"Rate",type:"Title",mode:4,fieldStyle:{textAlign:"right"},style:{textDecoration:"underline"}},{fieldCol:5,Placeholder:"Start Date",type:"Title",mode:4,fieldStyle:{textAlign:"center"},style:{textDecoration:"underline"}},{fieldCol:10,Placeholder:"Finish Date",type:"Title",mode:4,fieldStyle:{textAlign:"center"},style:{textDecoration:"underline"}},{fieldCol:24,Placeholder:"Sale Tax",type:"Title",mode:4,style:{textDecoration:"underline"}},{fieldCol:4,Placeholder:"GST:",type:"Text",itemStyle:{textAlign:"right",paddingRight:"15%"}},{object:"GST",fieldCol:3,key:"value",size:"small",shape:"%",type:"InputNumber"},{object:"GST",fieldCol:5,key:"startDate",size:"small",shape:"%",type:"DatePicker",rules:[function(e){var t=e.getFieldValue;return{validator:function(e,a){var l;return(null!==(l=t("GST"))&&void 0!==l?l:{}).value?a?Promise.resolve():Promise.reject(new Error("Start Date is Required!!")):Promise.resolve()}}}]},{object:"GST",fieldCol:10,key:"endDate",size:"small",shape:"%",type:"DatePicker",rules:[function(e){var t=e.getFieldValue;return{validator:function(e,a){var l;return(null!==(l=t("GST"))&&void 0!==l?l:{}).value?a?Promise.resolve():Promise.reject(new Error("End Date is Required!!")):Promise.resolve()}}}]},{fieldCol:24,Placeholder:"on Cost Rate",type:"Title",mode:4,style:{textDecoration:"underline"}},{fieldCol:4,Placeholder:"Superannuation:",type:"Text",itemStyle:{textAlign:"right",paddingRight:"15%",marginBottom:10}},{object:"Superannuation",fieldCol:3,key:"value",size:"small",shape:"%",type:"InputNumber"},{object:"Superannuation",fieldCol:5,key:"startDate",size:"small",shape:"%",type:"DatePicker",rules:[function(e){var t=e.getFieldValue;return{validator:function(e,a){var l;return(null!==(l=t("Superannuation"))&&void 0!==l?l:{}).value?a?Promise.resolve():Promise.reject(new Error("Start Date is Required!!")):Promise.resolve()}}}]},{object:"Superannuation",fieldCol:10,key:"endDate",size:"small",shape:"%",type:"DatePicker",rules:[function(e){var t=e.getFieldValue;return{validator:function(e,a){var l;return(null!==(l=t("Superannuation"))&&void 0!==l?l:{}).value?a?Promise.resolve():Promise.reject(new Error("End Date is Required!!")):Promise.resolve()}}}]}]),d=Object(he.a)(c,2),u=d[0],m=d[1],f=[{fieldCol:24,Placeholder:"General Settings",type:"Title",mode:4,style:{textDecoration:"underline"}},{fieldCol:4,size:"small",Placeholder:"Records Per Page",type:"Text",labelAlign:"right"},{object:"settings",fieldCol:20,key:"recordsPerPage",size:"small",type:"InputNumber",labelCol:{span:4},labelAlign:"right",itemStyle:{marginBottom:20}},{fieldCol:4,size:"small",Placeholder:"Display Email",rangeMin:!0,type:"Text",labelAlign:"left"},{object:"settings",fieldCol:20,key:"displayEmail",Placeholder:"Display Name In Email",size:"small",type:"input",labelCol:{span:3},labelAlign:"right",itemStyle:{marginBottom:20}},{fieldCol:4,size:"small",Placeholder:"From Email",rangeMin:!0,type:"Text",labelAlign:"left"},{object:"settings",fieldCol:20,key:"fromEmail",Placeholder:"From Email Address",size:"small",type:"input",labelCol:{span:3},labelAlign:"right",itemStyle:{marginBottom:20}},Object(Ne.a)({fieldCol:20,mode:"horizontal",type:"Divider",itemStyle:{padding:"0px",margin:"0px"}},"itemStyle",{marginBottom:20})];Object(l.useEffect)((function(){b()}),[]);var b=function(){Promise.all([pt(),bt(),_e(),Ve.a.get(He,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;$(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization);var r={};if(l){var o,s=Object(h.a)(n);try{for(s.s();!(o=s.n()).done;){var c=o.value,d=c.variable,u=c.globalVariableId,m=c.value,f=c.startDate,p=c.endDate;r[null===d||void 0===d?void 0:d.name]={globalVariableId:u,value:m,startDate:W(f),endDate:W(p)}}}catch(b){s.e(b)}finally{s.f()}}return{success:l,data:r}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))]).then((function(e){e[2].success&&a.setFieldsValue(Object(Fe.a)({settings:e[2].data},e[3].data));var t=e[0].success?e[0].data:[],l=e[1].success?e[1].data:[];s({settings:e[2].data,variable:e[3].data}),y([{value:"workCover",label:"WorkCover"}].concat(Object(we.a)(l),[{value:"publicHoildays",label:"Public Holidays"}]),t)})).catch((function(e){return console.log(e)}))},g=function(e){var t;return[{fieldCol:4,Placeholder:null!==(t=Y[e])&&void 0!==t?t:e,type:"Text",itemStyle:{textAlign:"right",paddingRight:"15%",marginBottom:10}},{object:e,fieldCol:3,key:"value",size:"small",shape:"%",type:"InputNumber"},{object:e,fieldCol:5,key:"startDate",size:"small",shape:"%",type:"DatePicker",rules:[function(t){var a=t.getFieldValue;return{validator:function(t,l){var n;return(null!==(n=a(e))&&void 0!==n?n:{}).value?l?Promise.resolve():Promise.reject(new Error("Start Date is Required!!")):Promise.resolve()}}}]},{object:e,fieldCol:10,key:"endDate",size:"small",shape:"%",type:"DatePicker",rules:[function(t){var a=t.getFieldValue;return{validator:function(t,l){var n;return(null!==(n=a(e))&&void 0!==n?n:{}).value?l?Promise.resolve():Promise.reject(new Error("End Date is Required!!")):Promise.resolve()}}}]}]},y=function(e,t){var a,l=[],n=[],i=Object(h.a)(e);try{for(i.s();!(a=i.n()).done;){var r=a.value.label;l.push.apply(l,Object(we.a)(g(r)))}}catch(d){i.e(d)}finally{i.f()}var o,s=Object(h.a)(t);try{for(s.s();!(o=s.n()).done;){var c=o.value.label;n.push.apply(n,Object(we.a)(g(c)))}}catch(d){s.e(d)}finally{s.f()}e.length>0&&m((function(e){return[].concat(Object(we.a)(e),l,[{fieldCol:24,Placeholder:"Payroll Tax",type:"Title",mode:5,itemStyle:{paddingLeft:"5%"},style:{textDecoration:"underline"}}],n,[{fieldCol:20,mode:"horizontal",type:"Divider",itemStyle:{padding:"0px",margin:"0px"}}])}))};return n.a.createElement(n.a.Fragment,null,n.a.createElement(Me.a,{id:"my-form",form:a,scrollToFirstError:!0,onFinish:function(e){delete e[void 0];var t=e.settings;delete e.settings;var l,n=[];Object.entries(e).map((function(e){var t=Object(he.a)(e,2),a=t[0],l=t[1];l.value&&n.push(Object(Fe.a)(Object(Fe.a)({},l),{},{name:a,startDate:W(l.startDate,!0),endDate:W(l.endDate,!0)}))})),Promise.all([(l=t,z.b.loading({content:"Loading...",key:1},5),Ve.a.post(Ye,l,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message,i=a.data;$(n),z.b.success({content:n,key:1},5),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization);var r={};return l&&i.forEach((function(e){var t=e.keyLabel,a=e.keyValue;r[t]=a})),{success:l,data:r}})).catch((function(e){return z.b.error({content:"Error!",key:1},5),{error:"Please login again!",status:!1,message:e.message}}))),Ue({variables:n})]).then((function(e){var t=e[0].success?e[0].data:o.settings,l=e[1].success?e[1].data:o.variables;a.setFieldsValue(Object(Fe.a)({settings:t},l))})).catch((function(e){return console.log(e)}))},size:"small",layout:"inline",style:{padding:"20px 50px 20px 50px"}},n.a.createElement(ft,{FormFields:u}),n.a.createElement(ft,{FormFields:f})),n.a.createElement(p.a,{justify:"end"},n.a.createElement(ce.b,{size:"large"},n.a.createElement(Le.a,{placement:"bottom",title:"Are you sure want to save new Settings?",onConfirm:function(){return a.submit()},okText:"Yes",cancelText:"No"},n.a.createElement(Be.a,{type:"primary",size:"small"},"Save")),n.a.createElement(Be.a,{size:"small",onClick:function(){return a.resetFields()}},"Cancel"))))};var At=function(e){var t=this,a=Me.a.useForm(),i=Object(he.a)(a,1)[0],r=Object(l.useState)([{fieldCol:6,Placeholder:"Rate",type:"Title",mode:4,fieldStyle:{textAlign:"right"},style:{textDecoration:"underline"}},{fieldCol:5,Placeholder:"Start Date",type:"Title",mode:4,fieldStyle:{textAlign:"center"},style:{textDecoration:"underline"}},{fieldCol:5,Placeholder:"Finish Date",type:"Title",mode:4,fieldStyle:{textAlign:"center"},style:{textDecoration:"underline"}},{fieldCol:24,Placeholder:"Sale Tax",type:"Title",mode:4,style:{textDecoration:"underline"}},{fieldCol:4,Placeholder:"GST:",type:"Text",itemStyle:{textAlign:"center"}},{object:"gst",fieldCol:3,key:"rate",size:"small",shape:"%",type:"InputNumber"},{object:"gst",fieldCol:5,key:"date",size:"small",shape:"%",type:"DatePicker"},{object:"gst",fieldCol:4,key:"finish",size:"small",shape:"%",type:"DatePicker"},{fieldCol:24,Placeholder:"on Cost Rate",type:"Title",mode:4,style:{textDecoration:"underline"}},{fieldCol:4,Placeholder:"Superannuation:",type:"Text",itemStyle:{textAlign:"center"}},{object:"superannuation",fieldCol:3,key:"rate",size:"small",shape:"%",type:"InputNumber"},{object:"superannuation",fieldCol:5,key:"date",size:"small",shape:"%",type:"DatePicker"},{object:"superannuation",fieldCol:4,key:"finish",size:"small",shape:"%",type:"DatePicker"},{fieldCol:24,Placeholder:"Payroll Tax",type:"Text",itemStyle:{paddingLeft:"5%"}}]),o=Object(he.a)(r,2),s=o[0];o[1],Object(l.useEffect)((function(){c()}),[]);var c=function(){Promise.all([pt(),bt()]).then((function(e){console.log(e[1])})).catch((function(e){return console.log(e)}))};return n.a.createElement(n.a.Fragment,null,n.a.createElement(Me.a,{id:"my-form",form:i,scrollToFirstError:!0,size:"small",layout:"inline",style:{padding:50,paddingTop:20}},n.a.createElement(ft,{FormFields:s})),n.a.createElement(p.a,{justify:"end"},n.a.createElement(ce.b,{size:"large"},n.a.createElement(Le.a,{placement:"bottom",title:"Are you sure want to save new Settings?",onConfirm:function(){return t.submit()},okText:"Yes",cancelText:"No"},n.a.createElement(Be.a,{type:"primary",size:"small"},"Save")),n.a.createElement(Be.a,{size:"small",onClick:function(){return t.reset()}},"Cancel"))))},Rt=a(569),wt=a(576),Ft=a(602),Nt=a(311),Mt=a(73),Lt=Me.a.Item,Bt=We.a.Dragger,qt=Ke.a.RangePicker,Vt=Ge.a.RangePicker,Yt=ve.a.Title,Ht=ve.a.Text,_t={required:"${label} is required!",types:{email:"${label} is not validate email!",number:"${label} is not a validate number!"},number:{range:"${label} must be between ${min} and ${max}"}},Ut=function(e){return Array.isArray(e)?e:e&&e.fileList},Wt=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).multipleUpload=function(e,t,a,n){var i=l.state.uploadKeys;return l.state.uploadKeys[a]=e,l.setState({uploadKeys:Object(Fe.a)({},i)}),!1},l.formatter=function(e,t){return"$"===t?"$ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,","):"ABN"===t?"".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g," "):t?"".concat(e).concat(t):"".concat(e)},l.parser=function(e,t){return"$"===t?e.replace(/\$\s?|(,*)/g,""):"ABN"===t?e.replace(/\$\s?|(\s*)/g,""):t?e.replace(t,""):e},l.onFinishs=function(e){l.props.Callback(e)},l.content=function(){var e=l.props.FormFields,t=e.fields,a=e.btns?e.btns:{},i=a.btn?a.btn:[];return n.a.createElement(b.a,{span:e.FormCol},n.a.createElement(Me.a,Object.assign({id:e.formId,ref:e.formId,style:e.Formstyle,name:"nest-messages",onFinish:l.onFinishs,validateMessages:_t,scrollToFirstError:!0,size:e.size,layout:e.FormLayout},e.layout,{initialValues:e.initialValues,preserve:!1!==e.preserve}),e.fields?n.a.createElement(n.a.Fragment,null,t.map((function(e,t){return n.a.createElement(b.a,{span:e.fieldCol,offset:e.filedOffset,key:t+1,hidden:!0===e.hidden,style:e.style},n.a.createElement(Lt,Object.assign({},e.layout,{name:[e.object,e.key],extra:e.hint,labelAlign:e.labelAlign,label:e.label,labelCol:e.labelCol,wrapperCol:e.wrapperCol,rules:e.rules,valuePropName:e.valuePropName,getValueFromEvent:e.getValue&&Ut,hidden:!0===e.hidden,style:e.itemStyle,noStyle:e.noStyle}),l.filedformat(e.type,e.Placeholder,e.data,e.mode,e.rangeMin,e.rangeMax,e.showTime,e.shape,e.size,e.fieldStyle,e.disabled,e.readOnly,e.onChange,e.onClick,e.onBlur,e.onClear,e.tooltip,e.tooltipTitle,e.tooltipTrigger)))}))):n.a.createElement("span",null),a.btn?n.a.createElement(b.a,{span:a.fieldCol,offset:a.filedOffset},n.a.createElement(p.a,{justify:a.justify,style:a.backstyle},n.a.createElement(Lt,{style:a.style},n.a.createElement(ce.b,{size:a.size},i.map((function(e,t){return n.a.createElement(Be.a,{key:t,type:e.type,htmlType:e.htmlType,size:e.size,hidden:e.hidden,s:!0},e.placeholder)})))))):n.a.createElement("span",null)))},l.filedformat=function(e,t,a,i,r,o,s,c,d,u,m,f,p,b,g,y,h,v,E){var k=null;switch(e){case"Title":k=n.a.createElement(Yt,{level:i,size:d,style:u},h?n.a.createElement($e.a,{title:v,trigger:E}," ",t):t);break;case"Text":k=n.a.createElement(Ht,{strong:i,onClick:b,style:u,disabled:m},h?n.a.createElement($e.a,{title:v,trigger:E}," ",t):t,r&&n.a.createElement("span",{style:{color:"red"}}," * "));break;case"Password":k=n.a.createElement(Je.a.Password,{placeholder:t,visibilityToggle:i,size:d,style:u});break;case"Textarea":k=n.a.createElement(Je.a.TextArea,{placeholder:t,allowClear:!0,autoSize:i,asize:d,style:u,prefix:i});break;case"InputNumber":k=n.a.createElement(Xe.a,{placeholder:t,min:r,max:o,size:d,formatter:function(e){return l.formatter(e,c)},parser:function(e){return l.parser(e,c)},style:u,onBlur:g,onChange:p,disabled:m,readOnly:f});break;case"Select":k=n.a.createElement(Qe.a,{placeholder:t,options:a,mode:i,showArrow:!0,size:d,allowClear:!0,onChange:p,onClear:y,style:u,showSearch:!0,optionFilterProp:["label","value"],filterOption:function(e,t){var a=t.label.toLowerCase().indexOf(e.toLowerCase())>=0,l=t.value.toString().toLowerCase().indexOf(e.toLowerCase())>=0;return a||l},disabled:m});break;case"Switch":k=n.a.createElement(Ze.a,{size:d,style:u});break;case"Radio":k=n.a.createElement(et.a.Group,{options:a,optionType:i,buttonStyle:c,size:d,style:u});break;case"Checkbox":k=n.a.createElement(tt.a,{options:a,size:d,style:u,onChange:p});break;case"CheckboxGroup":k=n.a.createElement(tt.a.Group,{options:a,size:d,style:u,onChange:p});break;case"DatePicker":k=n.a.createElement(Ke.a,{picker:i,showTime:s,disabledDate:null!==r&&void 0!==r?r:o,size:d,style:u,onBlur:g,onChange:p,format:"ddd DD MMM yyyy",disabled:m});break;case"TimePicker":k=n.a.createElement(Ge.a,{format:s,use12Hours:"use12Hours"===i,size:d,minuteStep:r,showNow:o,style:u});break;case"TimeRange":k=n.a.createElement(Vt,{format:s,use12Hours:"use12Hours"===i,minuteStep:r,size:d,showNow:o,style:u});break;case"RangePicker":k=n.a.createElement(qt,{picker:i,showTime:s,size:d,style:u,format:"ddd DD MMM yyyy"});break;case"Divider":k=n.a.createElement(at.a,{type:i,style:u});break;case"Button":k=n.a.createElement(Be.a,{type:i,shape:c,block:o,style:u,onClick:b,size:d},t);break;case"Upload":k=n.a.createElement(We.a,{name:"logo",action:i,listType:"text",multiple:o,style:u},t);break;case"Dragger":k=n.a.createElement(Bt,{name:"logo",action:i,listType:"text",multiple:!0,style:u,beforeUpload:function(){return!1}},t);break;default:k=n.a.createElement(Je.a,{placeholder:t,style:u,size:d,disabled:m,readOnly:f,onBlur:g,onChange:p})}return k},l}return Object(d.a)(a,[{key:"render",value:function(){return this.content()}}]),a}(l.Component),Kt=Wt,Gt="".concat(A,"/calendar-holidays"),$t=a(305),Jt=(a(141),function(e,t,a){return{sorter:function(a,l){var n=ta(a,e),i=ta(l,e);return"number"===t?n-i:"string"===t?"".concat(n).localeCompare("".concat(i)):"date"===t?T()(n||"2011 11 10").unix()-T()(i||"2011 11 10").unix():void 0},defaultSortOrder:a&&"ascend"}}),Xt=function(e,t,a,l){return{sorter:function(a,n){var i=ta(a,e),r=ta(n,e);return i=i===l?"AA":i,r=r===l?"AA":r,"number"===t?i-r:"string"===t?"".concat(i).localeCompare("".concat(r)):"date"===t?T()(i||"2011 11 10").unix()-T()(r||"2011 11 10").unix():void 0},defaultSortOrder:a&&"ascend"}},Qt=function(e,t){return n.a.createElement(p.a,{justify:"end"},n.a.createElement(b.a,{span:e},n.a.createElement(Je.a.Search,{placeholder:"Search Table",enterButton:!0,size:"small",onChange:function(e){var a=e.target.value;t(a)},onPressEnter:function(e){var a=e.target.value;t(a)},allowClear:!0})))},Zt=function(e){var t=e.title,a=e.visible,i=e.onClose,r=e.filters,o=e.filterFunction,s=e.filterFields,c=e.effectRender,d=e.effectFunction,u=Me.a.useForm(),m=Object(he.a)(u,1)[0];Object(l.useEffect)((function(){var e={};for(var t in c&&d(),r)if("Date"===r[t].type){var a=r[t].value;e[t]=a&&[T()(a[0]),T()(a[1])]}else{var l;e[t]=null!==(l=r[t].value)&&void 0!==l?l:""}m.setFieldsValue({obj:e})}),[]);return n.a.createElement(wt.a,{title:t,maskClosable:!1,centered:!0,width:750,visible:a,destroyOnClose:!0,onOk:function(){m.submit()},onCancel:function(){return i()}},n.a.createElement(Me.a,{form:m,size:"small",layout:"inline",onFinish:function(e){for(var t in e=e.obj,r)if("Date"===r[t].type){var a,l,n=e[t];r[t].value=n&&[null===(a=n[0])||void 0===a?void 0:a.format("YYYY-MM-DD"),null===(l=n[1])||void 0===l?void 0:l.format("YYYY-MM-DD")]}else{var i;r[t].value=null!==(i=e[t])&&void 0!==i?i:""}o(!1,!1,r)}},n.a.createElement(ft,{FormFields:s})))},ea=function(e){var t=e.filters,a=e.filterFunction,i=Object.keys(t),r=Object(l.useState)({}),o=Object(he.a)(r,2),s=(o[0],o[1]);return Object(l.useEffect)((function(){return function(){s({})}}),[]),n.a.createElement(b.a,{span:24},i.map((function(e){return t[e].value&&t[e].value.length>0&&n.a.createElement("span",{key:e},n.a.createElement($t.a,{color:"magenta",key:e},t[e].label,": "),"string"===typeof t[e].value?n.a.createElement($t.a,{key:"".concat(e,"value"),color:"lime",closable:!0,onClose:function(){return a("",e)}},t[e].value):"Date"===t[e].type?n.a.createElement($t.a,{key:t[e].value[0],color:"lime",closable:!0,onClose:function(){a(null,e)}},"".concat(t[e].value[0],"=>").concat(t[e].value[1])):t[e].multi?t[e].value&&t[e].value.map((function(l){return n.a.createElement($t.a,{key:"".concat(e).concat(l.value),color:"lime",closable:!0,onClose:function(){var n=t[e].value.filter((function(e){return e.value!==l.value}));a(n,e)}},l.label)})):t[e].value&&t[e].value.map((function(l){return n.a.createElement($t.a,{key:"".concat(e).concat(l),color:"lime",closable:!0,onClose:function(){var n=t[e].value.filter((function(e){return e!==l}));a(n,e)}},l)})))})))},ta=function(e,t){return t.split(".").reduce((function(e,t){var a;return null!==(a=e[t])&&void 0!==a?a:""}),e)},aa=ve.a.Title,la=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).getData=function(e){(function(e){return Ve.a.get(Gt+"?calendarId=".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;($(i),l)&&(n.map((function(e){e.label=e.holidayType.label})),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization));return{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))})(e).then((function(t){t.success&&l.setState({data:t.data,calendarId:e,filterData:t.data,openModal:!1,editTimeoff:!1,loading:!1})}))},l.handleDelete=function(e){(function(e){return Ve.a.delete(Gt+"/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;if($(n),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return l})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(e).then((function(e){e&&l.getData()}))},l.toggelModal=function(e){if(e){var t=l.state.FormFields;Ve.a.get("".concat(A,"/holiday-types"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&(n.map((function(e){e.value=e.id,delete e.id,delete e.createdAt,delete e.deletedAt,delete e.updatedAt})),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization)),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(a){a.success&&(t.fields[0].data=a.data,l.setState({FormFields:t,openModal:e}))}))}else l.setState({openModal:e,editTimeoff:!1})},l.Callback=function(e){var t={calendarId:l.state.calendarId,holidayTypeId:null===e||void 0===e?void 0:e.obj.holidayTypeId,date:W(null===e||void 0===e?void 0:e.obj.date,!0)};l.state.editTimeoff?l.editRecord(t):l.addType(t)},l.addType=function(e){var t;l.setState({loading:!0}),(t=e,z.b.loading({content:"Loading...",key:1}),Ve.a.post(Gt,t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e&&l.getData()}))},l.getRecord=function(e){var t={id:e.id,holidayTypeId:e.holidayTypeId,date:W(e.date)};l.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{obj:t}}),editTimeoff:t.id},(function(){l.toggelModal(!0)}))},l.editRecord=function(e){var t,a=l.state.editTimeoff;l.setState({loading:!0}),e.id=a,(t=e,z.b.loading({content:"Loading...",key:t.id}),Ve.a.put(Gt+"/".concat(t.id),t,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:t.id}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),n})).catch((function(e){return z.b.error({content:e.message,key:t.id}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e&&l.getData()}))},l.submit=function(){l.holidayForm.current.refs.form.submit()},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){return t.label&&t.label.toLowerCase().includes(e.toLowerCase())||t.date&&W(t.date,!0,!0).toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.advancefilter=function(e,t,a){var n=l.state,i=n.data,r=n.searchedColumn;if(t?r[t].value=e:r=a,r.label.value||r.date.value){var o,s=null!==(o=r.date.value)&&void 0!==o?o:[null,null];l.setState({filterData:i.filter((function(e){var t,a,l;return"".concat(null!==(t=e.label)&&void 0!==t?t:"").toLowerCase().includes(r.label.value.toLowerCase())&&T()(r.date.value?T()(e.date).format("YYYY-MM-DD"):"2010-10-20").isBetween(null!==(a=s[0])&&void 0!==a?a:"2010-10-19",null!==(l=s[1])&&void 0!==l?l:"2010-10-25",void 0,"[]")})),searchedColumn:r,openSearch:!1})}else l.setState({searchedColumn:r,filterData:i,openSearch:!1})},l.holidayForm=n.a.createRef(),l.columns=[Object(Fe.a)({title:"Title",dataIndex:"label",key:"label"},Jt("label","string")),Object(Fe.a)({title:"Date",dataIndex:"date",key:"date",render:function(e,t){return W(e,!0,!0)}},Jt("date","date")),{title:"Action",key:"action",align:"right",width:115,render:function(e,t){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Delete",danger:!0,className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){return l.getRecord(t)}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))}}],l.state={calendarId:!1,data:[],filterData:[],openModal:!1,editTimeoff:!1,FormFields:{formId:"form",justify:"center",FormCol:12,layout:{labelCol:{span:6}},justifyField:"center",size:"small",fields:[{object:"obj",fieldCol:24,key:"holidayTypeId",label:"Title",size:"small",type:"Select",data:[],labelAlign:"right"},{object:"obj",fieldCol:24,key:"date",label:"Date",size:"small",mode:"date",type:"DatePicker",labelAlign:"right",fieldStyle:{width:"100%"}}]},openSearch:!1,searchedColumn:{label:{type:"Input",value:"",label:"label",showInColumn:!0},date:{type:"Date",value:null,label:"Date",showInColumn:!0}},filterFields:[{Placeholder:"Title",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Date",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"label",size:"small",type:"Input"},{object:"obj",fieldCol:12,key:"date",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}}]},l}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.match.params.id;this.getData(e)}},{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.openModal),l=t.editTimeoff,i=t.FormFields,r=t.loading,o=t.filterData,s=t.openSearch,c=t.filterFields,d=t.searchedColumn,u=this.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(aa,{level:4},"Holidays")),n.a.createElement(b.a,{span:"2"},n.a.createElement(Ke.a,{size:"small",mode:"year",picker:"year",format:"YYYY",defaultValue:T()(new Date)})),n.a.createElement(b.a,null,n.a.createElement(p.a,{justify:"space-between",gutter:10},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"default",size:"small",onClick:function(){return e.setState({openSearch:!0})}},n.a.createElement(Ft.a,null),"Filter")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){e.toggelModal(!0)}},n.a.createElement(Nt.a,null)," Add Holiday")))),n.a.createElement(ea,{filters:d,filterFunction:this.advancefilter}),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},columns:u,dataSource:o,size:"small",rowKey:function(e){return e.id},className:"fs-small"}))),s&&n.a.createElement(Zt,{title:"Filter Holidays",visible:s,filters:d,filterFields:c,filterFunction:this.advancefilter,effectRender:!1,onClose:function(){return e.setState({openSearch:!1})}}),a?n.a.createElement(wt.a,{title:l?"Edit Holiday":"Add Holiday",maskClosable:!1,centered:!0,visible:a,onOk:function(){e.submit()},onCancel:function(){e.toggelModal(!1)},okButtonProps:{disabled:r},okText:r?n.a.createElement(Mt.a,null):"Save",width:500,bodyStyle:{padding:"10px 0px 0px 0px"}},n.a.createElement(p.a,{justify:"center"},n.a.createElement(Kt,{ref:this.holidayForm,Callback:this.Callback,FormFields:i}))):null)}}]),a}(l.Component),na="".concat(A,"/calendars"),ia=ve.a.Title,ra=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.getData()},l.getData=function(){Ve.a.get(na,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(e){e.success&&l.setState({data:e.data,filterData:e.data,FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{}}),openModal:!1,editTimeoff:!1,loading:!1})}))},l.toggelModal=function(e){e?l.setState({openModal:e}):l.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{}}),openModal:!1,editTimeoff:!1})},l.Callback=function(e){l.state.editTimeoff?l.editRecord(e.obj):l.addCal(e.obj)},l.addCal=function(e){var t;l.setState({loading:!0}),(t=e,z.b.loading({content:"Loading...",key:1}),Ve.a.post(na,t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;if($(n),z.b.success({content:n,key:1}),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return l})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e&&l.getData()}))},l.getRecord=function(e,t){l.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{obj:e}}),editTimeoff:e.id,openModal:!0})},l.editRecord=function(e){var t,a=l.state.editTimeoff;l.setState({loading:!0}),e.id=a,(t=e,z.b.loading({content:"Loading...",key:t.id}),Ve.a.put(na+"/".concat(t.id),t,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:t.id},5),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),n})).catch((function(e){return z.b.error({content:e.message,key:t.id}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e&&l.getData()}))},l.submit=function(){l.state.calenderForm.current.refs.calenderId.submit()},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){return t.label&&t.label.toLowerCase().includes(e.toLowerCase())||"".concat(t.isActive?"Enabled":"Disabled").toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.columns=[Object(Fe.a)({title:"Title",dataIndex:"label",key:"label"},Jt("label","string")),{title:"Status",dataIndex:"isActive",key:"isActive",align:"right",render:function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement($t.a,{color:e?"green":"#7d7b7b",key:e},e?"Enabled":"Disabled"))}},{title:"Action",key:"action",align:"right",width:115,render:function(e,t){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{onClick:function(){return l.getRecord(e,t)}},"Edit"),n.a.createElement(v.a.Item,null,n.a.createElement(s.b,{to:{pathname:"/admin/calendars/holidays/".concat(e.id)},className:"nav-link"},"Holidays")))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))}}],l.state={data:[],calenderForm:n.a.createRef(),openModal:!1,filterData:[],FormFields:{formId:"calenderId",justify:"center",FormCol:20,FieldSpace:{xs:12,sm:16,md:122},layout:{labelCol:{span:12}},justifyField:"center",size:"middle",initialValues:{obj:{isActive:!0}},fields:[{object:"obj",fieldCol:20,layout:{labelCol:{span:4},wrapperCol:{span:0}},key:"label",label:"Title",size:"small",type:"input",labelAlign:"left"},{object:"obj",fieldCol:20,key:"isActive",label:"Status",size:"small",type:"Switch",layout:{labelCol:{span:4}},labelAlign:"left",valuePropName:"checked"}]}},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.openModal),l=t.editTimeoff,i=t.loading,r=t.calenderForm,o=t.FormFields,s=t.filterData,c=this.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(ia,{level:4},"Calendars")),n.a.createElement(b.a,{style:{textAlign:"end"}},n.a.createElement(Be.a,{type:"primary",onClick:function(){e.toggelModal(!0)},size:"small"},n.a.createElement(Nt.a,null),"Add Calendar")),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},columns:c,dataSource:s,size:"small",rowKey:function(e){return e.id},className:"fs-small"}))),a?n.a.createElement(wt.a,{title:l?"Edit Calendar":"Add Calendar",maskClosable:!1,centered:!0,visible:a,onOk:function(){e.submit()},okButtonProps:{disabled:i},okText:i?n.a.createElement(Mt.a,null):"Save",onCancel:function(){e.toggelModal(!1)},width:600},n.a.createElement(Kt,{ref:r,Callback:this.Callback,FormFields:o})):null)}}]),a}(l.Component),oa="".concat(A,"/holiday-types"),sa=ve.a.Title,ca=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getData()},e.getData=function(){Ve.a.get(oa,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(t){t.success&&e.setState({data:t.data,filterData:t.data,isVisible:!1,editType:!1})}))},e.handleDelete=function(t){(function(e){return Ve.a.delete(oa+"/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(t).then((function(t){t&&e.getData()}))},e.submit=function(){e.HalForm.current.refs.type_form.submit()},e.Callback=function(t){e.state.editType?e.editRecord(t.obj):e.addType(t.obj)},e.addType=function(t){var a;e.setState({loading:!1}),(a=t,z.b.loading({content:"Loading...",key:1}),Ve.a.post(oa,a,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1}),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){t&&(e.HalForm.current.refs.type_form.resetFields(),e.getData())}))},e.getRecord=function(t){var a=Object.assign({},t);e.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},e.state.FormFields),{},{initialValues:{obj:a}}),editType:a.id,isVisible:!0})},e.editRecord=function(t){var a,l=e.state.editType;e.setState({loading:!1}),t.id=l,(a=t,z.b.loading({content:"Loading...",key:a.id}),Ve.a.put(oa+"/".concat(a.id),a,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:a.id}),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),n})).catch((function(e){return z.b.error({content:e.message,key:a.id}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){t&&(e.HalForm.current.refs.type_form.resetFields(),e.getData())}))},e.generalFilter=function(t){var a=e.state.data;t?e.setState({filterData:a.filter((function(e){return e.label&&e.label.toLowerCase().includes(t.toLowerCase())}))}):e.setState({filterData:a})},e.HalForm=n.a.createRef(),e.columns=[Object(Fe.a)({title:"Types",dataIndex:"label",key:"label"},Jt("label","string")),{title:"Action",key:"action",align:"right",width:115,render:function(t,a){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){return e.getRecord(t,a)}},"Edit"),n.a.createElement(v.a.Item,{key:"Delete",danger:!0,className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(t.id)}},n.a.createElement("div",null," Delete "))))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))}}],e.state={isVisible:!1,newType:"",data:[],filterData:[],editType:!1,FormFields:{formId:"type_form",FormCol:20,FieldSpace:{xs:12,sm:16,md:122},FormLayout:"inline",size:"middle",fields:[{object:"obj",fieldCol:24,key:"label",label:"Name",labelAlign:"right",type:"Input",size:"small"}]}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.isVisible),l=t.editType,i=t.FormFields,r=t.loading,o=t.filterData;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(sa,{level:3},"Holiday Types")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){e.setState({isVisible:!0})}},n.a.createElement(Nt.a,null)," Holiday Type"))),n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},columns:this.columns,dataSource:o,size:"small",rowKey:function(e){return e.id},className:"fs-small"}),a&&n.a.createElement(wt.a,{title:l?"Edit Type":"Add Type",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:r},okText:r?n.a.createElement(Mt.a,null):"Save",width:400,onCancel:function(){delete i.initialValues,e.setState({isVisible:!1,FormFields:i})},onOk:function(){e.submit()}},n.a.createElement(p.a,{justify:"center"},n.a.createElement(Kt,{ref:this.HalForm,Callback:this.Callback,FormFields:i}))))}}]),a}(l.Component),da="".concat(A,"/leave-request-types"),ua=ve.a.Title,ma=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.getData()},l.getData=function(){Ve.a.get(da,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(e){e.success&&l.setState({data:e.data,filterData:e.data,openModal:!1,editTimeoff:!1,loading:!1,FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{}})})}))},l.handleDelete=function(e){(function(e){return Ve.a.delete(da+"/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(e).then((function(e){e&&l.getData()}))},l.toggelModal=function(e){e?l.setState({openModal:e}):l.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{}}),openModal:e,editTimeoff:!1})},l.submit=function(){l.dynamoForm.current.refs.time_off.submit()},l.Callback=function(e){l.state.editTimeoff?l.editRecord(e.obj):l.addType(e.obj)},l.addType=function(e){var t;l.setState({loading:!0}),console.log(e),(t=e,z.b.loading({content:"Loading...",key:1}),Ve.a.post(da,t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:"Success!",key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e&&l.getData()}))},l.getRecord=function(e){l.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{obj:e}}),editTimeoff:e.id,openModal:!0})},l.editRecord=function(e){var t;l.setState({loading:!0}),e.id=l.state.editTimeoff,(t=e,z.b.loading({content:"Loading...",key:t.id}),Ve.a.put(da+"/".concat(t.id),t,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:"Success!",key:t.id}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),n})).catch((function(e){return z.b.error({content:e.message,key:t.id}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e&&l.getData()}))},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){return t.label&&t.label.toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.dynamoForm=n.a.createRef(),l.columns=[Object(Fe.a)({title:"Title",dataIndex:"label",key:"label"},Jt("label","string")),{title:"Action",key:"action",align:"right",width:115,render:function(e,t){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{danger:!0,key:"Delete",className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){return l.getRecord(t)}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))}}],l.state={data:[],filterData:[],openModal:!1,editTimeoff:!1,loading:!1,FormFields:{formId:"time_off",justify:"center",FormCol:20,FieldSpace:{xs:12,sm:16,md:122},layout:{labelCol:{span:12}},justifyField:"center",size:"middle",fields:[{object:"obj",fieldCol:20,layout:{labelCol:{span:4},wrapperCol:{span:0}},key:"label",label:"Title",size:"small",type:"input",labelAlign:"left"}]}},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.editTimeoff),l=t.openModal,i=t.loading,r=t.FormFields,o=t.filterData,s=this.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(ua,{level:4},"Leave Categories")),n.a.createElement(b.a,{style:{textAlign:"end"}},n.a.createElement(Be.a,{type:"primary",onClick:function(){e.toggelModal(!0)},size:"small"},n.a.createElement(Nt.a,null),"Add Leave Category")),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},columns:s,dataSource:o,size:"small",rowKey:function(e){return e.id},className:"fs-small"}))),l?n.a.createElement(wt.a,{title:a?"Edit Leave Category":"Add Leave Category",maskClosable:!1,centered:!0,visible:l,onOk:function(){e.submit()},okButtonProps:{disabled:i},okText:i?n.a.createElement(Mt.a,null):"Save",onCancel:function(){e.toggelModal(!1)},width:600},n.a.createElement(Kt,{ref:this.dynamoForm,Callback:this.Callback,FormFields:r})):null)}}]),a}(l.Component),fa=a(603),pa="".concat(A,"/leave-request-policies"),ba=ve.a.Title,ga=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.timeOff(),l.getData()},l.timeOff=function(){Ve.a.get("".concat(A,"/leave-request-types"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&(n.map((function(e){e.value=e.id,delete e.id,delete e.createdAt,delete e.deletedAt,delete e.updatedAt})),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization)),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(e){if(e.success){var t=l.state.FormFields_1;t[0].data=e.data,l.setState({FormFields_1:t})}}))},l.getData=function(){Ve.a.get(pa,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(e){e.success&&l.setState({data:e.data,filterData:e.data,openModal:!1,editTimeoff:!1,loading:!1})}))},l.handleDelete=function(e){(function(e){return Ve.a.delete(pa+"/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(e).then((function(e){e&&l.getData()}))},l.getRecord=function(e,t){l.setState({editTimeoff:e.id,openModal:!0},(function(){return l.formRef.current.setFieldsValue({obj:e})}))},l.editRecord=function(e){var t;e.id=l.state.editTimeoff,console.log(e),l.setState({loading:!0}),(t=e,z.b.loading({content:"Loading...",key:t.id}),Ve.a.put(pa+"/".concat(t.id),t,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:t.id}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),n})).catch((function(e){return z.b.error({content:e.message,key:t.id}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e&&l.getData()}))},l.renderTable=function(e){var t;l.setState({loading:!0}),(t=e,z.b.loading({content:"Loading...",key:1}),Ve.a.post(pa,t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){l.getData()}))},l.onFinish=function(e){var t=e.obj;l.state.editTimeoff?(console.log("edit"),l.editRecord(t)):(console.log("emes"),l.renderTable(t))},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){return t.label&&t.label.toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.formRef=n.a.createRef(),l.addField=n.a.createRef(),l.columns=[Object(Fe.a)({title:"Code",dataIndex:"id",key:"id",width:"5%"},Jt("id","number",!0)),Object(Fe.a)({title:"Title",dataIndex:"label",key:"label"},Jt("label","string")),{title:"Action",key:"action",align:"right",width:115,render:function(e,t){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Delete",className:"pop-confirm-menu",danger:!0},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){return l.getRecord(t,e)}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))}}],l.state={data:[],filterData:[],openModal:!1,loading:!1,FormFields:[{object:"obj",fieldCol:24,key:"label",label:"Policy Title",size:"small",rules:[{required:!0,message:"Policy Title is Required"}],type:"Input",labelAlign:"left",itemStyle:{marginBottom:"5px"}},{fieldCol:24,layout:{wrapperCol:{span:0}},Placeholder:"Insert Leave Type",type:"Button",mode:"primary",style:{textAlign:"right"},size:"small",onClick:function(e,t){l.addField.click()},itemStyle:{marginBottom:5}},{fieldCol:5,Placeholder:"Categories",type:"Text",size:"small",style:{margin:"auto 0"}},{fieldCol:2,layout:{wrapperCol:{offset:1}},Placeholder:"Earn Hours",type:"Text",size:"small",style:{margin:"auto 0"}},{fieldCol:3,layout:{wrapperCol:{offset:1}},Placeholder:"Earn Every",type:"Text",size:"small",style:{margin:"auto 0"}},{fieldCol:2,layout:{wrapperCol:{offset:1}},Placeholder:"Rest Hours",type:"Text",size:"small",style:{margin:"auto 0"}},{fieldCol:3,layout:{wrapperCol:{offset:1}},Placeholder:"Reset Every",type:"Text",size:"small",style:{margin:"auto 0"}},{fieldCol:2,layout:{wrapperCol:{offset:1}},Placeholder:"Threshold",type:"Text",size:"small",style:{margin:"auto 0"}},{fieldCol:2,layout:{wrapperCol:{offset:1}},Placeholder:"Overdraw Allowance",type:"Text",size:"small",style:{margin:"auto 0"}},{fieldCol:2,layout:{wrapperCol:{offset:1}},Placeholder:"Balance Required",type:"Text",size:"small",style:{margin:"auto 0"}},{fieldCol:2,layout:{wrapperCol:{offset:1}},Placeholder:"Include Holidays",type:"Text",size:"small",style:{margin:"auto 0"}}],FormFields_1:[{fieldCol:5,key:"leaveRequestTypeId",size:"small",type:"Select",itemStyle:{marginBottom:"5px"}},{fieldCol:2,key:"earnHours",initialValue:0,size:"small",type:"InputNumber",fieldStyle:{width:"100%"}},{fieldCol:3,key:"earnEvery",initialValue:"N",size:"small",type:"Select",labelAlign:"left",data:[{value:"M",label:"Monthly"},{value:"Y",label:"Yearly"},{value:"A",label:"Anniversary"},{value:"MA",label:"Monthly Anniversary"},{value:"N",label:"NEVER"}]},{fieldCol:2,key:"resetHours",initialValue:0,size:"small",type:"InputNumber",labelAlign:"left",fieldStyle:{width:"100%"}},{fieldCol:3,key:"resetEvery",initialValue:"N",size:"small",type:"Select",labelAlign:"left",data:[{value:"M",label:"Monthly"},{value:"Y",label:"Yearly"},{value:"A",label:"Anniversary"},{value:"MA",label:"Monthly Anniversary"},{value:"N",label:"NEVER"}]},{fieldCol:2,key:"threshold",initialValue:0,size:"small",type:"InputNumber",labelAlign:"left",fieldStyle:{width:"100%"}},{fieldCol:2,key:"minimumBalance",initialValue:0,size:"small",type:"InputNumber",labelAlign:"left",fieldStyle:{width:"100%"},rules:[{type:"number",max:0,message:"Maximum 0"}]},{fieldCol:2,key:"minimumBalanceRequired",initialValue:0,size:"small",type:"InputNumber",labelAlign:"left",fieldStyle:{width:"100%"},rules:[{type:"number",min:0,message:"Minimum 0"}]},{fieldCol:1,key:"includeOffDays",valuePropName:"checked",size:"small",type:"Switch",labelAlign:"left",style:{textAlign:"center"}}],editTimeoff:!1},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.openModal),l=t.editTimeoff,i=t.FormFields,r=t.FormFields_1,o=t.loading,s=t.filterData,c=this.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(ba,{level:4},"Leave Policies ")),n.a.createElement(b.a,{style:{textAlign:"end"}},n.a.createElement(Be.a,{type:"primary",onClick:function(){e.setState({openModal:!0})},size:"small"},n.a.createElement(Nt.a,null),"Add Leave Policy")),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:c,dataSource:s,size:"small",className:"fs-small"}))),a&&n.a.createElement(wt.a,{title:l?"Edit Leave Policy":"Add Leave Policy",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:o,htmlType:"submit",form:"my-form"},okText:o?n.a.createElement(Mt.a,null):"Save",onCancel:function(){e.setState({openModal:!1})},width:1400,forceRender:!0},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,scrollToFirstError:!0,size:"small",layout:"inline"},n.a.createElement(ft,{FormFields:i}),n.a.createElement(Me.a.List,{name:["obj","leaveRequestPolicyLeaveRequestTypes"]},(function(t,a){var l=a.add,i=a.remove;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Me.a.Item,{style:{textAlign:"right"}},n.a.createElement(Be.a,{size:"small",onClick:function(){return l()},ref:function(t){return e.addField=t}})),t.map((function(e){var t=e.name,a=e.key;return n.a.createElement("span",{className:"ant-row",key:a,style:{width:"100%"}},n.a.createElement(ft,{FormFields:r,listName:t}),n.a.createElement(fa.a,{style:{color:"red",margin:"auto"},onClick:function(){return i(t)}}))})))})))))}}]),a}(l.Component),ya="".concat(A,"/roles"),ha={ADMIN_OPTIONS:{ADD:["ANY"],UPDATE:["ANY"],READ:["ANY"],DELETE:["ANY"]},CONTACT_PERSONS:{ADD:["ANY"],UPDATE:["ANY"],READ:["ANY"],DELETE:["ANY"]},ORGANIZATIONS:{ADD:["ANY"],UPDATE:["ANY"],READ:["ANY"],DELETE:["ANY"]},USERS:{ADD:["ANY"],UPDATE:["ANY"],READ:["ANY"],DELETE:["ANY"]},PROJECTS:{ADD:["ANY"],UPDATE:["ANY","MANAGE"],READ:["ANY","MANAGE","OWN"],DELETE:["ANY"]},OPPORTUNITIES:{ADD:["ANY"],UPDATE:["ANY","MANAGE"],READ:["ANY","MANAGE"],DELETE:["ANY"]},TIMESHEETS:{ADD:["OWN"],UPDATE:["OWN"],READ:["ANY","MANAGE","OWN"],DELETE:["OWN"],APPROVAL:["ANY","MANAGE"],UNAPPROVAL:["ANY","MANAGE"]},LEAVE_REQUESTS:{ADD:["OWN"],UPDATE:["OWN"],READ:["OWN"],DELETE:["OWN"],APPROVAL:["ANY","MANAGE"],UNAPPROVAL:["ANY","MANAGE"]},EXPENSES:{ADD:["OWN"],UPDATE:["OWN"],READ:["OWN"],DELETE:["OWN"],APPROVAL:["ANY","MANAGE"],UNAPPROVAL:["ANY","MANAGE"]},PROFILE:{UPDATE:["OWN"]}},va=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.handleRawDtata()},l.handleRawDtata=function(){var e=l.state.newPermission;l.props.perData.forEach((function(t){e[t.resource]?e[t.resource][t.action]?e[t.resource][t.action].push(t.grant):e[t.resource][t.action]=[t.grant]:e[t.resource]=Object(Ne.a)({},t.action,[t.grant])})),l.formRef.current.setFieldsValue(Object(Fe.a)({},e))},l.onFinish=function(e){for(var t,a,n=[],i=l.props,r=i.eidtPer,o=i.Callback,s=0,c=Object.entries(e);s<c.length;s++){var d=Object(he.a)(c[s],2),u=d[0],m=d[1];if(m)for(var f=0,p=Object.entries(m);f<p.length;f++){var b=Object(he.a)(p[f],2),g=b[0],y=b[1];if(y){var v,E=Object(h.a)(y);try{for(E.s();!(v=E.n()).done;){var k=v.value;n.push({resource:u,action:g,grant:k})}}catch(S){E.e(S)}finally{E.f()}}}}(t=r,a=n,z.b.loading({content:"Loading...",key:t}),Ve.a.put(ya+"/".concat(t,"/update-permissions"),a,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.data,r=l.message;return $(r),z.b.success({content:r,key:t}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),{success:n,data:i}})).catch((function(e){return z.b.error({content:e.message,key:t}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e.success&&o(e.data)}))},l.formRef=n.a.createRef(),l.Columns=[{title:"Category",dataIndex:"category",key:"category"},{title:"Create",key:"ADD",dataIndex:"ADD",render:function(e,t,a){return n.a.createElement(Me.a.Item,{noStyle:!0,name:[t.key,"ADD"]},ha[t.key].ADD&&n.a.createElement(tt.a.Group,{options:ha[t.key].ADD}))}},{title:"Update",key:"UPDATE",dataIndex:"UPDATE",render:function(e,t,a){return n.a.createElement(Me.a.Item,{noStyle:!0,name:[t.key,"UPDATE"]},ha[t.key].UPDATE&&n.a.createElement(tt.a.Group,{options:ha[t.key].UPDATE}))}},{title:"Read",key:"READ",dataIndex:"READ",render:function(e,t,a){return n.a.createElement(Me.a.Item,{noStyle:!0,name:[t.key,"READ"]},ha[t.key].READ&&n.a.createElement(tt.a.Group,{options:ha[t.key].READ}))}},{title:"Delete",key:"DELETE",dataIndex:"DELETE",render:function(e,t,a){return n.a.createElement(Me.a.Item,{noStyle:!0,name:[t.key,"DELETE"]},ha[t.key].DELETE&&n.a.createElement(tt.a.Group,{options:ha[t.key].DELETE}))}},{title:"Approval",key:"APPROVAL",dataIndex:"APPROVAL",render:function(e,t,a){return n.a.createElement(Me.a.Item,{noStyle:!0,name:[t.key,"APPROVAL"]},ha[t.key].APPROVAL&&n.a.createElement(tt.a.Group,{options:ha[t.key].APPROVAL}))}},{title:"Unapproval",key:"UNAPPROVAL",dataIndex:"UNAPPROVAL",render:function(e,t,a){return n.a.createElement(Me.a.Item,{noStyle:!0,name:[t.key,"UNAPPROVAL"]},ha[t.key].UNAPPROVAL&&n.a.createElement(tt.a.Group,{options:ha[t.key].UNAPPROVAL}))}}],l.state={loading:!1,newPermission:{},MODULES:[{key:"ADMIN_OPTIONS",category:"Admin Options"},{key:"CONTACT_PERSONS",category:"Contact Persons"},{key:"ORGANIZATIONS",category:"Organisations"},{key:"USERS",category:"Resource"},{key:"PROJECTS",category:"Projects"},{key:"OPPORTUNITIES",category:"Opportunities"},{key:"TIMESHEETS",category:"Timesheets"},{key:"LEAVE_REQUESTS",category:"Leave Requests"},{key:"EXPENSES",category:"Expenses"},{key:"PROFILE",category:"Profile"}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=e.loading,a=e.MODULES,l=this.props,i=l.closeModal,r=l.isSystem,o=l.isVisible;return n.a.createElement(wt.a,{title:"Edit Permission",maskClosable:!1,centered:!0,visible:o,okText:t?n.a.createElement(Mt.a,null):"Save",okButtonProps:{disabled:t||r,htmlType:"submit",form:"my-form"},onCancel:function(){i()},width:"min-content"},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,size:"small",layout:"inline"},n.a.createElement(Rt.a,{bordered:!0,size:"small",className:"fs-small",rowKey:"key",columns:this.Columns,dataSource:a,pagination:!1})))}}]),a}(l.Component),Ea=ve.a.Title,ka=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.getRoles()},l.getRoles=function(){Ve.a.get(ya,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(e){e.success&&l.setState({data:e.data,openModal:!1,editRole:!1})}))},l.closeModal=function(){l.roleForm.current.refs.role_form.resetFields(),l.setState({openModal:!1,editRole:!1})},l.Callback=function(e){l.state.editRole?l.editRecord(e.obj):l.addRecord(e.obj)},l.addRecord=function(e){(function(e){return z.b.loading({content:"Loading...",key:1}),Ve.a.post(ya,e,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),z.b.success({content:i,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))})(e).then((function(e){e.success&&l.setState({data:[].concat(Object(we.a)(l.state.data),[e.data]),openModal:!1})}))},l.getRecord=function(e,t){l.setState({editRole:e.id,openModal:!0,roleIndex:t},(function(){l.roleForm.current.refs.role_form.setFieldsValue({obj:e})}))},l.editRecord=function(e){var t=l.state,a=t.editRole,n=t.roleIndex,i=t.data;(function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.put(ya+"/".concat(e),t,{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.data,r=l.message;return $(r),z.b.success({content:r,key:e}),n&&K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n,data:i}})).catch((function(t){return z.b.error({content:t.message,key:e}),{error:"Please login again!",status:!1,message:t.message}}))})(a,e).then((function(e){e.success&&(i[n]=e.data,console.log(i),l.setState({data:Object(we.a)(i),editRole:!1,openModal:!1,roleIndex:!1}))}))},l.callPermission=function(e,t){var a;console.log(e),l.setState({perModal:!0,editRole:e.id,roleIndex:t,permissions:null!==(a=e.permissions)&&void 0!==a?a:[],isSystem:e.isSystem})},l.updatePermission=function(e){var t=l.state,a=t.roleIndex,n=t.data;n[a]=e,console.log(n),l.setState({data:Object(we.a)(n),editRole:!1,openModal:!1,roleIndex:!1,perModal:!1})},l.perColse=function(){l.setState({perModal:!1,editRole:!1,openModal:!1,roleIndex:!1})},l.roleForm=n.a.createRef(),l.columns=[Object(Fe.a)({title:"Code",dataIndex:"id",key:"id",width:"5%"},Jt("id","number",!0)),Object(Fe.a)({title:"Title",dataIndex:"label",key:"label"},Jt("label","string")),{title:"Action",key:"action",align:"right",width:115,render:function(e,t,a){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Edit",disabled:e.isSystem,onClick:function(){l.getRecord(e,a)}}," Edit "),n.a.createElement(v.a.Item,{key:"Permission",onClick:function(){return l.callPermission(e,a)}}," Permissions "))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))}}],l.state={data:[],openModal:!1,editRole:!1,perModal:!1,permissions:!1,isSystem:!1,loading:!1,FormFields:{formId:"role_form",justify:"center",FormCol:20,FieldSpace:{xs:12,sm:16,md:122},layout:{labelCol:{span:12}},justifyField:"center",size:"middle",fields:[{object:"obj",fieldCol:20,layout:{labelCol:{span:4},wrapperCol:{span:0}},key:"label",label:"Title",size:"small",type:"input",labelAlign:"left"}]}},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.data,l=t.openModal,i=t.editRole,r=t.FormFields,o=t.perModal,s=t.loading,c=t.permissions,d=t.isSystem,u=this.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Ea,{level:4},"Roles")),n.a.createElement(b.a,{style:{textAlign:"end"}},n.a.createElement(Be.a,{type:"primary",onClick:function(){e.setState({openModal:!0})},size:"small"}," ",n.a.createElement(Nt.a,null)," Add Roles ")),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{bordered:!0,pagination:{pageSize:G().pageSize},rowKey:"id",columns:u,dataSource:a,size:"small",className:"fs-small"}))),l&&n.a.createElement(wt.a,{title:i?"Edit Role":"Add Role",maskClosable:!1,centered:!0,visible:l,okButtonProps:{disabled:s,htmlType:"submit",form:"role_form"},okText:s?n.a.createElement(Mt.a,null):"Save",onCancel:function(){e.closeModal()},width:600},n.a.createElement(Kt,{ref:this.roleForm,Callback:this.Callback,FormFields:r})),o&&n.a.createElement(va,{isVisible:o,Callback:this.updatePermission,perData:c,isSystem:d,eidtPer:i,closeModal:this.perColse}))}}]),a}(l.Component),Sa="".concat(A,"/panels"),Ca=ve.a.Title,ja=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.getData()},l.getData=function(){Ve.a.get(Sa,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(e){e.success&&l.setState({data:e.data,filterData:e.data,FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{}}),openModal:!1,editPanel:!1})}))},l.handleDelete=function(e){(function(e){return Ve.a.delete(Sa+"/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(e).then((function(e){e&&l.getData()}))},l.toggelModal=function(e){e?l.setState({openModal:e,loading:!1}):l.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{}}),openModal:e,editPanel:!1,loading:!1})},l.submit=function(){l.dynamoForm.current.refs.time_off.submit()},l.Callback=function(e){l.state.editPanel?l.editRecord(e.obj):l.addType(e.obj)},l.addType=function(e){var t;l.setState({loading:!0}),(t=e,z.b.loading({content:"Loading...",key:1}),Ve.a.post(Sa,t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e&&l.getData()}))},l.getRecord=function(e){console.log(e);var t={id:e.id,label:e.label};l.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{obj:t}}),editPanel:t.id,openModal:!0})},l.editRecord=function(e){l.setState({loading:!0});var t,a=l.state.editPanel;e.id=a,(t=e,z.b.loading({content:"Loading...",key:t.id}),Ve.a.put(Sa+"/".concat(t.id),t,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:t.id}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),n})).catch((function(e){return z.b.error({content:e.message,key:t.id}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e&&l.getData()}))},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){return t.label&&t.label.toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.dynamoForm=n.a.createRef(),l.columns=[Object(Fe.a)({title:"Code",dataIndex:"id",key:"id",width:"5%"},Jt("id","number",!0)),Object(Fe.a)({title:"Name",dataIndex:"label",key:"label"},Jt("label","string")),{title:"Action",key:"action",align:"right",width:115,render:function(e,t){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Delete",danger:!0,className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){return l.getRecord(t)}},"Edit"),n.a.createElement(v.a.Item,{key:"skills"},n.a.createElement(s.b,{to:{pathname:"/admin/panels/skills/".concat(t.id)}},"Skills")))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))}}],l.state={data:[],filterData:[],openModal:!1,editPanel:!1,FormFields:{formId:"time_off",justify:"center",FormCol:20,layout:{labelCol:{span:6}},justifyField:"center",size:"middle",fields:[{object:"obj",fieldCol:24,key:"label",label:"Name",size:"small",type:"input",labelAlign:"right"}]}},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.openModal),l=t.editPanel,i=t.FormFields,r=t.loading,o=t.filterData,s=this.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Ca,{level:4},"Panels")),n.a.createElement(b.a,{style:{textAlign:"end"}},n.a.createElement(Be.a,{type:"primary",onClick:function(){e.toggelModal(!0)},size:"small"},n.a.createElement(Nt.a,null),"Add Panels")),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:s,dataSource:o,size:"small",className:"fs-small"}))),a?n.a.createElement(wt.a,{title:l?"Edit Panel":"Add Panel",maskClosable:!1,centered:!0,visible:a,onOk:function(){e.submit()},okButtonProps:{disabled:r},okText:r?n.a.createElement(Mt.a,null):"Save",onCancel:function(){e.toggelModal(!1)},width:400},n.a.createElement(Kt,{ref:this.dynamoForm,Callback:this.Callback,FormFields:i})):null)}}]),a}(l.Component),Da=a(604),Oa="".concat(A,"/panel-skills"),Ia=ve.a.Title,Pa=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).getSkills=function(){Ve.a.get("".concat(A,"/standard-skills"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),n.map((function(e){e.value=e.id,delete e.id,delete e.createdAt,delete e.deletedAt,delete e.updatedAt,delete e.standardSkillStandardLevels}))),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(e){if(e.success){var t=l.state.FormFields;t.fields[3].data=e.data,l.setState({FormFields:t})}}))},l.getData=function(){var e,t=l.state,a=t.panelId,n=t.FormFields,i=t.FormFields_1;(e=a,console.log(e),Ve.a.get(Oa+"?panelId=".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))).then((function(e){e.success&&l.setState({data:e.data,filterData:e.data,FormFields:Object(Fe.a)(Object(Fe.a)({},n),{},{initialValues:{}}),FormFields_1:Object(Fe.a)(Object(Fe.a)({},i),{},{fields:[],initialValues:{}}),mergeObj:{},openModal:!1,editPS:!1,form1Submitted:!1,form2Submitted:!1,loading:!1})}))},l.newField=function(e){var t=l.state.skill_pirority,a=["level".concat(e),"pirority".concat(e),"stceil".concat(e),"ltceil".concat(e),"id".concat(e),e];return[{object:"obj",fieldCol:8,layout:{wrapperCol:{span:20}},key:a[0],size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:"5px"}},{object:"obj",fieldCol:7,layout:{wrapperCol:{span:20}},key:a[1],size:"small",data:t,type:"Select",labelAlign:"left",itemStyle:{marginBottom:"5px"}},{object:"obj",fieldCol:4,layout:{wrapperCol:{span:20}},key:a[2],size:"small",type:"InputNumber",labelAlign:"left",itemStyle:{marginBottom:"5px"}},{object:"obj",fieldCol:4,layout:{wrapperCol:{span:20}},key:a[3],size:"small",type:"InputNumber",labelAlign:"left",itemStyle:{marginBottom:"5px"}},{object:"obj",fieldCol:6,key:a[4],hidden:!0,size:"small",type:"Input"},{fieldCol:1,size:"small",Placeholder:n.a.createElement(Da.a,null),key:a[5],type:"Text",style:{textAlign:"right"},fieldStyle:{cursor:"pointer"},onClick:function(e,t){l.state.FormFields_1.fields=l.state.FormFields_1.fields.filter((function(e){return e.key!==a[0]&&e.key!==a[1]&&e.key!==a[2]&&e.key!==a[3]&&e.key!==a[4]&&e.key!==a[5]})),l.setState({FormFields_1:l.state.FormFields_1})}}]},l.handleDelete=function(e){(function(e){return Ve.a.delete(Oa+"/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(e).then((function(e){e&&l.getData()}))},l.toggelModal=function(e){var t=l.state,a=t.FormFields_1,n=t.FormFields;e?l.setState({openModal:e,FormFields_1:Object(Fe.a)(Object(Fe.a)({},a),{},{fields:l.newField(0)}),editPS:!1,loading:!1}):l.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},n),{},{initialValues:{}}),FormFields_1:Object(Fe.a)(Object(Fe.a)({},a),{},{fields:[],initialValues:{}}),openModal:!1,editPS:!1,form1Submitted:!1,form2Submitted:!1,loading:!1})},l.submit=function(){l.dynamoForm_1.current.refs.title_form.submit(),l.dynamoForm_2.current.refs.hours_form.submit()},l.Callback=function(e){var t=l.state.panelId;l.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},l.state.mergeObj),{},{label:e.obj.label,standardSkillId:e.obj.standard,panelId:t}),form1Submitted:!0},(function(){l.state.form1Submitted&&l.state.form2Submitted&&(l.state.editPS?(console.log("edit"),l.editRecord()):(console.log("emes"),l.renderTable()))}))},l.Callback2=function(e){for(var t=e.obj,a=[],n=Object.keys(t).length/5,i=0;i<n;i++){var r;if(t["pirority".concat(i)])a.push({id:null!==(r=t["id".concat(i)])&&void 0!==r?r:0,levelLabel:t["level".concat(i)],standardLevelId:t["pirority".concat(i)],shortTermCeil:t["stceil".concat(i)],longTermCeil:t["ltceil".concat(i)]})}console.log(a),l.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},l.state.mergeObj),{},{panelSkillStandardLevels:a}),form2Submitted:!0},(function(){l.state.form1Submitted&&l.state.form2Submitted&&(l.state.editPS?(console.log("edit"),l.editRecord()):(console.log("emes"),l.renderTable()))}))},l.renderTable=function(){var e,t=l.state.mergeObj;l.setState({loading:!0}),(e=t,z.b.loading({content:"Loading...",key:1}),Ve.a.post(Oa,e,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){l.getData()}))},l.getRecord=function(e,t){var a={},n=e.panelSkillStandardLevels,i={key:e.id,label:e.label,standard:e.standardSkill.id};jt("skill=".concat(i.standard)).then((function(t){t.success&&l.setState({skill_pirority:t.data},(function(){for(var t=n.length,r=0;r<t;r++){l.state.FormFields_1.fields=l.state.FormFields_1.fields.concat(l.newField(r));var o=n[r];a["id".concat(r)]=o.id,a["level".concat(r)]=o.levelLabel,a["pirority".concat(r)]=o.standardLevel.id,a["stceil".concat(r)]=o.shortTermCeil,a["ltceil".concat(r)]=o.longTermCeil}l.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{obj:i}}),FormFields_1:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields_1),{},{initialValues:{obj:a}}),editPS:e.id,openModal:!0})}))}))},l.editRecord=function(){var e,t=l.state,a=t.mergeObj,n=t.editPS;l.setState({loading:!0}),a.id=n,(e=a,z.b.loading({content:"Loading...",key:e.id}),Ve.a.put(Oa+"/".concat(e.id),e,{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:e.id}),n&&K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),n})).catch((function(t){return z.b.error({content:t.message,key:e.id}),{error:"Please login again!",status:!1,message:t.message}}))).then((function(e){e&&l.getData()}))},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){return t.label&&t.label.toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.dynamoForm_1=n.a.createRef(),l.dynamoForm_2=n.a.createRef(),l.columns=[Object(Fe.a)({title:"Skill",dataIndex:"label",key:"label"},Jt("label","string")),{title:"Action",key:"action",align:"right",width:115,render:function(e,t){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Delete",danger:!0,className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){return l.getRecord(t)}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))}}],l.state={openModal:!1,mergeObj:{},form1Submitted:!1,form2Submitted:!1,editPS:!1,panelId:!1,skill_select:!1,skill_pirority:!1,loading:!1,data:[],filterData:[],FormFields:{formId:"title_form",justify:"center",FormCol:24,FieldSpace:{xs:12,sm:16,md:12},layout:{labelCol:{span:4}},justifyField:"center",FormLayout:"inline",size:"small",fields:[{fieldCol:12,Placeholder:"Panel Skill",type:"Text",size:"small"},{fieldCol:12,Placeholder:"Generic Skill",type:"Text",size:"small"},{object:"obj",fieldCol:12,key:"label",size:"small",rules:[{required:!0,message:"Panel Skill is Required"}],type:"Input",labelAlign:"left",itemStyle:{marginBottom:"5px"}},{object:"obj",fieldCol:12,key:"standard",size:"small",rules:[{required:!0,message:"Generic Skill is Required"}],type:"Select",data:[],onChange:function(e,t){if(e){var a="skill=".concat(t.value);jt(a).then((function(e){if(e.success){var t=l.state.FormFields_1,a=t.fields;a.map((function(t,a){return 1!==a&&a%6!==1||(t.data=e.data),t})),l.setState({skill_pirority:e.data,FormFields_1:Object(Fe.a)(Object(Fe.a)({},t),{},{fields:a})})}}))}},labelAlign:"left",itemStyle:{marginBottom:"5px"}},{fieldCol:24,Placeholder:"Add Level",type:"Button",mode:"primary",style:{textAlign:"right"},size:"small",itemStyle:{marginBottom:"10px"},onClick:function(e,t){var a,n=l.state.FormFields_1.fields[l.state.FormFields_1.fields.length-1],i=n?parseInt(n.key)+1:0;l.state.FormFields_1.fields=(a=l.state.FormFields_1.fields).concat.apply(a,Object(we.a)(l.newField(i))),l.setState({FormFields_1:l.state.FormFields_1})}},{fieldCol:8,Placeholder:"Panel Level",type:"Text",size:"small"},{fieldCol:7,layout:{wrapperCol:{offset:1}},Placeholder:"Generic Level",type:"Text",size:"small"},{fieldCol:4,layout:{wrapperCol:{offset:1}},Placeholder:n.a.createElement("div",null,"ST Ceil ",n.a.createElement("span",{style:{fontSize:10}},"(hourly)")),tooltip:!0,tooltipTitle:"Short Term Ceiling Rate (ex GST)",tooltipTrigger:"hover",type:"Text",size:"small"},{fieldCol:4,layout:{wrapperCol:{offset:1}},tooltip:!0,tooltipTitle:"Long Term Ceiling Rate (ex GST)",tooltipTrigger:"hover",Placeholder:n.a.createElement("div",null,"LT Ceil ",n.a.createElement("span",{style:{fontSize:10}},"(hourly)")),type:"Text",size:"small"}]},FormFields_1:{formId:"hours_form",justify:"center",preserve:!1,FormCol:24,justifyField:"center",FormLayout:"inline",size:"small",fields:[]}},l}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({panelId:this.props.match.params.id},(function(){e.getData(),e.getSkills()}))}},{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.openModal),l=t.editPS,i=t.FormFields,r=t.FormFields_1,o=t.loading,s=t.filterData;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Ia,{level:4},"Panel Information")),n.a.createElement(b.a,{style:{textAlign:"end"}},n.a.createElement(Be.a,{type:"primary",onClick:function(){e.toggelModal(!0)},size:"small"},n.a.createElement(Nt.a,null),"Add Skill"))),n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:this.columns,dataSource:s,size:"small",className:"fs-small"}),a?n.a.createElement(wt.a,{title:l?"Edit Skill":"Add Skill",maskClosable:!1,centered:!0,visible:a,onOk:function(){e.submit()},okButtonProps:{disabled:o},okText:o?n.a.createElement(Mt.a,null):"Save",onCancel:function(){e.toggelModal(!1)},width:700},n.a.createElement(p.a,null,n.a.createElement(Kt,{ref:this.dynamoForm_1,Callback:this.Callback,FormFields:i})),n.a.createElement(p.a,{style:{maxHeight:"145px",overflowY:"auto"}},n.a.createElement(Kt,{ref:this.dynamoForm_2,Callback:this.Callback2,FormFields:r}))):null)}}]),a}(l.Component),xa="".concat(A,"/standard-levels"),Ta=ve.a.Title,za=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getData()},e.getData=function(){Ve.a.get(xa,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(t){t.success&&e.setState({data:t.data,filterData:t.data,isVisible:!1,editLevel:!1,FormFields:Object(Fe.a)(Object(Fe.a)({},e.state.FormFields),{},{initialValues:{}})})}))},e.handleDelete=function(t){(function(e){return Ve.a.delete(xa+"/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;if($(n),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return l})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(t).then((function(t){t&&e.getData()}))},e.submit=function(){e.levelForm.current.refs.level_form.submit()},e.Callback=function(t){e.state.editLevel?e.editRecord(t.obj):e.addType(t.obj)},e.addType=function(t){var a;e.setState({loading:!0}),(a=t,z.b.loading({content:"Loading...",key:1},5),Ve.a.post(xa,a,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1},5),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return z.b.error({content:"Error!",key:1},5),{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){t&&e.getData()}))},e.getRecord=function(t){var a=Object.assign({},t);e.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},e.state.FormFields),{},{initialValues:{obj:a}}),editLevel:a.id,isVisible:!0})},e.editRecord=function(t){e.setState({loading:!0});var a,l=e.state.editLevel;t.id=l,(a=t,z.b.loading({content:"Loading...",key:a.id}),Ve.a.put(xa+"/".concat(a.id),a,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.message;if($(i),z.b.success({content:i,key:a.id},5),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),n)return n})).catch((function(e){return z.b.error({content:"Error!",key:a.id}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){t&&e.getData()}))},e.generalFilter=function(t){var a=e.state.data;t?e.setState({filterData:a.filter((function(e){return e.label&&e.label.toLowerCase().includes(t.toLowerCase())}))}):e.setState({filterData:a})},e.levelForm=n.a.createRef(),e.columns=[Object(Fe.a)({title:"Level Name",dataIndex:"label",key:"label"},Jt("label","string")),{title:"Action",key:"action",align:"right",width:115,render:function(t,a){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){return e.getRecord(t,a)}},"Edit"),n.a.createElement(v.a.Item,{danger:!0,key:"Delete",className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(t.id)}},n.a.createElement("div",null," Delete "))))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))}}],e.state={isVisible:!1,newSkill:"",data:[],filterData:[],editLevel:!1,loading:!1,FormFields:{formId:"level_form",FormCol:20,FieldSpace:{xs:12,sm:16,md:122},FormLayout:"inline",size:"middle",fields:[{object:"obj",fieldCol:24,key:"label",label:"Name",labelAlign:"right",type:"Input",size:"small"}]}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.isVisible),l=t.editLevel,i=t.FormFields,r=(t.loading,t.filterData);return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Ta,{level:3},"Standard Levels")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){e.setState({isVisible:!0})}},n.a.createElement(Nt.a,null)," Add Level"))),n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,rowKey:function(e){return e.id},columns:this.columns,dataSource:r,size:"small",className:"fs-small"}),a&&n.a.createElement(wt.a,{title:l?"Edit Level":"Add Level",maskClosable:!1,centered:!0,visible:a,okText:"Save",width:400,onCancel:function(){e.setState({isVisible:!1,FormFields:Object(Fe.a)(Object(Fe.a)({},i),{},{initialValues:{}})})},onOk:function(){e.submit()}},n.a.createElement(p.a,{justify:"center"},n.a.createElement(Kt,{ref:this.levelForm,Callback:this.Callback,FormFields:i}))))}}]),a}(l.Component),Aa=a(33),Ra="".concat(A,"/standard-skills"),wa=ve.a.Title,Fa=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getLevel(),e.getData()},e.getLevel=function(){Ve.a.get("".concat(A,"/standard-levels"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(n.map((function(e){e.value=e.id,delete e.id,delete e.createdAt,delete e.deletedAt,delete e.updatedAt})),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(t){t.success&&e.setState({level_data:t.data})}))},e.getData=function(){Ve.a.get(Ra,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(t){t.success&&e.setState({data_skill:t.data,filterData:t.data,isVisible:!1,editSkill:!1,skillFields:Object(Fe.a)(Object(Fe.a)({},e.state.skillFields),{},{initialValues:{}}),LevelFields:Object(Fe.a)(Object(Fe.a)({},e.state.LevelFields),{},{initialValues:{},fields:[]}),mergeObj:{}})}))},e.newField=function(t){var a=e.state.level_data,l=["level".concat(t),"priority".concat(t),t];return[{object:"obj",fieldCol:15,layout:{wrapperCol:{span:23}},key:"level".concat(t),size:"small",data:a,type:"Select",labelAlign:"left",itemStyle:{marginBottom:"5px"}},{object:"obj",fieldCol:7,layout:{wrapperCol:{span:20}},key:"priority".concat(t),size:"small",data:e.priority_data,type:"Select",labelAlign:"left",itemStyle:{marginBottom:"5px"}},{fieldCol:1,size:"small",Placeholder:n.a.createElement(Da.a,null),key:t,type:"Text",style:{textAlign:"right"},fieldStyle:{cursor:"pointer"},onClick:function(e,t){this.state.LevelFields.fields=this.state.LevelFields.fields.filter((function(e){return e.key!==l[0]&&e.key!==l[1]&&e.key!==l[2]&&e.key!==l[3]&&e.key!==l[4]})),this.setState({LevelFields:this.state.LevelFields})}.bind(Object(Aa.a)(e))}]},e.toggelModal=function(t){e.state.FormFields_1;t?e.setState({isVisible:t,loading:!1,LevelFields:Object(Fe.a)(Object(Fe.a)({},e.state.LevelFields),{},{fields:e.newField(0)})}):e.setState({skillFields:Object(Fe.a)(Object(Fe.a)({},e.state.skillFields),{},{initialValues:{}}),LevelFields:Object(Fe.a)(Object(Fe.a)({},e.state.LevelFields),{},{fields:[],initialValues:{}}),isVisible:!1,editSkill:!1,formSubmitted:!1,levelSubmitted:!1,loading:!1})},e.handleDelete=function(t){(function(e){return Ve.a.delete(Ra+"/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(t).then((function(t){t&&e.getData()}))},e.submit=function(){e.skillForm.current.refs.skill_form.submit(),e.levelForm.current.refs.level_form.submit()},e.skillCall=function(t){e.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},e.state.mergeObj),{},{label:t.obj.label}),formSubmitted:!0},(function(){e.state.formSubmitted&&e.state.levelSubmitted&&(e.state.editSkill?(console.log("edit"),e.editRecord(e.state.mergeObj)):(console.log("emes"),e.addSkill(e.state.mergeObj)))}))},e.levelCall=function(t){for(var a=t.obj,l=[],n=Object.keys(a).length/2,i=0;i<n;i++)a["level".concat(i)]&&l.push({standardLevelId:a["level".concat(i)],priority:a["priority".concat(i)]});e.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},e.state.mergeObj),{},{standardSkillStandardLevels:l}),levelSubmitted:!0},(function(){e.state.formSubmitted&&e.state.levelSubmitted&&(e.state.editSkill?(console.log("edit"),e.editRecord(e.state.mergeObj)):(console.log("emes"),e.addSkill(e.state.mergeObj)))}))},e.addSkill=function(t){e.setState({loading:!0});var a,l=e.state.mergeObj;console.log({mergeObj:l}),(a=l,z.b.loading({content:"Loading...",key:1}),Ve.a.post(Ra,a,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){e.getData()}))},e.getRecord=function(t){for(var a={},l=t.standardSkillStandardLevels,n=l.length,i=0;i<n;i++){e.state.LevelFields.fields=e.state.LevelFields.fields.concat(e.newField(i));var r=l[i];a["level".concat(i)]=r.standardLevel.id,a["priority".concat(i)]=r.priority}var o={label:t.label};e.setState({skillFields:Object(Fe.a)(Object(Fe.a)({},e.state.skillFields),{},{initialValues:{obj:o}}),LevelFields:Object(Fe.a)(Object(Fe.a)({},e.state.LevelFields),{},{initialValues:{obj:a}}),editSkill:t.id,isVisible:!0})},e.editRecord=function(){e.setState({loading:!0});var t,a=e.state,l=a.mergeObj,n=a.editSkill;l.id=n,console.log(l),(t=l,z.b.loading({content:"Loading...",key:t.id}),Ve.a.put(Ra+"/".concat(t.id),t,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:t.id}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),n})).catch((function(e){return z.b.error({content:e.message,key:t.id}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){t&&(e.getData(),e.toggelModal(!1))}))},e.generalFilter=function(t){var a=e.state.data_skill;t?e.setState({filterData:a.filter((function(e){return e.label&&e.label.toLowerCase().includes(t.toLowerCase())}))}):e.setState({filterData:a})},e.skillForm=n.a.createRef(),e.levelForm=n.a.createRef(),e.columns=[Object(Fe.a)({title:"Skill Name",dataIndex:"label",key:"label"},Jt("label","string")),{title:"Action",key:"action",align:"right",width:115,render:function(t,a){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{danger:!0,key:"Delete",className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(t.id)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Eidt",onClick:function(){return e.getRecord(t,a)}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))}}],e.priority_data=[{label:"1",value:1},{label:"2",value:2},{label:"3",value:3},{label:"4",value:4},{label:"5",value:5}],e.level_data=[{val:1,value:"Superstar",label:"Superstar"},{key:2,value:"Senior",label:"Senior"},{key:3,value:"Middle",label:"Middle"},{key:4,value:"Junior",label:"Junior"},{key:5,value:"Trainee",label:"Trainee"}],e.state={isVisible:!1,editSkill:!1,mergeObj:{},formSubmitted:!1,levelSubmitted:!1,level_data:!1,loading:!1,data_skill:[],filterData:[],skillFields:{formId:"skill_form",FormCol:24,FieldSpace:{xs:12,sm:16,md:12},layout:{labelCol:{span:4}},justifyField:"center",FormLayout:"inline",size:"small",fields:[{object:"obj",fieldCol:24,layout:{wrapperCol:{span:20}},key:"label",label:"Name",size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:"5px"}},{fieldCol:24,Placeholder:"Add Skill",type:"Button",mode:"primary",style:{textAlign:"right"},size:"small",itemStyle:{marginBottom:"10px"},onClick:function(e,t){var a,l=this.state.LevelFields.fields[this.state.LevelFields.fields.length-1],n=l?parseInt(l.key)+1:0;this.state.LevelFields.fields=(a=this.state.LevelFields.fields).concat.apply(a,Object(we.a)(this.newField(n))),this.setState({LevelFields:this.state.LevelFields})}.bind(Object(Aa.a)(e))},{fieldCol:15,Placeholder:"Level Name",type:"Text",size:"small"},{fieldCol:7,layout:{wrapperCol:{offset:1}},Placeholder:"priority",type:"Text",size:"small"}]},LevelFields:{formId:"level_form",FormCol:24,justifyField:"center",FormLayout:"inline",size:"small",fields:[]}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data_skill,t.isVisible),l=t.editSkill,i=t.LevelFields,r=t.skillFields,o=t.loading,s=t.filterData;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(wa,{level:3},"Standard Skills")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){e.toggelModal(!0)}},n.a.createElement(Nt.a,null)," Add Skill"))),n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},columns:this.columns,dataSource:s,size:"small",className:"fs-small"}),a&&n.a.createElement(wt.a,{title:l?"Edit Skill":"Add Skill",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:o},okText:o?n.a.createElement(Mt.a,null):"Save",width:400,onCancel:function(){e.toggelModal(!1)},onOk:function(){e.submit()}},n.a.createElement(p.a,{justify:"center"},n.a.createElement(Kt,{ref:this.skillForm,Callback:this.skillCall,FormFields:r})),n.a.createElement(p.a,{style:{maxHeight:"85px",overflowY:"auto"}},n.a.createElement(Kt,{ref:this.levelForm,Callback:this.levelCall,FormFields:i}))))}}]),a}(l.Component),Na=a(36),Ma=a.n(Na),La=a(43),Ba=a(97),qa=(a(417),a(308)),Va=function(e,t,a,l){return z.b.loading({content:"Loading...",key:t}),Ve.a.post("".concat(A,"/data/").concat(e,"/").concat(t),a,{headers:l?{"content-type":"multipart/form-data",Authorization:G().accessToken}:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message,r=l.data;return $(i),z.b.success({content:i,key:t}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),{success:n,data:r}})).catch((function(e){return Q(e,t,5)}))},Ya=ve.a.Title,Ha=We.a.Dragger,_a={ORG:"ORGANIZATIONS",CPE:"CONTACT PERSONS",OPP:"OPPORTUNITIES",PRO:"PROJECTS",EMP:"EMPLOYEES",SCO:"SUB CONTRACTORS"},Ua=function(){var e=Object(l.useState)({visible:!1,type:null,loading:!1}),t=Object(he.a)(e,2),a=t[0],i=t[1],r=Object(l.useState)([]),o=Object(he.a)(r,2),s=o[0],c=o[1],d=Object(l.useState)([]),u=Object(he.a)(d,2),m=u[0],f=u[1],p=Object(l.useState)(!1),b=Object(he.a)(p,2),g=b[0],y=b[1],v=[{title:"Title",dataIndex:"type",key:"type",render:function(e,t){return n.a.createElement("div",null,n.a.createElement("div",null,n.a.createElement(Ya,{level:5},_a[e])),n.a.createElement("div",{className:"desc"},t.importing?n.a.createElement("span",null,"Last Import  At: ",n.a.createElement("b",null,"In Progress ")," "):n.a.createElement("div",null,n.a.createElement("span",null,"Last Import  At: ",n.a.createElement("b",null,t.imported?W(t.lastImported,!0,!0):t.lastImported)),n.a.createElement("span",{className:"file-mr"},t.log&&n.a.createElement("a",{href:"http://".concat(t.log),target:"_blank",rel:"noopener noreferrer"}," ",n.a.createElement(qa.a,null)," ",_a[e],"_LOGS.xlsx"))),t.exporting?n.a.createElement("span",null,"Last Export  At: ",n.a.createElement("b",null,"In Progress ")):n.a.createElement("div",null,n.a.createElement("span",null,"Last Export  At: ",n.a.createElement("b",null,t.exported?W(t.lastExported,!0,!0):t.lastExported)),n.a.createElement("span",{className:"file-mr"},t.file&&n.a.createElement("a",{href:"http://".concat(t.file),target:"_blank",rel:"noopener noreferrer",className:"fail-link"}," ",n.a.createElement(qa.a,null)," ",_a[e],".xlsx")))))}},{title:"Import",dataIndex:"importing",key:"importing",align:"center",render:function(e,t,a){return n.a.createElement(Be.a,{type:"primary",shape:"round",loading:e,disabled:!e&&g,onClick:function(){return i({visible:!0,type:t.type,loading:!1,index:a})}}," Import")}},{title:"Export",dataIndex:"exporting",key:"exporting",align:"center",render:function(e,t,a){return n.a.createElement(Be.a,{type:"primary",shape:"round",danger:!0,loading:e,disabled:!e&&g,onClick:function(){return C(t.type,a)}}," Export")}}];Object(l.useEffect)((function(){E()}),[]);var E=function(){Ve.a.get("".concat(A,"/data/status"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l?(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}):{success:!1}})).catch((function(e){return Q(e,"type",1)})).then((function(e){e.success&&k(e.data)}))},k=function(e){var t,a=Object(h.a)(e);try{for(a.s();!(t=a.n()).done;){var l=t.value,n=l.importing,i=l.exporting;if(n||i){y(!0);break}}}catch(r){a.e(r)}finally{a.f()}c(e)},S=function(e,t,a){y(a);var l=Object(we.a)(s);l[e][t]=a,c(l)},C=function(e,t){S(t,"exporting",!0),Va("export",e,{}).then((function(e){E(),y(!1)})).catch((function(e){S(t,"exporting",!1)}))},j=function(){var e=Object(La.a)(Ma.a.mark((function e(t){var l,n;return Ma.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=t.file,n=l.name.split("."),["xls","xlsx"].includes(n[n.length-1])?(i(Object(Fe.a)(Object(Fe.a)({},a),{},{loading:!0})),l.thumbUrl=X("xls"),f([l]),i(Object(Fe.a)(Object(Fe.a)({},a),{},{loading:!1}))):z.b.error({content:"Only Xlsx Files Are Allowed ",key:a.type});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return n.a.createElement("div",null,n.a.createElement(Ya,{level:4},"Import/Export"),n.a.createElement(Rt.a,{bordered:!0,rowKey:function(e){return e.type},columns:v,dataSource:s,showHeader:!1,pagination:!1}),n.a.createElement(wt.a,{title:"Import Data Into "+_a[a.type],maskClosable:!1,centered:!0,visible:a.visible,onOk:function(){i(Object(Fe.a)(Object(Fe.a)({},a),{},{loading:!0}));var e=new FormData;e.append("file",m[0]),S(a.index,"importing",!0),Va("import",a.type,e,!0).then((function(e){E(),y(!1)})).catch((function(e){S(a.index,"importing",!1)})),i({visible:!1,type:null,loading:!1}),f([])},okText:"Import",onCancel:function(){i({visible:!1,type:null,loading:!1}),f([])},width:540,confirmLoading:a.loading,destroyOnClose:!0},n.a.createElement("div",null,n.a.createElement(Ha,{name:"file",multiple:!1,maxCount:1,listType:"picture",className:"upload-list-inline",customRequest:j,onRemove:function(){return f([])},fileList:m,accept:".xls, .xlsx"},n.a.createElement(Ba.a,{image:m.length>0?Ba.a.PRESENTED_IMAGE_DEFAULT:Ba.a.PRESENTED_IMAGE_SIMPLE,description:n.a.createElement("p",{className:"import-empty"},"Click or drag file to this area to upload")})))))},Wa="".concat(A,"/expense-types"),Ka=function(){return Ve.a.get("".concat(Wa,"?select=true"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Ga=ve.a.Title,$a=[{component:zt,link:"/admin/global-settings"},{component:At,link:"/admin/tax-rates"},{component:ca,link:"/admin/holiday-types"},{component:ra,link:"/admin/calendars"},{component:la,link:"/admin/calendars/holidays/:id"},{component:ma,link:"/admin/leave-categories"},{component:ga,link:"/admin/leave-policies"},{component:ka,link:"/admin/roles"},{component:ja,link:"/admin/panels"},{component:function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getData()},e.getData=function(){Ve.a.get(Wa,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(t){t.success&&e.setState({data:t.data,filterData:t.data,isVisible:!1,editLevel:!1,FormFields:Object(Fe.a)(Object(Fe.a)({},e.state.FormFields),{},{initialValues:{}})})}))},e.handleDelete=function(t){(function(e){return Ve.a.delete(Wa+"/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;if($(n),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return l})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(t).then((function(t){t&&e.getData()}))},e.submit=function(){e.levelForm.current.refs.level_form.submit()},e.Callback=function(t){e.state.editLevel?e.editRecord(t.obj):e.addType(t.obj)},e.addType=function(t){var a;e.setState({loading:!0}),(a=t,z.b.loading({content:"Loading...",key:1},5),Ve.a.post(Wa,a,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1},5),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return z.b.error({content:"Error!",key:1},5),{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){t&&e.getData()}))},e.getRecord=function(t){var a=Object.assign({},t);e.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},e.state.FormFields),{},{initialValues:{obj:a}}),editLevel:a.id,isVisible:!0})},e.editRecord=function(t){e.setState({loading:!0});var a,l=e.state.editLevel;t.id=l,(a=t,z.b.loading({content:"Loading...",key:a.id}),Ve.a.put(Wa+"/".concat(a.id),a,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.message;if($(i),z.b.success({content:i,key:a.id},5),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),n)return n})).catch((function(e){return z.b.error({content:"Error!",key:a.id}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){t&&e.getData()}))},e.generalFilter=function(t){var a=e.state.data;t?e.setState({filterData:a.filter((function(e){return e.label&&e.label.toLowerCase().includes(t.toLowerCase())}))}):e.setState({filterData:a})},e.levelForm=n.a.createRef(),e.columns=[Object(Fe.a)({title:"Expense Name",dataIndex:"label",key:"label"},Jt("label","string")),{title:"Action",key:"action",align:"right",width:115,render:function(t,a){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){return e.getRecord(t,a)}},"Edit"),n.a.createElement(v.a.Item,{danger:!0,key:"Delete",className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(t.id)}},n.a.createElement("div",null," Delete "))))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))}}],e.state={isVisible:!1,newSkill:"",data:[],filterData:[],editLevel:!1,loading:!1,FormFields:{formId:"level_form",FormCol:20,FieldSpace:{xs:12,sm:16,md:122},FormLayout:"inline",size:"middle",fields:[{object:"obj",fieldCol:24,key:"label",label:"Name",labelAlign:"right",type:"Input",size:"small"}]}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.isVisible),l=t.editLevel,i=t.FormFields,r=(t.loading,t.filterData);return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Ga,{level:3},"Expense Types")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){e.setState({isVisible:!0})}},n.a.createElement(Nt.a,null)," Add Expense"))),n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,rowKey:function(e){return e.id},columns:this.columns,dataSource:r,size:"small",className:"fs-small"}),a&&n.a.createElement(wt.a,{title:l?"Edit Expense":"Add Expense",maskClosable:!1,centered:!0,visible:a,okText:"Save",width:400,onCancel:function(){e.setState({isVisible:!1,FormFields:Object(Fe.a)(Object(Fe.a)({},i),{},{initialValues:{}})})},onOk:function(){e.submit()}},n.a.createElement(p.a,{justify:"center"},n.a.createElement(Kt,{ref:this.levelForm,Callback:this.Callback,FormFields:i}))))}}]),a}(l.Component),link:"/admin/expense-types"},{component:Pa,link:"/admin/panels/skills/:id"},{component:Ua,link:"/admin/import-export"},{component:za,link:"/admin/standard-levels"},{component:Fa,link:"/admin/skills"}],Ja=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var l=arguments.length,i=new Array(l),r=0;r<l;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).state={bread:[]},e.getPageLink=function(){return $a.map((function(e,t){return n.a.createElement(o.b,{exact:!0,path:e.link,component:e.component,key:t})}))},e.getbreadcrums=function(){var t=e.props.location;return(t=t.split("/")).map((function(e,t){return""!==e&&isNaN(e)?n.a.createElement(Re.a.Item,{key:t},e):null}))},e}return Object(d.a)(a,[{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement(b.a,null,n.a.createElement(Re.a,{style:{margin:"0px 0px 16px 10px"},itemRender:this.itemRender,routes:this.routes},this.getbreadcrums())),n.a.createElement(b.a,{span:24},this.getPageLink()))}}]),a}(l.Component),Xa=(a(418),f.a.Sider),Qa=f.a.Content,Za=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var l=arguments.length,n=new Array(l),i=0;i<l;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).state={collapsed:!0},e.toggle=function(){e.setState({collapsed:!e.state.collapsed})},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state.collapsed;return n.a.createElement(f.a,null,n.a.createElement(Qa,{style:{padding:"0 0px"}},n.a.createElement(f.a,{className:"site-layout-background",style:{padding:"0px 0"}},n.a.createElement(Xa,{className:"site-layout-background",width:200,trigger:null,collapsible:!0,collapsed:this.state.collapsed},n.a.createElement(Ae,null)),n.a.createElement(Qa,{style:{padding:"0 0px",minHeight:640}},n.a.createElement(p.a,{style:{paddingLeft:"10px"}},n.a.createElement("span",{className:"admin-trigger",onClick:this.toggle},e?n.a.createElement(g.a,null):n.a.createElement(y.a,null)),n.a.createElement(Ja,{location:this.props.location.pathname}))))))}}]),a}(l.Component),el=a(572),tl=a(297),al=a.n(tl),ll="".concat(A,"/organizations"),nl=function(e){var t,a=e,l=e.delegateContactPerson;return{basic:{name:a.name,title:a.title,parent:a.parentOrganization&&a.parentOrganization.id,phone:a.phoneNumber,delegate_cp:a.delegateContactPersonId,delegate_contactPerson:l&&"".concat(l.firstName," ").concat(l.lastName," - ").concat(null!==(t=l.phoneNumber)&&void 0!==t?t:""),email:a.email,EBA:a.expectedBusinessAmount,address:a.address,website:a.website,businessType:a.businessType},billing:{ABN:a.abn,tax_Code:a.taxCode,invoice_email:a.invoiceEmail,invoice_number:a.invoiceContactNumber,CTI:a.cti},insured:{insurer_PI:a.piInsurer,insurer_PL:a.plInsurer,insurer_WC:a.wcInsurer,policy_PI:a.piPolicyNumber,policy_PL:a.plPolicyNumber,policy_WC:a.wcPolicyNumber,SumIns_PI:a.piSumInsured,SumIns_PL:a.plSumInsured,SumIns_WC:a.wcSumInsured,expiry_PI:W(a.piInsuranceExpiry),expiry_PL:W(a.plInsuranceExpiry),expiry_WC:W(a.wcInsuranceExpiry)},bank:{bankName:a.bankAccounts[0]&&a.bankAccounts[0].name,bankAccountNo:a.bankAccounts[0]&&a.bankAccounts[0].accountNo,bankBsb:a.bankAccounts[0]&&a.bankAccounts[0].bsb},future:{currentForecast:a.currentFinancialYearTotalForecast,nextForecast:a.nextFinancialYearTotalForecast}}},il=function(e){return Ve.a.get(ll+"/".concat(e),{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;if($(n),a){var i,r=nl(l),o=r.basic,s=r.billing,c=r.insured,d=r.bank,u=r.future;return K(null===e||void 0===e||null===(i=e.headers)||void 0===i?void 0:i.authorization),{success:a,basic:o,billing:s,insured:c,bank:d,future:u,data:l}}return{success:a}})).catch((function(e){var t;if(null===(t=e.response)||void 0===t?void 0:t.data){var a,l=e.response.status,n=null===(a=e.response)||void 0===a?void 0:a.data,i=n.message;return{authError:"Not Authorized!"===i,status:l,success:n.success,message:i}}return{error:"Please login again!",status:!1,message:e.message}}))},rl=el.a.TabPane,ol=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e,l,i;return Object(c.a)(this,a),(i=t.call(this)).componentDidMount=function(){var e=i.props.editOrg;e?i.fetchAll():(i.getOrgs(e),i.callAdd_Edit())},i.fetchAll=function(){var e=i.props.editOrg,t="helpers/contact-persons?organizationId=".concat(e,"&associated=1");Promise.all([vt(e),ht(t)]).then((function(t){var a=i.state.BasicFields;a.fields[5].data=t[0].data,a.fields[13].data=t[1].data,i.setState({BasicFields:a}),i.getRecord(e)})).catch((function(e){console.log(e)}))},i.getOrgs=function(e){vt(e).then((function(e){if(e.success){var t=i.state.BasicFields;t.fields[5].data=e.data,i.setState({BasicFields:t})}}))},i.callAdd_Edit=function(){var e=i.state.BasicFields;i.setState({BasicFields:Object(Fe.a)(Object(Fe.a)({},e),{},{fields:e.fields.filter((function(e){return"Business Type"===e.Placeholder?(e.fieldCol=24,e):"Delegate Contact person"!==e.Placeholder&&"delegate_cp"!==e.key?e:void 0}))})})},i.submit=function(){i.basicRef.current.refs.basic_form.submit(),i.billingRef.current&&i.billingRef.current.refs.billing_form.submit(),i.insuredRef.current&&i.insuredRef.current.refs.insured_form.submit(),i.bankRef.current&&i.bankRef.current.refs.bank_form.submit(),i.futureRef.current&&i.futureRef.current.refs.future_form.submit()},i.BasicCall=function(e){var t;e=e.obj,i.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},i.state.mergeObj),{},{name:e.name?e.name:"",title:null!==(t=e.title)&&void 0!==t?t:"",parentOrganizationId:e.parent?e.parent:null,phoneNumber:e.phone?e.phone:"",delegateContactPersonId:e.delegate_cp?e.delegate_cp:null,email:e.email?e.email:"",expectedBusinessAmount:e.EBA?e.EBA:0,address:e.address?e.address:"",website:e.website?e.website:"",businessType:e.businessType?e.businessType:void 0}),basicSubmitted:!0},(function(){i.state.basicSubmitted&&i.state.billingSubmitted&&i.state.insuredSubmitted&&i.state.bankSubmitted&&i.state.futureSubmitted&&(i.props.editOrg?i.editRecord(i.state.mergeObj):i.addOrganization(i.state.mergeObj))}))},i.BillingCall=function(e){e=e.obj,i.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},i.state.mergeObj),{},{abn:e.ABN?e.ABN:"",taxCode:e.tax_Code?e.tax_Code:"",invoiceEmail:e.invoice_email?e.invoice_email:"",invoiceContactNumber:e.invoice_number?e.invoice_number:"",cti:e.CTI?e.CTI:""}),billingSubmitted:!0},(function(){i.state.basicSubmitted&&i.state.billingSubmitted&&i.state.insuredSubmitted&&i.state.bankSubmitted&&i.state.futureSubmitted&&(i.props.editOrg?i.editRecord(i.state.mergeObj):i.addOrganization(i.state.mergeObj))}))},i.InsuredCall=function(e){e=e.obj,i.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},i.state.mergeObj),{},{piInsurer:e.insurer_PI?e.insurer_PI:"",plInsurer:e.insurer_PL?e.insurer_PL:"",wcInsurer:e.insurer_WC?e.insurer_WC:"",piPolicyNumber:e.policy_PI?e.policy_PI:"",plPolicyNumber:e.policy_PL?e.policy_PL:"",wcPolicyNumber:e.policy_WC?e.policy_WC:"",piSumInsured:e.SumIns_PI?e.SumIns_PI:0,plSumInsured:e.SumIns_PL?e.SumIns_PL:0,wcSumInsured:e.SumIns_WC?e.SumIns_WC:0,piInsuranceExpiry:W(e.expiry_PI,!0),plInsuranceExpiry:W(e.expiry_PL,!0),wcInsuranceExpiry:W(e.expiry_WC,!0)}),insuredSubmitted:!0},(function(){i.state.basicSubmitted&&i.state.billingSubmitted&&i.state.insuredSubmitted&&i.state.bankSubmitted&&i.state.futureSubmitted&&(i.props.editOrg?i.editRecord(i.state.mergeObj):i.addOrganization(i.state.mergeObj))}))},i.BankCall=function(e){e=e.obj,i.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},i.state.mergeObj),{bankName:e.bankName?e.bankName:"",bankAccountNo:e.bankAccountNo?e.bankAccountNo:"",bankBsb:e.bankBsb?e.bankBsb:""}),bankSubmitted:!0},(function(){i.state.basicSubmitted&&i.state.billingSubmitted&&i.state.insuredSubmitted&&i.state.bankSubmitted&&i.state.futureSubmitted&&(i.props.editOrg?i.editRecord(i.state.mergeObj):i.addOrganization(i.state.mergeObj))}))},i.FutureCall=function(e){e=e.obj,console.log(e),i.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},i.state.mergeObj),{currentFinancialYearTotalForecast:e.currentForecast?e.currentForecast:0,nextFinancialYearTotalForecast:e.nextForecast?e.nextForecast:0}),futureSubmitted:!0},(function(){i.state.basicSubmitted&&i.state.billingSubmitted&&i.state.insuredSubmitted&&i.state.bankSubmitted&&i.state.futureSubmitted&&(i.props.editOrg?i.editRecord(i.state.mergeObj):i.addOrganization(i.state.mergeObj))}))},i.addOrganization=function(e){var t,a=i.props.callBack;console.log(e),i.setState({basicSubmitted:!1,billingSubmitted:!1,insuredSubmitted:!1,bankSubmitted:!1,futureSubmitted:!1,loading:!0}),(t=e,z.b.loading({content:"Loading...",key:1}),Ve.a.post(ll,t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e.success?a():i.setState({loading:!1})}))},i.getRecord=function(e){il(e).then((function(e){if(e.success){var t=e.basic,a=e.billing,l=e.insured,n=e.bank,r=e.future;e.data;i.basicRef.current.refs.basic_form.setFieldsValue({obj:t}),i.billingRef.current.refs.billing_form.setFieldsValue({obj:a}),i.insuredRef.current.refs.insured_form.setFieldsValue({obj:l}),i.bankRef.current.refs.bank_form.setFieldsValue({obj:n}),i.futureRef.current.refs.future_form.setFieldsValue({obj:r})}}))},i.editRecord=function(e){var t,a=i.props,l=a.editOrg,n=a.callBack;e.id=l,console.log(e),i.setState({basicSubmitted:!1,billingSubmitted:!1,insuredSubmitted:!1,bankSubmitted:!1,futureSubmitted:!1,loading:!1}),(t=e,z.b.loading({content:"Loading...",key:t.id}),Ve.a.put(ll+"/".concat(t.id),t,{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.message,n=t.data;if($(l),z.b.success({content:l,key:n.id}),a){var i,r=nl(n),o=r.basic,s=r.billing,c=r.insured,d=r.bank,u=r.future;return K(null===e||void 0===e||null===(i=e.headers)||void 0===i?void 0:i.authorization),{success:a,basic:o,billing:s,insured:c,bank:d,future:u,data:n}}return{success:a,data:n}})).catch((function(e){return Q(e,t.id,5)}))).then((function(e){e.success?n(e):i.setState({loading:!1})}))},i.onDrag=function(e,t){var a,l,n,r,o=null===(a=window)||void 0===a||null===(l=a.document)||void 0===l?void 0:l.documentElement,s=o.clientWidth,c=o.clientHeight,d=null===(n=i.draggleRef)||void 0===n||null===(r=n.current)||void 0===r?void 0:r.getBoundingClientRect();i.setState({bounds:{left:-(null===d||void 0===d?void 0:d.left)+(null===t||void 0===t?void 0:t.x),right:s-((null===d||void 0===d?void 0:d.right)-(null===t||void 0===t?void 0:t.x)),top:-(null===d||void 0===d?void 0:d.top)+(null===t||void 0===t?void 0:t.y),bottom:c-((null===d||void 0===d?void 0:d.bottom)-(null===t||void 0===t?void 0:t.y))}})},i.basicRef=n.a.createRef(),i.billingRef=n.a.createRef(),i.bankRef=n.a.createRef(),i.insuredRef=n.a.createRef(),i.futureRef=n.a.createRef(),i.draggleRef=n.a.createRef(),i.state={editOrg:!1,basicSubmitted:!1,billingSubmitted:!1,bankSubmitted:!1,insuredSubmitted:!1,futureSubmitted:!1,check:!1,bounds:{left:0,top:0,bottom:0,right:0},dragDisable:!0,BasicFields:{formId:"basic_form",FormCol:24,justifyField:"center",FormLayout:"inline",contactPerson:[],layout:{labelCol:{span:10},wrapperCol:{span:0}},size:"middle",fields:[{Placeholder:"Name",rangeMin:!0,fieldCol:9,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Title",fieldCol:3,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Parent",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:9,key:"name",size:"small",rules:[{required:!0,message:"Name is Required"}],type:"Input",itemStyle:{marginBottom:1}},{object:"obj",fieldCol:3,key:"title",size:"small",type:"Input",itemStyle:{marginBottom:1}},{object:"obj",fieldCol:12,key:"parent",size:"small",data:[],type:"Select"},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Email",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"phone",size:"small",type:"Input"},{object:"obj",fieldCol:12,key:"email",size:"small",type:"Input"},{Placeholder:"Business Type",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Delegate Contact person",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"businessType",size:"small",rules:[{required:!0,message:"Business Type is Required"}],type:"Select",data:[{label:"Sole Trader",value:1},{label:"Partnership",value:2},{label:"Company",value:3},{label:"Trust",value:4}]},{object:"obj",fieldCol:12,key:"delegate_cp",size:"small",data:i.state?i.state.contactPerson:[],type:"Select",itemStyle:{marginBottom:"10px"}},{Placeholder:"Address",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"address",size:"small",type:"Input"},{Placeholder:"Website",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"website",size:"small",type:"Input",itemStyle:{marginBottom:"20px"}}]},BillingFields:{formId:"billing_form",FormCol:24,FieldSpace:24,justifyField:"center",FormLayout:"inline",layout:{labelCol:{span:9},wrapperCol:{span:0}},size:"middle",fields:[{Placeholder:"ABN",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Tax Code",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"ABN",shape:"ABN",size:"small",type:"InputNumber",rules:[function(e){e.getFieldValue;return{validator:function(e,t){if(t){var a=t.toString(),l=new Array(10,1,3,5,7,9,11,13,15,17,19);if(11===a.length){var n=0;return l.forEach((function(e,t){var l=a[t]-(t?0:1);n+=e*l})),console.log(n%89),n%89===0?Promise.resolve():Promise.reject(new Error("ABN is not valid"))}return Promise.reject(new Error("Must contain 11 digits"))}return Promise.resolve()}}}],fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"tax_Code",size:"small",type:"Select",data:[{value:"GST",label:"GST - Goods & Services Tax Registered"},{value:"EXP",label:"EXP - GST Free Exports/Overseas Org"},{value:"GNR",label:"GNR - GST Non-Registered"},{value:"UNG",label:"UNG - No ABN"}]},{Placeholder:"Email for Invoices",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Contact Number for Invoices",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"invoice_email",size:"small",type:"Input"},{object:"obj",fieldCol:12,key:"invoice_number",size:"small",type:"Input"}]},InsuredFields:{formId:"insured_form",FormCol:24,FieldSpace:24,justifyField:"center",FormLayout:"inline",size:"middle",fields:[{Placeholder:" Professional Indemnity",fieldCol:24,size:"small",type:"Title",mode:5,labelAlign:"right"},{Placeholder:"Insurer",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Policy Number",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Sum Insured",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Expiry",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:6,key:"insurer_PI",size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:"10px"},onChange:function(e){var t=e.target.value,a=i.state.InsuredFields,l=a.fields;t?(l[2].rangeMin=!0,l[3].rangeMin=!0,l[4].rangeMin=!0,l[6].rules=[{required:!0,message:"Policy Number is required"}],l[7].rules=[{required:!0,message:"Sum Insured is required"}],l[8].rules=[{required:!0,message:"Expiry Date is required"}]):(l[2].rangeMin=!1,l[3].rangeMin=!1,l[4].rangeMin=!1,l[6].rules=[{required:!1,message:""}],l[7].rules=[{required:!1,message:""}],l[8].rules=[{required:!1,message:""}]),i.setState({InsuredFields:Object(Fe.a)(Object(Fe.a)({},a),{},{fields:Object(we.a)(l)})})}},{object:"obj",fieldCol:6,key:"policy_PI",size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:10}},{object:"obj",key:"SumIns_PI",fieldCol:6,size:"small",type:"InputNumber",shape:"$",fieldStyle:{width:"100%"},labelAlign:"left",itemStyle:{marginBottom:10}},{object:"obj",fieldCol:6,key:"expiry_PI",size:"small",type:"DatePicker",labelAlign:"left",itemStyle:{marginBottom:"10px"}},{Placeholder:"Public Liability",fieldCol:24,size:"small",type:"Title",mode:5,labelAlign:"right",itemStyle:{marginTop:20}},{Placeholder:"Insurer",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Policy Number",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Sum Insured",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Expiry",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:6,key:"insurer_PL",size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:10},onChange:function(e){var t=e.target.value,a=i.state.InsuredFields,l=a.fields;t?(l[11].rangeMin=!0,l[12].rangeMin=!0,l[13].rangeMin=!0,l[15].rules=[{required:!0,message:"Policy Number is required"}],l[16].rules=[{required:!0,message:"Sum Insured is required"}],l[17].rules=[{required:!0,message:"Expiry Date is required"}]):(l[11].rangeMin=!1,l[12].rangeMin=!1,l[13].rangeMin=!1,l[15].rules=[{required:!1,message:""}],l[16].rules=[{required:!1,message:""}],l[17].rules=[{required:!1,message:""}]),i.setState({InsuredFields:Object(Fe.a)(Object(Fe.a)({},a),{},{fields:Object(we.a)(l)})})}},{object:"obj",fieldCol:6,key:"policy_PL",size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:10}},{object:"obj",fieldCol:6,key:"SumIns_PL",size:"small",shape:"$",type:"InputNumber",fieldStyle:{width:"100%"},labelAlign:"left",itemStyle:{marginBottom:10}},{object:"obj",fieldCol:6,key:"expiry_PL",size:"small",type:"DatePicker",labelAlign:"left",itemStyle:{marginBottom:"10px"}},{Placeholder:"Worker\u2019s Compensation",fieldCol:24,size:"small",type:"Title",mode:5,labelAlign:"right",itemStyle:{marginTop:20}},{Placeholder:"Insurer",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Policy Number",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Sum Insured",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Expiry",fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:6,key:"insurer_WC",size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:10},onChange:function(e){var t=e.target.value,a=i.state.InsuredFields,l=a.fields;t?(l[20].rangeMin=!0,l[21].rangeMin=!0,l[22].rangeMin=!0,l[24].rules=[{required:!0,message:"Policy Number is required"}],l[25].rules=[{required:!0,message:"Sum Insured is required"}],l[26].rules=[{required:!0,message:"Expiry Date is required"}]):(l[20].rangeMin=!1,l[21].rangeMin=!1,l[22].rangeMin=!1,l[24].rules=[{required:!1,message:""}],l[25].rules=[{required:!1,message:""}],l[26].rules=[{required:!1,message:""}]),i.setState({InsuredFields:Object(Fe.a)(Object(Fe.a)({},a),{},{fields:Object(we.a)(l)})})}},{object:"obj",fieldCol:6,key:"policy_WC",size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:"10px"}},{object:"obj",fieldCol:6,key:"SumIns_WC",size:"small",shape:"$",type:"InputNumber",fieldStyle:{width:"100%"},labelAlign:"left",itemStyle:{marginBottom:10}},{object:"obj",fieldCol:6,key:"expiry_WC",size:"small",type:"DatePicker",labelAlign:"left",itemStyle:{marginBottom:"10px"}}]},BankFields:{formId:"bank_form",FormCol:24,FieldSpace:24,justifyField:"center",FormLayout:"inline",layout:{labelCol:{span:9},wrapperCol:{span:0}},size:"middle",fields:[{Placeholder:"Bank Account Name",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"BSB Number",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"bankName",size:"small",type:"Input"},{object:"obj",fieldCol:12,key:"bankBsb",size:"small",type:"Input"},{Placeholder:"Bank Account Number",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"bankAccountNo",size:"small",type:"Input"}]},FutureFields:{formId:"future_form",FormCol:24,justifyField:"center",FormLayout:"inline",contactPerson:[],size:"middle",fields:[{Placeholder:"Current Financial Year Total Forecast",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Next Financial Year Total Forecast",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},(e={object:"obj",fieldCol:12,key:"currentForecast",size:"small",type:"Input",shape:"$"},Object(Ne.a)(e,"type","InputNumber"),Object(Ne.a)(e,"fieldStyle",{width:"100%"}),e),(l={object:"obj",fieldCol:12,key:"nextForecast",size:"small",type:"Input",shape:"$"},Object(Ne.a)(l,"type","InputNumber"),Object(Ne.a)(l,"fieldStyle",{width:"100%"}),l)]}},i}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.editOrg,l=t.visible,i=this.state,r=i.bounds,o=i.dragDisable,s=i.BasicFields,c=i.BillingFields,d=i.InsuredFields,u=i.BankFields,m=i.FutureFields,f=i.loading;return n.a.createElement(wt.a,{title:n.a.createElement("div",{style:{width:"100%",cursor:"move"},onMouseOver:function(){o&&e.setState({dragDisable:!1})},onMouseOut:function(){e.setState({dragDisable:!0})}},a?"Edit Organisation":"Add Organisation"),maskClosable:!1,centered:!0,visible:l,onOk:function(){e.submit()},okButtonProps:{disabled:f},okText:f?n.a.createElement(Mt.a,null):"Save",onCancel:this.props.close,width:900,destroyOnClose:!0,modalRender:function(t){return n.a.createElement(al.a,{bounds:r,disabled:o,onStart:function(t,a){return e.onDrag(t,a)}},n.a.createElement("div",{ref:e.draggleRef},t))}},n.a.createElement(el.a,{type:"card"},n.a.createElement(rl,{tab:"General Details",key:"general_details",forceRender:!0},n.a.createElement(Kt,{ref:this.basicRef,Callback:this.BasicCall,FormFields:s})),n.a.createElement(rl,{tab:"Billing Details",key:"billing_details",forceRender:!0},n.a.createElement(Kt,{ref:this.billingRef,Callback:this.BillingCall,FormFields:c})),n.a.createElement(rl,{tab:"Insurance Details",key:"insurance_detail",forceRender:!0},n.a.createElement(Kt,{ref:this.insuredRef,Callback:this.InsuredCall,FormFields:d})),n.a.createElement(rl,{tab:"Bank Details",key:"bank_detail",forceRender:!0},n.a.createElement(Kt,{ref:this.bankRef,Callback:this.BankCall,FormFields:u})),n.a.createElement(rl,{tab:"Work In Future",key:"future",forceRender:!0},n.a.createElement(Kt,{ref:this.futureRef,Callback:this.FutureCall,FormFields:m}))))}}]),a}(l.Component),sl=function(e,t,a,l,n,i){return z.b.loading({content:"Loading...",key:a}),Ve.a.delete("".concat(A).concat(t,"/").concat(a),{headers:J()}).then((function(t){var r=t.data,o=r.success,s=r.message;if($(s),o){var c;if(z.b.success({content:s,key:a}),K(null===t||void 0===t||null===(c=t.headers)||void 0===c?void 0:c.authorization),l>=0){var d=n.filter((function(e,t){return e.id!==a})),u=[];return i&&(u=i.filter((function(e,t){return e.id!==a}))),{success:o,data:u,filterData:d}}return e.goBack(),{success:o}}return{success:o}})).catch((function(e){return Q(e,a,5)}))},cl=ve.a.Title,dl=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.getData()},l.getData=function(){var e=JSON.parse(G().permissions).ORGANIZATIONS;Ve.a.get(ll,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(t){t.success&&l.setState({data:t.data,filterData:t.data,infoModal:!1,editOrg:!1,permissions:null!==e&&void 0!==e?e:{},openSearch:!1})}))},l.handleDelete=function(e,t){var a=l.state,n=a.data,i=a.filterData,r=l.props.history;sl(r,"/organizations",e,t,i,n).then((function(e){e.success&&l.setState({data:Object(we.a)(e.data),filterData:Object(we.a)(e.filterData)})}))},l.closeModal=function(){l.setState({infoModal:!1,editOrg:!1})},l.callBack=function(){l.getData()},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){return"ORG-00".concat(t.id.toString()).includes(e)||t.name&&t.name.toLowerCase().includes(e.toLowerCase())||t.title&&t.title.toLowerCase().includes(e.toLowerCase())||t.parentOrganization&&t.parentOrganization.name.toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.advancefilter=function(e,t,a){var n=l.state,i=n.data,r=n.searchedColumn;t?r[t].value=e:r=a,r.id.value||r.name.value||r.title.value||r["parentOrganization.name"].value||r.phoneNumber.value||r.email.value||r.delegate_cp.value||r.address.value||r.businessType.value.length>0?l.setState({filterData:i.filter((function(e){var t,a,l,n,i,o;return"ORG-00".concat(e.id.toString()).includes(r.id.value)&&"".concat(null!==(t=e.name)&&void 0!==t?t:"").toLowerCase().includes(r.name.value.toLowerCase())&&"".concat(null!==(a=e.title)&&void 0!==a?a:"").toLowerCase().includes(r.title.value.toLowerCase())&&"".concat(e.parentOrganization?e.parentOrganization.name:"").toLowerCase().includes(r["parentOrganization.name"].value.toLowerCase())&&"".concat(null!==(l=e.phoneNumber)&&void 0!==l?l:"").toLowerCase().includes(r.phoneNumber.value.toLowerCase())&&"".concat(null!==(n=e.email)&&void 0!==n?n:"").toLowerCase().includes(r.email.value.toLowerCase())&&"".concat(null!==(i=e.address)&&void 0!==i?i:"").toLowerCase().includes(r.address.value.toLowerCase())&&"".concat(null!==(o=e.delegateContactPersonId)&&void 0!==o?o:"").toLowerCase().includes("".concat(r.delegate_cp.value).toLowerCase())&&(r.businessType.value.length>0?r.businessType.value:[{value:","}]).some((function(t){return(r.businessType.value.length>0?[e.businessType]:[","]).includes(t.value)}))})),searchedColumn:r,openSearch:!1}):l.setState({searchedColumn:r,filterData:i,openSearch:!1})},l.filterModalUseEffect=function(){yt().then((function(e){var t=l.state.filterFields;t[13].data=e.success?e.data:[],l.setState({filterFields:t})})).catch((function(e){console.log(e)}))},l.columns=[Object(Fe.a)({title:"Code",dataIndex:"id",key:"id",width:120,render:function(e){return"ORG-00".concat(e)}},Jt("id","number",!0)),Object(Fe.a)({title:"Name",dataIndex:"name",key:"name",width:500,render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(t.id,"/info")},className:"nav-link"},e)}},Jt("name","string")),Object(Fe.a)({title:"Title",dataIndex:"title",key:"title",width:100},Jt("name","string")),Object(Fe.a)({title:"Parent Organisation",dataIndex:"parentOrganization",key:"parentOrganization",width:500,render:function(e){return e&&n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(e.id,"/info")},className:"nav-link"},e.name)}},Jt("parentOrganization.name","string")),{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){var i,r,o;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(l))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){l.setState({infoModal:!0,editOrg:t.id})},disabled:l.state&&!l.state.permissions.UPDATE},"Edit"," "),n.a.createElement(v.a.Item,{key:"View"},n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(t.id,"/info")},className:"nav-link"},"View"," ")))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],l.state={infoModal:!1,editOrg:!1,data:[],filterData:[],permissions:{},searchedColumn:{id:{type:"Input",value:"",label:"Code",showInColumn:!0},name:{type:"Input",value:"",label:"Organisation",showInColumn:!0},title:{type:"Input",value:"",label:"Title",showInColumn:!0},"parentOrganization.name":{type:"Input",value:"",label:"Parent Organisation",showInColumn:!0},Action:{type:"Input",value:"",label:"",showInColumn:!0,disabled:!0},email:{type:"Input",value:"",label:"Email",showInColumn:!1},phoneNumber:{type:"Input",value:"",label:"Phone Number",showInColumn:!1},address:{type:"none",value:"",label:"Address",showInColumn:!1},businessType:{type:"none",multi:!0,value:[],label:"Business Type",showInColumn:!1},delegate_cp:{type:"none",value:[],label:"Delegate Contact Person",showInColumn:!1}},filterFields:[{Placeholder:"Name",fieldCol:9,size:"small",type:"Text"},{Placeholder:"Title",fieldCol:3,size:"small",type:"Text"},{Placeholder:"Parent",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:9,key:"name",size:"small",type:"Input"},{object:"obj",fieldCol:3,key:"title",size:"small",type:"Input"},{object:"obj",fieldCol:12,key:"parentOrganization.name",size:"small",type:"Input"},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Email",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"phoneNumber",size:"small",type:"Input"},{object:"obj",fieldCol:12,key:"email",size:"small",type:"Input"},{Placeholder:"Business Type",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Delegate Contact person",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"businessType",size:"small",type:"Select",mode:"multiple",customValue:function(e,t){return t},data:[{label:"Sole Trader",value:1},{label:"Partnership",value:2},{label:"Company",value:3},{label:"Trust",value:4}]},{object:"obj",fieldCol:12,key:"delegate_cp",size:"small",data:[],type:"Select",itemStyle:{marginBottom:"10px"}},{Placeholder:"Address",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"address",size:"small",type:"Input"}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.infoModal),l=t.editOrg,i=t.permissions,r=t.filterData,o=t.searchedColumn,s=t.filterFields,c=t.openSearch,d=this.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(cl,{level:4},"Organisations")),n.a.createElement(b.a,{style:{textAlign:"end"}},n.a.createElement(p.a,{justify:"space-between",gutter:[30]},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"default",size:"small",onClick:function(){return e.setState({openSearch:!0})}},n.a.createElement(Ft.a,null),"Filter")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",onClick:function(){e.setState({infoModal:!0})},size:"small",disabled:!i.ADD},n.a.createElement(Nt.a,null),"Add Organisations")))),n.a.createElement(ea,{filters:o,filterFunction:this.advancefilter}),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:d,dataSource:r,size:"small",className:"fs-small"}))),c&&n.a.createElement(Zt,{title:"Filter Organizations",visible:c,filters:o,filterFields:s,filterFunction:this.advancefilter,effectFunction:this.filterModalUseEffect,effectRender:!0,onClose:function(){return e.setState({openSearch:!1})}}),a&&n.a.createElement(ol,{visible:a,editOrg:l,close:this.closeModal,callBack:this.callBack}))}}]),a}(l.Component),ul=a(580),ml=a(568),fl=a(579),pl=a(584),bl=a(607),gl=a(309),yl=a(608),hl="".concat(A,"/attachments/"),vl=function(e,t){return Ve.a.post("".concat(A,"/files"),e,{headers:{"content-type":"multipart/form-data",Authorization:G().accessToken}}).then((function(e){if(200===e.status){var t,a=e.data,l=a.success,n=a.data,i=a.message;$(i);var r={fileId:n[0].id,uid:n[0]&&n[0].uniqueName,name:n[0]&&n[0].originalName,type:n[0]&&n[0].type,url:"".concat(A,"/files/").concat(n[0]&&n[0].uniqueName),thumbUrl:X(n[0].type)};return K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,file:r}}return{success:!1}})).catch((function(e){return console.log(e),{}}))},El=function(e,t,a){return Ve.a.post("".concat(hl).concat(e,"/").concat(t),a,{headers:J()}).then((function(e){if(200===e.status){var t,a,l,n,i,r,o,s,c,d,u,m,f,p,b,g,y,h,v,E=e.data,k=E.success,S=E.data,C=E.message;return $(C),S={id:null===(t=S[0])||void 0===t?void 0:t.id,createdAt:null===(a=S[0])||void 0===a?void 0:a.createdAt,fileId:null===(l=S[0])||void 0===l?void 0:l.fileId,status:null===(n=S[0])||void 0===n?void 0:n.status,targetId:null===(i=S[0])||void 0===i?void 0:i.targetId,targetType:null===(r=S[0])||void 0===r?void 0:r.type,uid:null===(o=S[0])||void 0===o||null===(s=o.file)||void 0===s?void 0:s.uniqueName,name:null===(c=S[0])||void 0===c||null===(d=c.file)||void 0===d?void 0:d.originalName,type:null===(u=S[0])||void 0===u||null===(m=u.file)||void 0===m?void 0:m.type,url:"".concat(A,"/files/").concat(null===(f=S[0])||void 0===f||null===(p=f.file)||void 0===p?void 0:p.uniqueName),userId:null===(b=S[0])||void 0===b||null===(g=b.file)||void 0===g?void 0:g.userId,thumbUrl:X(null===(y=S[0])||void 0===y||null===(h=y.file)||void 0===h?void 0:h.type)},K(null===e||void 0===e||null===(v=e.headers)||void 0===v?void 0:v.authorization),{success:k,data:S}}return{success:!1}})).catch((function(e){return console.log(e),{}}))},kl=function(e,t){return Ve.a.get("".concat(hl).concat(e,"/").concat(t),{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;if($(n),a){var i,r=[],o=[];return l.map((function(e){r.push(e.id),o.push({id:e.id,userId:e.userId,createdAt:e.createdAt,fileId:e.fileId,status:e.status,targetId:e.targetId,targetType:e.targetType,uid:e.file.uniqueName,name:e.file.originalName,type:"png"===e.file.type?"image/png":e.file.type,url:"".concat(A,"/files/").concat(e.file.uniqueName),thumbUrl:X(e.file.type)})})),K(null===e||void 0===e||null===(i=e.headers)||void 0===i?void 0:i.authorization),{success:a,fileList:o,fileIds:r}}return{success:!1}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Sl="".concat(A,"/comments/"),Cl=(a(423),Je.a.TextArea),jl=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).getComments=function(t,a){(function(e,t){return Ve.a.get("".concat(Sl).concat(e,"/").concat(t),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;if($(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))})(t,a).then((function(t){var a;t&&t.success&&e.setState({data:null!==(a=t.data)&&void 0!==a?a:[],loginId:parseInt(G().id)})}))},e.scrollToBottom=function(){e.messagesEnd.current.scrollIntoView({behavior:"smooth"})},e.deleteIcon=function(t,a){e.setState((function(e){return{isHovered:Object(Fe.a)(Object(Fe.a)({},e.isHovered),{},Object(Ne.a)({},t,a))}}))},e.handleDelete=function(t){(function(e){return Ve.a.delete("".concat(Sl).concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;if($(n),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))})(t).then((function(a){a.success&&e.setState({data:e.state.data.filter((function(e){return e.id!==t}))})}))},e.handelEmpty=function(t){var a=e.state.value;13!==t.keyCode||a||t.preventDefault()},e.comChange=function(t){e.setState({value:t.target.value})},e.addComent=function(t){var a=e.state,l=a.value,n=a.data,i=a.fileList,r=a.fileIds;if(!t.shiftKey&&(l||i.length>0)){var o={content:l,files:i,attachments:r},s=e.props;(function(e,t,a){return Ve.a.post("".concat(Sl).concat(e,"/").concat(t),a,{headers:J()}).then((function(e){if(200===e.status){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}}})).catch((function(e){return console.log(e),{}}))})(s.targetType,s.targetId,o).then((function(t){t.success&&e.setState({data:[].concat(Object(we.a)(n),[t.data]),value:null,fileList:[],fileIds:[]},(function(){setTimeout((function(){e.scrollToBottom(),e.setState({value:null})}),0)}))}))}},e.logScroll=function(t){var a=t.target,l=a.scrollHeight,n=a.scrollTop,i=a.clientHeight;n?l-n===i&&(t.persist(t.target),setTimeout((function(){l-n===i&&console.log("I will get rendered now")}),1e3)):(t.persist(n),setTimeout((function(){var t=e.state.data;!n&&t.length<500||console.log("Empty")}),1e3))},e.actions=function(e){return e.map((function(e){return n.a.createElement("span",null,n.a.createElement(qa.a,null)," ",n.a.createElement("a",{href:"".concat(A,"/files/").concat(e.uid),download:e.name,target:"_blank",rel:"noopener noreferrer"},e.name))}))},e.handleUpload=function(){var t=Object(La.a)(Ma.a.mark((function t(a){var l,n,i,r,o;return Ma.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=a.onSuccess,n=a.onError,i=a.file,r=a.onProgress,o=new FormData,{headers:{"content-type":"multipart/form-data"},onUploadProgress:function(t){var a=Math.floor(t.loaded/t.total*100);e.setState({progress:a}),100===a&&setTimeout((function(){return e.setState({progres:0})}),1e3),r({percent:t.loaded/t.total*100})}},o.append("files",i),vl(o).then((function(t,a){if(t.success)l("Ok"),e.setState({fileList:[].concat(Object(we.a)(e.state.fileList),[t.file]),fileIds:[].concat(Object(we.a)(e.state.fileIds),[t.file.fileId])});else{console.log("Eroor: ",a);new Error("Some error");n({err:a})}}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onRemove=function(t){e.setState((function(e){var a=e.fileList.indexOf(t),l=e.fileList.slice(),n=e.fileIds;return l.splice(a,1),n.splice(a,1),{fileIds:n,fileList:l}}))},e.commentRender=function(t,a,l){var i,r=t.attachments&&e.actions(t.attachments),o=e.state.loginId,s=e.props.onHold;return n.a.createElement(ml.a,{key:t.id,author:n.a.createElement("a",null," ",t.author?t.authorId===o?"".concat(t.author," (Me)"):t.author:"?????"," "),avatar:n.a.createElement(fl.a,{style:{backgroundColor:Dl[a.toString()[a.toString().length-1]]},alt:null!==(i=t.author)&&void 0!==i?i:"??????"},t.author?t.author[0].toUpperCase():"?"),actions:r,content:n.a.createElement("p",null,t.content),datetime:n.a.createElement(n.a.Fragment,null,n.a.createElement($e.a,{title:W(t.createdAt,!0,"ddd DD MMM yyyy HH:mm:ss")},n.a.createElement("span",null,W(W(t.createdAt,!0,"ddd DD MMM yyyy HH:mm:ss")).fromNow())),t.authorId===o&&!s&&n.a.createElement($e.a,{key:"comment-basic-delete",title:"Delete"},n.a.createElement("span",{style:Ol.delCol,onMouseOver:function(){e.deleteIcon(a,!0)},onMouseLeave:function(){e.deleteIcon(a,!1)}},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){e.handleDelete(t.id)},okText:"Yes",cancelText:"No"},l[a]?n.a.createElement(bl.a,{style:Ol.delIcon}):n.a.createElement(gl.a,null)))))})},e.messagesEnd=n.a.createRef(),e.UploadRef=n.a.createRef(),e.state={isHovered:{},fileList:[],fileIds:[],data:[],value:null,loginId:null},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.scrollToBottom();var e=this.props,t=e.targetType,a=e.targetId;this.getComments(t,a)}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,l=t.isHovered,i=t.value,r=t.fileList,o=this.props.onHold;return n.a.createElement(p.a,{justify:"space-around"},n.a.createElement(b.a,{style:Ol.cSec,span:24,onScroll:this.logScroll},n.a.createElement(pl.b,{itemLayout:"horizontal",dataSource:a,renderItem:function(t,a){return n.a.createElement("li",null,e.commentRender(t,a,l))}}),n.a.createElement("div",{ref:this.messagesEnd})),n.a.createElement(b.a,{span:23,style:Ol.cBox},n.a.createElement(Me.a.Item,{colon:!1,label:n.a.createElement(qa.a,{style:o?Ol.sendIcon:l.attachIcon?Ol.attachIconHoverd:Ol.sendIcon,onMouseOver:function(){e.deleteIcon("attachIcon",!0)},onMouseOut:function(){e.deleteIcon("attachIcon",!1)},onClick:function(){o||e.UploadRef.current.click()}})},n.a.createElement(Cl,{placeholder:o?"This Project Is Closed....":"Enter Your Comment....",autoSize:{minRows:1,maxRows:5},disabled:o,onPressEnter:this.addComent,onChange:this.comChange,onKeyDown:this.handelEmpty,value:i}),n.a.createElement(We.a,{listType:"text",multiple:!0,customRequest:this.handleUpload,onRemove:this.onRemove,fileList:r,style:{backgroundColor:"rosybrown"},className:"upload-list-inline"},n.a.createElement(qa.a,{ref:this.UploadRef,style:{fontSize:0}})))),n.a.createElement(b.a,{span:1,style:{alignSelf:"flex-end",marginBottom:r.length>2?30*r.length/4+1:25}},n.a.createElement(Me.a.Item,null,n.a.createElement(yl.a,{onClick:this.addComent,className:"sendIcon",style:o?Ol.sendIcon:l.sendIcon?Ol.sendIconHoverd:Ol.sendIcon,onMouseOver:function(){e.deleteIcon("sendIcon",!0)},onMouseOut:function(){e.deleteIcon("sendIcon",!1)}}))))}}]),a}(l.Component),Dl=["#f56a00","#7265e6","#ffbf00","#0000ff","#b8860b","#907849","#80afe2","#FAAB14","#b17401","#42a3f3","#ce8785"],Ol={cSec:{maxHeight:500,overflowY:"auto",minHeight:500},delCol:{paddingLeft:"10px",cursor:"pointer",textAlignLast:"right"},cBox:{paddingLeft:"40px"},disabled:{paddingLeft:"40px"},sendBox:{alignSelf:"flex-end",maxHeight:"100px",backgroundColor:"yellow"},sendIcon:{fontSize:"24px",paddingLeft:"10px"},sendIconHoverd:{fontSize:"24px",paddingLeft:"10px",color:"blue"},attachIconHoverd:{fontSize:"24px",paddingLeft:"10px",color:"#40a9ff"},delIcon:{fontSize:"18px"},sendAvatar:{backgroundColor:"#"+Math.floor(16777216*Math.random()).toString(16)}},Il=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getEntityProjects()},e.getEntityProjects=function(){var t=JSON.parse(G().permissions).PROJECTS,a=e.props,l=a.customUrl,n=a.showColumn;Ot(l).then((function(a){a.success&&e.setState({permissions:t,projects:a.data,columns:n?e.columns.filter((function(e){return"organization"!==e.dataIndex})):e.columns})}))},e.columns=[{title:"Code",dataIndex:"id",key:"id",wdith:115,render:function(e){return"00".concat(e)}},{title:"Title",dataIndex:"title",key:"title",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"/projects/".concat(t.id,"/info")},className:"nav-link"}," ",e," ")}},{title:"Organisation Name",dataIndex:"organization",key:"organization",width:300,render:function(e){return e&&n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(e.id,"/info")},className:"nav-link"},e.name)}},{title:"Revenue",dataIndex:"value",key:"value",render:function(e){return"".concat(_(e))}},{title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return e&&W(e,!0,!0)}},{title:"End Date",dataIndex:"endDate",key:"endDtae",render:function(e){return e&&W(e,!0,!0)}},{title:"...",key:"action",align:"center",width:"1%",render:function(t){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{disabled:e.state&&!e.state.permissions.READ},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(t.id,"/info")},className:"nav-link"},"View")))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],e.state={projects:[],permissions:{},columns:[]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=e.projects,a=e.columns;return n.a.createElement(Rt.a,{bordered:!0,rowKey:function(e){return e.id},pagination:{pageSize:G().pageSize},columns:a,dataSource:t,size:"small",className:"fs-small"})}}]),a}(l.Component),Pl=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getList()},e.getList=function(){var t=JSON.parse(G().permissions).OPPORTUNITIES,a=e.props,l=a.customUrl,n=a.showColumn;e.state.data;Ot(l).then((function(a){e.setState({data:a.success?a.data:[],permissions:t,columns:n?e.columns.filter((function(e){return"organization"!==e.dataIndex})):e.columns})}))},e.columns=[{title:"Code",dataIndex:"id",key:"id",wdith:115,render:function(e){return"00".concat(e)}},{title:"Title",dataIndex:"title",key:"title",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"/opportunities/".concat(t.id,"/info")},className:"nav-link"}," ",e," ")}},{title:"Organisation Name",dataIndex:"organization",key:"organization",width:300,render:function(e){return e&&n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(e.id,"/info")},className:"nav-link"},e.name)}},{title:"Estimated Value",dataIndex:"value",key:"value",render:function(e){return"".concat(_(e))}},{title:"Estimated Start Date",dataIndex:"startDate",key:"startDate",width:"fit-content",render:function(e){return e&&W(e,!0,!0)}},{title:"Estimated End Date",dataIndex:"endDate",key:"endDtae",render:function(e){return e&&W(e,!0,!0)}},{title:"Bid Date",dataIndex:"bidDate",key:"bidDate",render:function(e){return e&&W(e,!0,!0)}},{title:"Status",dataIndex:"status",key:"status",render:function(e){return e}},{title:"...",key:"action",align:"center",width:"1%",render:function(t){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{disabled:e.state&&!e.state.permissions.READ},n.a.createElement(s.b,{to:{pathname:"/opportunities/".concat(t.id,"/info")},className:"nav-link"},"View")))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],e.state={data:[],columns:[],permissions:{}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=e.data,a=e.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Rt.a,{bordered:!0,pagination:{pageSize:G().pageSize},columns:a,dataSource:t,size:"small",className:"fs-small"}))}}]),a}(l.Component),xl=ul.b.Item,Tl=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l,n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){console.log(n.props.bank)},n.state={data:null!==(l=e.bank)&&void 0!==l?l:{}},n}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state.data,t=this.props.targetType;return n.a.createElement(ul.b,{size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(xl,{label:"Bank Account Name"},e.bankName," "),n.a.createElement(xl,{label:"Account Number"},e.bankAccountNo," "),n.a.createElement(xl,{label:"BSB"},e.bankBsb),"EMP"===t&&n.a.createElement(xl,{label:"Tax File Number"},e.tfn))}}]),a}(l.Component),zl=a(609),Al=(a(424),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props,a=t.targetType,l=t.targetId;e.getRecord(a,l)},e.getRecord=function(t,a){kl(t,a).then((function(t){t.success&&e.setState({fileList:t.fileList,fileIds:t.fileIds,loginId:parseInt(G().id)})}))},e.handleUpload=function(){var t=Object(La.a)(Ma.a.mark((function t(a){var l,n,i,r,o;return Ma.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=a.onSuccess,n=a.onError,i=a.file,r=a.onProgress,o=new FormData,{headers:{"content-type":"multipart/form-data"},onUploadProgress:function(t){var a=Math.floor(t.loaded/t.total*100);e.setState({progress:a}),100===a&&setTimeout((function(){return e.setState({progres:0})}),1e3),r({percent:t.loaded/t.total*100})}},o.append("files",i),e.setState({loading:!0}),vl(o).then((function(t,a){if(t.success){l("Ok");var i=e.props,r=i.targetType,o=i.targetId,s={files:[t.file.fileId]};El(r,o,s).then((function(a){a.success&&e.setState({fileList:[].concat(Object(we.a)(e.state.fileList),[a.data]),fileIds:[].concat(Object(we.a)(e.state.fileIds),[t.file.fileId]),loading:!1})}))}else{console.log("Eroor: ",a),e.setState({loading:!1});new Error("Some error");n({err:a})}}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onRemove=function(t){var a,l=e.state.loginId,n=e.props.onHold;console.log(t),t.userId!==l||n||(a=t.id,Ve.a.delete("".concat(hl).concat(a),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))).then((function(a){a.success&&e.setState((function(e){var a=e.fileList.indexOf(t),l=e.fileList.slice(),n=e.fileIds;return l.splice(a,1),n.splice(a,1),{fileIds:n,fileList:l}}))}))},e.UploadRef=Object(l.createRef)(),e.state={fileList:[],fileIds:[],loading:!1,loginId:null},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=e.fileList,a=e.loading,l=this.props,i=l.listType,r=l.onHold;return n.a.createElement(p.a,null,n.a.createElement(b.a,{span:"24"},n.a.createElement(We.a,{multiple:!0,showUploadList:{showRemoveIcon:!0},listType:null!==i&&void 0!==i?i:"picture",fileList:t,customRequest:this.handleUpload,onRemove:this.onRemove,style:{backgroundColor:"rosybrown"}},n.a.createElement(Be.a,{type:"ghost",loading:a,disabled:r},n.a.createElement(zl.a,null)," ",r?"This Project Is Closed":"Upload New File"))))}}]),a}(l.Component)),Rl=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){console.log(l.props.id)},l.columns=[{title:"Name",dataIndex:"name",key:"name",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(t.key,"/info")},className:"nav-link"},e)}},{title:"Parent",dataIndex:"parent",key:"parent",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(t&&t.key,"/info")},className:"nav-link"},e)}}],l.state={data:[]},l}return Object(d.a)(a,[{key:"componentWillReceiveProps",value:function(e){window.location.reload(!1)}},{key:"render",value:function(){var e=this.state.data;return n.a.createElement(Rt.a,{bordered:!0,columns:this.columns,dataSource:e,size:"small",className:"fs-small"})}}]),a}(l.Component),wl=(Object(o.i)(Rl),function(e){var t=e.history;return n.a.createElement("div",null,void wt.a.error({title:"Not Authorized!",content:"You don't have permission to view this Information",okText:"Go Back",okType:"danger",onOk:function(){t.goBack()||t.push("/profile")}}))}),Fl=ul.b.Item,Nl=el.a.TabPane,Ml=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).closeModal=function(){e.setState({infoModal:!1,editOrg:!1})},e.callBack=function(t){t.success&&e.setState({data:t.data,basic:t.basic,bank:t.bank,infoModal:!1,editOrg:!1})},e.componentDidMount=function(){var t=e.props.match.params.id;e.getOrgRecord(t)},e.getOrgRecord=function(t){il(t).then((function(a){var l,n,i;a.success?e.setState({data:null!==(l=a.data)&&void 0!==l?l:{},basic:null!==(n=a.basic)&&void 0!==n?n:{},bank:null!==(i=a.bank)&&void 0!==i?i:{},organizationId:t}):a.authError&&e.setState({notAuth:!0})}))},e.handleDelete=function(e){(function(e){return Ve.a.delete(ll+"/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(e).then((function(e){e.success&&(window.location.href="/organisations")}))},e.state={infoModal:!1,editOrg:!1,data:{},bank:{},basic:{},organizationId:!1,notAuth:!1},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.data,l=t.bank,i=t.infoModal,r=t.editOrg,o=t.organizationId,c=t.basic,d=t.notAuth,u=n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,a&&a.name),n.a.createElement(b.a,null,n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(a.id)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){e.setState({infoModal:!0,editOrg:a.id})}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))));return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:u,size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Fl,{label:"Contact"},a.phoneNumber),n.a.createElement(Fl,{label:"Email"},a.email),n.a.createElement(Fl,{label:"Address"},a.address),n.a.createElement(Fl,{label:"Website"},n.a.createElement(s.b,{to:{pathname:"https://".concat(a.website)},target:"_blank"},a.website)),n.a.createElement(Fl,{label:"Contact Person"},c?c.delegate_contactPerson:null)),o&&n.a.createElement(el.a,{type:"card",style:{marginTop:"50px"}},n.a.createElement(Nl,{tab:"Projects",key:"project"},n.a.createElement(Il,{targetId:o,showColumn:!0,customUrl:"helpers/work?type=P&organization=".concat(o)})),n.a.createElement(Nl,{tab:"Opportunities",key:"opportunity"},n.a.createElement(Pl,{targetId:o,showColumn:!0,customUrl:"helpers/work?type=O&organization=".concat(o)})),n.a.createElement(Nl,{tab:"Attachments",key:"attachments"},n.a.createElement(Al,{targetId:o,targetType:"ORG"})),n.a.createElement(Nl,{tab:"Comments",key:"comments"},n.a.createElement(jl,{targetId:o,targetType:"ORG"})),n.a.createElement(Nl,{tab:"Bank Details",key:"Bank"},n.a.createElement(Tl,{targetId:o,title:a.name,bank:l}))),i&&n.a.createElement(ol,{visible:i,editOrg:r,close:this.closeModal,callBack:this.callBack}),d&&n.a.createElement(wl,this.props))}}]),a}(l.Component),Ll=a(312),Bl="".concat(A,"/contactpersons"),ql=function(e){return Ve.a.get(Bl+"/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;if($(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){var t;if(null===(t=e.response)||void 0===t?void 0:t.data){var a,l=e.response.status,n=null===(a=e.response)||void 0===a?void 0:a.data,i=n.message,r=n.success;return $(i),{authError:"Not Authorized!"===i,status:l,success:r,message:i}}return{error:"Please login again!",status:!1,message:e.message}}))},Vl="".concat(A,"/employees"),Yl=function(e){return Ve.a.get(Vl+"/".concat(e),{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;if($(n),a){var i=Hl(l);return{success:a,data:l,basic:i.basic,detail:i.detail,kin:i.kin,bank:i.bank,billing:i.billing,train:i.train}}return{success:a}})).catch((function(e){var t;if(null===(t=e.response)||void 0===t?void 0:t.data){var a,l=e.response.status,n=null===(a=e.response)||void 0===a?void 0:a.data,i=n.message;return{authError:"Not Authorized!"===i,status:l,success:n.success,message:i}}return{error:"Please login again!",status:!1,message:e.message}}))};function Hl(e){var t,a=e.contactPersonOrganization?e.contactPersonOrganization.contactPerson:{},l={cpCode:"Emp-00".concat(a.id),firstName:a.firstName,lastName:a.lastName,gender:a.gender,phoneNumber:a.phoneNumber,email:a.email,dateOfBirth:W(a.dateOfBirth),birthPlace:a.birthPlace,address:a.address,stateId:a.stateId,username:e.username,password:e.password,roleId:e.roleId,lineManagerId:e.lineManagerId,active:e.active},n={superannuationName:e.superannuationName,superannuationBankName:e.superannuationBankName,superannuationBankAccountOrMembershipNumber:e.superannuationBankAccountOrMembershipNumber,superannuationAbnOrUsi:e.superannuationAbnOrUsi,superannuationBankBsb:e.superannuationBankBsb,superannuationAddress:e.superannuationAddress,superannuationType:e.superannuationType},i={nextOfKinDateOfBirth:W(e.nextOfKinDateOfBirth),nextOfKinEmail:e.nextOfKinEmail,nextOfKinGender:e.nextOfKinGender,nextOfKinName:e.nextOfKinName,nextOfKinPhoneNumber:e.nextOfKinPhoneNumber,nextOfKinRelation:e.nextOfKinRelation},r=e.bankAccounts.length>0?e.bankAccounts[0]:{},o={bankName:r.name,bankAccountNo:r.accountNo,bankBsb:r.bsb,tfn:e.tfn,taxFreeThreshold:e.taxFreeThreshold,helpHECS:e.helpHECS},s=e.employmentContracts.length>0?e.employmentContracts[0]:{};return{basic:l,detail:n,kin:i,bank:o,billing:{employmentContractId:s.id,employeeId:s.employeeId,payslipEmail:s.payslipEmail,membershipAccountNo:s.membershipAccountNo,payFrequency:s.payFrequency,startDate:W(s.startDate),endDate:W(s.endDate),type:s.type,noOfHours:s.noOfHours,noOfDays:s.noOfDays,noOfHoursPer:s.noOfHoursPer,remunerationAmount:s.remunerationAmount,remunerationAmountPer:s.remunerationAmountPer,comments:s.comments,leaveRequestPolicyId:null!==(t=s.leaveRequestPolicyId)&&void 0!==t?t:0,fileId:s.fileId,file:s.fileId?[{id:s.file.id,createdAt:s.file.createdAt,fileId:s.file.id,uid:s.file.uniqueName,name:s.file.originalName,type:s.file.type,url:"".concat(A,"/files/").concat(s.file.uniqueName),thumbUrl:X(s.file.type)}]:[]},train:{training:e.training}}}var _l=el.a.TabPane,Ul=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.editEmp;e.fetchAll(t)},e.fetchAll=function(t){var a=e.props.editEmp;Promise.all([pt(),Dt(),t?e.getRecord(a):ht("helpers/contact-persons?organizationId=1&active=0&associated=1"),It(),ht("helpers/contact-persons?organizationId=1&active=1&associated=1")]).then((function(a){var l=e.state,n=l.BasicFields,i=l.BillingFields,r=l.ManagerFields;n[15].data=a[0].data,n[3].data=a[1].data,i[17].data=a[3].data,r[1].data=a[4].data,e.setState({BasicFields:n,BillingFields:i,ManagerFields:r,CONTACT:t?[]:a[2].data})})).catch((function(e){console.log(e)}))},e.setBankReq=function(){var t=e.formRef.current.getFieldsValue().bank,a=t.bankAccountNo,l=t.bankBsb,n=t.bankName,i=t.tfn,r=e.state.BankFields;a||l||n||i?(r[0].rangeMin=!0,r[1].rangeMin=!0,r[4].rangeMin=!0,r[5].rangeMin=!0,r[2].rules=[{required:!0,message:"Account Name is required"}],r[3].rules=[{required:!0,message:"Account Number is required"}],r[6].rules=[{required:!0,message:"BSB Number is required"}],r[7].rules=[{required:!0,message:"Tax File Number is required"}]):(r[0].rangeMin=!1,r[1].rangeMin=!1,r[4].rangeMin=!1,r[5].rangeMin=!1,r[2].rules=[{required:!1,message:""}],r[3].rules=[{required:!1,message:""}],r[6].rules=[{required:!1,message:""}],r[7].rules=[{required:!1,message:""}]),e.setState({BankFields:Object(we.a)(r)})},e.addEmployee=function(t){var a=e.props.callBack,l=e.state.sContact;t.contactPersonId=l,function(e){return z.b.loading({content:"Loading...",key:1}),Ve.a.post(Vl,e,{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.message,n=t.data;return $(l),z.b.success({content:l,key:1}),a?{success:a,data:n,billing:Hl(n).billing}:{success:a,data:n}})).catch((function(e){return Q(e,1,5)}))}(t).then((function(t){e.setState({loading:!1}),t.success&&a(t.data,!1)}))},e.getRecord=function(t){return Yl(t).then((function(t){if(t.success){var a,l=e.state.BillingFields;return e.formRef.current.setFieldsValue({basic:t.basic,detail:t.detail,bank:t.bank,kin:t.kin,billing:t.billing,train:t.train}),l[11].Placeholder=1===(null===t||void 0===t||null===(a=t.billing)||void 0===a?void 0:a.type)?"Hourly Base Salary":"Annual Base Salary",e.setState({fileIds:t.billing.fileId,fileList:t.billing.file,BillingFields:l}),e.onFundType(t.detail&&t.detail),!0}}))},e.editRecord=function(t){var a,l,n=e.props,i=n.editEmp,r=n.callBack;(a=i,l=t,z.b.loading({content:"Loading...",key:a}),console.log(l),Ve.a.put(Vl+"/".concat(a),l,{headers:J()}).then((function(e){var t=e.data,l=t.success,n=t.message,i=t.data;if($(n),z.b.success({content:n,key:a}),l){var r,o=Hl(i).billing;return K(null===e||void 0===e||null===(r=e.headers)||void 0===r?void 0:r.authorization),{success:l,data:i,billing:o}}return{success:l,data:i}})).catch((function(e){return Q(e,a,5)}))).then((function(t){e.setState({loading:!1}),t.success&&r()}))},e.onContact=function(t){t?ql(t).then((function(a){a.success&&(console.log(a.data),a.data.cpCode="Emp-00".concat(a.data.id),a.data.dateOfBirth=W(a.data.dateOfBirth),e.formRef.current.setFieldsValue({basic:a.data}),e.setState({sContact:t}))})):e.formRef.current.resetFields()},e.onFundType=function(t){var a=[{Placeholder:"SMSF ABN",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"ESA Address",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"detail",fieldCol:12,key:"superannuationAbnOrUsi",shape:"ABN",size:"small",type:"Input",rules:[{required:!0,message:"SMSF ABN is required"},function(e){e.getFieldValue;return{validator:function(e,t){var a=t.toString(),l=new Array(10,1,3,5,7,9,11,13,15,17,19);if(11===a.length){var n=0;return l.forEach((function(e,t){var l=a[t]-(t?0:1);n+=e*l})),console.log(n%89),n%89===0?Promise.resolve():Promise.reject(new Error("ABN is not valid"))}return Promise.reject(new Error("Must contain 11 digits"))}}}],itemStyle:{marginBottom:10}},{object:"detail",fieldCol:12,key:"superannuationAddress",size:"small",type:"Input",rules:[{required:!0,message:"ESA Address is required"}],itemStyle:{marginBottom:10}},{Placeholder:"Bank Account Holder Name",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"BSB Number",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"detail",fieldCol:12,key:"superannuationBankName",size:"small",type:"Input",rules:[{required:!0,message:"Account Name is required"}],itemStyle:{marginBottom:10}},{object:"detail",fieldCol:12,key:"superannuationBankBsb",size:"small",type:"Input",rules:[{required:!0,message:"BSB Number is required"}],itemStyle:{marginBottom:10}},{Placeholder:"Bank Account Number",rangeMin:!0,fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"detail",fieldCol:12,key:"superannuationBankAccountOrMembershipNumber",size:"small",type:"Input",rules:[{required:!0,message:"Account Number is required"}],itemStyle:{marginBottom:"10px"}}],l=e.state.DetailFields,n=e.formRef.current.getFieldsValue().detail,i=n.superAnnuationName,r=n.superannuationType;"P"===r?(l.splice(4,l.length),l=l.concat([{Placeholder:"Membership / Account",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"USI Number",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"detail",fieldCol:12,key:"superannuationBankAccountOrMembershipNumber",size:"small",type:"Input",rules:[{required:!0,message:"Membership / Account is required"}],itemStyle:{marginBottom:10}},{object:"detail",fieldCol:12,key:"superannuationAbnOrUsi",size:"small",type:"Input",rules:[{required:!0,message:"USI Number is required"}],itemStyle:{marginBottom:10}}])):"S"===r?(l.splice(4,l.length),l=l.concat(a)):l.splice(4,l.length);var o={superAnnuationName:i,superannuationType:r};e.formRef.current.setFieldsValue({detail:o}),e.setState({DetailFields:Object(we.a)(l)})},e.onFinish=function(t){var a,l,n,i,r,o,s=e.state.fileIds;e.setState({loading:!0});var c=t.basic,d=t.detail,u=t.kin,m=t.bank,f=t.billing,p=Object(Fe.a)(Object(Fe.a)(Object(Fe.a)(Object(Fe.a)({},c),d),u),{},{latestEmploymentContract:Object(Fe.a)(Object(Fe.a)({},f),{},{fileId:s,startDate:W(f.startDate,!0),endDate:W(f.endDate,!0),leaveRequestPolicyId:f.leaveRequestPolicyId||null,remunerationAmountPer:1===f.type?1:7}),dateOfBirth:W(c.dateOfBirth,!0),lineManagerId:null!==(a=null===c||void 0===c?void 0:c.lineManagerId)&&void 0!==a?a:null,superannuationType:null!==(l=null===d||void 0===d?void 0:d.superannuationType)&&void 0!==l?l:null,bankName:null!==(n=m.bankName)&&void 0!==n?n:"",bankAccountNo:null!==(i=m.bankAccountNo)&&void 0!==i?i:"",bankBsb:null!==(r=m.bankBsb)&&void 0!==r?r:"",tfn:null!==(o=m.tfn)&&void 0!==o?o:"",taxFreeThreshold:m.taxFreeThreshold,helpHECS:m.helpHECS});e.props.editEmp?e.editRecord(p):e.addEmployee(p)},e.handleUpload=function(){var t=Object(La.a)(Ma.a.mark((function t(a){var l,n,i,r,o;return Ma.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=a.onSuccess,n=a.onError,i=a.file,r=a.onProgress,o=new FormData,{headers:{"content-type":"multipart/form-data"},onUploadProgress:function(t){var a=Math.floor(t.loaded/t.total*100);e.setState({progress:a}),100===a&&setTimeout((function(){return e.setState({progres:0})}),1e3),r({percent:t.loaded/t.total*100})}},o.append("files",i),vl(o).then((function(t,a){if(t.success)l("Ok"),e.setState({fileList:[t.file],fileIds:t.file.fileId});else{console.log("Eroor: ",a);new Error("Some error");n({err:a})}}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onFinishFailed=function(t){t.values;var a=t.errorFields;t.outOfDate;e.setState({activeKey:a[0].name[0]})},e.onRemove=function(t){e.setState({fileIds:null,fileList:[]})},e.formRef=n.a.createRef(),e.state={editEmp:!1,loading:!1,CONTACT:[],data:{},imgLoading:!1,fileList:[],fileIds:null,activeKey:"basic",BasicFields:[{fieldCol:12,size:"small",Placeholder:"Contact person Code",rangeMin:!0,type:"Text",labelAlign:"left"},{Placeholder:"Role",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"cpCode",size:"small",readOnly:!0,rules:[{required:!0,message:"Select Contact Person !!"}],type:"Input",labelAlign:"left",itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"roleId",rules:[{required:!0,message:"Role is required!!"}],size:"small",type:"Select",data:[],itemStyle:{marginBottom:10}},{fieldCol:12,size:"small",Placeholder:"First Name",disabled:!1,type:"Text",labelAlign:"left"},{Placeholder:"Last Name",fieldCol:12,size:"small",disabled:!1,type:"Text",labelAlign:"left"},{object:"basic",fieldCol:12,key:"firstName",size:"small",type:"Input",labelAlign:"left",disabled:!1,itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"lastName",size:"small",type:"Input",labelAlign:"left",disabled:!1,itemStyle:{marginBottom:5}},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{fieldCol:12,size:"small",Placeholder:"Personal Email",disabled:!1,type:"Text",labelAlign:"left"},{object:"basic",fieldCol:12,key:"phoneNumber",size:"small",type:"input",itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"email",size:"small",type:"Input",disabled:!1,itemStyle:{marginBottom:10}},{Placeholder:"Gender",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"State For Payroll Tax Purpose",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"gender",size:"small",data:[{label:"Male",value:"M"},{label:"Female",value:"F"},{label:"Other",value:"O"}],itemStyle:{marginBottom:10},type:"Select"},{object:"basic",fieldCol:12,key:"stateId",size:"small",type:"Select",data:[],itemStyle:{marginBottom:10}},{Placeholder:"Date Of Birth",fieldCol:12,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:1}},{Placeholder:"Birth Place",fieldCol:12,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:1}},{object:"basic",fieldCol:12,key:"dateOfBirth",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"birthPlace",size:"small",type:"string",itemStyle:{marginBottom:10}},{Placeholder:"Residential Address",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:24,key:"address",size:"small",type:"Input",itemStyle:{marginBottom:"10px"}}],DetailFields:[{Placeholder:"Superannuation Fund/ SMSF Name",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Account type",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"detail",fieldCol:12,key:"superannuationName",size:"small",type:"Input",itemStyle:{marginBottom:"10px"}},{object:"detail",fieldCol:12,key:"superannuationType",size:"small",data:[{label:"Public",value:"P"},{label:"SMSF",value:"S"}],type:"Select",itemStyle:{marginBottom:10},onChange:function(t){e.onFundType(t)}}],KinFields:[{Placeholder:"Name",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"kin",fieldCol:12,key:"nextOfKinName",size:"small",type:"input",itemStyle:{marginBottom:10}},{object:"kin",fieldCol:12,key:"nextOfKinPhoneNumber",size:"small",type:"input",itemStyle:{marginBottom:10}},{Placeholder:"Email",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Relationship to Employee",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"kin",fieldCol:12,key:"nextOfKinEmail",size:"small",type:"input",itemStyle:{marginBottom:10}},{object:"kin",fieldCol:12,key:"nextOfKinRelation",size:"small",data:[{label:"Spouse",value:"Spouse"},{label:"Partner",value:"Partner"},{label:"Sibling",value:"Sibling"},{label:"Parent",value:"Parent"},{label:"Child",value:"Child"},{label:"Friend",value:"Friend"}],type:"Select"}],BankFields:[{Placeholder:"Bank Account Holder Name",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Bank Account Number",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"bank",fieldCol:12,key:"bankName",size:"small",type:"Input",onChange:function(t){e.setBankReq(t)},itemStyle:{marginBottom:10}},{object:"bank",fieldCol:12,key:"bankAccountNo",size:"small",type:"Input",onChange:function(t){e.setBankReq(t)},itemStyle:{marginBottom:10}},{Placeholder:"BSB Number",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Tax File Number",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"bank",fieldCol:12,key:"bankBsb",size:"small",type:"Input",onChange:function(t){e.setBankReq(t)},itemStyle:{marginBottom:10}},{object:"bank",fieldCol:12,key:"tfn",size:"small",type:"Input",onChange:function(t){e.setBankReq(t)},itemStyle:{marginBottom:10}},{Placeholder:"Tax-free Threshold",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"HELP (HECS)",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"bank",fieldCol:12,key:"taxFreeThreshold",size:"small",data:[{label:"Yes",value:!0},{label:"No",value:!1}],type:"Select",itemStyle:{marginBottom:10}},{object:"bank",fieldCol:12,key:"helpHECS",size:"small",data:[{label:"Yes",value:!0},{label:"No",value:!1}],type:"Select",itemStyle:{marginBottom:10}}],BillingFields:[{Placeholder:"Employment Status",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Payslip Email",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"type",size:"small",data:[{label:"Casual",value:1},{label:"Part Time",value:2},{label:"Full Time",value:3}],type:"Select",onChange:function(t){var a=e.state.BillingFields;1===t?(a[11].Placeholder="Hourly Base Salary",e.setState({BillingFields:a})):(a[11].Placeholder="Annual Base Salary",e.setState({BillingFields:a}))},rules:[{required:!0,message:"Status is Required"}],itemStyle:{marginBottom:10}},{object:"billing",fieldCol:12,key:"payslipEmail",size:"small",type:"input",itemStyle:{marginBottom:10}},{Placeholder:"Work Hours In A Week",rangeMin:!0,fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Work Days In A Week",rangeMin:!0,fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Contract Start Date",fieldCol:12,rangeMin:!0,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:6,key:"noOfHours",size:"small",type:"InputNumber",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Work Hours are Required"}],itemStyle:{marginBottom:10}},{object:"billing",fieldCol:6,key:"noOfDays",size:"small",type:"InputNumber",rangeMin:1,rangeMax:5,fieldStyle:{width:"100%"},rules:[{required:!0,message:"Work Days are Required"}],itemStyle:{marginBottom:10}},{object:"billing",fieldCol:12,key:"startDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Start Date is Required"}],itemStyle:{marginBottom:10},rangeMin:function(t){var a=e.formRef.current.getFieldValue().billing;return a.endDate&&t>a.endDate}},{Placeholder:"Contract End Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Annual Base Salary",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"endDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:1},rangeMax:function(t){var a=e.formRef.current.getFieldValue().billing;return a.startDate&&t<a.startDate}},{object:"billing",fieldCol:12,key:"remunerationAmount",size:"small",type:"InputNumber",shape:"$",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Salary is Required"}],itemStyle:{marginBottom:10}},{Placeholder:"Pay Frequence",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Leave Policy",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"payFrequency",size:"small",data:[{label:"Hourly",value:1},{label:"Daily",value:2},{label:"Weekly",value:3},{label:"Fortnightly",value:4},{label:"Monthly",value:5}],type:"Select",rules:[{required:!0,message:"Payment Frequncy is required"}],itemStyle:{marginBottom:10}},{object:"billing",fieldCol:12,key:"leaveRequestPolicyId",size:"small",data:[],type:"Select",rules:[{required:!0,message:"Policy is required"}],itemStyle:{marginBottom:10}},{Placeholder:"Comments",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:24,key:"comments",size:"small",type:"Textarea",itemStyle:{marginBottom:1}}],ManagerFields:[{Placeholder:"Employee Manager",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"lineManagerId",size:"small",data:[],type:"Select",itemStyle:{marginBottom:10}}],TrainFields:[{Placeholder:"Training",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"train",fieldCol:24,key:"training",size:"small",mode:{minRows:8,maxRows:12},type:"Textarea"}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.editEmp,l=t.visible,i=t.close,r=this.state,o=r.BasicFields,s=r.DetailFields,c=r.KinFields,d=r.BankFields,u=r.BillingFields,m=r.TrainFields,f=r.ManagerFields,p=r.CONTACT,g=r.loading,y=r.fileList,h=r.activeKey;return n.a.createElement(wt.a,{title:a?"Edit Employee":"Add Employee",maskClosable:!1,centered:!0,visible:l,okButtonProps:{disabled:g,htmlType:"submit",form:"my-form"},okText:g?n.a.createElement(Mt.a,null):"Save",onCancel:function(){return i()},width:900},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,onFinishFailed:this.onFinishFailed,scrollToFirstError:!0,size:"small",layout:"inline",initialValues:{billing:{startDate:null}}},!a&&n.a.createElement(b.a,{span:8,style:{marginBottom:10}},n.a.createElement(Me.a.Item,{name:["basic","contactPersonId"]},n.a.createElement(Qe.a,{placeholder:"Contact Person",options:p,showArrow:!0,size:"small",allowClear:!0,onClear:this.onContact,onChange:this.onContact,showSearch:!0,optionFilterProp:"label",filterOption:function(e,t){return t.label.toLowerCase().indexOf(e.toLowerCase())>=0},style:{width:"100%"}}))),n.a.createElement(b.a,{span:8,style:{marginLeft:"auto",marginBottom:10}},n.a.createElement(Me.a.Item,{name:["basic","username"],rules:[{required:!0,message:"Email/Username is requrired"}]},n.a.createElement(Je.a,{placeholder:"Email",size:"small",type:"email",style:{width:"100%"}}))),n.a.createElement(el.a,{type:"card",activeKey:h,onChange:function(t){e.setState({activeKey:t})}},n.a.createElement(_l,{tab:"Personal Details",key:"basic",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:o})),n.a.createElement(_l,{tab:" Employment Contract",key:"billing",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:u}),n.a.createElement("p",{style:{marginTop:10,marginBottom:2}},"Signed Contract"),n.a.createElement(We.a,{customRequest:this.handleUpload,listType:"picture-card",maxCount:1,fileList:y,onRemove:this.onRemove},y.length<1&&n.a.createElement("div",{style:{marginTop:10}},n.a.createElement(Ll.a,null),n.a.createElement("div",{style:{marginTop:8}},"Upload")))),n.a.createElement(_l,{tab:"Superannuation",key:"detail",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:s})),n.a.createElement(_l,{tab:"Next of Kin",key:"kin",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:c})),n.a.createElement(_l,{tab:"Banking/Tax Details",key:"bank",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:d})),n.a.createElement(_l,{tab:"Employee Manager",key:"manage",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:f})),n.a.createElement(_l,{tab:"Training Detail",key:"train",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:m})))))}}]),a}(l.Component),Wl=ve.a.Title,Kl=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getList()},e.getList=function(){var t=JSON.parse(G().permissions).USERS;Ve.a.get(Vl,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(a){a.success&&e.setState({data:a.data,filterData:a.data,infoModal:!1,editEmp:!1,permissions:t})}))},e.handleDelete=function(t,a){var l=e.state,n=l.data,i=l.filterData,r=e.props.history;sl(r,"/employees",t,a,i,n).then((function(t){t.success&&e.setState({data:Object(we.a)(t.data),filterData:Object(we.a)(t.filterData)})}))},e.closeModal=function(){e.setState({infoModal:!1,editEmp:!1})},e.callBack=function(t){e.getList()},e.generalFilter=function(t){var a=e.state.data;t?(t=t.replace(/\s+/g,"").toLowerCase(),e.setState({filterData:a.filter((function(e){var a=e.contactPersonOrganization.contactPerson,l=a.firstName,n=a.lastName,i=a.email,r=a.phoneNumber,o=a.id,s="".concat(l||""," ").concat(n||""),c="".concat(n||""," ").concat(l||"");return"Emp-00".concat(o.toString()).replace(/\s+/g,"").includes(t)||s.toLowerCase().replace(/\s+/g,"").includes(t.toLowerCase())||c.toLowerCase().replace(/\s+/g,"").includes(t.toLowerCase())||i&&i.toLowerCase().replace(/\s+/g,"").includes(t.toLowerCase())||r&&r.startsWith(t)}))})):e.setState({filterData:a})},e.advancefilter=function(t,a,l){var n=e.state,i=n.data,r=n.searchedColumn;a?r[a].value=t:r=l,r.id.value||r.firstName.value||r.lastName.value||r.email.value||r.phoneNumber.value||r.gender.value.length>0||r.stateId.value.length>0||r.address.value||r.clearanceLevel.value.length>0||r.role.value.length>0?e.setState({filterData:i.filter((function(e){var t=e.contactPersonOrganization.contactPerson,a=t.firstName,l=t.lastName,n=t.email,i=t.phoneNumber,o=t.id,s=t.gender,c=t.stateId,d=t.address,u=t.clearanceLevel;return"Emp-00".concat(o.toString()).includes(r.id.value)&&"".concat(null!==a&&void 0!==a?a:"").toLowerCase().includes(r.firstName.value.toLowerCase())&&"".concat(null!==l&&void 0!==l?l:"").toLowerCase().includes(r.lastName.value.toLowerCase())&&"".concat(null!==n&&void 0!==n?n:"").toLowerCase().includes(r.email.value.toLowerCase())&&"".concat(null!==i&&void 0!==i?i:"").toLowerCase().includes(r.phoneNumber.value.toLowerCase())&&"".concat(null!==d&&void 0!==d?d:"").toLowerCase().includes(r.address.value.toLowerCase())&&(r.gender.value.length>0?r.gender.value:[{value:","}]).some((function(e){return(r.gender.value.length>0?[s]:[","]).includes(e.value)}))&&(r.stateId.value.length>0?r.stateId.value:[{value:","}]).some((function(e){return(r.stateId.value.length>0?[c]:[","]).includes(e.value)}))&&(r.role.value.length>0?r.role.value:[{value:","}]).some((function(t){return(r.role.value.length>0?[e.roleId]:[","]).includes(t.value)}))&&(r.clearanceLevel.value.length>0?r.clearanceLevel.value:[{value:","}]).some((function(e){return(r.clearanceLevel.value.length>0?[u]:[","]).includes(e.value)}))})),searchedColumn:r,openSearch:!1}):e.setState({searchedColumn:r,filterData:i,openSearch:!1})},e.filterModalUseEffect=function(){Promise.all([pt(),Dt()]).then((function(t){var a=e.state.filterFields;a[11].data=t[0].success?t[0].data:[],a[14].data=t[1].success?t[1].data:[],e.setState({filterFields:a})})).catch((function(e){console.log(e)}))},e.columns=[Object(Fe.a)({title:"Code",dataIndex:["contactPersonOrganization","contactPersonId"],key:"contactPersonId",wdith:115,render:function(e){return"Emp-00".concat(e)}},Jt("contactPersonOrganization.contactPersonId","number",!0)),Object(Fe.a)({title:"First Name",dataIndex:["contactPersonOrganization","contactPerson","firstName"],key:"firstName",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"/Employees/".concat(t.id,"/info")},className:"nav-link"},e)}},Jt("contactPersonOrganization.contactPerson.firstName","string")),Object(Fe.a)({title:"Last Name",dataIndex:["contactPersonOrganization","contactPerson","lastName"],key:"lastName"},Jt("contactPersonOrganization.contactPerson.lastName","string")),{title:"Phone",dataIndex:["contactPersonOrganization","contactPerson","phoneNumber"],key:"phoneNumber"},{title:"Email",dataIndex:["contactPersonOrganization","contactPerson","email"],key:"email"},{title:"...",key:"action",align:"center",width:"1%",render:function(t,a,l){var i,r,o,c,d,u;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(e))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(a.id,l)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){e.setState({infoModal:!0,editEmp:a.id})},disabled:!(null===(c=Object(Aa.a)(e))||void 0===c||null===(d=c.state)||void 0===d||null===(u=d.permissions)||void 0===u?void 0:u.UPDATE)},"Edit"),n.a.createElement(v.a.Item,{key:"view"},n.a.createElement(s.b,{to:{pathname:"/Employees/".concat(a.id,"/info")},className:"nav-link"},"View")),n.a.createElement(v.a.Item,{key:"Contract History"},n.a.createElement(s.b,{to:{pathname:"/Employee/".concat(a.id,"/contracts")},className:"nav-link"},"Contract History")),n.a.createElement(v.a.Item,{key:"Novated lease"},n.a.createElement(s.b,{to:{pathname:"/Employee/".concat(a.id,"/novated-lease")},className:"nav-link"},"Novated Lease")))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],e.state={infoModal:!1,editEmp:!1,data:[],permissions:{},filterData:[],openSearch:!1,searchedColumn:{id:{type:"Input",value:"",label:"Code",showInColumn:!0},firstName:{type:"Input",value:"",label:"First Name",showInColumn:!0},lastName:{type:"Input",value:"",label:"Last Name",showInColumn:!0},phoneNumber:{type:"Input",value:"",label:"Phone Number",showInColumn:!0},email:{type:"Input",value:"",label:"Personal Email",showInColumn:!0},Action:{type:"Input",value:"",label:"",showInColumn:!0,disabled:!0},stateId:{type:"none",multi:!0,value:[],label:"State",showInColumn:!1,disabled:!1},clearanceLevel:{type:"none",multi:!0,value:[],label:"clearanceLevel",showInColumn:!1,disabled:!1},gender:{type:"Select",multi:!0,value:[],label:"Gender",showInColumn:!1},address:{type:"none",value:"",label:"Residential Address",showInColumn:!1,disabled:!1},role:{type:"none",multi:!0,value:[],label:"Role",showInColumn:!1,disabled:!1}},filterFields:[{fieldCol:12,size:"small",Placeholder:"First Name",type:"Text",labelAlign:"left"},{Placeholder:"Last Name",fieldCol:12,size:"small",type:"Text",labelAlign:"left"},{object:"obj",fieldCol:12,key:"firstName",size:"small",type:"Input",labelAlign:"left"},{object:"obj",fieldCol:12,key:"lastName",size:"small",type:"Input",labelAlign:"left"},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{fieldCol:12,size:"small",Placeholder:"Personal Email",type:"Text",labelAlign:"left"},{object:"obj",fieldCol:12,key:"phoneNumber",size:"small",type:"input"},{object:"obj",fieldCol:12,key:"email",size:"small",type:"Input"},{Placeholder:"Gender",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"State For Payroll Tax Purpose",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"gender",mode:"multiple",customValue:function(e,t){return t},size:"small",data:[{label:"Male",value:"M"},{label:"Female",value:"F"},{label:"Other",value:"O"}],type:"Select"},{object:"obj",fieldCol:12,mode:"multiple",customValue:function(e,t){return t},key:"stateId",size:"small",type:"Select",data:[]},{Placeholder:"Role",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Clearance Level",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,mode:"multiple",key:"role",customValue:function(e,t){return t},size:"small",type:"Select",data:[]},{object:"obj",fieldCol:12,key:"clearanceLevel",size:"small",mode:"multiple",customValue:function(e,t){return t},data:[{label:"BV - Baseline Vetting",value:"BV"},{label:"NV1 - Negative Vetting 1",value:"NV1"},{label:"NV2 - Negative Vetting 2",value:"NV2"},{label:"PV - Positive Vetting",value:"PV"},{label:"No clearance",value:"NC"}],type:"Select"},{Placeholder:"Residential Address",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"address",size:"small",type:"Input"}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.infoModal),l=t.editEmp,i=t.permissions,r=t.filterData,o=t.searchedColumn,s=t.filterFields,c=t.openSearch,d=this.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Wl,{level:4},"Employees")),n.a.createElement(b.a,null,n.a.createElement(p.a,{justify:"space-between",gutter:17},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"default",size:"small",onClick:function(){return e.setState({openSearch:!0})}},n.a.createElement(Ft.a,null),"Filter")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",onClick:function(){e.setState({infoModal:!0})},size:"small",disabled:!i.ADD},n.a.createElement(Nt.a,null),"Employees")))),n.a.createElement(ea,{filters:o,filterFunction:this.advancefilter}),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:d,dataSource:r,size:"small",className:"fs-small"}))),c&&n.a.createElement(Zt,{title:"Filter Employees",visible:c,filters:o,filterFields:s,filterFunction:this.advancefilter,effectFunction:this.filterModalUseEffect,effectRender:!0,onClose:function(){return e.setState({openSearch:!1})}}),a&&n.a.createElement(Ul,{visible:a,editEmp:l,close:this.closeModal,callBack:this.callBack}))}}]),a}(l.Component),Gl=a(241),$l=a(610),Jl=a(611),Xl="".concat(A,"/leave-requests"),Ql=function(e){return z.b.loading({content:"Loading...",key:e}),Ve.a.get("".concat(Xl,"/").concat(e),{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.message,r=l.data;if(z.b.success({content:i,key:e}),K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),n){var o,s=null===r||void 0===r?void 0:r.entries,c=null!==(o=null===r||void 0===r?void 0:r.attachments)&&void 0!==o?o:[],d=[],u=[];return c.map((function(e){d.push(e.fileId),u.push({id:e.id,createdAt:e.createdAt,fileId:e.fileId,status:e.status,targetId:e.targetId,targetType:e.targetType,uid:e.file.uniqueName,name:e.file.originalName,type:"png"===e.file.type?"image/png":e.file.type,url:"".concat(A,"/files/").concat(e.file.uniqueName),thumbUrl:X(e.file.type)})})),{success:n,data:r,entries:s,fileIds:d,fileList:u}}return{success:n,data:r}})).catch((function(t){var a,l,n=null===t||void 0===t||null===(a=t.response)||void 0===a||null===(l=a.data)||void 0===l?void 0:l.message;return z.b.error({content:n,key:e}),{error:"Please login again!",success:!1,message:t.message}}))},Zl=function(e){return Ve.a.get("".concat(Xl,"/approvalLeaveRequests?").concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){var t,a,l=null===e||void 0===e||null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message;return"Leave Requests not found"!==l&&z.b.error({content:l,key:1}),{error:"Please login again!",success:!1,message:e.message}}))},en=["index"],tn=["title","editable","children","dataIndex","record","handleSave"],an=n.a.createContext(null),ln=ve.a.Text,nn=function(e){e.index;var t=Object(Gl.a)(e,en),a=Me.a.useForm(),l=Object(he.a)(a,1)[0];return n.a.createElement(Me.a,{form:l,component:!1},n.a.createElement(an.Provider,{value:l},n.a.createElement("tr",t)))},rn=function(e){var t=e.title,a=e.editable,i=e.children,r=e.dataIndex,o=e.record,s=e.handleSave,c=Object(Gl.a)(e,tn),d=Object(l.useState)(!1),u=Object(he.a)(d,2),m=u[0],f=u[1],g=Object(l.useRef)(null),y=Object(l.useContext)(an);Object(l.useEffect)((function(){m&&g.current.focus()}),[m]);var h=function(){f(!m),y.setFieldsValue(Object(Ne.a)({},r,o[r]))},v=function(){var e=Object(La.a)(Ma.a.mark((function e(){var t;return Ma.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.validateFields();case 3:t=e.sent,h(),s(Object(Fe.a)(Object(Fe.a)({},o),t)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Save failed:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),E=i;return a&&(E=m?n.a.createElement(p.a,null,n.a.createElement(b.a,{span:10},n.a.createElement(Me.a.Item,{style:{margin:0},name:r,rules:[{required:!0,message:"".concat(t," is required.")}]},n.a.createElement(Xe.a,{ref:g,size:"small"}))),n.a.createElement(b.a,{style:{margin:"auto 0"},span:3},n.a.createElement($l.a,{style:{color:"red",fontSize:24},onClick:function(){return f(!m)}})),n.a.createElement(b.a,{style:{margin:"auto 0"}},n.a.createElement(Le.a,{title:"You Want to Update Accrued Balance?",onConfirm:v,okText:"Yes",cancelText:"No"},n.a.createElement(Jl.a,{style:{color:"green",fontSize:24}})))):n.a.createElement("div",{className:"editable-cell-value-wrap",style:{paddingRight:24},onClick:h},i)),n.a.createElement("td",c,E)},on=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){var e,t=l.props.empId;(e=t,Ve.a.get("".concat(A,"/leave-request-balances?employeeId=").concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l){var i=new Date(Math.max.apply(Math,Object(we.a)(n.map((function(e){return new Date(e.updatedAt)})))));return{success:l,data:n,lastUpdate:i}}return{success:l}})).catch((function(e){var t,a,l=null===e||void 0===e||null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message;return z.b.error({content:null!==l&&void 0!==l?l:e.message,key:1}),{error:"Please login again!",success:!1,message:e.message}}))).then((function(e){(null===e||void 0===e?void 0:e.success)&&l.setState({data:e.data,lastUpdate:e.lastUpdate})}))},l.handleSave=function(e){var t,a;(t=e.id,a=e,Ve.a.patch("".concat(A,"/leave-request-balances/").concat(t),a,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){var t,a,l=null===e||void 0===e||null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message;return z.b.error({content:null!==l&&void 0!==l?l:e.message,key:1}),{error:"Please login again!",success:!1,message:e.message}}))).then((function(t){if(t.success){console.log(t.data);var a=Object(we.a)(l.state.data),n=a.findIndex((function(t){return e.id===t.id})),i=a[n];a.splice(n,1,Object(Fe.a)(Object(Fe.a)({},i),t.data)),l.setState({data:a})}}))},l.columns=[{title:"Type",dataIndex:"name",key:"name",width:"30%"},{title:"Accrued",dataIndex:"carryForward",key:"carryForward",className:"editable-cell",width:"14%",editable:e.editable,render:function(e){return U(e)}},{title:"Earned YTD",dataIndex:"earned",key:"earned",width:"14%",render:function(e,t){return U(t.balanceHours-t.carryForward+t.used)}},{title:"Used YTD",dataIndex:"used",key:"used",width:"14%",render:function(e){return U(e)}},{title:"Balance",dataIndex:"balanceHours",key:"balanceHours",width:"14%",render:function(e){return U(e)}}],l.state={data:[],permissions:{},lastUpdate:null},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.data,l=t.lastUpdate,i=this.props.style,r={body:{row:nn,cell:rn}},o=this.columns.map((function(t){return t.editable?Object(Fe.a)(Object(Fe.a)({},t),{},{onCell:function(a){return Object(Fe.a)(Object(Fe.a)({},t),{},{record:a,handleSave:e.handleSave})}}):t}));return n.a.createElement(p.a,null,n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{components:r,style:i,bordered:!0,rowKey:function(e){return e.id},columns:o,dataSource:a,size:"small",className:"fs-small",tableLayout:"fixed"})),n.a.createElement(b.a,null,n.a.createElement(ln,{type:"danger"},"Last Updated: ",W(l,!0,!0)," ")))}}]),a}(l.Component);a(266),a(267);function sn(e){var t=e.value,a=e.shape,l=e.onChange,i=e.min,r=e.max;return n.a.createElement(Xe.a,{size:"small",value:t,formatter:function(e){return ut(e,a)},parser:function(e){return mt(e,a)},onChange:l,min:i,max:r})}var cn=function(e){var t=Object(l.useState)({}),a=Object(he.a)(t,2),i=a[0],r=a[1],o=Object(l.useState)([]),s=Object(he.a)(o,2),c=s[0],d=s[1],u=Object(l.useState)(0),m=Object(he.a)(u,2),f=m[0],g=m[1],y=Object(l.useState)([20,25,30,40]),h=Object(he.a)(y,2),E=h[0],k=h[1],S=Object(l.useState)(0),C=Object(he.a)(S,2),j=C[0],D=C[1],O=Object(l.useState)(8),I=Object(he.a)(O,2),P=I[0],x=I[1];Object(l.useEffect)((function(){var t=ee("years");Tt("employees",e.empId).then((function(e){if(e.success){for(var a=e.data,l=a.contract,n=a.golobalVariables,i=a.employeeBuyRate,o=[],s=0;null===(c=s<l.noOfDays)||void 0===c||c;s++){var c;o.push(s+1)}var u=W(new Date).isoWeekdayCalc({rangeStart:"1 July ".concat(t.start),rangeEnd:"30 June ".concat(t.end),weekdays:o});l.workDaysPerAnum=u,g(i),r(l),d(n)}}))}),[]);return n.a.createElement("div",null,i.hourlyBaseRate?n.a.createElement(p.a,{className:"buy-sell-calculator"},n.a.createElement(b.a,{span:12,className:"buy-cost calculator"},n.a.createElement(p.a,null,n.a.createElement(b.a,{span:24,className:"mb-10"},n.a.createElement(ve.a.Title,{level:5},"Buy Rate Calculator - Employee")),"                 ",n.a.createElement(b.a,{span:16,className:"label"},1===i.type?"Hourly Base Salary":"Annual Base Salary"),n.a.createElement(b.a,{span:8,className:"item"},_(null===i||void 0===i?void 0:i.remunerationAmount)),n.a.createElement(b.a,{span:16,className:"label"},"Daily Hours"),n.a.createElement(b.a,{span:8,className:"item"},U(null===i||void 0===i?void 0:i.dailyHours)),n.a.createElement(b.a,{span:16,className:"label"},"Weekly Hours - (".concat(U(null===i||void 0===i?void 0:i.dailyHours)," * ").concat(null===i||void 0===i?void 0:i.noOfDays," days)")),n.a.createElement(b.a,{span:8,className:"item"},U(null===i||void 0===i?void 0:i.noOfHours)),n.a.createElement(b.a,{span:16,className:"label"},"Billable Days per annum"),n.a.createElement(b.a,{span:8,className:"item"},null===i||void 0===i?void 0:i.workDaysPerAnum),n.a.createElement(b.a,{span:16,className:"label my-10"},1===i.type?"Hourly Base Rate":"Hourly Base Rate - (".concat(_(null===i||void 0===i?void 0:i.remunerationAmount)," / ",52," / ").concat(U(null===i||void 0===i?void 0:i.noOfHours),")")),n.a.createElement(b.a,{span:8,className:"item my-10"},_(null===i||void 0===i?void 0:i.hourlyBaseRate)),n.a.createElement(b.a,{span:5,offset:16,className:"item"},n.a.createElement(ve.a.Text,{underline:!0,strong:!0},"Applicable")),c.map((function(e,t){return n.a.createElement(b.a,{span:24,key:t},n.a.createElement(p.a,null,n.a.createElement(b.a,{span:12,className:"label"},Y[e.name]?"Payroll Tax - ".concat(Y[e.name]):e.name),n.a.createElement(b.a,{span:4,className:"item"},"".concat(e.value,"%")),n.a.createElement(b.a,{span:4,className:"item"},n.a.createElement(se.a,{trigger:["click"],overlay:n.a.createElement(v.a,{style:{backgroundColor:"#f6f4f1"},onClick:function(e){!function(e,t){var a=c;a[t].apply=e;var l=i.hourlyBaseRate;a=a.map((function(e,t){return e.amount=0===t?"Yes"===e.apply?(null===i||void 0===i?void 0:i.hourlyBaseRate)*e.value/100:0:"Yes"===e.apply?((null===i||void 0===i?void 0:i.hourlyBaseRate)+a[0].amount)*e.value/100:0,l+=e.amount,e})),g(l),d(Object(we.a)(a))}(null===e||void 0===e?void 0:e.key,t)}},n.a.createElement(v.a.Item,{key:"Yes"},"Yes"),n.a.createElement(v.a.Item,{key:"No"},"No"))},n.a.createElement("span",{className:"mouse-pointer"},e.apply))),n.a.createElement(b.a,{span:4,className:"item"},_(e.amount))))})),n.a.createElement(b.a,{span:16,className:"label my-30"},"Adjustment"),n.a.createElement(b.a,{span:8,className:"item my-30"},n.a.createElement(sn,{value:j,shape:"$",onChange:function(e){D(null!==e&&void 0!==e?e:0)}})),n.a.createElement(b.a,{span:16,className:"label bold my-20"}," Employee Hourly Buy Rate"),n.a.createElement(b.a,{span:8,className:"item bold my-20"}," ",_(f+j)),n.a.createElement(b.a,{span:12,className:"label mb-10"},"Daily Billable Hours"),n.a.createElement(b.a,{span:6,className:"item bold  mb-10"},n.a.createElement(sn,{value:P,onChange:function(e){x(null!==e&&void 0!==e?e:0)}})),n.a.createElement(b.a,{span:16,className:"label bold "}," Employee Daily Buy Rate"),n.a.createElement(b.a,{span:8,className:"item bold total-cost pr-5"}," ",_(P*(f+j))))),n.a.createElement(b.a,{span:12,className:"sell-cost"},n.a.createElement(p.a,null,n.a.createElement(b.a,{span:24,className:"mb-10"},n.a.createElement(ve.a.Title,{level:5},"Sell Rate Calculator - Employee")),n.a.createElement(b.a,{span:7},"Expected CM %"),E.map((function(e,t){return n.a.createElement(b.a,{span:4,key:t},n.a.createElement(sn,{value:e,max:100,shape:"%",onChange:function(e){return function(e,t){E[t]=null!==e&&void 0!==e?e:0,k(Object(we.a)(E))}(e,t)}}))}))),n.a.createElement(p.a,{align:"bottom"},n.a.createElement(b.a,{span:8,className:"label bold"},"Employee Daily Sell Rate"),E.map((function(e,t){return n.a.createElement(b.a,{span:4,className:"bold",key:t},_(P*(f+j)/(1-e/100)))}))))):n.a.createElement(p.a,{className:"buy-sell-calculator ",align:"middle",justify:"center"},n.a.createElement(b.a,{span:12,className:"no-active"},n.a.createElement(ve.a.Text,{type:"danger",mark:!0},"No Active Contract")),n.a.createElement(b.a,{span:12,className:"no-active"},n.a.createElement(ve.a.Text,{type:"danger",mark:!0},"No Active Contract")))," ")},dn=ul.b.Item,un=el.a.TabPane,mn=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.match.params.id;e.getRecord(t)},e.getRecord=function(t){var a=JSON.parse(G().permissions).USERS;Yl(t).then((function(l){l.success?e.setState({data:l.basic,contract:l.billing,bank:l.bank,permissions:a,emp:t,infoModal:!1}):l.authError&&e.setState({notAuth:!0})}))},e.closeModal=function(){e.setState({infoModal:!1})},e.handleDelete=function(t){var a=e.props.history;sl(a,"/employees",t).then((function(e){e.success}))},e.toggleActiveStatus=function(t){(function(e){return z.b.loading({content:"Loading...",key:e}),Ve.a.put(Vl+"/".concat(e,"/toggleActive"),{},{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.message,r=l.data;return $(i),z.b.success({content:i,key:e}),n?(K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n,data:r}):{success:n,data:r}})).catch((function(t){return Q(t,e,5)}))})(t).then((function(t){t.success&&e.setState({data:Object(Fe.a)(Object(Fe.a)({},e.state.data),{},{active:!e.state.data.active})})}))},e.callBack=function(){var t=e.state.emp;e.getRecord(t)},e.state={infoModal:!1,emp:!1,data:{},bank:{},contract:{},permissions:{},notAuth:!1},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.data,l=t.infoModal,i=t.emp,r=t.bank,o=t.notAuth,c=t.contract,d=t.permissions,u=n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,"Basic Information"),n.a.createElement(b.a,null,n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===d||void 0===d?void 0:d.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(i)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",disabled:!(null===d||void 0===d?void 0:d.UPDATE),onClick:function(){e.setState({infoModal:!0})}},"Edit"),n.a.createElement(v.a.Item,{key:"contracts"},n.a.createElement(s.b,{to:{pathname:"/Employee/".concat(i,"/contracts")},className:"nav-link"},"Contract History")),n.a.createElement(v.a.Item,{key:"novated-lease"},n.a.createElement(s.b,{to:{pathname:"/Employee/".concat(i,"/novated-lease")},className:"nav-link"},"Novated Lease")),n.a.createElement(v.a.Item,{key:"deactive",disabled:!(null===d||void 0===d?void 0:d.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to ".concat(a.active?"Deactive":"Activate"),onConfirm:function(){return e.toggleActiveStatus(i)}},n.a.createElement("div",null," ",a.active?"Deactivate":"Activate"," "))))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))));return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:u,size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(dn,{label:"First Name"},a.firstName),n.a.createElement(dn,{label:"Last Name"},a.lastName),n.a.createElement(dn,{label:"Phone"},a.phoneNumber," "),n.a.createElement(dn,{label:"Email"},a.email),n.a.createElement(dn,{label:"Address"},a.address),n.a.createElement(dn,{label:"Date Of Birth"},W(a.dateOfBirth,!0,!0)),n.a.createElement(dn,{label:"Gender"},V[a.gender]),n.a.createElement(dn,{label:"Employment Status"},B[null===c||void 0===c?void 0:c.type])),i&&n.a.createElement(el.a,{type:"card",style:{marginTop:"50px"}},n.a.createElement(un,{tab:"Opportunities",key:"leads"},n.a.createElement(Pl,{targetId:i,customUrl:"helpers/work?type=O&employee=".concat(i)})),n.a.createElement(un,{tab:"Project",key:"project"},n.a.createElement(Il,{targetId:i,customUrl:"helpers/work?type=P&employee=".concat(i)})),n.a.createElement(un,{tab:"Comments",key:"comments"},n.a.createElement(jl,{targetType:"EMP",targetId:i})),n.a.createElement(un,{tab:"Attachments",key:"attachments"},n.a.createElement(Al,{targetType:"EMP",targetId:i})),n.a.createElement(un,{tab:"Bank Account",key:"account"},n.a.createElement(Tl,{targetType:"EMP",targetId:i,title:a.name,bank:r})),n.a.createElement(un,{tab:"Leave Balance",key:"leaveBalance"},n.a.createElement(on,{empId:i,editable:!0})),n.a.createElement(un,{tab:"Cost Calculator",key:"cost-calculator"},n.a.createElement(cn,{empId:i}))),l&&n.a.createElement(Ul,{visible:l,editEmp:i,close:this.closeModal,callBack:this.callBack}),o&&n.a.createElement(wl,this.props))}}]),a}(l.Component),fn="".concat(A,"/employment-contracts"),pn=function(e){return Ve.a.get(fn+"?employeeId=".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},bn=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getData()},e.onFinish=function(t){e.setState({loading:!0});var a=e.props,l=a.editCntrct,n=a.editEmp,i=e.state.fileIds,r=t.billing;r=Object(Fe.a)(Object(Fe.a)({},r),{},{noOfHoursPer:1,remunerationAmountPer:1===r.type?1:7,startDate:W(r.startDate,!0),endDate:W(r.endDate,!0),employeeId:n,fileId:i,leaveRequestPolicyId:r.leaveRequestPolicyId||null}),l?e.editRecord(r):e.addContract(r)},e.addContract=function(t){var a=e.props.callBack;(function(e){return z.b.loading({content:"Loading...",key:1}),Ve.a.post(fn,e,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))})(t).then((function(t){e.setState({loading:!1}),t.success&&a()}))},e.getData=function(){var t,a=e.props.editCntrct;Promise.all([It(),a&&(t=a,Ve.a.get(fn+"/".concat(t),{headers:J()}).then((function(e){var t,a,l=e.data,n=l.success,i=l.data,r=l.message;return $(r),n&&(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),i.leaveRequestPolicyId=null!==(a=i.leaveRequestPolicyId)&&void 0!==a?a:0,i.file=i.fileId?[{id:i.file.id,createdAt:i.file.createdAt,fileId:i.file.id,uid:i.file.uniqueName,name:i.file.originalName,type:i.file.type,url:"".concat(A,"/files/").concat(i.file.uniqueName),thumbUrl:X(i.file.type)}]:[]),{success:n,data:i}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}})))]).then((function(t){var a=e.state.BillingFields;a[17].data=t[0].success?t[0].data:[];var l=t[1],n=l.success,i=l.data;n&&(a[11].Placeholder=1===i.type?"Hourly Base Salary":"Annual Base Salary",i.startDate=W(i.startDate),i.endDate=W(i.endDate),e.formRef.current.setFieldsValue({billing:i})),e.setState({fileIds:n?i.fileId:null,fileList:n?i.file:[],BillingFields:a})}))},e.editRecord=function(t){var a=e.props,l=a.editCntrct,n=a.callBack;(function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.put(fn+"/".concat(e),t,{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.message;($(i),z.b.success({content:i,key:e}),n)&&K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization);return{success:n}})).catch((function(t){return z.b.error({content:t.message,key:e}),{error:"Please login again!",status:!1,message:t.message}}))})(l,t).then((function(t){e.setState({loading:!1}),t.success&&n()}))},e.handleUpload=function(){var t=Object(La.a)(Ma.a.mark((function t(a){var l,n,i,r,o;return Ma.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=a.onSuccess,n=a.onError,i=a.file,r=a.onProgress,o=new FormData,{headers:{"content-type":"multipart/form-data"},onUploadProgress:function(t){var a=Math.floor(t.loaded/t.total*100);e.setState({progress:a}),100===a&&setTimeout((function(){return e.setState({progres:0})}),1e3),r({percent:t.loaded/t.total*100})}},o.append("files",i),vl(o).then((function(t,a){if(t.success)l("Ok"),e.setState({fileList:[t.file],fileIds:t.file.fileId});else{console.log("Eroor: ",a);new Error("Some error");n({err:a})}}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onRemove=function(t){e.setState({fileIds:null,fileList:[]})},e.formRef=n.a.createRef(),e.state={editCntrct:!1,loading:!1,imgLoading:!1,fileList:[],fileIds:null,data:{},BillingFields:[{Placeholder:"Employment Status",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Payslip Email",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"type",size:"small",data:[{label:"Casual",value:1},{label:"Part Time",value:2},{label:"Full Time",value:3}],type:"Select",rules:[{required:!0,message:"Status is Required"}],onChange:function(t){var a=e.state.BillingFields;1===t?(a[11].Placeholder="Hourly Base Salary",e.setState({BillingFields:a})):(a[11].Placeholder="Annual Base Salary",e.setState({BillingFields:a}))},itemStyle:{marginBottom:1}},{object:"billing",fieldCol:12,key:"payslipEmail",size:"small",type:"input",itemStyle:{marginBottom:1}},{Placeholder:"Work Hours In A Week",rangeMin:!0,fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Work Days In A Week",rangeMin:!0,fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Contract Start Date",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:6,key:"noOfHours",size:"small",type:"InputNumber",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Work Hours is Required"}],itemStyle:{marginBottom:1}},{object:"billing",fieldCol:6,key:"noOfDays",size:"small",type:"InputNumber",rangeMin:1,rangeMax:5,fieldStyle:{width:"100%"},rules:[{required:!0,message:"Work Days are Required"}],itemStyle:{marginBottom:10}},{object:"billing",fieldCol:12,key:"startDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Start Date is Required"}],itemStyle:{marginBottom:1},rangeMin:function(t){var a=e.formRef.current.getFieldValue().billing;return a.endDate&&t>a.endDate}},{Placeholder:"Contract End Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Annual Base Salary",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"endDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:1},rangeMax:function(t){var a=e.formRef.current.getFieldValue().billing;return a.startDate&&t<a.startDate}},{object:"billing",fieldCol:12,key:"remunerationAmount",size:"small",type:"InputNumber",shape:"$",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Salary is Required"}],itemStyle:{marginBottom:1}},{Placeholder:"Pay Frequence",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Leave Policy",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"payFrequency",size:"small",data:[{label:"Hourly",value:1},{label:"Daily",value:2},{label:"Weekly",value:3},{label:"Fortnightly",value:4},{label:"Monthly",value:5}],type:"Select",rules:[{required:!0,message:"Payment Frequncy is required"}],itemStyle:{marginBottom:1}},{object:"billing",fieldCol:12,key:"leaveRequestPolicyId",size:"small",data:[],type:"Select",rules:[{required:!0,message:"Policy is required"}],itemStyle:{marginBottom:10}},{Placeholder:"Comments",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:24,key:"comments",size:"small",type:"Textarea",itemStyle:{marginBottom:1}}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.editCntrct,a=e.visible,l=e.close,i=this.state,r=i.BillingFields,o=i.loading,s=i.fileList;return n.a.createElement(wt.a,{title:t?"Edit Billing":"Add Billing",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:o,htmlType:"submit",form:"my-form"},okText:o?n.a.createElement(Mt.a,null):"Save",onCancel:l,width:900},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,scrollToFirstError:!0,size:"small",layout:"inline",initialValues:{billing:{entryDate:W(new Date)}}},n.a.createElement(ft,{FormFields:r})),n.a.createElement("p",{style:{marginTop:10,marginBottom:2}},"Signed Contract"),n.a.createElement(We.a,{customRequest:this.handleUpload,listType:"picture-card",maxCount:1,fileList:s,onRemove:this.onRemove},s.length<1&&n.a.createElement("div",{style:{marginTop:10}},n.a.createElement(Ll.a,null),n.a.createElement("div",{style:{marginTop:8}},"Upload"))))}}]),a}(l.Component),gn=(ve.a.Title,ul.b.Item),yn=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.match.params.id;e.fetchAll(t)},e.fetchAll=function(t){var a=JSON.parse(G().permissions).USERS;Promise.all([pn(t),Yl(t)]).then((function(t){e.setState({data:t[0].data,filterData:t[0].data,intro:t[1].basic,billModal:!1,editCntrct:!1,permissions:a})})).catch((function(e){console.log(e)}))},e.getList=function(t){pn(t).then((function(t){t.success&&e.setState({data:t.data,filterData:t.data,billModal:!1,editCntrct:!1})}))},e.callBack=function(){var t=e.props.match.params.id;e.getList(t)},e.handleDelete=function(t,a){var l=e.state,n=l.data,i=l.filterData,r=e.props.history;sl(r,"/employment-contracts",t,a,i,n).then((function(t){t.success&&e.setState({data:Object(we.a)(t.data),filterData:Object(we.a)(t.filterData)})}))},e.generalFilter=function(t){var a=e.state.data;t?e.setState({filterData:a.filter((function(e){var a,l,n;return"00".concat(e.id).includes(t)||e.startDate&&"".concat(W(e.startDate,!0,!0)).toLowerCase().includes(t.toLowerCase())||e.endDate&&"".concat(W(e.endDate,!0,!0)).toLowerCase().includes(t.toLowerCase())||"".concat(null!==(a=_(e.remunerationAmount))&&void 0!==a?a:"").toLowerCase().includes(t.toLowerCase())||"".concat(null!==(l=q[e.remunerationAmountPer])&&void 0!==l?l:"").toLowerCase().includes(t.toLowerCase())||"".concat(null!==(n=B[e.remunerationAmountPer])&&void 0!==n?n:"").toLowerCase().includes(t.toLowerCase())}))}):e.setState({filterData:a})},e.columns=[Object(Fe.a)({title:"Code",dataIndex:"id",key:"id",wdith:115,render:function(e){return"00".concat(e)}},Jt("id","number",!0)),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return e&&W(e,!0,!0)}},Jt("startDate","date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e){return e&&W(e,!0,!0)}},Jt("endDate","date")),{title:"Employment Type",dataIndex:"type",key:"type",render:function(e){return B[e]}},Object(Fe.a)({title:"Base Remuneration",dataIndex:"remunerationAmount",key:"remunerationAmount",render:function(e){return"".concat(_(e))}},Jt("remunerationAmount","number")),{title:"...",key:"action",align:"center",width:"1%",render:function(t,a,l){var i,r,o,s,c,d;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(e))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(a.id,l)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",disabled:!(null===(s=Object(Aa.a)(e))||void 0===s||null===(c=s.state)||void 0===c||null===(d=c.permissions)||void 0===d?void 0:d.UPDATE),onClick:function(){e.setState({billModal:!0,editCntrct:a.id})}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],e.state={intro:{},data:[],billModal:!1,editCntrct:!1,openSearch:!1,filterData:[],permissions:{}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.billModal,l=t.editCntrct,i=(t.data,t.intro),r=t.filterData,o=this.props.match.params.id;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:"Contract History",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(gn,null,"Code: ",n.a.createElement("b",null,i.cpCode)),n.a.createElement(gn,null,"First Name: ",n.a.createElement("b",null,i.firstName)),n.a.createElement(gn,null,"Last Name: ",n.a.createElement("b",null,i.lastName)),n.a.createElement(gn,{style:{textAlign:"right"}},n.a.createElement(Be.a,{size:"small",type:"primary",onClick:function(){return e.setState({billModal:!0})}},n.a.createElement(Nt.a,null)," Contract"))),n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:this.columns,dataSource:r,size:"small",className:"fs-small"}),a&&n.a.createElement(bn,{visible:a,editCntrct:l,close:function(){return e.setState({billModal:!1,editCntrct:!1})},callBack:this.callBack,editEmp:o}))}}]),a}(l.Component),hn="".concat(A,"/employees/"),vn=function(e){return Ve.a.get(hn+"".concat(e,"/leases"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},En=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props,a=t.editLease,l=t.empId;a&&e.getRecord(l,a)},e.onFinish=function(t){var a=e.props,l=a.editLease,n=a.empId,i=t.obj;i=Object(Fe.a)(Object(Fe.a)({},i),{},{employeeId:n,startDate:W(i.startDate,!0),endDate:W(i.endDate,!0)}),l?e.editRecord(i):e.addContract(i)},e.addContract=function(t){e.setState({loading:!0});var a=e.props,l=a.callBack;(function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.post(hn+"".concat(e,"/leases"),t,{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:e}),n&&K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n}})).catch((function(t){return z.b.error({content:t.message,key:e}),{error:"Please login again!",status:!1,message:t.message}}))})(a.empId,t).then((function(e){console.log(e),e.success&&l()}))},e.getRecord=function(t,a){(function(e,t){return Ve.a.get(hn+"".concat(e,"/leases/").concat(t),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;($(i),l)&&(n.startDate=W(n.startDate),n.endDate=W(n.endDate),n.totalDeduction=(n.preTaxDeductionAmount?n.preTaxDeductionAmount:0)+(n.postTaxDeductionAmount?n.postTaxDeductionAmount:0),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization));return{success:l,data:n}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(t,a).then((function(t){var a=t.success,l=t.data;a&&e.leaseRef.current.setFieldsValue({obj:l})}))},e.editRecord=function(t){e.setState({loading:!0});var a=e.props,l=a.editLease,n=a.callBack;(function(e,t,a){return z.b.loading({content:"Loading...",key:t}),Ve.a.put(hn+"".concat(e,"/leases/").concat(t),a,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:t}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),{success:n}})).catch((function(e){return z.b.error({content:e.message,key:t}),{error:"Please login again!",status:!1,message:e.message}}))})(a.empId,l,t).then((function(e){e.success&&n()}))},e.leaseRef=n.a.createRef(),e.state={leaseSubmitted:!1,loading:!1,LeaseFields:[{Placeholder:"Leasing Company Name",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Lease Start Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"companyName",size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:10}},{object:"obj",fieldCol:12,key:"startDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10},rangeMin:function(t){var a=e.leaseRef.current.getFieldValue(["obj","endDate"]);return Z(t,a,"start")}},{Placeholder:"Lease End Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Vehicle Registration Number",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"endDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10},rangeMax:function(t){var a=e.leaseRef.current.getFieldValue(["obj","startDate"]);return Z(t,a,"end")}},{object:"obj",fieldCol:12,key:"vehicleRegistrationNo",size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:10}},{Placeholder:"Vehicle Make And Model",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Financer Name",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"vehicleMakeModel",size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:10}},{object:"obj",fieldCol:12,key:"financerName",size:"small",type:"Input",labelAlign:"left",itemStyle:{marginBottom:10}},{Placeholder:"Amount Financed",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Installment Frequency",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"financedAmount",size:"small",type:"InputNumber",labelAlign:"left",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10}},{object:"obj",fieldCol:12,key:"installmentFrequency",size:"small",data:[{label:"Weekly",value:3},{label:"Fortnightly",value:4},{label:"Monthly",value:5},{label:"Quarterly",value:6}],type:"Select",itemStyle:{marginBottom:1}},{Placeholder:"Pre Tax Deduction",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Post Tax Deduction",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"preTaxDeductionAmount",size:"small",type:"InputNumber",labelAlign:"left",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10},onChange:function(){var t=e.leaseRef.current.getFieldsValue().obj;t.totalDeduction=(t.preTaxDeductionAmount?t.preTaxDeductionAmount:0)+(t.postTaxDeductionAmount?t.postTaxDeductionAmount:0),e.leaseRef.current.setFieldsValue({obj:t})}},{object:"obj",fieldCol:12,key:"postTaxDeductionAmount",size:"small",type:"InputNumber",labelAlign:"left",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10},onChange:function(){var t=e.leaseRef.current.getFieldsValue().obj;t.totalDeduction=(t.preTaxDeductionAmount?t.preTaxDeductionAmount:0)+(t.postTaxDeductionAmount?t.postTaxDeductionAmount:0),e.leaseRef.current.setFieldsValue({obj:t})}},{Placeholder:"Total Deduction",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"totalDeduction",size:"small",type:"InputNumber",labelAlign:"left",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10}}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.editLease,a=e.visible,l=e.close,i=this.state,r=i.LeaseFields,o=i.loading;return n.a.createElement(wt.a,{title:t?"Edit Novated Lease":"Add Novated Lease",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:o,htmlType:"submit",form:"my-form"},okText:o?n.a.createElement(Mt.a,null):"Save",onCancel:l,width:900},n.a.createElement(Me.a,{id:"my-form",ref:this.leaseRef,onFinish:this.onFinish,scrollToFirstError:!0,size:"small",layout:"inline"},n.a.createElement(ft,{FormFields:r})))}}]),a}(l.Component),kn=ve.a.Title,Sn=ul.b.Item,Cn=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.match.params.id;e.fetchAll(t)},e.fetchAll=function(t){Promise.all([vn(t),Yl(t)]).then((function(a){e.setState({data:a[0].data,filterData:a[0].data,employee:a[1].basic?a[1].basic:{},infoModal:!1,empId:t,editLease:!1})})).catch((function(e){console.log(e)}))},e.getList=function(){var t=e.state.empId;vn(t).then((function(t){e.setState({data:t.data,filterData:t.data,infoModal:!1,editLease:!1})}))},e.handleDelete=function(t,a){console.log({id:t,index:a});var l=e.state.empId,n="/employees/".concat(l,"/leases"),i=e.state,r=i.data,o=i.filterData,s=e.props.history;sl(s,n,t,a,o,r).then((function(t){console.log(t),t.success&&e.setState({data:Object(we.a)(t.data),filterData:Object(we.a)(t.filterData)})}))},e.closeModal=function(){e.setState({infoModal:!1,editLease:!1})},e.callBack=function(t){e.getList()},e.generalFilter=function(t){var a=e.state.data;t?e.setState({filterData:a.filter((function(e){var a,l,n;return"".concat(null!==(a=e.companyName)&&void 0!==a?a:"").toLowerCase().includes(t.toLowerCase())||"".concat(null!==(l=e.financerName)&&void 0!==l?l:"").toLowerCase().includes(t.toLowerCase())||e.startDate&&"".concat(W(e.startDate,!0,!0)).toLowerCase().includes(t.toLowerCase())||e.endDate&&"".concat(W(e.endDate,!0,!0)).toLowerCase().includes(t.toLowerCase())||"".concat(null!==(n=e.financedAmount)&&void 0!==n?n:"").toLowerCase().includes(t.toLowerCase())}))}):e.setState({filterData:a})},e.columns=[Object(Fe.a)({title:"Company Name",dataIndex:"companyName",key:"companyName"},Jt("companyName","string")),Object(Fe.a)({title:"Financer Name",dataIndex:"financerName",key:"financerName"},Jt("financerName","string")),Object(Fe.a)({title:"Finance Amount",dataIndex:"financedAmount",key:"financedAmount",render:function(e){return"".concat(_(e))}},Jt("financedAmount","number")),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return e&&W(e,!0,!0)}},Jt("startDate","date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e){return e&&W(e,!0,!0)}},Jt("endDate","date")),{title:"...",key:"id",dataIndex:"id",align:"center",width:"1%",render:function(t,a,l){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(t,l)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){e.setState({infoModal:!0,editLease:t})}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],e.state={infoModal:!1,empId:!1,data:[],employee:{},editLease:!1,openSearch:!1,filterData:[]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.infoModal),l=t.empId,i=t.employee,r=t.editLease,o=t.filterData,s=this.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:"Employee Information",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Sn,{label:"First Name"},i.firstName),n.a.createElement(Sn,{label:"Last Name"},i.lastName),n.a.createElement(Sn,{label:"Phone"},i.phoneNumber," "),n.a.createElement(Sn,{label:"Email"},i.email),n.a.createElement(Sn,{label:"Address"},i.address),n.a.createElement(Sn,{label:"Date Of Birth"},W(i.dateOfBirth,!0,!0)),n.a.createElement(Sn,{label:"Gender"},i.gender)),n.a.createElement(p.a,{justify:"space-between",style:{paddingTop:30}},n.a.createElement(b.a,null,n.a.createElement(kn,{level:4},"Novated Lease")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",onClick:function(){e.setState({infoModal:!0,editLease:!1})},size:"small"},n.a.createElement(Nt.a,null),"Novated Lease")),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:s,dataSource:o,size:"small",className:"fs-small"}))),a&&n.a.createElement(En,{visible:a,empId:l,editLease:r,close:this.closeModal,callBack:this.callBack}))}}]),a}(l.Component),jn="".concat(A,"/sub-contractors"),Dn=function(e){return Ve.a.get(jn+"/".concat(e),{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;if($(n),a){var i,r=function(e){var t=e.contactPersonOrganization?e.contactPersonOrganization.contactPerson:{},a=e.contactPersonOrganization?e.contactPersonOrganization.organization:{},l={cpCode:"Sub-00".concat(t.id),firstName:t.firstName,lastName:t.lastName,gender:t.gender,dateOfBirth:W(t.dateOfBirth),phoneNumber:t.phoneNumber,email:t.email,address:t.address,stateId:t.stateId,username:e.username,roleId:e.roleId,lineManagerId:e.lineManagerId,organization:{name:a.name,id:a.id},birthPlace:t.birthPlace,active:e.active},n={nextOfKinDateOfBirth:W(e.nextOfKinDateOfBirth),nextOfKinEmail:e.nextOfKinEmail,nextOfKinGender:e.nextOfKinGender,nextOfKinName:e.nextOfKinName,nextOfKinPhoneNumber:e.nextOfKinPhoneNumber,nextOfKinRelation:e.nextOfKinRelation},i=e.employmentContracts.length>0?e.employmentContracts[0]:{},r={employeeId:i.employeeId,payslipEmail:i.payslipEmail,startDate:W(i.startDate),endDate:W(i.endDate),noOfHours:i.noOfHours,noOfDays:i.noOfDays,noOfHoursPer:i.noOfHoursPer,remunerationAmount:i.remunerationAmount,remunerationAmountPer:i.remunerationAmountPer,comments:i.comments,fileId:i.fileId,file:i.fileId?[{id:i.file.id,createdAt:i.file.createdAt,fileId:i.file.id,uid:i.file.uniqueName,name:i.file.originalName,type:i.file.type,url:"".concat(A,"/files/").concat(i.file.uniqueName),thumbUrl:X(i.file.type)}]:[]};return{basic:l,kin:n,billing:r}}(l),o=r.basic,s=r.kin,c=r.billing;return K(null===e||void 0===e||null===(i=e.headers)||void 0===i?void 0:i.authorization),{success:a,data:l,basic:o,billing:c,kin:s}}return{success:!1}})).catch((function(e){var t;if(null===(t=e.response)||void 0===t?void 0:t.data){var a,l=e.response.status,n=null===(a=e.response)||void 0===a?void 0:a.data,i=n.message;return{authError:"Not Authorized!"===i,status:l,success:n.success,message:i}}return{error:"Please login again!",status:!1,message:e.message}}))};var On=el.a.TabPane,In=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.state.editCont;t&&e.getRecord(t),vt().then((function(t){t.success&&e.setState({ORGS:t.data.filter((function(e){return 1!==e.value}))})}))},e.componentDidMount=function(){var t=e.props.editCont;e.fetchAll(t)},e.fetchAll=function(t){Promise.all([pt(),Dt(),t?e.getRecord(t):vt(),ht("helpers/contact-persons?organizationId=1")]).then((function(a){var l=e.state,n=l.BasicFields,i=l.ManagerFields,r=l.BillingFields;n[15].data=a[0].data,n[3].data=a[1].data,i[1].data=a[3].data,r[5].Placeholder=t&&"Total Fee ".concat(q[a[2].paymentBase]),e.setState({BasicFields:n,ManagerFields:i,BillingFields:r,sUsername:t?a[2].username:null,ORGS:t?[]:a[2].data.filter((function(e){return 1!==e.value}))})})).catch((function(e){console.log(e)}))},e.onFinish=function(t){var a=e.props.editCont;e.setState({loading:!0});var l=e.state.fileIds,n=t.basic,i=t.billing,r=t.kin,o=Object(Fe.a)(Object(Fe.a)(Object(Fe.a)({},n),{},{dateOfBirth:W(n.dateOfBirth,!0)},r),{},{latestContract:Object(Fe.a)(Object(Fe.a)({},i),{},{fileId:l,startDate:W(i.startDate,!0),endDate:W(i.endDate,!0)})});a?e.editRecord(o):e.addContactor(o)},e.addContactor=function(t){var a=e.props.callBack,l=e.state;l.sContact,l.sOrg;console.log(t),function(e){return z.b.loading({content:"Loading...",key:1}),Ve.a.post(jn,e,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1}),l?(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:e.data}):{success:!1}})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))}(t).then((function(t){e.setState({loading:!1}),t.success&&a()}))},e.getRecord=function(t){return Dn(t).then((function(t){if(t.success){var a=t.basic,l=t.kin,n=t.billing;return e.formRef.current.setFieldsValue({basic:a,kin:l,billing:n}),e.setState({fileIds:n.fileId,fileList:n.file}),{username:a.username,paymentBase:n.remunerationAmountPer}}}))},e.editRecord=function(t){var a,l,n=e.props,i=n.editCont,r=n.callBack;(a=i,l=t,z.b.loading({content:"Loading...",key:a}),Ve.a.put(jn+"/".concat(a),l,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:a}),n&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:n}})).catch((function(e){return z.b.error({content:e.message,key:a}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){e.setState({loading:!1}),t.success&&r()}))},e.onCancel=function(){e.props.close()},e.onOrg=function(t){var a="helpers/contact-persons?organizationId=".concat(t,"&active=0&associated=1");ht(a).then((function(a){a.success&&e.setState({sOrg:t,CONTACTS:a.data})}))},e.onPerson=function(t){ql(t).then((function(a){a.success&&(a.data.cpCode="Con-00".concat(a.data.id),a.data.dateOfBirth=W(a.data.dateOfBirth),e.formRef.current.setFieldsValue({basic:a.data}),e.setState({sContact:t}))}))},e.onClear=function(t,a){e.setState({sContact:a,sOrg:t},(function(){e.formRef.current.resetFields()}))},e.handleUpload=function(){var t=Object(La.a)(Ma.a.mark((function t(a){var l,n,i,r,o;return Ma.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=a.onSuccess,n=a.onError,i=a.file,r=a.onProgress,o=new FormData,{headers:{"content-type":"multipart/form-data"},onUploadProgress:function(t){var a=Math.floor(t.loaded/t.total*100);e.setState({progress:a}),100===a&&setTimeout((function(){return e.setState({progres:0})}),1e3),r({percent:t.loaded/t.total*100})}},o.append("files",i),vl(o).then((function(t,a){if(t.success)l("Ok"),e.setState({fileList:[t.file],fileIds:t.file.fileId});else{console.log("Eroor: ",a);new Error("Some error");n({err:a})}}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onRemove=function(t){e.setState({fileIds:null,fileList:[]})},e.onFinishFailed=function(t){t.values;var a=t.errorFields;t.outOfDate;e.setState({activeKey:a[0].name[0]})},e.formRef=n.a.createRef(),e.state={editCont:!1,CONTACTS:[],sContact:null,ORGS:[],sOrg:null,sUsername:null,loading:!1,activeKey:"basic",fileIds:null,fileList:[],data:{},BasicFields:[{fieldCol:12,size:"small",Placeholder:"Contact person Code",rangeMin:!0,type:"Text",labelAlign:"left"},{Placeholder:"Role",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"cpCode",size:"small",rules:[{required:!0,message:"Code is Required"}],type:"Input",readOnly:!0,labelAlign:"left",itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"roleId",size:"small",rules:[{required:!0,message:"Role is required!!"}],type:"Select",data:[],itemStyle:{marginBottom:10}},{fieldCol:12,size:"small",Placeholder:"First Name",disabled:!1,type:"Text",labelAlign:"left"},{fieldCol:12,size:"small",Placeholder:"Last Name",disabled:!1,type:"Text",labelAlign:"left"},{object:"basic",fieldCol:12,key:"firstName",size:"small",type:"Input",labelAlign:"left",disabled:!1,itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"lastName",size:"small",type:"Input",labelAlign:"left",disabled:!1,itemStyle:{marginBottom:5}},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{fieldCol:12,size:"small",Placeholder:"Email",disabled:!1,type:"Text",labelAlign:"left"},{object:"basic",fieldCol:12,key:"phoneNumber",size:"small",type:"input",itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"email",size:"small",type:"Input",disabled:!1,itemStyle:{marginBottom:10}},{Placeholder:"Gender",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"State For Payroll Tax Purpose",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"gender",size:"small",data:[{label:"Male",value:"M"},{label:"Female",value:"F"},{label:"Others",value:"O"}],itemStyle:{marginBottom:10},type:"Select"},{object:"basic",fieldCol:12,key:"stateId",size:"small",type:"Select",data:[],itemStyle:{marginBottom:10}},{Placeholder:"Date Of Birth",fieldCol:12,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:1}},{Placeholder:"Birth Place",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"dateOfBirth",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"birthPlace",size:"small",type:"Input",itemStyle:{marginBottom:20}},{Placeholder:"Address",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:24,key:"address",size:"small",type:"Input",itemStyle:{marginBottom:"10px"}}],KinFields:[{Placeholder:"Name",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"kin",fieldCol:12,key:"nextOfKinName",size:"small",type:"input",itemStyle:{marginBottom:1}},{object:"kin",fieldCol:12,key:"nextOfKinPhoneNumber",size:"small",type:"input",itemStyle:{marginBottom:1}},{Placeholder:"Email",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Relationship to Contractor",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"kin",fieldCol:12,key:"nextOfKinEmail",size:"small",type:"input",itemStyle:{marginBottom:10}},{object:"kin",fieldCol:12,key:"nextOfKinRelation",size:"small",data:[{label:"Spouse",value:"Spouse"},{label:"Partner",value:"Partner"},{label:"Sibling",value:"Sibling"},{label:"Parent",value:"Parent"},{label:"Child",value:"Child"},{label:"Friend",value:"Friend"}],type:"Select"}],BillingFields:[{Placeholder:"Contract Start Date",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Contract End Date",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"startDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Start Date is Required"}],itemStyle:{marginBottom:1},rangeMin:function(t){var a=e.formRef.current.getFieldValue().billing;return a.endDate&&t>a.endDate}},{object:"billing",fieldCol:12,key:"endDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},rules:[{required:!0,message:"End Date is Required"}],itemStyle:{marginBottom:1},rangeMax:function(t){var a=e.formRef.current.getFieldValue().billing;return a.startDate&&t<a.startDate}},{Placeholder:"Contract Payment Basis",fieldCol:12,rangeMin:!0,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Total Fee",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"remunerationAmountPer",size:"small",data:[{label:"Hourly",value:1},{label:"Daily",value:2},{label:"Weekly",value:3},{label:"Fortnightly",value:4},{label:"Monthly",value:5}],type:"Select",rules:[{required:!0,message:"Payment Frequncy is Required"}],onChange:function(t,a){var l=e.state.BillingFields;l[5].Placeholder="Total Fee ".concat(t?a.label:""),e.setState({BillingFields:l})},itemStyle:{marginBottom:1}},{object:"billing",fieldCol:12,key:"remunerationAmount",size:"small",type:"InputNumber",shape:"$",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Total Fee is Required"}],itemStyle:{marginBottom:1}},{Placeholder:"Work Hours In A Week",rangeMin:!0,fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Work Days In A Week",rangeMin:!0,fieldCol:18,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:6,key:"noOfHours",size:"small",type:"InputNumber",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Work Hour is Reqired"}],itemStyle:{marginBottom:1}},{object:"billing",fieldCol:6,key:"noOfDays",size:"small",type:"InputNumber",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Work Days are Required"}],itemStyle:{marginBottom:10}},{Placeholder:"Comments",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:24,key:"comments",size:"small",type:"Textarea",itemStyle:{marginBottom:1}}],ManagerFields:[{Placeholder:"Contractor Manager",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"lineManagerId",size:"small",data:[],type:"Select",itemStyle:{marginBottom:10}}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.editCont,l=t.visible,i=this.state,r=i.BasicFields,o=i.BillingFields,s=i.KinFields,c=i.ManagerFields,d=i.sContact,u=i.CONTACTS,m=i.ORGS,f=i.sOrg,p=i.fileIds,g=i.loading,y=i.fileList,h=i.activeKey;return n.a.createElement(wt.a,{title:a?"Edit Subcontractor":"Add Subcontractor",maskClosable:!1,centered:!0,visible:l,okButtonProps:{disabled:g,htmlType:"submit",form:"my-form"},okText:g?n.a.createElement(Mt.a,null):"Save",onCancel:this.onCancel,width:900},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,onFinishFailed:this.onFinishFailed,scrollToFirstError:!0,size:"small",layout:"inline",initialValues:{billing:{startDate:null}}},!a&&n.a.createElement(b.a,{span:7,style:{marginBottom:"1em"}},n.a.createElement(Me.a.Item,{name:["basic","organizationId"]},n.a.createElement(Qe.a,{value:f,placeholder:"Organization",options:m,showArrow:!0,size:"small",allowClear:!0,onChange:this.onOrg,onClear:function(){return e.onClear(null,null)},showSearch:!0,optionFilterProp:"label",filterOption:function(e,t){return t.label.toLowerCase().indexOf(e.toLowerCase())>=0},style:{width:"100%"}}))),!a&&n.a.createElement(b.a,{span:7,style:{marginLeft:"auto"}},n.a.createElement(Me.a.Item,{name:["basic","contactPersonId"]},n.a.createElement(Qe.a,{value:d,placeholder:"Contact Person",options:u,showArrow:!0,disabled:!f,size:"small",allowClear:!0,onChange:this.onPerson,onClear:function(){return e.onClear(f,null)},showSearch:!0,optionFilterProp:"label",filterOption:function(e,t){return t.label.toLowerCase().indexOf(e.toLowerCase())>=0},style:{width:"100%"}}))),n.a.createElement(b.a,{span:a?8:7,style:{marginLeft:"auto",marginBottom:10}},n.a.createElement(Me.a.Item,{name:["basic","username"],rules:[{required:!0,type:"email",message:"Email is Required"}]},n.a.createElement(Je.a,{placeholder:"Email",size:"small",style:{width:"100%"}}))),n.a.createElement(el.a,{type:"card",activeKey:h,onChange:function(t){e.setState({activeKey:t})}},n.a.createElement(On,{tab:"Contractor Details",key:"basic",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:r})),n.a.createElement(On,{tab:"Subcontractor Contracts",key:"billing",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:o}),n.a.createElement("p",{style:{marginTop:10,marginBottom:2}},"Signed Contract"),n.a.createElement(We.a,{customRequest:this.handleUpload,listType:"picture-card",maxCount:1,fileList:y,onRemove:this.onRemove},!p&&n.a.createElement("div",{style:{marginTop:10}},n.a.createElement(Ll.a,null),n.a.createElement("div",{style:{marginTop:8}},"Upload")))),n.a.createElement(On,{tab:"Next of Kin",key:"kin",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:s})),n.a.createElement(On,{tab:"Contractor Manager",key:"manage",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:c})))))}}]),a}(l.Component),Pn=ve.a.Title,xn=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getList()},e.getList=function(){var t=JSON.parse(G().permissions).USERS;Ve.a.get(jn,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;if($(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(a){a.success&&e.setState({data:a.data,filterData:a.data,infoModal:!1,editCont:!1,permissions:t})}))},e.callBack=function(){e.getList()},e.handleDelete=function(t,a){var l=e.state,n=l.data,i=l.filterData,r=e.props.history;sl(r,"/sub-contractors",t,a,i,n).then((function(t){t.success&&e.setState({data:Object(we.a)(t.data),filterData:Object(we.a)(t.filterData)})}))},e.closeModal=function(){e.setState({infoModal:!1,editCont:!1})},e.generalFilter=function(t){var a=e.state.data;t?e.setState({filterData:a.filter((function(e){var a=e.contactPersonOrganization.contactPerson,l=a.firstName,n=a.lastName,i=a.email,r=a.phoneNumber,o=a.id,s=e.contactPersonOrganization.organization.name;return"Sub-00".concat(o.toString()).includes(t)||l&&l.toLowerCase().includes(t.toLowerCase())||n&&n.toLowerCase().includes(t.toLowerCase())||s&&s.toLowerCase().includes(t.toLowerCase())||i&&i.toLowerCase().includes(t.toLowerCase())||r&&r.startsWith(t)}))}):e.setState({filterData:a})},e.advancefilter=function(t,a,l){var n=e.state,i=n.data,r=n.searchedColumn;a?r[a].value=t:r=l,r.id.value||r.firstName.value||r.lastName.value||r.email.value||r.phoneNumber.value||r.gender.value.length>0||r.stateId.value.length>0||r.address.value||r.role.value.length>0||r.clearanceLevel.value.length>0||r.organization.value.length>0?e.setState({filterData:i.filter((function(e){var t=e.contactPersonOrganization.contactPerson,a=t.firstName,l=t.lastName,n=t.email,i=t.phoneNumber,o=t.id,s=t.gender,c=t.stateId,d=t.clearanceLevel,u=t.address,m=e.contactPersonOrganization.organizationId;return"Sub-".concat(o.toString()).includes(r.id.value)&&"".concat(null!==a&&void 0!==a?a:"").toLowerCase().includes(r.firstName.value.toLowerCase())&&"".concat(null!==l&&void 0!==l?l:"").toLowerCase().includes(r.lastName.value.toLowerCase())&&"".concat(null!==n&&void 0!==n?n:"").toLowerCase().includes(r.email.value.toLowerCase())&&"".concat(null!==i&&void 0!==i?i:"").toLowerCase().includes(r.phoneNumber.value.toLowerCase())&&"".concat(null!==u&&void 0!==u?u:"").toLowerCase().includes(r.address.value.toLowerCase())&&(r.gender.value.length>0?r.gender.value:[{value:","}]).some((function(e){return(r.gender.value.length>0?[s]:[","]).includes(e.value)}))&&(r.stateId.value.length>0?r.stateId.value:[{value:","}]).some((function(e){return(r.stateId.value.length>0?[c]:[","]).includes(e.value)}))&&(r.role.value.length>0?r.role.value:[{value:","}]).some((function(t){return(r.role.value.length>0?[e.roleId]:[","]).includes(t.value)}))&&(r.organization.value.length>0?r.organization.value:[{value:","}]).some((function(e){return(r.organization.value.length>0?[m]:[","]).includes(e.value)}))&&(r.clearanceLevel.value.length>0?r.clearanceLevel.value:[{value:","}]).some((function(e){return(r.clearanceLevel.value.length>0?[d]:[","]).includes(e.value)}))})),searchedColumn:r,openSearch:!1}):e.setState({searchedColumn:r,filterData:i})},e.filterModalUseEffect=function(){Promise.all([pt(),Dt(),vt()]).then((function(t){var a=e.state.filterFields;a[11].data=t[0].success?t[0].data:[],a[14].data=t[1].success?t[1].data:[],a[15].data=t[2].success?t[2].data.filter((function(e){return 1!==e.value})):[],e.setState({filterFields:a})})).catch((function(e){console.log(e)}))},e.columns=[Object(Fe.a)({title:"Code",dataIndex:["contactPersonOrganization","contactPersonId"],key:"contactPersonId",width:115,render:function(e){return"Sub-00".concat(e)}},Jt("contactPersonOrganization.contactPersonId","number",!0)),Object(Fe.a)({title:"First Name",dataIndex:["contactPersonOrganization","contactPerson","firstName"],key:"firstName",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"/sub-contractors/".concat(t.id,"/info")},className:"nav-link"},e)}},Jt("contactPersonOrganization.contactPerson.firstName","string")),Object(Fe.a)({title:"Last Name",dataIndex:["contactPersonOrganization","contactPerson","lastName"],key:"lastName"},Jt("contactPersonOrganization.contactPerson.lastName","string")),Object(Fe.a)(Object(Fe.a)({title:"Organisation",dataIndex:["contactPersonOrganization","organization"],key:"organization"},Jt("contactPersonOrganization.organization.name","string")),{},{render:function(e,t){return e&&n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(e.id,"/info")},className:"nav-link"},e.name)}}),{title:"Phone",dataIndex:["contactPersonOrganization","contactPerson","phoneNumber"],key:"phoneNumber"},{title:"Email",dataIndex:["contactPersonOrganization","contactPerson","email"],key:"email"},{title:"...",key:"action",align:"center",width:"1%",render:function(t,a,l){var i,r,o;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(e))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(a.id,l)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){e.setState({infoModal:!0,editCont:a.id})},disabled:e.state&&!e.state.permissions.UPDATE},"Edit"),n.a.createElement(v.a.Item,{key:"View"},n.a.createElement(s.b,{to:{pathname:"/sub-contractors/".concat(a.id,"/info")},className:"nav-link"},"View")),n.a.createElement(v.a.Item,{key:"Contracts"},n.a.createElement(s.b,{to:{pathname:"/sub-contractors/".concat(a.id,"/contracts")},className:"nav-link"},"Contracts")))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],e.state={infoModal:!1,editCont:!1,data:[],permissions:{},filterData:[],openSearch:!1,searchedColumn:{id:{type:"Input",value:"",label:"Code",showInColumn:!0},firstName:{type:"Input",value:"",label:"First Name",showInColumn:!0},lastName:{type:"Input",value:"",label:"Last Name",showInColumn:!0},organization:{type:"Select",multi:!0,value:[],label:"Organisation",showInColumn:!0},phoneNumber:{type:"Input",value:"",label:"Phone Number",showInColumn:!0},email:{type:"Input",value:"",label:"Email",showInColumn:!0},Action:{type:"Input",value:"",label:"",showInColumn:!0,disabled:!0},stateId:{type:"none",multi:!0,value:[],label:"State",showInColumn:!1,disabled:!1},clearanceLevel:{type:"none",multi:!0,value:[],label:"clearanceLevel",showInColumn:!1,disabled:!1},gender:{type:"Select",multi:!0,value:[],label:"Gender",showInColumn:!1},address:{type:"none",value:"",label:"Address",showInColumn:!1,disabled:!1},role:{type:"none",multi:!0,value:[],label:"Role",showInColumn:!1,disabled:!1}},filterFields:[{fieldCol:12,size:"small",Placeholder:"First Name",type:"Text",labelAlign:"left"},{Placeholder:"Last Name",fieldCol:12,size:"small",type:"Text",labelAlign:"left"},{object:"obj",fieldCol:12,key:"firstName",size:"small",type:"Input",labelAlign:"left"},{object:"obj",fieldCol:12,key:"lastName",size:"small",type:"Input",labelAlign:"left"},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{fieldCol:12,size:"small",Placeholder:"Email",type:"Text",labelAlign:"left"},{object:"obj",fieldCol:12,key:"phoneNumber",size:"small",type:"input"},{object:"obj",fieldCol:12,key:"email",size:"small",type:"Input"},{Placeholder:"Gender",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"State For Payroll Tax Purpose",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"gender",mode:"multiple",customValue:function(e,t){return t},size:"small",data:[{label:"Male",value:"M"},{label:"Female",value:"F"},{label:"Other",value:"O"}],type:"Select"},{object:"obj",fieldCol:12,mode:"multiple",customValue:function(e,t){return t},key:"stateId",size:"small",type:"Select",data:[]},{Placeholder:"Role",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Organization",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,mode:"multiple",customValue:function(e,t){return t},key:"role",size:"small",type:"Select",data:[]},{object:"obj",fieldCol:12,mode:"multiple",customValue:function(e,t){return t},key:"organization",size:"small",type:"Select",data:[]},{Placeholder:"Clearance Level",fieldCol:24,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"clearanceLevel",size:"small",mode:"multiple",customValue:function(e,t){return t},data:[{label:"BV - Baseline Vetting",value:"BV"},{label:"NV1 - Negative Vetting 1",value:"NV1"},{label:"NV2 - Negative Vetting 2",value:"NV2"},{label:"PV - Positive Vetting",value:"PV"},{label:"No clearance",value:"NC"}],type:"Select"},{Placeholder:"Address",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"address",size:"small",type:"Input"}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.infoModal),l=t.editCont,i=t.permissions,r=t.filterData,o=t.searchedColumn,s=t.filterFields,c=t.openSearch,d=this.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Pn,{level:4},"Sub Contractors")),n.a.createElement(b.a,null,n.a.createElement(p.a,{justify:"space-between",gutter:17},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"default",size:"small",onClick:function(){return e.setState({openSearch:!0})}},n.a.createElement(Ft.a,null),"Filter")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",onClick:function(){e.setState({infoModal:!0})},size:"small",disabled:!i.ADD},n.a.createElement(Nt.a,null),"Subcontactors")))),n.a.createElement(ea,{filters:o,filterFunction:this.advancefilter}),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:d,dataSource:r,size:"small",className:"fs-small"}))),c&&n.a.createElement(Zt,{title:"Filter Subcontractors",visible:c,filters:o,filterFields:s,filterFunction:this.advancefilter,effectFunction:this.filterModalUseEffect,effectRender:!0,onClose:function(){return e.setState({openSearch:!1})}}),a&&n.a.createElement(In,{visible:a,editCont:l,close:this.closeModal,callBack:this.callBack}))}}]),a}(l.Component);function Tn(e){var t=e.value,a=e.shape,l=e.onChange,i=e.min,r=e.max;return n.a.createElement(Xe.a,{size:"small",value:t,formatter:function(e){return ut(e,a)},parser:function(e){return mt(e,a)},onChange:l,min:i,max:r})}var zn=function(e){var t=Object(l.useState)({}),a=Object(he.a)(t,2),i=a[0],r=a[1],o=Object(l.useState)([]),s=Object(he.a)(o,2),c=s[0],d=s[1],u=Object(l.useState)(0),m=Object(he.a)(u,2),f=m[0],g=m[1],y=Object(l.useState)([20,25,30,40]),h=Object(he.a)(y,2),E=h[0],k=h[1],S=Object(l.useState)(0),C=Object(he.a)(S,2),j=C[0],D=C[1],O=Object(l.useState)(8),I=Object(he.a)(O,2),P=I[0],x=I[1];Object(l.useEffect)((function(){Tt("sub-contractors",e.conId).then((function(e){if(e.success){var t=e.data,a=t.contract,l=t.golobalVariables,n=t.employeeBuyRate;g(n),r(a),d(l)}}))}),[]);return n.a.createElement("div",null,i.hourlyBaseRate?n.a.createElement(p.a,{className:"buy-sell-calculator"},n.a.createElement(b.a,{span:12,className:"buy-cost calculator"},n.a.createElement(p.a,null,n.a.createElement(b.a,{span:24,className:"mb-10"},n.a.createElement(ve.a.Title,{level:5},"Buy Rate Calculator - Contractor")),n.a.createElement(b.a,{span:16,className:"label"},"Daily Hours"),n.a.createElement(b.a,{span:8,className:"item"},U(null===i||void 0===i?void 0:i.dailyHours)),n.a.createElement(b.a,{span:16,className:"label"},"Hourly Cost"),n.a.createElement(b.a,{span:8,className:"item"},_(null===i||void 0===i?void 0:i.hourlyBaseRate)),n.a.createElement(b.a,{span:5,offset:16,className:"item"},n.a.createElement(ve.a.Text,{underline:!0,strong:!0},"Applicable")),c.map((function(e,t){return n.a.createElement(b.a,{span:24,key:t},n.a.createElement(p.a,null,"  ",n.a.createElement(b.a,{span:12,className:"label"},Y[e.name]?"Payroll Tax - ".concat(Y[e.name]):e.name),n.a.createElement(b.a,{span:4,className:"item"},"".concat(e.value,"%")),n.a.createElement(b.a,{span:4,className:"item"},n.a.createElement(se.a,{trigger:["click"],overlay:n.a.createElement(v.a,{style:{backgroundColor:"#f6f4f1"},onClick:function(e){!function(e,t){var a=c;a[t].apply=e;var l=null===i||void 0===i?void 0:i.hourlyBaseRate;a=a.map((function(e,t){return e.amount="Yes"===e.apply?(null===i||void 0===i?void 0:i.hourlyBaseRate)*e.value/100:0,l+=e.amount,e})),g(l+(null===i||void 0===i?void 0:i.hourlyBaseRate)),d(Object(we.a)(a))}(null===e||void 0===e?void 0:e.key,t)}},n.a.createElement(v.a.Item,{key:"Yes"},"Yes"),n.a.createElement(v.a.Item,{key:"No"},"No"))},n.a.createElement("span",{className:"mouse-pointer"},e.apply))),n.a.createElement(b.a,{span:4,className:"item"},_(e.amount))))})),n.a.createElement(b.a,{span:16,className:"label my-30"},"Adjustment"),n.a.createElement(b.a,{span:8,className:"item my-30"},n.a.createElement(Tn,{value:j,shape:"$",onChange:function(e){D(null!==e&&void 0!==e?e:0)}})),n.a.createElement(b.a,{span:16,className:"label bold my-20"}," Contractor Hourly Buy Rate"),n.a.createElement(b.a,{span:8,className:"item bold my-20"}," ",_(f+j)),n.a.createElement(b.a,{span:12,className:"label mb-10"},"Daily Billable Hours"),n.a.createElement(b.a,{span:6,className:"item bold mb-10"},n.a.createElement(Tn,{value:P,onChange:function(e){x(null!==e&&void 0!==e?e:0)}})),n.a.createElement(b.a,{span:16,className:"label bold"}," Contractor Daily Buy Rate"),n.a.createElement(b.a,{span:8,className:"item bold total-cost pr-5"}," ",_(P*(f+j))))),n.a.createElement(b.a,{span:12,className:"sell-cost"},n.a.createElement(p.a,null,n.a.createElement(b.a,{span:24,className:"mb-10"},n.a.createElement(ve.a.Title,{level:5},"Sell Rate Calculator - Contractor ")),n.a.createElement(b.a,{span:7},"Expected CM %"),E.map((function(e,t){return n.a.createElement(b.a,{span:4,key:t},n.a.createElement(Tn,{value:e,max:100,shape:"%",onChange:function(e){return function(e,t){E[t]=null!==e&&void 0!==e?e:0,k(Object(we.a)(E))}(e,t)}}))}))),n.a.createElement(p.a,{align:"bottom"},n.a.createElement(b.a,{span:8,className:"label bold"},"Contractor Daily Sell Rate"),E.map((function(e,t){return n.a.createElement(b.a,{span:4,className:"bold",key:t},_(P*(f+j)/(1-e/100)))}))))):n.a.createElement(p.a,{className:"buy-sell-calculator ",align:"middle",justify:"center"},n.a.createElement(b.a,{span:12,className:"no-active"},n.a.createElement(ve.a.Text,{type:"danger",mark:!0},"No Active Contract")),n.a.createElement(b.a,{span:12,className:"no-active"},n.a.createElement(ve.a.Text,{type:"danger",mark:!0},"No Active Contract"))))},An=ul.b.Item,Rn=el.a.TabPane,wn=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.match.params.id;e.getRecord(t)},e.getRecord=function(t){var a=JSON.parse(G().permissions).USERS;Dn(t).then((function(l){l.success?e.setState({data:l.basic,editCont:t,permissions:a,infoModal:!1}):l.authError&&e.setState({notAuth:!0})}))},e.closeModal=function(){e.setState({infoModal:!1})},e.handleDelete=function(t){var a=e.props.history;sl(a,"/sub-contractors",t).then((function(e){e.success}))},e.toggleActiveStatus=function(t){(function(e){return z.b.loading({content:"Loading...",key:e}),Ve.a.put(jn+"/".concat(e,"/toggleActive"),{},{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.message,r=l.data;return $(i),z.b.success({content:i,key:e}),n?(K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n,data:r}):{success:n,data:r}})).catch((function(t){return z.b.error({content:t.message,key:e}),{error:"Please login again!",status:!1,message:t.message}}))})(t).then((function(t){t.success&&e.setState({data:Object(Fe.a)(Object(Fe.a)({},e.state.data),{},{active:!e.state.data.active})})}))},e.callBack=function(){var t=e.state.editCont;e.getRecord(t)},e.state={infoModal:!1,editCont:!1,data:{},permissions:{},notAuth:!1},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.data,l=t.infoModal,i=t.editCont,r=t.permissions,o=t.notAuth,c=n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,"Basic Information"),n.a.createElement(b.a,null,n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===r||void 0===r?void 0:r.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(i)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",onClick:function(){e.setState({infoModal:!0})},disabled:!(null===r||void 0===r?void 0:r.UPDATE)},"Edit"),n.a.createElement(v.a.Item,{key:"contract"},n.a.createElement(s.b,{to:{pathname:"/sub-contractors/".concat(i,"/contracts")},className:"nav-link"},"Contracts")),n.a.createElement(v.a.Item,{key:"deactive",disabled:!(null===r||void 0===r?void 0:r.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to ".concat(a.active?"Deactive":"Activate"),onConfirm:function(){return e.toggleActiveStatus(i)}},n.a.createElement("div",null," ",a.active?"Deactivate":"Activate"," "))))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))));return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:c,size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(An,{label:"First Name"},a.firstName),n.a.createElement(An,{label:"Last Name"},a.lastName),n.a.createElement(An,{label:"Phone"},a.phoneNumber," "),n.a.createElement(An,{label:"Email"},a.email),n.a.createElement(An,{label:"Address"},a.address),n.a.createElement(An,{label:"Date Of Birth"},W(a.dateOfBirth,!0,!0)),n.a.createElement(An,{label:"Gender"},V[a.gender]),a.organization&&n.a.createElement(An,{label:"Organisation"},n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(a.organization.id,"/info")},className:"nav-link"},a.organization.name))),i&&n.a.createElement(el.a,{type:"card",style:{marginTop:"50px"}},n.a.createElement(Rn,{tab:"Projects",key:"projects"},n.a.createElement(Il,{targetId:i,customUrl:"helpers/work?type=P&employee=".concat(i)})),n.a.createElement(Rn,{tab:"Comments",key:"comments"},n.a.createElement(jl,{targetType:"CON",targetId:i})),n.a.createElement(Rn,{tab:"Attachments",key:"attachments"},n.a.createElement(Al,{targetType:"CON",targetId:i})),n.a.createElement(Rn,{tab:"Cost Calculator",key:"cost-calculator"},n.a.createElement(zn,{conId:i}))),l&&n.a.createElement(In,{visible:l,editCont:i,close:this.closeModal,callBack:this.callBack}),o&&n.a.createElement(wl,this.props))}}]),a}(l.Component),Fn="".concat(A,"/sub-contractors-contracts"),Nn=function(e){return Ve.a.get(Fn+"?subContractorId=".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Mn=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.editCntrct;t&&e.getRecord(t)},e.onFinish=function(t){e.setState({loading:!0});var a=e.state.fileIds,l=e.props,n=l.editCntrct,i=l.editEmp,r=t.billing;r.startDate=W(r.startDate,!0),r.endDate=W(r.endDate,!0),r.subContractorId=i,r.fileId=a,n?(console.log("edit"),e.editRecord(r)):(console.log("emes"),e.addContract(r))},e.addContract=function(t){console.log(t);var a=e.props.callBack;(function(e){return z.b.loading({content:"Loading...",key:1}),Ve.a.post(Fn,e,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))})(t).then((function(t){e.setState({loading:!1}),console.log(t),t.success&&a()}))},e.getRecord=function(t){var a;(a=t,Ve.a.get(Fn+"/".concat(a),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;return l&&(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),n.file=n.fileId?[{id:n.file.id,createdAt:n.file.createdAt,fileId:n.file.id,uid:n.file.uniqueName,name:n.file.originalName,type:n.file.type,url:"".concat(A,"/files/").concat(n.file.uniqueName),thumbUrl:X(n.file.type)}]:[]),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){var a=t.success,l=t.data;console.log(t),a&&(l.startDate=W(l.startDate),l.endDate=W(l.endDate),e.formRef.current.setFieldsValue({billing:l}),e.setState({fileIds:l.fileId,fileList:l.file}))}))},e.editRecord=function(t){var a=e.props,l=a.editCntrct,n=a.callBack;(function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.put(Fn+"/".concat(e),t,{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:e}),n&&K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n}})).catch((function(t){return z.b.error({content:t.message,key:e}),{error:"Please login again!",status:!1,message:t.message}}))})(l,t).then((function(t){e.setState({loading:!1}),t.success&&n()}))},e.handleUpload=function(){var t=Object(La.a)(Ma.a.mark((function t(a){var l,n,i,r,o;return Ma.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=a.onSuccess,n=a.onError,i=a.file,r=a.onProgress,o=new FormData,{headers:{"content-type":"multipart/form-data"},onUploadProgress:function(t){var a=Math.floor(t.loaded/t.total*100);e.setState({progress:a}),100===a&&setTimeout((function(){return e.setState({progres:0})}),1e3),r({percent:t.loaded/t.total*100})}},o.append("files",i),vl(o).then((function(t,a){if(t.success)l("Ok"),e.setState({fileList:[t.file],fileIds:t.file.fileId});else{console.log("Eroor: ",a);new Error("Some error");n({err:a})}}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onRemove=function(t){e.setState({fileIds:null,fileList:[]})},e.formRef=n.a.createRef(),e.state={editCntrct:!1,loading:!1,fileList:[],fileIds:null,data:{},BillingFields:[{Placeholder:"Contract Start Date",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Contract End Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"startDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Start Date is required"}],labelAlign:"right",rangeMin:function(t){var a=e.formRef.current.getFieldValue().billing;return a.endDate&&t>a.endDate}},{object:"billing",fieldCol:12,key:"endDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},rangeMax:function(t){var a=e.formRef.current.getFieldValue().billing;return a.startDate&&t<a.startDate}},{Placeholder:"Contract Payment Basis",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Rate",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"remunerationAmountPer",size:"small",data:[{label:"Hourly",value:1},{label:"Daily",value:2},{label:"Weekly",value:3},{label:"Fortnightly",value:4},{label:"Monthly",value:5}],type:"Select",rules:[{required:!0,message:"Payment Frequncy is required"}],onChange:function(t,a){var l=e.state.BillingFields;l[5].Placeholder="Total Fee ".concat(t?a.label:""),e.setState({BillingFields:l})}},{object:"billing",fieldCol:12,key:"remunerationAmount",size:"small",type:"InputNumber",shape:"$",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Total Fee is Required"}]},{Placeholder:"Work Hours In A Week",rangeMin:!0,fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Work Days In A Week",rangeMin:!0,fieldCol:18,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:6,key:"noOfHours",size:"small",type:"InputNumber",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Work Hour is Reqired"}],itemStyle:{marginBottom:1}},{object:"billing",fieldCol:6,key:"noOfDays",size:"small",type:"InputNumber",rangeMin:1,rangeMax:5,fieldStyle:{width:"100%"},rules:[{required:!0,message:"Work Days are Required"}],itemStyle:{marginBottom:10}},{Placeholder:"Comments",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:24,key:"comments",size:"small",type:"Textarea"}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.editCntrct,a=e.visible,l=e.close,i=this.state,r=i.BillingFields,o=i.loading,s=i.fileIds,c=i.fileList;return n.a.createElement(wt.a,{title:t?"Edit Contract":"Add Contract",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:o,htmlType:"submit",form:"my-form"},okText:o?n.a.createElement(Mt.a,null):"Save",onCancel:l,width:900},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,scrollToFirstError:!0,size:"small",layout:"inline",initialValues:{billing:{entryDate:W(new Date)}}},n.a.createElement(ft,{FormFields:r})),n.a.createElement("p",{style:{marginTop:10,marginBottom:2}},"Signed Contract"),n.a.createElement(We.a,{customRequest:this.handleUpload,listType:"picture-card",maxCount:1,fileList:c,onRemove:this.onRemove},!s&&n.a.createElement("div",{style:{marginTop:10}},n.a.createElement(Ll.a,null),n.a.createElement("div",{style:{marginTop:8}},"Upload"))))}}]),a}(l.Component),Ln=(ve.a.Title,ul.b.Item),Bn=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.match.params.id;e.fetchAll(t)},e.fetchAll=function(t){var a=JSON.parse(G().permissions).USERS;Promise.all([Nn(t),Dn(t)]).then((function(t){e.setState({data:t[0].data,filterData:t[0].data,intro:t[1].basic,billModal:!1,editCntrct:!1,permissions:a})})).catch((function(e){console.log(e)}))},e.getList=function(t){Nn(t).then((function(t){t.success&&e.setState({data:t.data,filterData:t.data,billModal:!1,editCntrct:!1})}))},e.callBack=function(){var t=e.props.match.params.id;e.getList(t)},e.handleDelete=function(t,a){var l=e.state,n=l.data,i=l.filterData,r=e.props.history;sl(r,"/sub-contractors-contracts",t,a,i,n).then((function(t){t.success&&e.setState({data:Object(we.a)(t.data),filterData:Object(we.a)(t.filterData)})}))},e.generalFilter=function(t){var a=e.state.data;t?e.setState({filterData:a.filter((function(e){var a,l;return"00".concat(e.id).includes(t)||e.startDate&&"".concat(W(e.startDate,!0,!0)).toLowerCase().includes(t.toLowerCase())||e.endDate&&"".concat(W(e.endDate,!0,!0)).toLowerCase().includes(t.toLowerCase())||"".concat(null!==(a=_(e.remunerationAmount))&&void 0!==a?a:"").toLowerCase().includes(t.toLowerCase())||"".concat(null!==(l=q[e.remunerationAmountPer])&&void 0!==l?l:"").toLowerCase().includes(t.toLowerCase())}))}):e.setState({filterData:a})},e.columns=[Object(Fe.a)({title:"Code",dataIndex:"id",key:"id",wdith:115,render:function(e){return"00".concat(e)}},Jt("id","number",!0)),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return e&&W(e,!0,!0)}},Jt("startDate","date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e){return e&&W(e,!0,!0)}},Jt("endDate","date")),Object(Fe.a)({title:"Rate",dataIndex:"remunerationAmount",key:"remunerationAmount",render:function(e){return"".concat(_(e))}},Jt("remunerationAmount","number")),{title:"Contract Payment Basis",dataIndex:"remunerationAmountPer",key:"remunerationAmountPer",render:function(e){return q[e]}},{title:"...",key:"action",align:"center",width:"1%",render:function(t,a,l){var i,r,o,s=null!==(i=null===(r=Object(Aa.a)(e))||void 0===r||null===(o=r.state)||void 0===o?void 0:o.permissions)&&void 0!==i?i:{},c=s.DELETE,d=s.UPDATE;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!c,className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(a.id,l)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",disabled:!d,onClick:function(){e.setState({billModal:!0,editCntrct:a.id})}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],e.state={intro:{},data:[],billModal:!1,editCntrct:!1,openSearch:!1,filterData:[],permissions:{}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.billModal,l=t.editCntrct,i=(t.data,t.intro),r=t.filterData,o=this.props.match.params.id;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:"Contract Information",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Ln,null,"Code: ",n.a.createElement("b",null,i.cpCode)),n.a.createElement(Ln,null,"First Name: ",n.a.createElement("b",null,i.firstName)),n.a.createElement(Ln,null,"Last Name: ",n.a.createElement("b",null,i.lastName)),n.a.createElement(Ln,{style:{textAlign:"right"}},n.a.createElement(Be.a,{size:"small",type:"primary",onClick:function(){return e.setState({billModal:!0})}},n.a.createElement(Nt.a,null)," Contract"))),n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:this.columns,dataSource:r,size:"small",className:"fs-small"}),a&&n.a.createElement(Mn,{visible:a,editCntrct:l,close:function(){return e.setState({billModal:!1,editCntrct:!1})},callBack:this.callBack,editEmp:o}))}}]),a}(l.Component),qn=a(612),Vn=el.a.TabPane,Yn=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.fetchAll()},e.fetchAll=function(){var t=e.props.editCP;Promise.all([pt(),gt(),vt()]).then((function(a){var l=e.state,n=l.BasicFields,i=l.SecurityFields;n.fields[11].data=a[0].data,i.fields[7].data=a[2].data,e.setState({BasicFields:n,SecurityFields:i,skill_data:a[1].data,orgs_data:a[2].data},(function(){t?e.getRecord(t):e.setState({associateFields:Object(Fe.a)(Object(Fe.a)({},e.state.associateFields),{},{fields:e.newAssociateField(0)}),SkillFields:Object(Fe.a)(Object(Fe.a)({},e.state.SkillFields),{},{fields:e.newSkillField(0)})})}))})).catch((function(e){console.log(e)}))},e.insertSkill=function(){var t,a=e.state.SkillFields,l=a.fields[a.fields.length-1],n=l?parseInt(l.key)+1:0;a.fields=(t=a.fields).concat.apply(t,Object(we.a)(e.newSkillField(n))),e.setState({SkillFields:a})},e.newSkillField=function(t,a){var l=e.state.skill_data,i=["skill".concat(t),"level".concat(t),t];return[{object:"skill",fieldCol:11,layout:{wrapperCol:{span:23}},key:i[0],size:"small",data:l||[],type:"Select",labelAlign:"left",onChange:function(t,a){var l=e.state.SkillFields;l.fields.map((function(e){return e.key===i[1]?(e.data=a?a.levels:[],e):e}));var n=e.skillRef.current.refs.skill_form.getFieldsValue().skill;n[i[1]]=void 0,e.skillRef.current.refs.skill_form.setFieldsValue({skill:n}),e.setState({SkillFields:l})}},{object:"skill",fieldCol:11,layout:{wrapperCol:{span:20}},key:i[1],size:"small",data:a||[],type:"Select",labelAlign:"left",itemStyle:{marginBottom:"5px"}},{fieldCol:2,size:"small",Placeholder:n.a.createElement(fa.a,{style:{color:"red",margin:"auto"}}),key:t,type:"Text",style:{textAlign:"right"},fieldStyle:{cursor:"pointer"},onClick:function(t,a){var l=e.state.SkillFields;l.fields=l.fields.filter((function(e){return e.key!==i[0]&&e.key!==i[1]&&e.key!==i[2]}));var n=e.skillRef.current.refs.skill_form.getFieldsValue().skill;n[i[0]]=void 0,n[i[1]]=void 0,n[i[2]]=void 0,e.skillRef.current.refs.skill_form.setFieldsValue({skill:n}),e.setState({SkillFields:l})}}]},e.insertAssociate=function(){var t,a=e.state.associateFields,l=a.fields[a.fields.length-1],n=l?parseInt(l.key)+1:0;a.fields=(t=a.fields).concat.apply(t,Object(we.a)(e.newAssociateField(n))),e.setState({associateFields:a})},e.newAssociateField=function(t){var a=e.state.orgs_data,l=["organizationId".concat(t),"designation".concat(t),"startDate".concat(t),"endDate".concat(t),"id".concat(t),t];return[{object:"asso",fieldCol:6,layout:{wrapperCol:{span:23}},key:l[0],size:"small",data:a,type:"Select",onChange:function(a){var n,i=e.state.associateFields;e.setState({associateFields:Object(Fe.a)(Object(Fe.a)({},i),{},{fields:(null!==(n=null===i||void 0===i?void 0:i.fields)&&void 0!==n?n:[]).map((function(e){return e.key===l[2]?a?(e.rules[0].required=!0,e):(e.rules[0].required=!1,e):e}))})});var r=e.associateRef.current.refs.associate_form.getFieldsValue().asso;r["id".concat(t)]=void 0,e.associateRef.current.refs.associate_form.setFieldsValue({asso:r})}},{object:"asso",fieldCol:6,layout:{wrapperCol:{span:23}},key:l[1],size:"small",type:"Input"},{object:"asso",fieldCol:5,layout:{wrapperCol:{span:23}},key:l[2],size:"small",rules:[{required:!1,message:"Start Date Required"}],type:"DatePicker"},{object:"asso",fieldCol:5,layout:{wrapperCol:{span:23}},key:l[3],size:"small",type:"DatePicker"},{object:"asso",fieldCol:6,key:l[4],hidden:!0,size:"small",type:"Input"},{fieldCol:2,size:"small",Placeholder:n.a.createElement(fa.a,{style:{color:"red",margin:"auto"}}),key:t,type:"Text",style:{textAlign:"right"},fieldStyle:{cursor:"pointer"},onClick:function(t,a){var n=e.state.associateFields;n.fields=n.fields.filter((function(e){return e.key!==l[0]&&e.key!==l[1]&&e.key!==l[2]&&e.key!==l[3]&&e.key!==l[4]&&e.key!==l[5]})),e.setState({associateFields:n})}}]},e.submit=function(){e.basicRef.current&&e.basicRef.current.refs.basic_form.submit(),e.associateRef.current&&e.associateRef.current.refs.associate_form.submit(),e.skillRef.current&&e.skillRef.current.refs.skill_form.submit(),e.securityRef.current&&e.securityRef.current.refs.security_form.submit()},e.BasicCall=function(t){var a;Object(Fe.a)(Object(Fe.a)({},t.basic),{},{dateOfBirth:W(null===t||void 0===t||null===(a=t.basic)||void 0===a?void 0:a.dateOfBirth,!0)});e.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},e.state.mergeObj),t.basic),basicSubmitted:!0},(function(){var t=e.state,a=t.basicSubmitted,l=t.associateSubmitted,n=t.skillSubmitted,i=t.securitySubmitted,r=t.mergeObj;a&&l&&n&&i&&(e.props.editCP?e.editRecord(r):e.addPerson(r))}))},e.AssociateCall=function(t){var a=t.asso,l=[],n=a?Object.keys(a).length/5:0;if(a&&Object.keys(a).length>0)for(var i=0;i<n;i++){var r;if(a["organizationId".concat(i)])l.push({id:null!==(r=a["id".concat(i)])&&void 0!==r?r:0,designation:a["designation".concat(i)],organizationId:a["organizationId".concat(i)],startDate:W(a["startDate".concat(i)],!0),endDate:W(a["endDate".concat(i)],!0)})}e.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},e.state.mergeObj),{},{contactPersonOrganizations:l}),associateSubmitted:!0},(function(){return e.validateForm()}))},e.SkillCall=function(t){for(var a=t.skill,l=[],n=0,i=Object.entries(null!==a&&void 0!==a?a:{});n<i.length;n++){var r=Object(he.a)(i[n],2),o=r[0],s=r[1];o.includes("level")&&s&&l.push(s)}e.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},e.state.mergeObj),{},{standardSkillStandardLevelIds:l}),skillSubmitted:!0},(function(){return e.validateForm()}))},e.SecurityCall=function(t){var a,l,n=Object(Fe.a)(Object(Fe.a)({},t.sec),{},{clearanceGrantedDate:W(null===t||void 0===t||null===(a=t.sec)||void 0===a?void 0:a.clearanceGrantedDate,!0),clearanceExpiryDate:W(null===t||void 0===t||null===(l=t.sec)||void 0===l?void 0:l.clearanceExpiryDate,!0)});e.setState({mergeObj:Object(Fe.a)(Object(Fe.a)({},e.state.mergeObj),n),securitySubmitted:!0},(function(){return e.validateForm()}))},e.validateForm=function(){var t=e.state,a=t.basicSubmitted,l=t.associateSubmitted,n=t.skillSubmitted,i=t.securitySubmitted,r=t.mergeObj;a&&l&&n&&i&&(e.props.editCP?(console.log("edit"),e.editRecord(r)):e.addPerson(r))},e.addPerson=function(t){var a,l=e.props.callBack;e.setState({basicSubmitted:!1,associateSubmitted:!1,detailSubmitted:!1,skillSubmitted:!1,securitySubmitted:!1,loading:!0}),(a=t,z.b.loading({content:"Loading...",key:1}),Ve.a.post(Bl,a,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){e.setState({loading:!1}),t.success&&l(t.data)}))},e.getRecord=function(t){ql(t).then((function(t){t.success&&function(){for(var a=t.data,l=e.state,n=l.SkillFields,i=l.associateFields,r=l.skill_data,o={},s={},c=a.standardSkillStandardLevels,d=a.contactPersonOrganizations,u=c.length<d.length?d.length:c.length,m=function(t){var a=c[t],l=d[t];a&&r.map((function(l){l.levels.map((function(i){i.value===a.id&&(n.fields=n.fields.concat(e.newSkillField(t,l.levels)),o["level".concat(t)]=i.value,o["skill".concat(t)]=l.value)}))})),l&&(i.fields=i.fields.concat(e.newAssociateField(t)),s["id".concat(t)]=l.id,s["designation".concat(t)]=l.designation,s["organizationId".concat(t)]=l.organizationId,s["startDate".concat(t)]=l.startDate&&W(l.startDate),s["endDate".concat(t)]=l.endDate&&W(l.endDate))},f=0;f<u;f++)m(f);0===c.length&&(n.fields=n.fields.concat(e.newSkillField(0))),0===d.length&&(i.fields=i.fields.concat(e.newAssociateField(0)));var p={firstName:a.firstName,lastName:a.lastName,email:a.email,gender:a.gender,phoneNumber:a.phoneNumber,address:a.address,birthPlace:a.birthPlace,dateOfBirth:W(a.dateOfBirth),stateId:a.stateId},b={clearanceLevel:a.clearanceLevel,clearanceGrantedDate:a.clearanceGrantedDate&&W(a.clearanceGrantedDate),clearanceExpiryDate:a.clearanceExpiryDate&&W(a.clearanceExpiryDate),clearanceSponsorId:a.clearanceSponsorId};e.basicRef.current.refs.basic_form.setFieldsValue({basic:p}),e.associateRef.current.refs.associate_form.setFieldsValue({asso:s}),e.skillRef.current.refs.skill_form.setFieldsValue({skill:o}),e.securityRef.current.refs.security_form.setFieldsValue({sec:b}),e.setState({associateFields:i,SkillFields:n})}()}))},e.editRecord=function(t){var a,l=e.props,n=l.editCP,i=l.callBack;t.id=n,e.setState({basicSubmitted:!1,associateSubmitted:!1,detailSubmitted:!1,skillSubmitted:!1,securitySubmitted:!1,loading:!0}),(a=t,z.b.loading({content:"Loading...",key:a.id}),Ve.a.put(Bl+"/".concat(a.id),a,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.message,r=l.data;return $(i),z.b.success({content:i,key:a.id}),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),n?{success:n,data:r}:{success:n}})).catch((function(e){return Q(e,a.id,5)}))).then((function(t){e.setState({loading:!1}),t.success&&i(t.data)}))},e.onCancel=function(){var t=e.state,a=t.BasicFields,l=t.associateFields,n=t.SkillFields;delete a.initialValues,delete l.initialValues,delete n.initialValues,e.setState({basicSubmitted:!1,associateSubmitted:!1,skillSubmitted:!1,BasicFields:Object(Fe.a)({},a),associateFields:Object(Fe.a)({},l),SkillFields:Object(Fe.a)({},n),mergeObj:{}},(function(){e.props.close()}))},e.basicRef=n.a.createRef(),e.associateRef=n.a.createRef(),e.skillRef=n.a.createRef(),e.securityRef=n.a.createRef(),e.state={editCP:!1,basicSubmitted:!1,associateSubmitted:!1,detailSubmitted:!1,skillSubmitted:!1,securitySubmitted:!1,skill_data:[],orgs_data:[],loading:!1,BasicFields:{formId:"basic_form",FormCol:24,justifyField:"center",FormLayout:"inline",layout:{labelCol:{span:10},wrapperCol:{span:0}},size:"small",fields:[{Placeholder:"First Name",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Last Name",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"firstName",size:"small",rules:[{required:!0,message:"First Name is Required"}],type:"input",labelAlign:"right",itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"lastName",size:"small",rules:[{required:!0,message:"Last Name is Required"}],type:"input",labelAlign:"right",itemStyle:{marginBottom:10}},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Email",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"phoneNumber",size:"small",type:"input",labelAlign:"right",itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"email",size:"small",type:"input",labelAlign:"right",itemStyle:{marginBottom:10}},{Placeholder:"Gender",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"State For Payroll Tax Purpose",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"gender",rangeMin:!0,rules:[{required:!0,message:"Gender is Required"}],size:"small",data:[{label:"Male",value:"M"},{label:"Female",value:"F"},{label:"Other",value:"O"}],type:"Select",itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"stateId",rules:[{required:!0,message:"State is Required"}],size:"small",type:"Select",data:[],itemStyle:{marginBottom:10}},{Placeholder:"Date Of Birth",fieldCol:12,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:1}},{Placeholder:"Birth Place",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"dateOfBirth",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10}},{object:"basic",fieldCol:12,key:"birthPlace",size:"small",type:"Input",itemStyle:{marginBottom:20}},{Placeholder:"Address",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:24,key:"address",size:"small",type:"Input",itemStyle:{marginBottom:20}}]},associateFields:{formId:"associate_form",FormCol:24,FieldSpace:24,justifyField:"center",FormLayout:"inline",size:"middle",preserve:!1,fields:[]},SkillFields:{formId:"skill_form",FormCol:24,FieldSpace:24,justifyField:"center",FormLayout:"inline",layout:{labelCol:{span:9},wrapperCol:{span:0}},size:"middle",fields:[]},SecurityFields:{formId:"security_form",FormCol:24,justifyField:"center",FormLayout:"inline",layout:{labelCol:{span:10},wrapperCol:{span:0}},size:"small",fields:[{Placeholder:"Clearance Level",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Date Granted",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"sec",fieldCol:12,key:"clearanceLevel",size:"small",data:[{label:"BV - Baseline Vetting",value:"BV"},{label:"NV1 - Negative Vetting 1",value:"NV1"},{label:"NV2 - Negative Vetting 2",value:"NV2"},{label:"PV - Positive Vetting",value:"PV"},{label:"No clearance",value:"NC"}],type:"Select",itemStyle:{marginBottom:10},onChange:function(t){var a=e.state.SecurityFields.fields;t?(a[1].rangeMin=!0,a[4].rangeMin=!0,a[5].rangeMin=!0,a[3].rules=[{required:!0,message:"Date Granted is required"}],a[6].rules=[{required:!0,message:"Expiry Date is required"}],a[7].rules=[{required:!0,message:"Current Sponsor is required"}]):(a[1].rangeMin=!1,a[4].rangeMin=!1,a[5].rangeMin=!1,a[3].rules=[{required:!1,message:""}],a[6].rules=[{required:!1,message:""}],a[7].rules=[{required:!1,message:""}]),e.setState({SecurityFields:Object(Fe.a)(Object(Fe.a)({},e.state.SecurityFields),{},{fields:Object(we.a)(a)})})}},{object:"sec",fieldCol:12,key:"clearanceGrantedDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10}},{Placeholder:"Expiry Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Current Sponsor",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"sec",fieldCol:12,key:"clearanceExpiryDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10}},{object:"sec",fieldCol:12,key:"clearanceSponsorId",size:"small",type:"Select",labelAlign:"right",itemStyle:{marginBottom:10}}]}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.editCP,l=t.visible,i=this.state,r=i.BasicFields,o=i.associateFields,s=i.SkillFields,c=i.SecurityFields,d=i.loading;return n.a.createElement(wt.a,{title:a?"Edit Contact":"Add Contact",maskClosable:!1,centered:!0,visible:l,onOk:function(){e.submit()},okButtonProps:{disabled:d},okText:d?n.a.createElement(Mt.a,null):"Save",onCancel:this.onCancel,width:900},n.a.createElement(el.a,{type:"card"},n.a.createElement(Vn,{tab:"Basic",key:"basic",forceRender:!0},n.a.createElement(Kt,{ref:this.basicRef,Callback:this.BasicCall,FormFields:r})),n.a.createElement(Vn,{tab:"Association",key:"association",forceRender:!0},n.a.createElement(p.a,{justify:"end"},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:this.insertAssociate},n.a.createElement(qn.a,null)," Insert Association")),n.a.createElement(b.a,{span:"24"},n.a.createElement(p.a,null,n.a.createElement(b.a,{span:"6"},"Organisation"),n.a.createElement(b.a,{span:"6"},"Designation"),n.a.createElement(b.a,{span:"5"},"Start Date"),n.a.createElement(b.a,{span:"5"},"End Date")))),n.a.createElement(p.a,null,n.a.createElement(Kt,{ref:this.associateRef,Callback:this.AssociateCall,FormFields:o}))),n.a.createElement(Vn,{tab:"Skill",key:"skill",forceRender:!0},n.a.createElement(p.a,{justify:"end"},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:this.insertSkill},n.a.createElement(qn.a,null)," Insert Skill")),n.a.createElement(b.a,{span:"24"},n.a.createElement(p.a,null,n.a.createElement(b.a,{span:"11"},"Skill"),n.a.createElement(b.a,{span:"11"},"Level")))),n.a.createElement(p.a,null,n.a.createElement(Kt,{ref:this.skillRef,Callback:this.SkillCall,FormFields:s}))),n.a.createElement(Vn,{tab:"Security Clearance",key:"security",forceRender:!0},n.a.createElement(Kt,{ref:this.securityRef,Callback:this.SecurityCall,FormFields:c}))))}}]),a}(l.Component),Hn=ve.a.Title,_n=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.getData()},l.getData=function(){var e=JSON.parse(G().permissions).CONTACT_PERSONS;Ve.a.get(Bl,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return console.log(e),{error:"Please login again!",success:!1,message:e.message}})).then((function(t){t.success&&l.setState({data:t.data,filterData:t.data,openModal:!1,editCP:!1,permissions:e})}))},l.handleDelete=function(e,t){console.log({id:e,index:t});var a=l.state,n=a.data,i=a.filterData,r=l.props.history;sl(r,"/contactpersons",e,t,i,n).then((function(e){e.success&&l.setState({data:Object(we.a)(e.data),filterData:Object(we.a)(e.filterData)})}))},l.toggelModal=function(e){l.setState({openModal:e,editCP:!1})},l.Callback=function(){l.getData()},l.submit=function(){l.contactForm.current.refs.contact_form.submit()},l.generalFilter=function(e){var t=l.state.data;(e=e.replace(/\s+/g,"").toLowerCase())?l.setState({filterData:t.filter((function(t){var a="".concat(t.firstName?t.firstName:""," ").concat(t.lastName?t.lastName:""),l="".concat(t.lastName?t.lastName:""," ").concat(t.firstName?t.firstName:"");return"00".concat(t.id.toString()).includes(e)||a.toLowerCase().replace(/\s+/g,"").includes(e.toLowerCase())||l.toLowerCase().replace(/\s+/g,"").includes(e.toLowerCase())||t.email&&t.email.toLowerCase().replace(/\s+/g,"").includes(e.toLowerCase())||t.gender&&V[t.gender].toLowerCase().includes(e.toLowerCase())||t.phoneNumber&&t.phoneNumber.startsWith(e)}))}):l.setState({filterData:t})},l.advancefilter=function(e,t,a){var n=l.state,i=n.data,r=n.searchedColumn;t?r[t].value=e:r=a,r.id.value||r.firstName.value||r.lastName.value||r.email.value||r.phoneNumber.value||r.gender.value.length>0||r.stateId.value.length>0||r.address.value||r.skill.value.length>0||r.clearanceLevel.value.length>0||r.association.value.length>0?l.setState({filterData:i.filter((function(e){var t,a,l,n,i;return"00".concat(e.id.toString()).includes(r.id.value)&&"".concat(null!==(t=e.firstName)&&void 0!==t?t:"").toLowerCase().includes(r.firstName.value.toLowerCase())&&"".concat(null!==(a=e.lastName)&&void 0!==a?a:"").toLowerCase().includes(r.lastName.value.toLowerCase())&&"".concat(null!==(l=e.email)&&void 0!==l?l:"").toLowerCase().includes(r.email.value.toLowerCase())&&"".concat(null!==(n=e.phoneNumber)&&void 0!==n?n:"").toLowerCase().includes(r.phoneNumber.value.toLowerCase())&&"".concat(null!==(i=e.address)&&void 0!==i?i:"").toLowerCase().includes(r.address.value.toLowerCase())&&(r.gender.value.length>0?r.gender.value:[{value:","}]).some((function(t){return(r.gender.value.length>0?[e.gender]:[","]).includes(t.value)}))&&(r.stateId.value.length>0?r.stateId.value:[{value:","}]).some((function(t){return(r.stateId.value.length>0?[e.stateId]:[","]).includes(t.value)}))&&(r.clearanceLevel.value.length>0?r.clearanceLevel.value:[{value:","}]).some((function(t){return(r.clearanceLevel.value.length>0?[e.clearanceLevel]:[","]).includes(t.value)}))&&(r.skill.value.length>0?r.skill.value:[{value:","}]).some((function(t){return(e.standardSkillStandardLevels&&e.standardSkillStandardLevels.length>0&&r.skill.value.length>0?e.standardSkillStandardLevels.map((function(e){return e.standardSkillId})):[","]).includes(t.value)}))&&(r.association.value.length>0?r.association.value:[{value:","}]).some((function(t){return(e.contactPersonOrganizations&&e.contactPersonOrganizations.length>0&&r.association.value.length>0?e.contactPersonOrganizations.map((function(e){return e.organizationId})):[","]).includes(t.value)}))})),searchedColumn:r,openSearch:!1}):l.setState({searchedColumn:r,filterData:i,openSearch:!1})},l.filterModalUseEffect=function(){Promise.all([pt(),gt(),vt()]).then((function(e){var t=l.state.filterFields;t[11].data=e[0].success?e[0].data:[],t[15].data=e[1].success?e[1].data:[],t[17].data=e[2].success?e[2].data:[],l.setState({filterFields:t})})).catch((function(e){console.log(e)}))},l.contactForm=n.a.createRef(),l.columns=[Object(Fe.a)({title:"Code",dataIndex:"id",key:"id",width:115,render:function(e){return"00".concat(e)}},Jt("id","number",!0)),Object(Fe.a)({title:"First Name",dataIndex:"firstName",key:"firstName",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"/contacts/".concat(t.id,"/info")},className:"nav-link"},e)}},Jt("firstName","string")),Object(Fe.a)({title:"Last Name",dataIndex:"lastName",key:"lastName"},Jt("lastName","string")),{title:"Gender",dataIndex:"gender",key:"gender",width:100,render:function(e){return V[e]}},{title:"Email",dataIndex:"email",key:"email"},{title:"Phone",dataIndex:"phoneNumber",key:"phoneNumber",width:150},Object(Fe.a)({title:"Status",dataIndex:"employementStatus",key:"employementStatus",render:function(e,t){var a,l="Employee"===e?"Employees":"Sub Contractor"===e?"sub-contractor":"contacts";return"contacts"!==l?n.a.createElement(s.b,{to:{pathname:"/".concat(l,"/").concat(null===t||void 0===t||null===(a=t.employee)||void 0===a?void 0:a.id,"/info")},className:"nav-link"},e):e}},Jt("employementStatus","string")),{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){var i,r,o;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,{key:a},n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(l))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"update",onClick:function(){l.setState({openModal:!0,editCP:t.id})},disabled:l.state&&!l.state.permissions.UPDATE},"Edit"),n.a.createElement(v.a.Item,{key:"View"},n.a.createElement(s.b,{to:{pathname:"/contacts/".concat(t.id,"/info")},className:"nav-link"},"View")))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],l.state={openSearch:!1,filterData:[],data:[],openModal:!1,editCP:!1,permissions:{},searchText:"",searchedColumn:{id:{type:"Input",value:"",label:"Code",showInColumn:!0},firstName:{type:"Input",value:"",label:"First Name",showInColumn:!0},lastName:{type:"Input",value:"",label:"Last Name",showInColumn:!0},gender:{type:"Select",multi:!0,value:[],label:"Gender",showInColumn:!0,mode:"multiple",options:[{label:"Male",value:"M"},{label:"Female",value:"F"},{label:"Other",value:"O"}]},email:{type:"Input",value:"",label:"Email",showInColumn:!0},phoneNumber:{type:"Input",value:"",label:"Phone Number",showInColumn:!0},Action:{type:"Input",value:"",label:"",showInColumn:!0,disabled:!0},stateId:{type:"none",multi:!0,value:[],label:"State",showInColumn:!1,disabled:!1},address:{type:"none",value:"",label:"Address",showInColumn:!1,disabled:!1},skill:{type:"none",multi:!0,value:[],label:"Skill",showInColumn:!1,disabled:!1},clearanceLevel:{type:"none",multi:!0,value:[],label:"clearanceLevel",showInColumn:!1,disabled:!1},association:{type:"none",multi:!0,value:[],label:"Association",showInColumn:!1,disabled:!1}},filterFields:[{Placeholder:"First Name",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Last Name",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"firstName",size:"small",type:"input"},{object:"obj",fieldCol:12,key:"lastName",size:"small",type:"input"},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Email",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"phoneNumber",size:"small",type:"input"},{object:"obj",fieldCol:12,key:"email",size:"small",type:"input"},{Placeholder:"Gender",fieldCol:12,size:"small",type:"Text"},{Placeholder:"State For Payroll Tax Purpose",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"gender",size:"small",mode:"multiple",customValue:function(e,t){return t},data:[{label:"Male",value:"M"},{label:"Female",value:"F"},{label:"Other",value:"O"}],type:"Select"},{object:"obj",fieldCol:12,key:"stateId",mode:"multiple",customValue:function(e,t){return t},size:"small",type:"Select"},{Placeholder:"Clearance Level",fieldCol:24,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"clearanceLevel",size:"small",mode:"multiple",customValue:function(e,t){return t},data:[{label:"BV - Baseline Vetting",value:"BV"},{label:"NV1 - Negative Vetting 1",value:"NV1"},{label:"NV2 - Negative Vetting 2",value:"NV2"},{label:"PV - Positive Vetting",value:"PV"},{label:"No clearance",value:"NC"}],type:"Select"},{Placeholder:"Skill",fieldCol:24,size:"small",type:"Text"},{object:"obj",fieldCol:24,key:"skill",size:"small",mode:"multiple",customValue:function(e,t){return t},data:[],type:"Select"},{Placeholder:"Association",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:24,key:"association",size:"small",mode:"multiple",customValue:function(e,t){return t},data:[],type:"Select"},{Placeholder:"Address",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:24,key:"address",size:"small",type:"Input"}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.filterData,l=t.openModal,i=t.editCP,r=t.permissions,o=t.searchedColumn,s=t.openSearch,c=t.filterFields,d=this.columns;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Hn,{level:4},"Contacts")),n.a.createElement(b.a,{style:{textAlign:"end"},span:12},n.a.createElement(p.a,{justify:"end"},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"default",size:"small",onClick:function(){return e.setState({openSearch:!0})}},n.a.createElement(Ft.a,null),"Filter")),n.a.createElement(b.a,{offset:1},n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){e.setState({openModal:!0})},disabled:!r.ADD},n.a.createElement(Nt.a,null),"Contact Person")))),n.a.createElement(ea,{filters:o,filterFunction:this.advancefilter}),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,className:"fixed-top fs-small",pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:d,dataSource:a,size:"small"}))),s&&n.a.createElement(Zt,{title:"Filter Contact Persons",visible:s,filters:o,filterFields:c,filterFunction:this.advancefilter,effectFunction:this.filterModalUseEffect,effectRender:!0,onClose:function(){return e.setState({openSearch:!1})}}),l&&n.a.createElement(Yn,{visible:l,editCP:i,close:this.toggelModal,callBack:this.Callback}))}}]),a}(l.Component),Un=ul.b.Item,Wn=el.a.TabPane,Kn=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l,n,i;return Object(c.a)(this,a),(i=t.call(this,e)).componentDidMount=function(){var e=i.state.userId;ql(e).then((function(e){if(e.success){var t=e.data;i.setState({data:Gn(t)})}else e.authError&&i.setState({notAuth:!0})}))},i.handleDelete=function(){var e=i.state.userId,t=i.props.history;sl(t,"/contactpersons",e).then((function(e){e.success}))},i.toggelModal=function(){i.setState({infoModal:!1})},i.Callback=function(e){console.log(e),e&&i.setState({data:Gn(e),infoModal:!1})},i.state={data:{},infoModal:!1,userId:null===e||void 0===e||null===(l=e.match)||void 0===l||null===(n=l.params)||void 0===n?void 0:n.id,notAuth:!1},i}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.data,l=t.infoModal,i=t.userId,r=t.notAuth,o=n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,"Contact Information"),n.a.createElement(b.a,null,n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete()}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"Edit",onClick:function(){e.setState({infoModal:!0})}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))));return n.a.createElement(p.a,null,n.a.createElement(b.a,{span:24},n.a.createElement(ul.b,{title:o,size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Un,{label:"Name"},a.fullname),n.a.createElement(Un,{label:"Phone"},a.phoneNumber),n.a.createElement(Un,{label:"Email"},a.email),n.a.createElement(Un,{label:"Gender"},a.gender),n.a.createElement(Un,{label:"Date Of Birth"},a.dateOfBirth),n.a.createElement(Un,{label:"Birth Place"},a.birthPlace),n.a.createElement(Un,{label:"Status"},a.employementStatus))),n.a.createElement(b.a,{span:24},n.a.createElement(el.a,{type:"card",style:{marginTop:"50px"}},n.a.createElement(Wn,{tab:"Opportunities",key:"leads"},n.a.createElement(Pl,{targetId:i,customUrl:"helpers/work?type=O&contact=".concat(i)})),n.a.createElement(Wn,{tab:"Projects",key:"projects"},n.a.createElement(Il,{targetId:i,customUrl:"helpers/work?type=P&contact=".concat(i)})),n.a.createElement(Wn,{tab:"Comments",key:"comments"},n.a.createElement(jl,{targetType:"COP",targetId:i})),n.a.createElement(Wn,{tab:"Attachments",key:"attachments"},n.a.createElement(Al,{targetType:"COP",targetId:i})))),l&&n.a.createElement(Yn,{visible:l,editCP:i,close:this.toggelModal,callBack:this.Callback}),r&&n.a.createElement(wl,this.props))}}]),a}(l.Component),Gn=function(e){var t,a;return{fullname:e.firstName+" "+e.lastName,email:e.email,gender:V[null===e||void 0===e?void 0:e.gender],phoneNumber:e.phoneNumber,address:e.address,birthPlace:e.birthPlace,dateOfBirth:W(W(e.dateOfBirth),!0,!0),stateId:e.stateId,employementStatus:$n(e.employementStatus,null===e||void 0===e||null===(t=e.employee)||void 0===t?void 0:t.id),employeeId:null===e||void 0===e||null===(a=e.employee)||void 0===a?void 0:a.id}};function $n(e,t){var a="Employee"===e?"Employees":"Sub Contractor"===e?"sub-contractor":"contacts";return t?n.a.createElement(s.b,{to:{pathname:"/".concat(a,"/").concat(t,"/info")},className:"nav-link"},e):e}var Jn=a(154),Xn=a(310),Qn=a(614),Zn=a(615),ei=a(613),ti=(a(425),a(230)),ai=a.n(ti),li=a(229),ni=a.n(li),ii="".concat(A,"/timesheets/"),ri=function(e){return z.b.loading({content:"Loading...",key:1}),Ve.a.delete(ii+"entries/".concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),z.b.success({content:i,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))},oi=function(e,t,a){return z.b.loading({content:"Loading...",key:1}),Ve.a.post(ii+"".concat(e.startDate,"&").concat(e.endDate,"&").concat(e.userId,"/milestoneEntries").concat(t),a,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),z.b.success({content:i,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return z.b.error({content:e.message,key:1}),{error:"Please login again!",status:!1,message:e.message}}))},si=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.timeObj.milestoneEntryId;e.getRecord("PEN",t[0])},e.getRecord=function(t,a){var l=e.props.timeObj.notes;kl(t,a).then((function(t){t.success&&e.setState({fileList:t.fileList,fileIds:t.fileIds,notes:l})}))},e.handleUpload=function(){var t=Object(La.a)(Ma.a.mark((function t(a){var l,n,i,r,o;return Ma.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=a.onSuccess,n=a.onError,i=a.file,r=a.onProgress,o=new FormData,{headers:{"content-type":"multipart/form-data"},onUploadProgress:function(t){var a=Math.floor(t.loaded/t.total*100);e.setState({progress:a}),100===a&&setTimeout((function(){return e.setState({progres:0})}),1e3),r({percent:t.loaded/t.total*100})}},o.append("files",i),vl(o).then((function(t,a){if(t.success)l("Ok"),e.setState({fileList:[].concat(Object(we.a)(e.state.fileList),[t.file]),fileIds:[].concat(Object(we.a)(e.state.fileIds),[t.file.fileId])});else{console.log("Eroor: ",a);new Error("Some error");n({err:a})}}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onRemove=function(t){e.setState((function(e){var a=e.fileList.indexOf(t),l=e.fileList.slice(),n=e.fileIds;return l.splice(a,1),n.splice(a,1),{fileIds:n,fileList:l}}))},e.addNotes=function(){e.setState({loading:!0});var t,a,l=e.props,n=l.timeObj,i=l.callBack,r=e.state,o=r.notes,s=(r.fileIds,r.fileList),c={note:o,attachments:s.length>0?[s[0].fileId]:[],milestoneEntryIds:n.milestoneEntryId};(t=n.milestoneEntryId[0],a=c,z.b.loading({content:"Loading...",key:t}),Ve.a.patch(ii+"milestoneEntriesUpdate",a,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message,r=l.data;return $(i),z.b.success({content:i,key:t}),n?(r.notes,r.attachment,K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),{success:n,data:r}):{success:n}})).catch((function(e){return z.b.error({content:e.message,key:t}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e.success&&(e.data.notes=o,i(e.data))}))},e.state={fileList:[],progress:0,fileIds:[],notes:void 0},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.visible,l=t.editTime,i=t.loading,r=t.close,o=(t.timeObj,this.state),s=o.fileList,c=o.notes;return n.a.createElement(wt.a,{title:l?"Edit Attachments & Notes":"Add Attachments & Notes",maskClosable:!1,centered:!0,visible:a,onOk:function(){e.addNotes()},okButtonProps:Object(Ne.a)({disabled:i},"disabled",!1),okText:i?n.a.createElement(Mt.a,null):"Save",onCancel:r,width:540},n.a.createElement(p.a,{gutter:[0,30]},n.a.createElement(b.a,{span:24},n.a.createElement("div",null,n.a.createElement(ni.a,{name:"file",multiple:!1,maxCount:1,listType:"picture",className:"upload-list-inline",disabled:!1,customRequest:this.handleUpload,onRemove:this.onRemove,fileList:s},s.length<1&&n.a.createElement(n.a.Fragment,null,n.a.createElement("p",{className:"ant-upload-drag-icon"},n.a.createElement(ei.a,null)),n.a.createElement("p",{className:"ant-upload-text"},"Click or drag file to this area to upload"))))),n.a.createElement(b.a,{span:24},n.a.createElement(ai.a,{placeholder:"Enter Your Notes....",autoSize:{minRows:3,maxRows:5},allowClear:!0,onChange:function(t){e.setState({notes:t.target.value})},value:c}))))}}]),a}(l.Component),ci=(a(286),a(193)),di=(a(521),ul.b),ui=function(e){var t=Object(l.useRef)(),a=Object(l.useState)([]),i=Object(he.a)(a,2),r=i[0],o=i[1],s=Object(l.useState)({}),c=Object(he.a)(s,2),d=(c[0],c[1],[{title:"Date",dataIndex:"date",key:"date",align:"center",width:50},{title:"Day",dataIndex:"day",key:"day",align:"center",width:50},{title:"Hours",dataIndex:"hours",key:"hours",width:80,children:[{title:"Start",dataIndex:"startTime",key:"startTime",align:"center",width:40},{title:"Finish",dataIndex:"endTime",key:"endTime",align:"center",width:40}]},{title:n.a.createElement("span",null,"Breaks ",n.a.createElement("br",null)," ",n.a.createElement("span",{style:{fontSize:9}},"minutes")),dataIndex:"breakMinutes",key:"breakMinutes",align:"center",width:40},{title:n.a.createElement("span",null,"Daily ",n.a.createElement("br",null)," Total ",n.a.createElement("span",{style:{fontSize:9}},"hours")),dataIndex:"actualHours",key:"actualHours",align:"center",width:40},{title:"Comments",dataIndex:"notes",key:"notes",align:"center",render:function(e){return e&&n.a.createElement(ve.a.Text,{ellipsis:!0},e)}}]);Object(l.useEffect)((function(){m()}),[]);var u=Object(ci.useReactToPrint)({content:function(){return t.current},documentTitle:"timesheet",removeAfterPrint:!0}),m=function(){var t,a={milestoneEntryIds:e.milestoneEntryId};return(t=a,Ve.a.post("".concat(ii,"print/milestoneEntries"),t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l?(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}):{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))).then((function(t){t.success&&(o(t.data),u(),e.close())})),!0};return n.a.createElement("div",{style:{display:"none"}},n.a.createElement("div",{ref:t,style:{margin:"2mm 10mm 0mm 10mm",size:"A4"}},r.map((function(e,t){return n.a.createElement("div",{key:t},n.a.createElement("div",{className:"sensitive"},n.a.createElement("p",null,"Sensitive: Personal (after first entry)")),n.a.createElement(p.a,{justify:"space-between",align:"middle"},n.a.createElement(b.a,null,n.a.createElement(ve.a.Title,{level:2,style:{margin:0}}," Timesheet ")),n.a.createElement(b.a,{style:{width:"60%",textAlign:"right"}},n.a.createElement("img",{src:"/z-cp-logo.png",width:200}))),"                                                      ",n.a.createElement(p.a,null,e&&n.a.createElement(ul.b,{column:2,bordered:!0,size:"small",style:{margin:"15px 0px"},className:"describe"},n.a.createElement(di,{label:"Company"}," ",e.company),n.a.createElement(di,{label:"Employee"},e.employee),n.a.createElement(di,{label:"Client",span:2}," ",e.milestone&&e.milestone.client),n.a.createElement(di,{label:"Project",span:2},e.milestone&&e.milestone.name),n.a.createElement(di,{label:"Client Contact"},e.milestone&&e.milestone.contact),n.a.createElement(di,{label:"Timesheet Period "},e.period))),n.a.createElement(Rt.a,{rowClassName:function(e){return"Sunday"===e.day||"Saturday"===e.day?"weekendClass":"weekClass"},className:"cellSize fs-small",rowKey:function(e){return e.id},bordered:!0,size:"small",pagination:!1,columns:d,dataSource:e.milestone&&e.milestone.entries,style:{fontSize:"10px"}}),n.a.createElement(ul.b,{column:3,bordered:!0,style:{marginBottom:20,marginTop:20},labelStyle:{padding:5},className:"describe"},n.a.createElement(di,{label:"Hours in Day "},e.milestone&&parseFloat(e.milestone.hoursPerDay).toFixed(2)),n.a.createElement(di,{label:"Total Hours "}," ",e.milestone&&parseFloat(e.milestone.totalHours).toFixed(2)," "),n.a.createElement(di,{label:"Invoiced Days "},e.milestone&&parseFloat(e.milestone.invoicedDays).toFixed(2))),n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,{span:11},"Employee Declaration"),n.a.createElement(b.a,{span:11},"Manager Approval")),n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,{span:11,style:{backgroundColor:"#deeaf6",minHeight:35}}),n.a.createElement(b.a,{span:11,style:{backgroundColor:"#deeaf6",minHeight:35}})),n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,{span:6},"Signature"),n.a.createElement(b.a,{span:5},"Date"),n.a.createElement(b.a,{span:2}),n.a.createElement(b.a,{span:6},"Signature"),n.a.createElement(b.a,{span:5},"Date")),n.a.createElement("div",{className:"b-sensitive-bottom"}," "))}))))},mi={R_STATUS:N,STATUS_COLOR:M,O_PHASE:F,O_PHASE_COLORS:{false:"red",true:"green"}},fi=function(e){var t,a,l=e.text,i=e.objName,r=e.colorName;return l&&"SV"!==l?n.a.createElement($t.a,{color:r?null===mi||void 0===mi||null===(t=mi[r])||void 0===t?void 0:t[l]:M[l]},i?null===mi||void 0===mi||null===(a=mi[i])||void 0===a?void 0:a[l]:N[l]):null},pi=ve.a.Title,bi=ve.a.Link,gi=(ve.a.Text,""),yi=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.fetchAll()},e.fetchAll=function(){Promise.all([Ve.a.get("".concat(ii,"milestones"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;return l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))]).then((function(t){var a=G(),l=a.id,n=a.permissions,i=parseInt(l),r=JSON.parse(n).TIMESHEETS;t[0].success&&t[0].data.length>0&&(t[0].data[0].value,t[0].data.forEach((function(e){e.value===i&&e.value}))),e.setState({milestones:t[0].success?t[0].data:[],permissions:null!==r&&void 0!==r?r:{},loginId:i},(function(){e.columns(),e.state.sMilestone&&e.getSheet()}))})).catch((function(e){console.log(e)}))},e.getSheet=function(){var t,a=e.state.sMilestone,l=e.state.sheetDates,n=l.startDate,i=l.endDate;a&&(t={mileId:a,startDate:n.format("DD-MM-YYYY"),endDate:i.format("DD-MM-YYYY")},Ve.a.get("".concat(ii,"milestone")+"/".concat(t.startDate,"&").concat(t.endDate,"&").concat(t.mileId),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=[];return l&&(n.timesheets.forEach((function(e){var t=Object(Fe.a)(Object(Fe.a)({},e),e.milestones[0]);delete t.milestones,i.push(t)})),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization)),console.log(i),{success:l,data:i}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))).then((function(t){var a;e.setState({data:t.success&&t.data&&null!==(a=t.data)&&void 0!==a?a:[],sTimesheet:{timesheet:[],keys:[]}})})),e.columns()},e.columns=function(){var t=e.state.sheetDates,a=t.startDate,l=t.endDate,i=e.state.columns,r=void 0;i=[i[0],i[1]];for(var o=a.format("D");o<=l.format("D");o++){var s;r=null!==(s=r)&&void 0!==s?s:T()(a.format()),i.push({title:n.a.createElement("span",null,n.a.createElement("div",null,r.format("ddd")),n.a.createElement("div",null," ",r.format("DD MMM")," ")),heading:n.a.createElement("span",null,r.format("dddd - DD MM YYYY")),dataIndex:r.format("D/M"),key:r.format("D/M"),width:200,editable:!0,align:"center",render:function(e,t,a){if(e){var l=T.a.duration(e.breakHours,"hours");return l=l&&T()(T()().hours(l.hours()).minutes(l.minutes())).format("HH:mm"),n.a.createElement($e.a,{title:e.notes&&"Note: ".concat(e.notes)},n.a.createElement(p.a,{style:{border:"1px solid"}},n.a.createElement(b.a,{span:24},"Start Time: ",e.startTime&&T()(e.startTime,["HH:mm"]).format("h:mm A")),n.a.createElement(b.a,{span:24},"End Time: ",e.endTime&&T()(e.endTime,["HH:mm"]).format("h:mm A")),n.a.createElement(b.a,{span:24},"Break: ",l&&l),n.a.createElement(b.a,{span:24},"Total Hours: ",e.actualHours&&e.actualHours))," ")}}}),r=r.add(1,"days")}e.setState({columns:i})},e.reviewTimeSheet=function(t,a,l,n){var i=e.state.sheetDates,r=i.startDate,o=i.endDate,s={pEntryId:t,userId:e.state.sMilestone,startDate:r.format("DD-MM-YYYY"),endDate:o.format("DD-MM-YYYY")};oi(s,a).then((function(t){var a=e.state.data;a[l].status=n,t.success&&e.setState({data:a})}))},e.actionTimeSheet=function(t,a){var l=e.state.sheetDates,n=l.startDate,i=l.endDate,r=e.state.sTimesheet.keys,o={userId:e.state.sMilestone,startDate:n.format("DD-MM-YYYY"),endDate:i.format("DD-MM-YYYY")},s={milestoneEntries:r,note:null===a||void 0===a?void 0:a.notes};oi(o,t,s).then((function(t){e.getSheet()}))},e.openAttachModal=function(t,a){console.log(t,a);var l={};if(a>=0)l={milestoneEntryId:[t.milestoneEntryId],milestoneId:t.milestoneId,notes:t.notes,milestone:t.milestone,status:t.status,rowIndex:a};else{var n=e.state.sTimesheet,i=n.keys,r=n.timesheet;l={milestoneEntryId:i,milestoneId:r[0].milestoneId,notes:r[0].notes,milestone:r[0].milestone,status:!1}}e.setState({timeObj:l,isAttach:!0})},e.exporPDF=function(t){console.log(t),e.setState({eData:t,isDownload:!0})},e.summaryFooter=function(t){var a=e.state.columns;if(t.length>0)return n.a.createElement(Rt.a.Summary,{fixed:"top"},n.a.createElement(Rt.a.Summary.Row,null,n.a.createElement(Rt.a.Summary.Cell,{index:0}," "),a.map((function(e,a){var l=e.key,i=(e.dateObj,0);return t.map((function(e,a){var n;"user"!==l&&(i+="totalHours"===l?null!==(n=t[a].totalHours)&&void 0!==n?n:0:e[l]?e[l].actualHours:0)})),"user"===l?n.a.createElement(Rt.a.Summary.Cell,{index:a+1,key:a+1},"Total Work In A day"):n.a.createElement(Rt.a.Summary.Cell,{index:a+1,key:a+1,align:"center"},i&&i.toFixed(2))}))))},e.milestoneSelect=function(t,a){var l=!0,n=!0,i=!0;a.forEach((function(e){"SB"===e.status&&(l=!1),"SB"===e.status&&(n=!1),"AP"===e.status&&(i=!1)})),e.setState({sTimesheet:{timesheet:a,keys:t,cantApprove:l,cantReject:n,cantUnapprove:i}})},e.onActionFinished=function(t,a){e.actionTimeSheet(a,t),gi.destroy()},e.multiAction=function(t){var a;console.log(t);var l=e.state.sheetDates.cMonth,i="Delete"!==t?n.a.createElement(p.a,null,n.a.createElement(b.a,{span:"24"},n.a.createElement(pi,{level:5},"Notes")),n.a.createElement(b.a,{span:"24"},n.a.createElement(Me.a,{id:"my-form",onFinish:function(a){return e.onActionFinished(a,t)}},n.a.createElement(Me.a.Item,{noStyle:!0,name:"notes"},n.a.createElement(Je.a.TextArea,{placeholder:"Enter Your Notes....",autoSize:{minRows:3,maxRows:10},allowClear:!0}))))):"";gi=wt.a.confirm({title:"".concat(t," timesheet for the month of ").concat(l.format("MMM YYYY")),width:520,icon:"Reject"===t?n.a.createElement(Jn.a,null):n.a.createElement(S.a,null),content:i,okButtonProps:{danger:null===(a="Delete"===t)||void 0===a||a,htmlType:"submit",form:"my-form"},okText:"Okay",cancelText:"Cancel"})},e.attachCallBack=function(t){var a=e.state,l=a.data,n=a.timeObj.rowIndex;n>=0?(l[n].notes=t.notes,l[n].attachment=t.attachment,e.setState({data:l,isAttach:!1,editTime:!1,timeObj:!1})):e.getSheet()},e.state={isAttach:!1,sheetDates:{startDate:T()().startOf("month"),endDate:T()().endOf("month"),cMonth:T()()},timeObj:!1,eData:[],sMilestone:null,loginId:null,data:[],permissions:{},milestones:[],actionNotes:"",sTimesheet:{timesheet:[],keys:[]},columns:[{title:"Employee",dataIndex:"user",key:"user",fixed:"left",width:300,style:{height:110},render:function(t,a,l){return n.a.createElement(p.a,{gutter:[0,10],style:{height:90}},n.a.createElement(b.a,{span:24},n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,{span:20}," ","".concat(t)," "),n.a.createElement(b.a,{style:{marginLeft:"auto"}},n.a.createElement($e.a,{placement:"top",title:"Export",destroyTooltipOnHide:!0},n.a.createElement(Xn.a,{onClick:function(){e.exporPDF([a.milestoneEntryId],l)}})),n.a.createElement("span",{className:"AP"===a.status?"disabledanticon":"anticon"},n.a.createElement($e.a,{placement:"top",title:"Upload",destroyTooltipOnHide:!0},n.a.createElement(Qn.a,{disabled:"AP"===a.status,onClick:function(){e.openAttachModal(a,l)},style:{color:"#1890ff",marginLeft:10}})))))),n.a.createElement(b.a,{span:24},n.a.createElement(p.a,{justify:"space-between"},a.attachment&&n.a.createElement(b.a,{span:16},n.a.createElement(bi,{href:"".concat(A,"/files/").concat(a.attachment.uid),download:a.attachment.name,target:"_blank",rel:"noopener noreferrer"},n.a.createElement(qa.a,null)," "," ",n.a.createElement($e.a,{placement:"top",title:a.attachment.name,destroyTooltipOnHide:!0},"".concat(a.attachment.name.substr(0,20)).concat(a.attachment.name.length>19?"\u2026":"")))),n.a.createElement(b.a,{style:{marginLeft:"auto"}},a.status&&n.a.createElement(fi,{text:a.status})),n.a.createElement(b.a,null,n.a.createElement($e.a,{placement:"top",title:a.actionNotes,destroyTooltipOnHide:!0},a.actionNotes&&n.a.createElement(Zn.a,{style:{fontSize:"small"}}))))))}},{title:"Total",dataIndex:"totalHours",key:"totalHours",fixed:"left",align:"center",width:100,render:function(e){return e&&e.toFixed(2)}}]},e}return Object(d.a)(a,[{key:"highlightRow",value:function(e){}},{key:"render",value:function(){var e=this,t=this.state,a=t.data,l=t.columns,i=t.timeObj,r=t.milestones,o=t.sMilestone,s=t.isAttach,c=t.isDownload,d=t.eData,u=t.sTimesheet,m=t.permissions;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(pi,{level:4},"Timesheet Approval")),n.a.createElement(b.a,null,n.a.createElement(Qe.a,{placeholder:"Select Project",style:{width:300},options:r,value:o,showSearch:!0,optionFilterProp:["label","value"],filterOption:function(e,t){var a=t.label.toLowerCase().indexOf(e.toLowerCase())>=0,l=t.value.toString().toLowerCase().indexOf(e.toLowerCase())>=0;return a||l},onSelect:function(t,a){e.setState({sMilestone:t},(function(){e.getSheet()}))}})),n.a.createElement(b.a,null,n.a.createElement(Ke.a,{mode:"month",picker:"month",format:"MMM-YYYY",onChange:function(t){e.setState({sheetDates:{cMonth:null!==t&&void 0!==t?t:T()(),startDate:T()(null!==t&&void 0!==t?t:T()()).startOf("month"),endDate:T()(null!==t&&void 0!==t?t:T()()).endOf("month")}},(function(){e.getSheet()}))},defaultValue:T()()}))),n.a.createElement(Rt.a,{sticky:!0,size:"small",style:{maxHeight:"fit-content"},className:"timeSheet-table fs-small",rowSelection:{selectedRowKeys:u.keys,fixed:!0,onChange:function(t,a){e.milestoneSelect(t,a)},getCheckboxProps:function(e){return{disabled:"SV"===e.timesheetStatus||"RJ"===e.timesheetStatus||"NC"===e.timesheetStatus||!m.UNAPPROVAL&&"AP"===e.timesheetStatus||!1===e.phase}}},scroll:{x:"'max-content'"},bordered:!0,pagination:!1,rowKey:"milestoneEntryId",columns:l,dataSource:Object(we.a)(a),summary:function(t){return e.summaryFooter(t)}}),n.a.createElement(p.a,{justify:"end",gutter:[20,200]},n.a.createElement(b.a,null," ",n.a.createElement(Be.a,{disabled:u.keys.length<1,onClick:function(){return e.openAttachModal()}},"Import")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",disabled:u.keys.length<1,onClick:function(){e.exporPDF(u.keys)}},"Export")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",danger:!0,disabled:u.keys.length<1||!m.APPROVAL||u.cantReject,onClick:function(){return e.multiAction("Reject")}},"Reject")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{className:"success",disabled:u.keys.length<1||!m.APPROVAL||u.cantApprove,onClick:function(){return e.multiAction("Approve")}},"Approve")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{className:"not-success",disabled:u.keys.length<1||!m.UNAPPROVAL||u.cantUnapprove,onClick:function(){return e.multiAction("Unapprove")}},"Unapprove"))),s&&n.a.createElement(si,{visible:s,timeObj:i,callBack:this.attachCallBack,close:function(){return e.setState({isAttach:!1,timeObj:!1})}}),c&&n.a.createElement(ui,{milestoneEntryId:d,close:function(){return e.setState({isDownload:!1})}}))}}]),a}(l.Component),hi=a(307),vi=a(616),Ei=a(617),ki=a(155),Si=a(118),Ci=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props,a=t.editTime,l=t.userId,n=JSON.parse(G().permissions).TIMESHEETS;e.setState({permissions:n},(function(){n.UPDATE&&e.getRecord(l,a||{startTime:T()("9:00",["HH:mm"]),endTime:T()("18:00",["HH:mm"])})}))},e.submit=function(){e.TimeRef.current&&e.TimeRef.current.refs.time_form.submit()},e.TimeCall=function(t){var a=e.props,l=a.editTime,n=a.timeObj,i=a.sheetDates.startDate,r=t.obj,o=i.format("YYYY");r.milestoneEntryId=n.milestoneEntryId,r.entryId=n.entryId,r.milestoneId=n.milestoneId,r.date=T()("".concat(n.col,"/").concat(o),"D/M/YYYY").format("DD-MM-YYYY"),r.startTime=r.startTime.format("HH:mm"),r.endTime=r.endTime.format("HH:mm"),r.breakHours=r.breakHours?T.a.duration(r.breakHours.format("HH:mm")).asHours():0,l?e.editRecord(l.entryId,r):e.addTime(r)},e.addTime=function(t){e.setState({loading:!0});var a=e.props,l=a.callBack,n=a.sheetDates,i=a.user,r=n.startDate,o=n.endDate;(function(e,t){return z.b.loading({content:"Loading...",key:1}),Ve.a.post(ii+"".concat(e.startDate,"&").concat(e.endDate,"&").concat(e.userId),t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l?(z.b.success({content:i,key:1}),n.actualHours=n.hours,K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}):{success:l}})).catch((function(e){return Q(e,1,5)}))})({userId:i,startDate:r.format("DD-MM-YYYY"),endDate:o.endOf("month").format("DD-MM-YYYY")},t).then((function(t){t.success?l(t.data,!0):e.setState({loading:!1})}))},e.editRecord=function(t,a){e.setState({loading:!0});var l=e.props.callBack;(function(e,t){return z.b.loading({content:"Loading...",key:1}),Ve.a.put(ii+"entries/".concat(e),t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l?(z.b.success({content:i,key:1}),n.actualHours=n.hours,K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}):{success:l}})).catch((function(e){return Q(e,1,5)}))})(t,a).then((function(e){e.success&&l(e.data,!1)}))},e.handleDelete=function(){var t=e.props,a=t.editTime,l=t.callBack;ri(a.entryId).then((function(e){e.success&&l({},!0)}))},e.getRecord=function(t,a){e.TimeRef.current.refs.time_form.setFieldsValue({obj:a})},e.TimeRef=n.a.createRef(),e.state={loading:!1,permissions:{},TimeFields:{formId:"time_form",justify:"center",FormCol:24,FieldSpace:{xs:12,sm:16,md:122},FormLayout:"inline",size:"middle",fields:[{object:"obj",fieldCol:8,key:"startTime",label:"Start",labelAlign:"right",type:"TimePicker",mode:"use12Hours",rangeMax:!1,rangeMin:15,size:"small",showTime:"hh:mm a"},{object:"obj",fieldCol:8,key:"endTime",label:"End",labelAlign:"right",type:"TimePicker",mode:"use12Hours",rangeMax:!1,rangeMin:15,size:"small",showTime:"hh:mm a"},{object:"obj",fieldCol:8,key:"breakHours",label:"Break",labelAlign:"right",rangeMin:15,rangeMax:!1,type:"TimePicker",size:"small",showTime:"HH:mm"},{object:"obj",fieldCol:24,style:{marginTop:"2%"},mode:{minRows:1,maxRows:3},key:"notes",label:"notes",labelAlign:"right",type:"Textarea",size:"small"}]}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.editTime,l=t.visible,i=t.close,r=t.timeObj,o=this.state,s=o.TimeFields,c=o.loading,d=o.permissions,u=a?d.UPDATE&&l:d.ADD&&l;return n.a.createElement(wt.a,{title:n.a.createElement(p.a,null,n.a.createElement(b.a,{flex:1}," ",a?"Edit Entry":"Add Entry"," "),n.a.createElement(b.a,{flex:4},n.a.createElement("b",null," ",r.title," "))),maskClosable:!1,centered:!0,visible:u,onOk:function(){e.submit()},okButtonProps:{disabled:c},onCancel:i,width:540,footer:[n.a.createElement(Be.a,{key:"cancel",onClick:i}," Cancel "),n.a.createElement(Be.a,{key:"ok",type:"primary",loading:c,onClick:function(){e.submit()}}," Save ")]},n.a.createElement(Kt,{ref:this.TimeRef,Callback:this.TimeCall,FormFields:s}))}}]),a}(l.Component),ji=ve.a.Title,Di=ve.a.Link,Oi=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.fetchAll()},e.fetchAll=function(){Ve.a.get("".concat(ii,"users"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(t){var a=0,l=G(),n=l.id,i=l.permissions,r=parseInt(n),o=JSON.parse(i).TIMESHEETS;t.success&&t.data.length>0&&(a=t.data.value,t.data.forEach((function(e){e.value===r&&(a=e.value)}))),e.setState({USERS:t.success?t.data:[],sUser:a,canApprove:o.APPROVAL&&o.APPROVAL.ANY,permissions:o,loginId:r},(function(){e.columns(),e.state.sUser&&e.getSheet()}))})).catch((function(e){console.log(e)}))},e.getProjects=function(t){var a,l;(a=t,l=0,Ve.a.get("".concat(A,"/helpers/milestones?userId=").concat(a,"&phase=").concat(l),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;return l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:le(n,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))).then((function(t){t.success&&e.setState({milestones:t.data})}))},e.getSheet=function(){var t,a=e.state,l=a.sUser,n=a.sheetDates,i=n.startDate,r=n.endDate;l&&(t={userId:l,startDate:i.format("DD-MM-YYYY"),endDate:r.format("DD-MM-YYYY")},Ve.a.get(ii+"".concat(t.startDate,"&").concat(t.endDate,"&").concat(t.userId),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message,data:[]}}))).then((function(t){var a,l,n;e.setState({timesheet:null!==(a=t.data)&&void 0!==a?a:{},data:null!==(l=null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.milestones)&&void 0!==l?l:[],sTMilestones:{milestones:[],keys:[]}})})),e.columns()},e.columns=function(){var t=e.state.sheetDates,a=t.sWeek,l=t.startDate,i=t.endDate,r=e.state,o=r.columns,s=r.sUser,c=r.loginId,d=r.permissions,u=void 0;o=[o[0],o[1]];for(var m=T()(a.format("YYYY-MM-DDTHH:mm:ss")).startOf("isoWeek"),f=T()(a.format("YYYY-MM-DDTHH:mm:ss")).endOf("isoWeek").diff(m,"days"),g=0;g<=f;g++){var y;u=null!==(y=u)&&void 0!==y?y:T()(m.format()),o.push({title:n.a.createElement("span",null,n.a.createElement("div",null,u.format("ddd")),n.a.createElement("div",null," ",u.format("DD MMM")," ")),heading:n.a.createElement("span",null,u.format("dddd - DD MM YYYY")),dateObj:T()(u.format()),dataIndex:u.format("D/M"),key:u.format("D/M"),className:(u.isBefore(l)||u.isAfter(i))&&"prevDates-TMcell",width:200,editable:!0,align:"center"}),u=u.add(1,"days")}e.setState({columns:o},(function(){var t=e.state.columns.map((function(t){return"project"===t.dataIndex||"totalHours"===t.dataIndex?t:Object(Fe.a)(Object(Fe.a)({},t),{},{render:function(a,r,o){if(!r.leaveRequest){var u=d&&d.DELETE&&d.DELETE.ANY||s===c,m=("SV"===r.status||"RJ"===r.status||!r.status)&&u&&!(!1===r.phase);if(a){var f=T.a.duration(a.breakHours,"hours");return f=f&&T()(T()().hours(f.hours()).minutes(f.minutes())).format("HH:mm"),n.a.createElement($e.a,{title:a.notes&&"Note: ".concat(a.notes)},n.a.createElement(p.a,{style:{border:"1px solid"}},n.a.createElement(b.a,{span:22},"Start Time: ",a.startTime&&T()(a.startTime,["HH:mm"]).format("h:mm A")),n.a.createElement(b.a,{span:2},m&&n.a.createElement(se.a,{placement:"bottomCenter",overlay:n.a.createElement(v.a,{onClick:e.handleMenuClick},n.a.createElement(v.a.Item,{disabled:s!==c,key:"Edit",onClick:function(){e.getRecord(r,o,t.dataIndex,t.heading)}},n.a.createElement(hi.a,null)),n.a.createElement(v.a.Item,{key:"delete",disabled:!d.DELETE,onClick:function(){e.deleteRecord(a,o,t.dataIndex)}},n.a.createElement(gl.a,null)))},n.a.createElement(vi.a,{style:{cursor:"pointer"}}))),n.a.createElement(b.a,{span:24},"End Time: ",a.endTime&&T()(a.endTime,["HH:mm"]).format("h:mm A")),n.a.createElement(b.a,{span:24},"Break: ",f&&f),n.a.createElement(b.a,{span:24},"Total Hours: ",a.actualHours&&a.actualHours)))}return m&&t.dateObj.isSameOrAfter(l)&&t.dateObj.isSameOrBefore(i)&&n.a.createElement(Ei.a,{style:{fontSize:24,color:"#1890ff"},onClick:function(){e.getRecord(r,o,t.dataIndex,t.heading)}})}if(a)return n.a.createElement($e.a,{title:a.notes&&"Note: ".concat(a.notes)},n.a.createElement(p.a,null,n.a.createElement(b.a,{span:24},"Off Hours: ",U(a.hours)),n.a.createElement(b.a,null,"Status: "),n.a.createElement(b.a,{style:{marginLeft:"auto",marginRight:5}},n.a.createElement(ce.b,{align:"end"},n.a.createElement(fi,{text:a.status}),n.a.createElement($e.a,{placement:"top",title:a.statusMsg,destroyTooltipOnHide:!0},a.statusMsg&&n.a.createElement(Zn.a,{style:{fontSize:"small"}}))))))}})}));e.setState({columns:t})}))},e.deleteRecord=function(t,a,l){ri(t.entryId).then((function(n){if(n.success){var i=e.state.data;delete i[a][l],i[a].totalHours=i[a].totalHours-t.actualHours,e.setState({data:i})}}))},e.getRecord=function(t,a,l,n){var i={milestoneEntryId:t.milestoneEntryId,milestoneId:t.milestoneId,milestone:t.milestone,row:a,col:l,title:n};if(t[l]){var r=t[l].breakHours,o=T.a.duration(r,"hours"),s={entryId:t[l].entryId,startTime:T()(t[l].startTime,"HH:mm")._isValid?T()(t[l].startTime,"HH:mm"):null,endTime:T()(t[l].endTime,"HH:mm")._isValid?T()(t[l].endTime,"HH:mm"):null,breakHours:o&&T()().hours(o.hours()).minutes(o.minutes()),notes:t[l].notes&&t[l].notes};e.setState({isVisible:!0,editTime:s,timeObj:i})}else e.setState({isVisible:!0,editTime:!1,timeObj:i})},e.callBack=function(t,a){var l=e.state,n=l.data,i=l.timeObj,r=i.row,o=i.col;if(t.entryId=t.id,n[r].milestoneEntryId=t.milestoneEntryId,a){var s,c;n[r][o]=t,n[r].totalHours=(null!==(s=n[r].totalHours)&&void 0!==s?s:0)+(null!==(c=t.actualHours)&&void 0!==c?c:0)}else{var d,u,m=n[r][o].actualHours;n[r][o]=t,n[r].totalHours=(null!==(d=n[r].totalHours)&&void 0!==d?d:0)+(null!==(u=t.actualHours)&&void 0!==u?u:0)-m}e.setState({data:n,timeObj:!1,isVisible:!1,editTime:!1})},e.reviewTimeSheet=function(t,a,l,n){var i=e.state.sheetDates,r=i.startDate,o=i.endDate,s={pEntryId:t,userId:e.state.sUser,startDate:r.format("DD-MM-YYYY"),endDate:o.format("DD-MM-YYYY")};oi(s,a).then((function(t){var a=e.state.data;t.success&&l>=0&&(a[l].status=n,e.setState({data:a}))}))},e.actionTimeSheet=function(t){var a=e.state.sheetDates,l=a.startDate,n=a.endDate,i=e.state.sTMilestones.keys,r={userId:e.state.sUser,startDate:l.format("DD-MM-YYYY"),endDate:n.format("DD-MM-YYYY")};oi(r,t,{milestoneEntries:i}).then((function(t){e.getSheet()}))},e.openAttachModal=function(t,a){var l={};if(t.milestoneEntryId){if(a>=0)l={milestoneEntryId:[t.milestoneEntryId],milestoneId:t.milestoneId,notes:t.notes,milestone:t.milestone,status:t.status,rowIndex:a};else{var n=e.state.sTimesheet,i=n.keys,r=n.timesheet;l={milestoneEntryId:i,milestoneId:r[0].milestoneId,notes:r[0].notes,milestone:r[0].milestone,status:!1}}e.setState({timeObj:l,isAttach:!0})}else e.exportUploadError()},e.exportUploadError=function(){z.b.error({content:"Can't Upload/Export To Timesheet Without Any Time Entry",key:"empty"},3)},e.attachCallBack=function(t){var a=e.state,l=a.data,n=a.timeObj.rowIndex;n>=0?(l[n].notes=t.notes,l[n].attachment=t.attachment,e.setState({data:l,isAttach:!1,editTime:!1,timeObj:!1})):e.getSheet()},e.exporPDF=function(t){var a,l,n=t?[t]:null===(a=e.state)||void 0===a||null===(l=a.sTimesheet)||void 0===l?void 0:l.keys;n?e.setState({eData:n,isDownload:!0}):e.exportUploadError()},e.summaryFooter=function(t){var a=e.state.columns,l=e.state.sheetDates,i=l.startDate,r=l.endDate;if(t.length>0)return n.a.createElement(Rt.a.Summary,{fixed:"top"},n.a.createElement(Rt.a.Summary.Row,null,n.a.createElement(Rt.a.Summary.Cell,{index:0}," "),a.map((function(e,a){var l=e.key,o=e.dateObj,s=0;return t.map((function(e,a){var n;"project"===l||e.leaveRequest||(s+="totalHours"===l?null!==(n=t[a].totalHours)&&void 0!==n?n:0:e[l]?e[l].actualHours:0)})),"project"===l?n.a.createElement(Rt.a.Summary.Cell,{index:a+1,key:a+1},"Total Hours"):"totalHours"===l||o&&o.isSameOrAfter(i)&&o.isSameOrBefore(r)?n.a.createElement(Rt.a.Summary.Cell,{index:a+1,key:a+1,align:"center"},U(s)):n.a.createElement(Rt.a.Summary.Cell,{index:a+1,key:a+1,align:"center",className:"prevDates-TMcell"},"0.00")}))))},e.milestoneSelect=function(t,a){e.setState({sTMilestones:{milestones:a,keys:t}})},e.multiAction=function(t){var a,l=e.state.sTMilestones,i=l.milestones,r=(l.keys,e.state.sheetDates.cMonth),o=n.a.createElement("div",null,i.map((function(e,t){var a=e.project,l=e.milestone,r=e.projectType;return n.a.createElement("div",{key:t},a,1===r&&" (".concat(l,")"),i.length-1>t&&",")}))),s=wt.a.confirm({title:"Do you wish to ".concat(t," timesheet for the month of ").concat(r.format("MMM YYYY")," ?"),icon:"Delete"===t?n.a.createElement(Jn.a,null):n.a.createElement(S.a,null),content:o,okButtonProps:{danger:null===(a="Delete"===t)||void 0===a||a},okText:"Okay",cancelText:"Cancel",onOk:function(){e.actionTimeSheet(t),s.destroy()}})},e.handleSelWeek=function(t){var a=e.state.sheetDates,l=a.sWeek,n=a.startDate,i=a.endDate,r=a.cMonth;if("pWeek"===t){var o=T()(l.subtract(7,"days"));l.isSame(n)||e.setState({sheetDates:Object(Fe.a)(Object(Fe.a)({},a),{},{sWeek:o.isSameOrAfter(n)?o:T()(r).startOf("month")})},(function(){return e.columns()}))}else if("nWeek"===t){var s=T()(l.add(7,"days"));l.isSame(i)||e.setState({sheetDates:Object(Fe.a)(Object(Fe.a)({},a),{},{sWeek:s.isSameOrBefore(i)?s:T()(r).endOf("month")})},(function(){return e.columns()}))}},e.state={isVisible:!1,proVisible:!1,isAttach:!1,sheetDates:{startDate:T()().startOf("month"),endDate:T()().endOf("month"),cMonth:T()(),sWeek:T()()},timeObj:!1,editTime:!1,loading:!1,eData:[],USERS:[],sUser:null,loginId:null,data:[],comments:null,sMilestone:{},permissions:{},canApprove:!1,milestones:[],sTMilestones:{milestones:[],keys:[]},columns:[{title:"Project",dataIndex:"project",key:"project",fixed:"left",width:300,render:function(t,a,l){return a.leaveRequest?n.a.createElement(p.a,{gutter:[0,10]},n.a.createElement(b.a,{span:24},a.leaveType),n.a.createElement(b.a,{span:24},t," ")):n.a.createElement(p.a,{gutter:[0,10],style:{height:90}},n.a.createElement(b.a,{span:24},n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,{span:20},n.a.createElement("div",null,n.a.createElement(s.b,{to:{pathname:"/projects/".concat(a.projectId,"/info")},className:"nav-link"}," ",t," ")),1===a.projectType&&n.a.createElement("div",null,n.a.createElement(s.b,{to:{pathname:"/projects/".concat(a.projectId,"/milestones/").concat(a.milestoneId,"/resources")},className:"nav-link"},"(",a.milestone,")"))),n.a.createElement(b.a,{style:{marginLeft:"auto"}},n.a.createElement($e.a,{placement:"top",title:"Export",destroyTooltipOnHide:!0},n.a.createElement(Xn.a,{onClick:function(){e.exporPDF(a.milestoneEntryId,l)}})),n.a.createElement("span",{className:"AP"===a.status?"disabledanticon":"anticon"},n.a.createElement($e.a,{placement:"top",title:"Upload",destroyTooltipOnHide:!0},n.a.createElement(Qn.a,{disabled:"AP"===a.status,onClick:function(){e.openAttachModal(a,l)},style:{color:"#1890ff",marginLeft:10}})))))),n.a.createElement(b.a,{span:24},n.a.createElement(p.a,{justify:"space-between"},a.attachment&&n.a.createElement(b.a,{span:16},n.a.createElement(Di,{href:"".concat(A,"/files/").concat(a.attachment.uid),download:a.attachment.name,target:"_blank",rel:"noopener noreferrer"},n.a.createElement(qa.a,null),n.a.createElement($e.a,{placement:"top",title:a.attachment.name,destroyTooltipOnHide:!0},"".concat(a.attachment.name.substr(0,20)).concat(a.attachment.name.length>19?"\u2026":"")))),n.a.createElement(b.a,{style:{marginLeft:"auto"}},a.status&&n.a.createElement(fi,{text:a.status})),n.a.createElement(b.a,null,n.a.createElement($e.a,{placement:"top",title:a.actionNotes,destroyTooltipOnHide:!0},a.actionNotes&&n.a.createElement(Zn.a,{style:{fontSize:"small"}}))))))}},{title:"Monthly Total",dataIndex:"totalHours",key:"totalHours",fixed:"left",align:"center",width:100,render:function(e,t){return!t.leaveRequest&&U(e)}}]},e}return Object(d.a)(a,[{key:"delRow",value:function(e){var t=this.state.data.filter((function(t,a){return a!=e}));this.setState({data:t})}},{key:"highlightRow",value:function(e){}},{key:"render",value:function(){var e,t=this,a=this.state,l=a.loading,i=a.data,r=a.isVisible,o=a.proVisible,s=a.columns,c=a.editTime,d=a.timeObj,u=a.sheetDates,m=a.milestones,f=a.sMilestone,g=a.isAttach,y=a.isDownload,h=a.eData,v=a.USERS,E=a.sUser,k=a.loginId,S=a.sTMilestones,C=a.permissions,j=S.keys.length<1&&(E!==k||!!(null===C||void 0===C||null===(e=C.DELETE)||void 0===e?void 0:e.ANY)),D=this.state.sheetDates,O=D.sWeek,I=D.startDate,P=D.endDate;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(ji,{level:4},"Timesheet Submission")),n.a.createElement(b.a,null,n.a.createElement(Qe.a,{placeholder:"Select User",options:v,value:E,style:{width:300},showSearch:!0,optionFilterProp:["label","value"],filterOption:function(e,t){var a=t.label.toLowerCase().indexOf(e.toLowerCase())>=0,l=t.value.toString().toLowerCase().indexOf(e.toLowerCase())>=0;return a||l},onSelect:function(e,a){t.setState({sUser:e},(function(){t.getSheet()}))}})),n.a.createElement(b.a,null,n.a.createElement(Ke.a,{mode:"month",picker:"month",format:"MMM-YYYY",onChange:function(e){t.setState({sheetDates:{cMonth:null!==e&&void 0!==e?e:T()(),startDate:T()(null!==e&&void 0!==e?e:T()()).startOf("month"),sWeek:T()(null!==e&&void 0!==e?e:T()()).startOf("month"),endDate:T()(null!==e&&void 0!==e?e:T()()).endOf("month")}},(function(){t.getSheet()}))},defaultValue:T()()})),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",disabled:E!==k,onClick:function(){t.getProjects(E),t.setState({proVisible:!0})}},"Add Project"))),n.a.createElement(p.a,{justify:"end"},n.a.createElement(b.a,null,n.a.createElement(Be.a,{disabled:O.isSameOrBefore(I),value:"pWeek",onClick:function(){return t.handleSelWeek("pWeek")}}," ",n.a.createElement(ki.a,null)),n.a.createElement(Be.a,{disabled:O.isSameOrAfter(P),value:"nWeek",onClick:function(){return t.handleSelWeek("nWeek")}},"  ",n.a.createElement(Si.a,null)))),n.a.createElement(Rt.a,{sticky:!0,size:"small",style:{maxHeight:"fit-content"},className:"timeSheet-table fs-small",rowSelection:{onChange:function(e,a){t.milestoneSelect(e,a)},getCheckboxProps:function(e){return{disabled:"SB"===e.status||"AP"===e.status||e.leaveRequest||!1===e.phase}}},scroll:{x:"'max-content'"},bordered:!0,pagination:!1,rowKey:function(e){return e.milestoneEntryId},columns:s,dataSource:Object(we.a)(i),summary:function(e){return t.summaryFooter(e)}}),n.a.createElement(p.a,{justify:"end",gutter:[20,200]},n.a.createElement(b.a,null,n.a.createElement(Be.a,{className:"success",disabled:E!==k||S.keys.length<1,onClick:function(){return t.multiAction("Submit")}},"Submit")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",danger:!0,disabled:j,onClick:function(){return t.multiAction("Delete")}},"Delete"))),r&&n.a.createElement(Ci,{visible:r,timeObj:d,editTime:c,sheetDates:u,user:E,close:function(){return t.setState({isVisible:!1,editTime:!1,timeObj:!1})},callBack:this.callBack}),g&&n.a.createElement(si,{visible:g,timeObj:d,close:function(){return t.setState({isAttach:!1,editTime:!1,timeObj:!1})},callBack:this.attachCallBack}),y&&n.a.createElement(ui,{milestoneEntryId:h,close:function(){return t.setState({isDownload:!1})}}),o&&n.a.createElement(wt.a,{title:"Add Project",maskClosable:!1,centered:!0,visible:o,okButtonProps:{disabled:l},okText:l?n.a.createElement(Mt.a,null):"Add",width:550,onCancel:function(){t.setState({proVisible:!1,sMilestone:{}})},onOk:function(){var e=t.state,a=e.data,l=e.sMilestone;if(a.findIndex((function(e){return e.milestoneId===l.value}))>=0)z.b.error({content:"Project TimeSheet is already created...!"},5);else{var n=a.findIndex((function(e){return e.leaveRequest})),i=-1===n?a.length:n;a.splice(i,0,{milestoneId:l.value,project:l.label,phase:!0})}t.setState({proVisible:!1,data:Object(we.a)(a),sMilestone:{}})}},n.a.createElement(p.a,{justify:"center"},n.a.createElement(b.a,{span:22},n.a.createElement(Qe.a,{placeholder:"Select Project",style:{width:"100%"},options:m,value:f.value,showSearch:!0,optionFilterProp:["label","value"],filterOption:function(e,t){var a=t.label.toLowerCase().indexOf(e.toLowerCase())>=0,l=t.value.toString().toLowerCase().indexOf(e.toLowerCase())>=0;return a||l},onSelect:function(e,a){t.setState({sMilestone:a})}})))))}}]),a}(l.Component),Ii=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){if(console.log(e.props),e.props.editOff){e.getRecord(e.state.data);e.state.default_hour}},e.submit=function(){e.timeRef.current.refs.off_form.submit()},e.BasicCall=function(t){var a=t.obj;e.props.editOff?(console.log("edit"),e.editRecord(a)):(console.log("emes"),e.addTimeOff(a))},e.addTimeOff=function(t){var a=e.props,l=a.rows,n=a.callBack;e.setState({loading:!0}),t.key=l,n(t,!1),e.onCancel()},e.getRecord=function(t){var a=t;console.log(a),e.timeRef.current.refs.off_form.setFieldsValue({obj:a})},e.editRecord=function(t){e.setState({loading:!0});var a=e.props,l=a.editOff,n=a.callBack;t.key=l,n(t,l),e.onCancel()},e.onCancel=function(){var t=e.state.timeFields;delete t.initialValues,e.setState({basicSubmitted:!1,timeFields:Object(Fe.a)({},t)},(function(){e.props.close()}))},e.timeRef=n.a.createRef(),e.state={data:{type:"Sick Leave",b_date:T()("Nov 25 2020"),e_date:T()("Nov 25 2020"),h_off:8,d_off:1,desc:"I was sick"},default_hour:8,hasChanged:!1,loading:!1,timeFields:{formId:"off_form",FormCol:24,justifyField:"center",FormLayout:"inline",layout:{labelCol:{span:10},wrapperCol:{span:0}},size:"middle",fields:[{Placeholder:"TimeOff Type",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"type",size:"small",type:"Select",data:[{value:"Sick Leave",label:"Sick Leave"},{value:"Vacations",label:"Vacations"},{value:"Training",label:"Training"}]},{Placeholder:"Begin Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"End Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"b_date",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},onBlur:function(e){var t=this.state,a=t.default_hour;if(t.hasChanged){var l=this.timeRef.current.refs.off_form.getFieldsValue().obj,n=l.b_date.format("YYYY MMM D");l.d_off=l.e_date.diff(n,"days")+1,console.log(l.d_off),l.h_off=l.d_off*a,this.timeRef.current.refs.off_form.setFieldsValue({obj:l}),this.setState({hasChanged:!1})}}.bind(Object(Aa.a)(e)),onChange:function(e){this.setState({hasChanged:!0})}.bind(Object(Aa.a)(e))},{object:"obj",fieldCol:12,key:"e_date",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},onBlur:function(e){var t=this.state,a=t.default_hour;if(t.hasChanged){var l=this.timeRef.current.refs.off_form.getFieldsValue().obj;l.b_date=l.b_date?l.b_date:T()();var n=l.b_date.format("YYYY MMM D");l.d_off=l.e_date.diff(n,"days")+1,console.log(l.d_off),l.h_off=l.d_off*a,this.timeRef.current.refs.off_form.setFieldsValue({obj:l}),this.setState({hasChanged:!1})}}.bind(Object(Aa.a)(e)),onChange:function(e){this.setState({hasChanged:!0})}.bind(Object(Aa.a)(e))},{Placeholder:"Hours",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Days",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"h_off",size:"small",type:"InputNumber",fieldStyle:{width:"100%"},onBlur:function(e){var t=this.state,a=t.default_hour;if(t.hasChanged){var l=this.timeRef.current.refs.off_form.getFieldsValue().obj;l.d_off=l.h_off/a,l.b_date=l.b_date?l.b_date:T()();var n=l.d_off<=1?0:Math.ceil(l.d_off)-1;l.e_date=T()(l.b_date).add(n,"d"),this.timeRef.current.refs.off_form.setFieldsValue({obj:l}),this.setState({hasChanged:!1})}}.bind(Object(Aa.a)(e)),onChange:function(e){this.setState({hasChanged:!0})}.bind(Object(Aa.a)(e))},{object:"obj",fieldCol:12,key:"d_off",size:"small",type:"InputNumber",fieldStyle:{width:"100%"},onBlur:function(e){var t=this.state,a=t.default_hour;if(t.hasChanged){var l=this.timeRef.current.refs.off_form.getFieldsValue().obj;l.h_off=l.d_off*a,l.b_date=l.b_date?l.b_date:T()();var n=l.d_off<=1?0:Math.ceil(l.d_off)-1;l.e_date=T()(l.b_date).add(n,"d"),this.timeRef.current.refs.off_form.setFieldsValue({obj:l})}}.bind(Object(Aa.a)(e)),onChange:function(e){this.setState({hasChanged:!0})}.bind(Object(Aa.a)(e))},{Placeholder:"Descriptions",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"desc",size:"small",type:"Textarea"},{Placeholder:"Attachments",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"attach",size:"small",mode:"",Placeholder:n.a.createElement(n.a.Fragment,null,"Click or drag & Drop ",n.a.createElement(zl.a,null)),type:"Dragger",labelAlign:"right",valuePropName:"fileList",getValue:!0}]}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.editOff,l=t.visible,i=this.setState,r=i.timeFields,o=i.loading;return n.a.createElement(wt.a,{title:a?"Edit Time Off":"Add Time Off",maskClosable:!1,centered:!0,visible:l,onOk:function(){e.submit()},okButtonProps:{disabled:o},okText:o?n.a.createElement(Mt.a,null):"Save",onCancel:this.onCancel,width:900},n.a.createElement(Kt,{ref:this.timeRef,Callback:this.BasicCall,FormFields:r}))}}]),a}(l.Component),Pi=ve.a.Title,xi=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).handleDelete=function(e){var t=Object(we.a)(l.state.data);l.setState({data:t.filter((function(t){return t.code!==e}))})},l.callBack=function(e,t){var a=l.state.data;!1===t?l.setState({data:[].concat(Object(we.a)(a),[e])}):(a[t]=e,l.setState({data:a}))},l.getRecord=function(e){l.setState({FormFields:Object(Fe.a)(Object(Fe.a)({},l.state.FormFields),{},{initialValues:{obj:e}}),editOff:e.key}),l.toggelModal(!0)},l.editRecord=function(e){e.key=l.state.editOff,e.code=e.key,l.state.data[e.key-1]=e,l.setState({data:Object(we.a)(l.state.data),mergeObj:{}},(function(){l.toggelModal(!1)}))},l.closeModal=function(){l.setState({infoModal:!1,editEmp:!1})},l.contactForm=n.a.createRef(),l.columns=[{title:"Type",dataIndex:"type",key:"type"},{title:"Descriptions",dataIndex:"desc",key:"desc"},{title:"Hours off",dataIndex:"h_off",key:"h_off"},{title:"Days Off",dataIndex:"d_off",key:"d_off"},{title:"Begin Date",dataIndex:"b_date",key:"b_date"},{title:"End Date",dataIndex:"e_date",key:"e_date"},{title:"Status",dataIndex:"status",key:"status"},{title:"...",key:"action",align:"center",width:"1%",render:function(e){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{danger:!0},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(e.code)}},"Delete")),n.a.createElement(v.a.Item,{onClick:function(){l.setState({infoModal:!0,editOff:e.key})}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],l.col_Status=[{title:"Type",dataIndex:"type",key:"type"},{title:"Earned + Forwarded",dataIndex:"earn_f",key:"earn_f"},{title:"Consumed",dataIndex:"consumed",key:"consumed"},{title:"Available",dataIndex:"available",key:"available"}],l.state={data:[{key:1,type:"Sick Leaves",desc:"I was sick",h_off:8,d_off:1,b_date:"25 Nov 2020",e_date:"25 Nov 2020",status:"Approved"},{key:2,type:"Vacations",desc:"I want to go on trip",h_off:32,d_off:4,b_date:"12 Nov 2020",e_date:"16 Nov 2020",status:"Approved"},{key:3,type:"Training",desc:"I am expending my skills",h_off:8,d_off:1,b_date:"10 Oct 2020",e_date:"10 Oct 2020",status:"Approved"}],data_status:[{key:1,type:"Sick Leaves",earn_f:60,consumed:25,available:35},{key:2,type:"Vacations",earn_f:40,consumed:32,available:8},{key:3,type:"Training",earn_f:120,consumed:96,available:24}],infoModal:!1,editOff:!1},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.data,l=t.data_status,i=t.infoModal,r=t.editOff;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{gutter:[0,100]},n.a.createElement(b.a,{span:24},n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Pi,{level:4},"Time Offs")),n.a.createElement(b.a,{style:{textAlign:"end"},span:4},n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Be.a,{size:"small"}," ",n.a.createElement(Ft.a,null),"Filter")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",onClick:function(){e.setState({infoModal:!0})},size:"small"}," ",n.a.createElement(Nt.a,null),"Add Timeoff")))),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{bordered:!0,columns:this.columns,dataSource:a,size:"small",className:"fs-small"})))),n.a.createElement(b.a,{span:24},n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Pi,{level:4},"Time Offs Status")),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{bordered:!0,columns:this.col_Status,dataSource:l,size:"small",className:"fs-small"}))))),i&&n.a.createElement(Ii,{visible:i,editOff:r,close:this.closeModal,callBack:this.callBack}))}}]),a}(l.Component),Ti="".concat(A,"/opportunities"),zi=function(e){return Ve.a.get(Ti+"/".concat(e),{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;if($(n),a){var i,r,o,s,c,d={id:l.id,panelId:l.panelId,organizationId:l.organizationId,organizationName:l.organization&&l.organization.name,ContactName:l.contactPerson&&"".concat(null!==(i=l.contactPerson.firstName)&&void 0!==i?i:"","  ").concat(null!==(r=l.contactPerson.lastName)&&void 0!==r?r:""," - ").concat(null!==(o=l.contactPerson.phoneNumber)&&void 0!==o?o:""),contactPersonId:l.contactPersonId,qualifiedOps:l.qualifiedOps,type:l.type,status:l.status,phase:l.phase,title:l.title,stateId:l.stateId,stage:l.stage,linkedWorkId:l.linkedWorkId,mileId:!!(l.milestones&&l.milestones.length>0)&&l.milestones[0].id},u={tender:l.tender,tenderNumber:l.tenderNumber},m={cmPercentage:l.cmPercentage?l.cmPercentage:0,cm$:(l.value*l.cmPercentage/100).toFixed(2),getPercentage:l.getPercentage?l.getPercentage:0,goPercentage:l.goPercentage?l.goPercentage:0,totalMonths:l.startDate&&l.endDate?Math.ceil(W(l.endDate).diff(W(l.startDate),"months",!0)):0,endDate:W(l.endDate),startDate:W(l.startDate),value:l.value?l.value:0};m.goget=(m.getPercentage*m.goPercentage/100).toFixed(2),m.discount=(l.value*m.goget/100).toFixed(2),m.upside=(l.value-m.discount).toFixed(2);var f={hoursPerDay:l.hoursPerDay,entryDate:W(l.entryDate),startDate:W(l.startDate),endDate:W(l.endDate),bidDate:W(l.bidDate)},p={accountDirectorId:l.accountDirectorId,accountManagerId:l.accountManagerId,opportunityManagerId:l.opportunityManagerId},b=null!==(s=l.milestones)&&void 0!==s?s:[];return l.ContactName=l.contactPerson&&l.contactPerson.firstName+" "+l.contactPerson.lastName,K(null===e||void 0===e||null===(c=e.headers)||void 0===c?void 0:c.authorization),{success:a,data:l,basic:d,tender:u,billing:m,dates:f,manage:p,milestones:b}}return{success:a}})).catch((function(e){var t;if(null===(t=e.response)||void 0===t?void 0:t.data){var a,l=e.response.status,n=null===(a=e.response)||void 0===a?void 0:a.data,i=n.message;return{authError:"Not Authorized!"===i,status:l,success:n.success,message:i}}return{error:"Please login again!",status:!1,message:e.message}}))},Ai=function(e,t,a){return z.b.loading({content:"Loading...",key:a}),Ve.a.post("".concat(A).concat(e),t,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.data,r=l.message;return $(r),z.b.success({content:r,key:a}),n&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:n,data:i[0]}})).catch((function(e){return Q(e,a,5)}))},Ri=function(e){return Ve.a.get("".concat(A).concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l?(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}):{success:l}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},wi=function(e,t,a){return z.b.loading({content:"Loading...",key:t}),Ve.a.put("".concat(A).concat(e,"/").concat(t),a,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.data,r=l.message;return $(r),z.b.success({content:r,key:t}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),{success:n,data:i&&i[0]}})).catch((function(e){return Q(e,t,5)}))},Fi=function(e){return Ve.a.get("".concat(Ti,"/").concat(e,"/hierarchy"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))},Ni=el.a.TabPane,Mi=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.fetchAll()},e.fetchAll=function(){var t=e.props,a=t.editLead,l=t.project,n=e.state,i=n.ManageFields,r=n.DatesFields,o=n.BasicFields;l&&(i[4].Placeholder="Project Manager",i[5].key="projectManagerId",r[0].rangeMin=!0,r[2].rules=[{required:!0,message:"Start Date is Required"}],r[1].rangeMin=!0,r[3].rules=[{required:!0,message:"End Date is Required"}],r[4].rangeMin=!0,r[6].rules=[{required:!0,message:"Dailty Hours is Required"}]),a&&(o[10].disabled=!0);Promise.all([Et(),vt(),pt(),ht("helpers/contact-persons?active=1&employee=1&associated=1&label=1"),a&&e.getRecord(a),St()]).then((function(t){var a=e.state,l=a.BasicFields,n=a.ManageFields;t[1].success&&(t[1].data[0].disabled=!0),l[2].data=t[0].success?t[0].data:[],l[3].data=t[1].success?t[1].data:[],l[11].data=t[2].success?t[2].data:[],l[6].data=t[4].success?t[4].data:[],l[17].data=t[5].success?t[5].data:[],n[2].data=t[3].success?t[3].data:[],n[3].data=t[3].success?t[3].data:[],n[5].data=t[3].success?t[3].data:[],e.setState({BasicFields:l,ManageFields:n,DatesFields:r})})).catch((function(e){console.log(e)}))},e.onFinish=function(t){var a,l,n,i,r,o,s,c,d,u,m,f,p,b,g,y,h,v,E;e.setState({loading:!0});var k=t.basic,S=t.tender,C=t.dates,j=t.billing,D=t.manage,O=e.props.editLead,I={panelId:null!==(a=k.panelId)&&void 0!==a?a:null,organizationId:null!==(l=k.organizationId)&&void 0!==l?l:null,contactPersonId:null!==(n=k.contactPersonId)&&void 0!==n?n:null,title:null!==(i=k.title)&&void 0!==i?i:"",type:null!==(r=k.type)&&void 0!==r?r:"",stateId:null!==(o=k.stateId)&&void 0!==o?o:null,qualifiedOps:null!==(s=k.qualifiedOps)&&void 0!==s&&s,stage:null!==(c=k.stage)&&void 0!==c?c:null,linkedWorkId:null!==(d=k.linkedWorkId)&&void 0!==d?d:null,tender:null!==(u=S.tender)&&void 0!==u?u:"",tenderNumber:null!==(m=S.tenderNumber)&&void 0!==m?m:"",value:null!==(f=j.value)&&void 0!==f?f:0,cmPercentage:null!==(p=j.cmPercentage)&&void 0!==p?p:0,goPercentage:null!==(b=j.goPercentage)&&void 0!==b?b:0,getPercentage:null!==(g=j.getPercentage)&&void 0!==g?g:0,accountDirectorId:null!==(y=D.accountDirectorId)&&void 0!==y?y:null,accountManagerId:null!==(h=D.accountManagerId)&&void 0!==h?h:null,opportunityManagerId:null!==(v=D.opportunityManagerId)&&void 0!==v?v:null,projectManagerId:null!==(E=D.projectManagerId)&&void 0!==E?E:null,hoursPerDay:C.hoursPerDay,startDate:W(C.startDate,!0),endDate:W(C.endDate,!0),bidDate:W(C.bidDate,!0),entryDate:W(C.entryDate,!0)};O?e.editProject(I):e.addOpportunity(I)},e.addOpportunity=function(t){var a,l=e.props.callBack;(a=t,z.b.loading({content:"Loading...",key:1},5),Ve.a.post(Ti,a,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1},5),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return Q(e,1,5)}))).then((function(t){t.success?l():e.setState({loading:!1})}))},e.editProject=function(t){e.props.project?e.workWon(t):e.editRecord(t)},e.getRecord=function(t){return zi(t).then((function(t){if(t.success){var a=t.basic,l=t.tender,n=t.billing,i=t.dates,r=t.manage;e.formRef.current.setFieldsValue({basic:a,tender:l,billing:n,dates:i,manage:r});var o="helpers/contact-persons?organizationId=".concat(a.organizationId,"&associated=1");return ht(o).then((function(e){return{success:e.success,data:e.data}}))}}))},e.editRecord=function(t){var a,l=e.props,n=l.editLead,i=l.callBack;t.id=n,(a=t,z.b.loading({content:"Loading...",key:a.id}),Ve.a.put(Ti+"/".concat(a.id),a,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:a.id},5),n&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:n}})).catch((function(e){return Q(e,a.id,5)}))).then((function(t){t.success?i():e.setState({loading:!1})}))},e.workWon=function(t){var a,l,n=e.props,i=n.editLead,r=n.callBack;console.log("workWon"),(a=i,l=t,z.b.loading({content:"Loading...",key:a}),Ve.a.put(Ti+"/".concat(a,"/win"),l,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:a}),n&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:n}})).catch((function(e){return Q(e,a,5)}))).then((function(t){t.success?r():e.setState({loading:!1})}))},e.formRef=n.a.createRef(),e.state={editLead:!1,formSubmitted:!1,check:!1,leadValue:0,SKILLS:[],STATES:[],ORGS:[],loading:!1,BasicFields:[{Placeholder:"Panel",rangeMin:!0,fieldCol:12,size:"small",type:"Text"},{Placeholder:"Organisation",rangeMin:!0,fieldCol:12,size:"small",type:"Text"},{object:"basic",fieldCol:12,key:"panelId",size:"small",rules:[{required:!0,message:"Panel is Required"}],data:[],type:"Select"},{object:"basic",fieldCol:12,key:"organizationId",size:"small",rules:[{required:!0,message:"Organisation is Required"}],data:[],type:"Select",onChange:function(t){if(t){var a="helpers/contact-persons?organizationId=".concat(t,"&associated=1");ht(a).then((function(t){if(t.success){var a=e.state.BasicFields;a[6].data=t.data,e.setState({BasicFields:a})}}))}else{var l=e.state.BasicFields;l[6].data=[];var n=e.formRef.current.getFieldsValue().basic;n.contactPersonId=void 0,e.formRef.current.setFieldsValue({basic:n}),e.setState({BasicFields:l})}}},{Placeholder:"Delegate Contact Person",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Name",rangeMin:!0,fieldCol:12,size:"small",type:"Text"},{object:"basic",fieldCol:12,key:"contactPersonId",size:"small",data:[],type:"Select"},{object:"basic",fieldCol:12,key:"title",size:"small",rules:[{required:!0,message:"Name is Required"}],type:"Input"},{Placeholder:"Type",rangeMin:!0,fieldCol:12,size:"small",type:"Text"},{Placeholder:"State",fieldCol:12,size:"small",type:"Text"},{object:"basic",fieldCol:12,key:"type",size:"small",rules:[{required:!0,message:"Type is Required"}],data:[{label:"Milestone",value:1},{label:"Time & Materials",value:2}],type:"Select"},{object:"basic",fieldCol:12,key:"stateId",size:"small",data:[],type:"Select",itemStyle:{marginBottom:"10px"}},{Placeholder:"Qualified Ops",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Stage",fieldCol:12,size:"small",type:"Text"},{object:"basic",fieldCol:12,key:"qualifiedOps",size:"small",data:[{label:"True",value:!0},{label:"False",value:!1}],itemStyle:{marginBottom:1},type:"Select"},{object:"basic",fieldCol:12,key:"stage",size:"small",data:[{label:"Lead",value:"L"},{label:"Tender Released",value:"TR"},{label:"Bid Development",value:"BD"},{label:"Bid Submitted",value:"BS"}],itemStyle:{marginBottom:1},type:"Select"},{Placeholder:"Linked Project",fieldCol:24,size:"small",type:"Text"},{object:"basic",fieldCol:12,key:"linkedWorkId",size:"small",data:[],itemStyle:{marginBottom:1},type:"Select"}],tenderFields:[{Placeholder:"Tender Title",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Tender Number",size:"small",fieldCol:12,type:"Text"},{object:"tender",fieldCol:12,key:"tender",size:"small",type:"Input"},{object:"tender",fieldCol:12,key:"tenderNumber",size:"small",type:"Input"}],BillingFields:[{Placeholder:"Estimated Value",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Contribution Margin as a %",size:"small",fieldCol:12,type:"Text"},{object:"billing",fieldCol:12,key:"value",size:"small",shape:"$",type:"InputNumber",onChange:function(t){var a=e.formRef.current.getFieldsValue().billing;a.cm$=U(a.cmPercentage?t*a.cmPercentage/100:0),a.discount=U(a.goget?t*a.goget/100:0),a.upside=U(a.discount?t-a.discount:0),e.formRef.current.setFieldsValue({billing:a})},fieldStyle:{width:"100%"}},{object:"billing",fieldCol:12,key:"cmPercentage",size:"small",shape:"%",type:"InputNumber",rangeMin:0,rangeMax:100,fieldStyle:{width:"100%"},onChange:function(t){var a=e.formRef.current.getFieldsValue().billing;a.cm$=(a.value?a.value*t/100:0).toFixed(2),e.formRef.current.setFieldsValue({billing:a})}},{Placeholder:"Contribution Margin",size:"small",fieldCol:12,type:"Text"},{fieldCol:12,Placeholder:"Go:",type:"Text",size:"small",tooltip:!0,tooltipTitle:"Likelihood Of Opportunity Going Live"},{object:"billing",fieldCol:12,key:"cm$",size:"small",shape:"$",disabled:!0,type:"InputNumber",fieldStyle:{width:"100%"}},{object:"billing",fieldCol:12,key:"goPercentage",size:"small",shape:"%",type:"InputNumber",fieldStyle:{width:"100%"},rangeMin:0,rangeMax:100,onChange:function(t){var a=e.formRef.current.getFieldsValue().billing;a.goget=(a.getPercentage?a.getPercentage*t/100:0).toFixed(2),a.discount=(a.goget&&a.value?a.value*a.goget/100:0).toFixed(2),a.upside=(a.discount?a.value-a.discount:0).toFixed(2),e.formRef.current.setFieldsValue({billing:a})}},{fieldCol:12,Placeholder:"Get: ",size:"small",type:"Text",tooltip:!0,tooltipTitle:"Likelihood Of Winning Opportunity"},{Placeholder:"GO/Get",size:"small",fieldCol:12,type:"Text"},{object:"billing",fieldCol:12,key:"getPercentage",size:"small",shape:"%",type:"InputNumber",rangeMin:0,rangeMax:100,fieldStyle:{width:"100%"},onChange:function(t){var a=e.formRef.current.getFieldsValue().billing;a.goget=(a.goPercentage?a.goPercentage*t/100:0).toFixed(2),a.discount=(a.goget&&a.value?a.value*a.goget/100:0).toFixed(2),a.upside=(a.discount?a.value-a.discount:0).toFixed(2),e.formRef.current.setFieldsValue({billing:a})}},{object:"billing",fieldCol:12,key:"goget",size:"small",shape:"%",disabled:!0,type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"Discounted Value (Forecast Amount)",size:"small",fieldCol:12,type:"Text"},{Placeholder:"Upside Value",size:"small",fieldCol:12,type:"Text"},{object:"billing",fieldCol:12,key:"discount",size:"small",disabled:!0,shape:"$",type:"InputNumber",fieldStyle:{width:"100%"}},{object:"billing",fieldCol:12,key:"upside",size:"small",disabled:!0,shape:"$",type:"InputNumber",fieldStyle:{width:"100%"}}],DatesFields:[{Placeholder:"Expected Project Start Date",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Expected Project End Date",fieldCol:12,size:"small",type:"Text"},{object:"dates",fieldCol:12,key:"startDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},rangeMin:function(t){var a=e.formRef.current.getFieldValue().dates;return a.endDate&&t>a.endDate}},{object:"dates",fieldCol:12,key:"endDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},rangeMax:function(t){var a=e.formRef.current.getFieldValue().dates;return a.startDate&&t<a.startDate}},{Placeholder:"Work Hours Per Day",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Bid Due Date",fieldCol:12,size:"small",type:"Text"},{object:"dates",fieldCol:12,key:"hoursPerDay",size:"small",rangeMin:0,rangeMax:24,type:"InputNumber",fieldStyle:{width:"100%"}},{object:"dates",fieldCol:12,key:"bidDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"}},{Placeholder:"Entry Date",fieldCol:24,size:"small",type:"Text"},{object:"dates",fieldCol:12,key:"entryDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"}}],ManageFields:[{Placeholder:"Account Director",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Account Manager",fieldCol:12,size:"small",type:"Text"},{object:"manage",fieldCol:12,key:"accountDirectorId",size:"small",data:[],type:"Select"},{object:"manage",fieldCol:12,key:"accountManagerId",size:"small",data:[],type:"Select"},{Placeholder:"Opportunity Manager",fieldCol:24,size:"small",type:"Text"},{object:"manage",fieldCol:12,key:"opportunityManagerId",size:"small",data:[],type:"Select"}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.editLead,a=e.visible,l=e.close,i=this.state,r=i.BasicFields,o=i.tenderFields,s=i.DatesFields,c=i.BillingFields,d=i.ManageFields,u=i.loading;return n.a.createElement(wt.a,{title:t?"Edit opportunity":"Add opportunity",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:u,htmlType:"submit",form:"my-form"},okText:u?n.a.createElement(Mt.a,null):"Save",onCancel:l,width:750},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,scrollToFirstError:!0,size:"small",layout:"inline",initialValues:{dates:{entryDate:W(new Date)}}},n.a.createElement(el.a,{type:"card"},n.a.createElement(Ni,{tab:"Opportunity Info",key:"basic",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:r})),n.a.createElement(Ni,{tab:"Tender Info",key:"tender",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:o})),n.a.createElement(Ni,{tab:"Key Dates",key:"dates",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:s})),n.a.createElement(Ni,{tab:"Forecast",key:"billing",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:c})),n.a.createElement(Ni,{tab:"Manage",key:"manage",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:d})))))}}]),a}(l.Component),Li=ve.a.Title,Bi=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.getList()},l.getList=function(){var e=JSON.parse(G().permissions).OPPORTUNITIES;Ve.a.get(Ti,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(t){l.setState({data:t.success?t.data:[],filterData:t.success?t.data:[],openModal:!1,editLead:!1,permissions:e})}))},l.handleDelete=function(e,t){var a=l.state,n=a.data,i=a.filterData,r=l.props.history;sl(r,"/opportunities",e,t,i,n).then((function(e){e.success&&l.setState({data:Object(we.a)(e.data),filterData:Object(we.a)(e.filterData)})}))},l.callBack=function(){l.getList()},l.closeModal=function(){l.setState({openModal:!1,editLead:!1})},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){var a=t.organization.name;return"00".concat(t.id.toString()).includes(e)||t.title&&t.title.toLowerCase().includes(e.toLowerCase())||a&&a.toLowerCase().includes(e.toLowerCase())||t.value&&_(t.value).toLowerCase().includes(e.toLowerCase())||t.startDate&&"".concat(W(t.startDate,!0,!0)).toLowerCase().includes(e.toLowerCase())||t.endDate&&"".concat(W(t.endDate,!0,!0)).toLowerCase().includes(e.toLowerCase())||t.bidDate&&"".concat(W(t.bidDate,!0,!0)).toLowerCase().includes(e.toLowerCase())||t.stage&&"".concat(R[t.stage]).toLowerCase().includes(e.toLowerCase())||t.type&&"".concat(L[t.type]).toLowerCase().includes(e.toLowerCase())||t.phoneNumber&&t.phoneNumber.startsWith(e)}))}):l.setState({filterData:t})},l.advancefilter=function(e,t,a){var n=l.state,i=n.data,r=n.searchedColumn;if(t?r[t].value=e:r=a,r.id.value||r.title.value||r.organization.value.length>0||r.revenue.value||r.startDate.value||r.endDate.value||r.bidDate.value||r.entryDate.value||r.panel.value.length>0||r.stage.value.length>0||r.status.value.length>0||r.type.value||r.stateId.value.length>0){var o,s,c,d,u=null!==(o=r.startDate.value)&&void 0!==o?o:["2010-10-19","2010-10-25"],m=null!==(s=r.endDate.value)&&void 0!==s?s:["2010-10-19","2010-10-25"],f=null!==(c=r.bidDate.value)&&void 0!==c?c:["2010-10-19","2010-10-25"],p=null!==(d=r.entryDate.value)&&void 0!==d?d:["2010-10-19","2010-10-25"];l.setState({filterData:i.filter((function(e){var t,a,l,n,i=e.organization.id;return"00".concat(e.id.toString()).includes(r.id.value)&&"".concat(null!==(t=e.title)&&void 0!==t?t:"").toLowerCase().includes(r.title.value.toLowerCase())&&"".concat(null!==(a=e.value.toString())&&void 0!==a?a:"").toLowerCase().includes(r.revenue.value.toString().toLowerCase())&&"".concat(null!==(l=e.type)&&void 0!==l?l:"").toLowerCase().includes(r.type.value.toLowerCase())&&"".concat(null!==(n=e.qualifiedOps)&&void 0!==n?n:"").toLowerCase().includes(r.qualifiedOps.value.toLowerCase())&&(r.organization.value.length>0?r.organization.value:[{value:","}]).some((function(e){return(r.organization.value.length>0?[i]:[","]).includes(e.value)}))&&(r.stateId.value.length>0?r.stateId.value:[{value:","}]).some((function(t){return(r.stateId.value.length>0?[e.stateId]:[","]).includes(t.value)}))&&(r.stage.value.length>0?r.stage.value:[{value:","}]).some((function(t){return(r.stage.value.length>0?[e.stage]:[","]).includes(t.value)}))&&(r.status.value.length>0?r.status.value:[{value:","}]).some((function(t){return(r.status.value.length>0?[e.status]:[","]).includes(t.value)}))&&(r.panel.value.length>0?r.panel.value:[{value:","}]).some((function(t){return(r.panel.value.length>0?[e.panelId]:[","]).includes(t.value)}))&&T()(r.startDate.value?W(e.startDate,!0,"YYYY-MM-DD"):"2010-10-20").isBetween(u[0],u[1],void 0,"[]")&&T()(r.endDate.value?W(e.endDate,!0,"YYYY-MM-DD"):"2010-10-20").isBetween(m[0],m[1],void 0,"[]")&&T()(r.bidDate.value?W(e.bidDate,!0,"YYYY-MM-DD"):"2010-10-20").isBetween(f[0],f[1],void 0,"[]")&&T()(r.entryDate.value?W(e.entryDate,!0,"YYYY-MM-DD"):"2010-10-20").isBetween(p[0],p[1],void 0,"[]")})),searchedColumn:r,openSearch:!1})}else l.setState({searchedColumn:r,filterData:i,openSearch:!1})},l.filterModalUseEffect=function(){Promise.all([Et(),vt(),pt()]).then((function(e){var t=l.state.filterFields;t[2].data=e[0].success?e[0].data:[],t[3].data=e[1].success?e[1].data:[],t[10].data=e[2].success?e[2].data:[],l.setState({filterFields:t})})).catch((function(e){console.log(e)}))},l.leadForm=n.a.createRef(),l.columns=[Object(Fe.a)({title:"Code",dataIndex:"id",key:"id",width:"1%",render:function(e){return"00".concat(e)}},Jt("id","number",!0)),Object(Fe.a)({title:"Title",dataIndex:"title",key:"title",width:"18%",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"/opportunities/".concat(t.id,"/info")},className:"nav-link"}," ",e," ")}},Jt("title","string")),Object(Fe.a)({title:"Organisation Name",dataIndex:"organization",width:"18%",key:"organization",render:function(e){return e&&n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(e.id,"/info")},className:"nav-link"},e.name)}},Jt("organization.name","string")),Object(Fe.a)({title:"Revenue",dataIndex:"value",key:"value",render:function(e){return"".concat(_(e))}},Jt("value","number")),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return e&&W(e,!0,!0)}},Jt("startDate","date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDtae",render:function(e){return e&&W(e,!0,!0)}},Jt("endDate","date")),Object(Fe.a)({title:"Bid Date",dataIndex:"bidDate",key:"bidDate",render:function(e){return e&&W(e,!0,!0)}},Jt("bidDate","date")),Object(Fe.a)({title:"Stage",dataIndex:"stage",key:"stage",width:"1%",render:function(e){return R[e]}},Jt("stage","string")),Object(Fe.a)({title:"Type",dataIndex:"type",key:"type",width:"1%",render:function(e){return L[e]}},Jt("type","number")),{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){var i,r,o,c,d;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(l))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",onClick:function(){return l.setState({openModal:!0,editLead:t.id})},disabled:l.state&&!l.state.permissions.UPDATE},"Edit"),1===t.type?n.a.createElement(v.a.Item,{key:"milestone"},n.a.createElement(s.b,{to:{pathname:"/opportunities/".concat(t.id,"/milestones")},className:"nav-link"},"Milestones")):n.a.createElement(v.a.Item,{key:"position"},n.a.createElement(s.b,{to:{pathname:"/opportunities/".concat(t.id,"/milestones/").concat(null===t||void 0===t||null===(c=t.milestones)||void 0===c||null===(d=c[0])||void 0===d?void 0:d.id,"/resources")},className:"nav-link"},"Postions")),n.a.createElement(v.a.Item,{key:"view"},n.a.createElement(s.b,{to:{pathname:"/opportunities/".concat(t.id,"/info")},className:"nav-link"},"View")))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],l.state={data:[],openModal:!1,editLead:!1,permissions:{},filterData:[],openSearch:!1,searchedColumn:{id:{type:"Input",value:"",label:"Code",showInColumn:!0},title:{type:"Input",value:"",label:"Title",showInColumn:!0},organization:{type:"Select",multi:!0,value:[],label:"Organization",showInColumn:!0},panel:{type:"Select",multi:!0,value:[],label:"panel",showInColumn:!0},revenue:{type:"Input",value:"",label:"Revenue",showInColumn:!0},startDate:{type:"Date",value:null,label:"Start Date",showInColumn:!0},endDate:{type:"Date",value:null,label:"End Date",showInColumn:!0,disabled:!0},bidDate:{type:"Date",value:null,label:"Bid Date",showInColumn:!0,disabled:!0},entryDate:{type:"Date",value:null,label:"Entry Date",showInColumn:!0,disabled:!0},stage:{type:"Select",multi:!0,value:[],label:"stage",showInColumn:!0},status:{type:"Select",multi:!0,value:[],label:"Status",showInColumn:!0},type:{type:"Select",value:"",label:"Type",showInColumn:!0},Action:{type:"Input",value:"",label:"",showInColumn:!0,disabled:!0},stateId:{type:"none",multi:!0,value:[],label:"State",showInColumn:!1,disabled:!1},address:{type:"none",value:"",label:"Address",showInColumn:!1,disabled:!1},qualifiedOps:{type:"none",value:"",label:"Qualified Ops",showInColumn:!1,disabled:!1}},filterFields:[{Placeholder:"Panel",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Organisation",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,mode:"multiple",key:"panel",customValue:function(e,t){return t},size:"small",data:[],type:"Select"},{object:"obj",fieldCol:12,mode:"multiple",key:"organization",customValue:function(e,t){return t},size:"small",data:[],type:"Select"},{Placeholder:"Name",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Type",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"title",size:"small",type:"Input"},{object:"obj",fieldCol:12,key:"type",size:"small",data:[{label:"Milestone",value:"1"},{label:"Time & Materials",value:"2"}],type:"Select"},{Placeholder:"State",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Stage",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,mode:"multiple",key:"stateId",customValue:function(e,t){return t},size:"small",data:[],type:"Select"},{object:"obj",fieldCol:12,key:"stage",mode:"multiple",customValue:function(e,t){return t},size:"small",data:[{label:"Lead",value:"L"},{label:"Tender Released",value:"TR"},{label:"Bid Development",value:"BD"},{label:"Bid Submitted",value:"BS"}],type:"Select"},{Placeholder:"Estimated Value",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Status",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"revenue",size:"small",shape:"$",type:"InputNumber",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"status",mode:"multiple",customValue:function(e,t){return t},size:"small",data:[{label:"Open",value:"O"},{label:"Lost",value:"L"},{label:"Did Not Proceed",value:"DNP"},{label:"Not Bid",value:"NB"}],type:"Select"},{Placeholder:"Expected Project Start Date",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Expected Project End Date",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"startDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"endDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}},{Placeholder:"Bid Due Date",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Entry Date",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"bidDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"entryDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.openModal),l=t.editLead,i=t.permissions,r=t.filterData,o=t.searchedColumn,s=t.filterFields,c=t.openSearch;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Li,{level:4},"Opportunities")),n.a.createElement(b.a,{style:{marginLeft:"auto"}},n.a.createElement(p.a,{justify:"space-between",gutter:"15"},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"default",size:"small",onClick:function(){return e.setState({openSearch:!0})}},n.a.createElement(Ft.a,null),"Filter")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){e.setState({openModal:!0,editLead:!1})},disabled:!i.ADD},n.a.createElement(Nt.a,null)," Add Opportunity")))),n.a.createElement(ea,{filters:o,filterFunction:this.advancefilter}),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:this.columns,dataSource:r,size:"small",className:"fs-small"}))),c&&n.a.createElement(Zt,{title:"Filter Opportunities",visible:c,filters:o,filterFields:s,filterFunction:this.advancefilter,effectFunction:this.filterModalUseEffect,effectRender:!0,onClose:function(){return e.setState({openSearch:!1})}}),a&&n.a.createElement(Mi,{visible:a,editLead:l,close:this.closeModal,callBack:this.callBack}))}}]),a}(l.Component),qi=a(618),Vi="".concat(A,"/projects"),Yi=function(e){return Ve.a.get(Vi+"/".concat(e),{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;if($(n),a){var i,r,o,s,c,d={id:l.id,panelId:l.panelId,organizationId:l.organizationId,organizationName:l.organization&&l.organization.name,ContactName:l.contactPerson&&"".concat(l.contactPerson.firstName,"  ").concat(l.contactPerson.lastName," - ").concat(null!==(i=l.contactPerson.phoneNumber)&&void 0!==i?i:""),contactPersonId:l.contactPersonId,qualifiedOps:l.qualifiedOps,type:l.type,status:l.status,phase:l.phase,title:l.title,stateId:l.stateId,linkedWorkId:l.linkedWorkId},u={tender:l.tender,tenderNumber:l.tenderNumber},m={cmPercentage:null!==(r=l.cmPercentage)&&void 0!==r?r:0,cm$:(l.value*l.cmPercentage/100).toFixed(2),getPercentage:null!==(o=l.getPercentage)&&void 0!==o?o:0,goPercentage:null!==(s=l.goPercentage)&&void 0!==s?s:0,totalMonths:l.startDate&&l.endDate?Math.round(W(l.endDate).diff(W(l.startDate),"months",!0)):0,endDate:l.endDate?W(l.endDate):null,startDate:l.startDate?W(l.startDate):null,value:l.value?l.value:0};m.goget=m.getPercentage*m.goPercentage/100,m.discount=l.value*m.goget/100,m.upside=l.value-m.discount;var f={entryDate:l.entryDate&&W(l.entryDate),startDate:l.startDate&&W(l.startDate),hoursPerDay:l.hoursPerDay,endDate:l.endDate&&W(l.endDate),bidDate:l.bidDate&&W(l.bidDate)},p={accountDirectorId:l.accountDirectorId,accountManagerId:l.accountManagerId,projectManagerId:l.projectManagerId};return l.ContactName=l.contactPerson&&l.contactPerson.firstName+" "+l.contactPerson.lastName,l.organizationName=l.organization&&l.organization.name,K(null===e||void 0===e||null===(c=e.headers)||void 0===c?void 0:c.authorization),{success:a,data:l,basic:d,tender:u,billing:m,dates:f,manage:p}}return{success:a}})).catch((function(e){var t;if(null===(t=e.response)||void 0===t?void 0:t.data){var a,l=e.response.status,n=null===(a=e.response)||void 0===a?void 0:a.data,i=n.message;return{authError:"Not Authorized!"===i,status:l,success:n.success,message:i}}return{error:"Please login again!",status:!1,message:e.message}}))},Hi=function(e,t){return Ve.a.get("".concat(A).concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;($(i),l)&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization);return{success:l,data:n}})).catch((function(e){var t;if(null===(t=e.response)||void 0===t?void 0:t.data){var a,l=e.response.status,n=null===(a=e.response)||void 0===a?void 0:a.data,i=n.message;return{authError:"Not Authorized!"===i,status:l,success:n.success,message:i}}return{error:"Please login again!",success:!1,message:e.message}}))},_i=function(e){return Ve.a.get("".concat(Vi,"/").concat(e,"/hierarchy"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))},Ui=function(e){return Ve.a.get(Vi+"/".concat(e,"/purchaseOrders"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Wi=function(e){return Ve.a.get("".concat(A).concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;($(i),l)&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization);return{success:l,data:n}})).catch((function(e){var t;if(null===(t=e.response)||void 0===t?void 0:t.data){var a,l=e.response.status,n=null===(a=e.response)||void 0===a?void 0:a.data,i=n.message;return{authError:"Not Authorized!"===i,status:l,success:n.success,message:i}}return{error:"Please login again!",success:!1,message:e.message}}))},Ki=function(e){return Ve.a.get(Vi+"/".concat(e,"/schedules"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Gi=function(e,t,a){if(e)return t?T.a.parseZone(e).format(!0===a?"ddd DD MMM yyyy":a):T.a.parseZone(e)},$i=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){var e=l.props,t=e.parent,a=e.id,n=l.state.fiscalYear;"P"===t?function(e,t){var a=T()().subtract(1,"months").endOf("month").format("D-M-YYYY");return Ve.a.get("".concat(Vi,"/").concat(e,"/profit-loss?startDate=").concat(W(t.start,!0,"D-M-YYYY"),"&endDate=").concat(W(t.end,!0,"D-M-YYYY"),"&actualDate=").concat(a),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))}(a,n).then((function(e){if(e.success){var t=e.data,a=t.actualStatement,n=t.actualTotal,i=t.forecast,r=t.holidays;l.calculateProjectData(a,n,null!==i&&void 0!==i?i:[],r)}})):Ve.a.get("".concat(Ti,"/get-holidays"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}})).then((function(e){if(e.success){var t=e.data.holidays;l.calculateLeadData(t)}}))},l.getWeekdays=function(e,t,a){return W(new Date).isoWeekdayCalc({rangeStart:e,rangeEnd:t,weekdays:[1,2,3,4,5],exclusions:a})},l.calculateProjectData=function(e,t,a,n){for(var i,r=l.state,o=r.data,s=r.fiscalYear,c=l.props,d=c.billing,u=c.type,m=Gi(d.startDate),f=Gi(d.endDate),p=0,b=0,g=0,y={},h={sellTotal:0,buyTotal:0},v=Gi(new Date).add(100,"years"),E=m.isBefore(s.start,"day")?s.start:m,k=f.isAfter(s.end,"day")?s.end:f,S=Gi(m);S.isSameOrBefore(f);S.add(1,"days"))6===S.isoWeekday()||7===S.isoWeekday()||n[Gi(S,!0,"M/D/YYYY")]||function(){n[Gi(S,!0,"M/D/YYYY")]&&console.log(Gi(S,!0,"M/D/YYYY"));var e=Gi(S,!0,"MMM YY");S.isSameOrAfter(E,"day")&&S.isSameOrBefore(k),S.isSameOrAfter(Gi(new Date),"month")&&a.forEach((function(t,a){var l,n;S.isBetween(Gi(t.con_startDate),null!==(l=Gi(t.con_endDate))&&void 0!==l?l:v,"day","[]")&&S.isBetween(Gi(t.res_startDate),null!==(n=Gi(t.res_endDate))&&void 0!==n?n:v,"day","[]")&&(y[e]?(y[e].monthTotalBuy+=t.forecastBuyRateDaily,y[e].monthTotalSell+=t.forecastSellRateDaily):y[e]={month:e,monthTotalBuy:t.forecastBuyRateDaily,monthTotalSell:t.forecastSellRateDaily},h.buyTotal+=t.forecastBuyRateDaily,h.sellTotal+=t.forecastSellRateDaily)})),o[0][e]?o[0][e]++:o[0][e]=1,p++}();2===u?g=d.value-(null!==(i=t.sellTotal)&&void 0!==i?i:0):1===u&&(b=d.value/p);for(var C=Gi(s.start);C.isSameOrBefore(s.end);C.add(1,"months")){var j,D,O,I,P,x=Gi(C,!0,"MMM YY"),T=o[0][x],z=0,A=0;if(2===u){if(e[x])z=null!==(D=null===(O=e[x])||void 0===O?void 0:O.monthTotalSell)&&void 0!==D?D:0,A=null!==(I=null===(P=e[x])||void 0===P?void 0:P.monthTotalBuy)&&void 0!==I?I:0;else if(y[x]){var R,w,F,N,M;if(g-=z=g-(null===(R=y[x])||void 0===R?void 0:R.monthTotalSell)<0?null!==(w=g)&&void 0!==w?w:0:null!==(F=null===(N=y[x])||void 0===N?void 0:N.monthTotalSell)&&void 0!==F?F:0,(null===(M=y[x])||void 0===M?void 0:M.monthTotalSell)>z){var L,B,q=z/(null===(L=y[x])||void 0===L?void 0:L.monthTotalSell)*100;A=(null===(B=y[x])||void 0===B?void 0:B.monthTotalBuy)/100*q}else{var V,Y;A=null!==(V=null===(Y=y[x])||void 0===Y?void 0:Y.monthTotalBuy)&&void 0!==V?V:0}}}else if(1===u){var H,_,U;z=isNaN(b*T)?0:b*T,A=null!==(H=null===(_=e[x])||void 0===_?void 0:_.monthTotalBuy)&&void 0!==H?H:null===(U=y[x])||void 0===U?void 0:U.monthTotalBuy}var W=z-A;o[1][x]=z,o[2][x]=z?A:0,o[3][x]=z?W:0,o[4][x]=z?W/z*100:0,o[0].total+=null!==(j=o[0][x])&&void 0!==j?j:0,o[1].total+=o[1][x],o[2].total+=o[2][x],o[3].total+=o[3][x]}o[4].total=o[3].total/o[1].total*100,l.setState({data:o},(function(){l.Columns()}))},l.calculateLeadData=function(e){for(var t=l.state,a=t.data,n=t.fiscalYear,i=l.props.billing,r=i.totalMonths>0?i.totalMonths:0,o=Gi(i.startDate),s=Gi(i.endDate),c=0,d=1;d<=r;d++){o=1===d?i.startDate:Gi(o).set("date",1),s=d===r?i.endDate:Gi(o).endOf("month");var u=l.getWeekdays(o,s,e);c+=u;var m=Gi(o,!0,"MMM YY");a[0][m]=u,o=Gi(o).add(1,"months")}var f=i.discount/c,p=f*i.cmPercentage/100,b=f-p;for(d=1;d<=r;d++){o=1===d?i.startDate:Gi(o).set("date",1),s=d===r?i.endDate:Gi(o).endOf("month");var g=Gi(o,!0,"MMM YY"),y=a[0][g];a[1][g]=f*y,a[2][g]=b*y,a[3][g]=p*y,a[4][g]=i.cmPercentage,o.isBetween(Gi(n.start),Gi(n.end),"month","[]")&&(a[0].total+=y,a[1].total+=f*y,a[2].total+=b*y,a[3].total+=p*y),o=Gi(o).add(1,"months")}a[4].total=a[3].total/a[1].total*100,l.setState({data:a},(function(){l.Columns()}))},l.Columns=function(){var e=l.props,t=(e.billing,e.parent),a=l.state,i=a.fiscalYear,r=a.data,o=[];console.log(r);for(var s=function(){var e=Gi(c,!0,"MMM YY"),a="P"===t?c.isSameOrAfter(Gi(new Date),"month")?"#ff7875":"#a0df7d":"#ff7875";a=r[0][e]?a:"",o.push({title:e,align:"center",dataIndex:e,key:e,onCell:function(){return{style:{backgroundColor:a}}},onHeaderCell:function(){return{style:{backgroundColor:a}}},render:function(t,a){if(t>=0&&!isNaN(r[0][e])){if("W"===a.key)return n.a.createElement("b",null,t," ");if("R"===a.key)return" ".concat(_(U(t)));if("C"===a.key)return" ".concat(_(U(t)));if("$"===a.key)return n.a.createElement("b",null," ".concat(_(U(t))));if("%"===a.key)return n.a.createElement("b",null," ".concat(U(t)," %"))}return"-"}})},c=Gi(i.start);c.isSameOrBefore(Gi(i.end));c.add(1,"months"))s();l.setState({columns:[{title:"Month",width:200,dataIndex:"label",key:"label",render:function(e,t){return"R"===t.key||"C"===t.key?e:"$"===t.key||"%"===t.key||"W"===t.key?n.a.createElement("b",null,e):void 0}},{title:"Total",dataIndex:"total",key:"total",width:130,render:function(e,t){if(e){if("W"===t.key)return n.a.createElement("b",null,e," ");if("R"===t.key)return" ".concat(_(U(e)));if("C"===t.key)return" ".concat(_(U(e)));if("$"===t.key)return n.a.createElement("b",null," ".concat(_(U(e))));if("%"===t.key)return n.a.createElement("b",null," ".concat(U(e)," %"))}return"-"}}].concat(o)})},l.state={billing:{},columns:[],fiscalYear:ee("dates"),data:[{key:"W",label:"Working Days",total:0},{key:"R",label:"Revenue \n ".concat("O"===e.parent?"(discounted value)":""),total:0},{key:"C",label:"Cost of sale/services",total:0},{key:"$",label:"CM $",total:0},{key:"%",label:"CM %",total:0}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=e.data,a=e.columns;this.props.billing;return n.a.createElement(p.a,{justify:"start",gutter:[20,5]},n.a.createElement(b.a,null,n.a.createElement($t.a,{color:"#a0df7d",className:"legends"}),n.a.createElement("span",null," Actual")),n.a.createElement(b.a,null,n.a.createElement($t.a,{color:"#ff7875",className:"legends"}),n.a.createElement("span",null," Forecast")),n.a.createElement(b.a,{span:"24"},n.a.createElement(Rt.a,{bordered:!0,rowKey:function(e){return e.label},columns:a,dataSource:t,size:"small",pagination:!1,className:"scroll-table fs-v-small full-width",scroll:{x:"max-content"}})))}}]),a}(l.Component),Ji=(el.a.TabPane,function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.fetchAll()},e.setFields=function(){var t=e.props.reason.api;return e.setState((function(e){return{Fields:e[t]}})),!0},e.fetchAll=function(t){Promise.all([vt(),e.setFields()]).then((function(t){var a=e.state.Fields;t[0].success&&(a[2].data=t[0].data,e.setState({Fields:a}))})).catch((function(e){console.log(e)}))},e.onFinish=function(t){var a,l,n=t.lost,i=e.props,r=i.editLead,o=i.close,s=e.props.reason.key;n.status=s,(a=r,l=n,Ve.a.put(Ti+"/".concat(a,"/lost"),l,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.message;return $(i),n&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),z.b.success({content:i,key:a}),{success:n}})).catch((function(e){return Q(e,a,5)}))).then((function(e){e.success&&o()}))},e.workWon=function(e){},e.formRef=n.a.createRef(),e.state={editLead:!1,check:!1,leadValue:0,loading:!1,Fields:[],Lost:[{Placeholder:"Successful Tenderder",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Winning Price",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"lost",fieldCol:12,key:"wonById",size:"small",data:[],type:"Select"},{object:"lost",fieldCol:12,key:"winningPrice",size:"small",shape:"$",type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"Reason",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"lost",fieldCol:12,key:"reason",size:"small",mode:"tags",data:[{label:"Price",value:"Price"},{label:"Resources",value:"Resources"},{label:"Approach",value:"Approach"}],type:"Select"},{Placeholder:"Customer Feedback",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"lost",fieldCol:24,key:"feedback",size:"small",mode:{minRows:2,maxRows:12},type:"Textarea"}],NotBid:[{Placeholder:"Reason",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"lost",fieldCol:24,key:"reason",size:"small",mode:"tags",data:[{label:"Insufficient\xa0",value:"Insufficient\xa0"},{label:"Resources",value:"Resources"},{label:"Not Competitive",value:"Not Competitive"},{label:"Not Financially viable",value:"Not Financially viable"},{label:"Outside\xa0Scope of Services",value:"Outside\xa0Scope of Services"}],type:"Select"}],NotProceed:[{Placeholder:"Reason",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"lost",fieldCol:24,key:"reason",size:"small",mode:{minRows:5,maxRows:12},type:"Textarea"}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.reason,l=e.close,i=this.state,r=i.Fields,o=i.loading;return n.a.createElement(wt.a,{title:a.msg,maskClosable:!1,centered:!0,visible:t,okButtonProps:{disabled:o,htmlType:"submit",form:"my-form"},okText:o?n.a.createElement(Mt.a,null):"Save",onCancel:l,width:750},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,scrollToFirstError:!0,size:"small",layout:"inline"},n.a.createElement(ft,{FormFields:r})))}}]),a}(l.Component)),Xi=[Object(Fe.a)({title:"Title",dataIndex:"title",key:"title",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"milestones/".concat(t.id,"/resources")},className:"nav-link"},e)}},Jt("title","string")),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return e&&W(e,!0,!0)}},Jt("startDate","date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e){return e&&W(e,!0,!0)}},Jt("endDate","date")),{title:"Approved",dataIndex:"isApproved",key:"isApproved",align:"right",render:function(e){return n.a.createElement(fi,{text:null!==e&&void 0!==e?e:"CM"})}}],Qi=[Object(Fe.a)({title:"Title",dataIndex:"title",key:"title"},Jt("title","string")),Object(Fe.a)({title:"Skill",dataIndex:["panelSkill","label"],key:"panelSkill"},Jt("panelSkill.label","string")),Object(Fe.a)({title:"Level",dataIndex:["panelSkillStandardLevel","levelLabel"],key:"panelSkillStandardLevel"},Jt("panelSkillStandardLevel.levelLabel","string")),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return e&&W(e,!0,!0)}},Jt("startDate","Date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e){return e&&W(e,!0,!0)}},Jt("endDate","Date")),Object(Fe.a)({title:"Total Hours",dataIndex:"billableHours",key:"billableHours",render:function(e){return U(e)}},Jt("billableHours","number"))],Zi=[{title:"Name",dataIndex:"contactPerson",key:"contactPerson",render:function(e){var t,a;return e&&"".concat(null!==(t=e.firstName)&&void 0!==t?t:""," ").concat(null!==(a=e.lastName)&&void 0!==a?a:"")}},{title:"Buy Rate (Hourly)",dataIndex:"buyingRate",key:"buyingRate",render:function(e){return"".concat(_(e))}},{title:"Sell Cost (Hourly)",dataIndex:"sellingRate",key:"sellingRate",render:function(e){return"".concat(_(e))}}];function er(e){e.key;var t=e.columns,a=e.data,i=e.expandable,r=e.checked,o=Object(l.useState)([]),s=Object(he.a)(o,2),c=s[0],d=s[1];return Object(l.useEffect)((function(){r&&d(a?1===a.length?[a[0].id]:-1!==a.findIndex((function(e){return!0===e.isMarkedAsSelected}))?[a[a.findIndex((function(e){return e.isMarkedAsSelected}))].id]:[]:[])}),[]),n.a.createElement("div",{style:{paddingRight:20}},n.a.createElement(Rt.a,{bordered:!0,size:"small",className:"fs-small",rowKey:function(e){return e.id},columns:t,dataSource:a,pagination:!1,rowSelection:r&&{type:"radio",selectedRowKeys:c,getCheckboxProps:function(e){return{disabled:!0}}},expandable:i&&{rowExpandable:function(e){var t;return(null===e||void 0===e||null===(t=e.opportunityResourceAllocations)||void 0===t?void 0:t.length)>0},expandedRowRender:function(e){return n.a.createElement(er,{data:e.opportunityResourceAllocations,columns:Zi,key:e.id,expandable:!1,checked:!0})}}}))}var tr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.id;Fi(t).then((function(a){if(a){var l=a.success,n=a.data;e.setState({leadId:t,data:l?n:[]})}}))},e.state={leadId:!1,data:[],desc:{},skillId:!1,levelId:!1,resource:!1,permissons:{ADD:!0}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=(e.desc,e.data);e.leadId,e.permissions;return n.a.createElement(Rt.a,{bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:Xi,dataSource:t,size:"small",className:"fs-small",expandable:{rowExpandable:function(e){var t;return(null===e||void 0===e||null===(t=e.opportunityResources)||void 0===t?void 0:t.length)>0},expandedRowRender:function(e){return n.a.createElement(er,{data:e.opportunityResources,columns:Qi,key:e.id,expandable:!0,checked:!1})}}})}}]),a}(l.Component),ar=[{title:"Name",dataIndex:"contactPerson",key:"contactPerson",render:function(e){var t,a;return e&&"".concat(null!==(t=e.firstName)&&void 0!==t?t:""," ").concat(null!==(a=e.lastName)&&void 0!==a?a:"")}},{title:"Buy Rate (Hourly)",dataIndex:"buyingRate",key:"buyingRate",render:function(e){return"".concat(_(e))}},{title:"Sell Rate (Hourly)",dataIndex:"sellingRate",key:"sellingRate",render:function(e){return"".concat(_(e))}}];function lr(e){var t=e.columns,a=e.data,i=Object(l.useState)(a?1===a.length?[a[0].id]:-1!==a.findIndex((function(e){return!0===e.isMarkedAsSelected}))?[a[a.findIndex((function(e){return e.isMarkedAsSelected}))].id]:[]:[]),r=Object(he.a)(i,2),o=r[0];r[1];return n.a.createElement("div",{style:{paddingRight:20}},n.a.createElement(Rt.a,{bordered:!0,size:"small",className:"fs-small",rowKey:function(e){return e.id},columns:t,dataSource:a,pagination:!1,rowSelection:{type:"radio",selectedRowKeys:o,getCheckboxProps:function(e){return{disabled:!0}}}}))}var nr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.id;Fi(t).then((function(a){if(a){var l,n=a.success,i=a.data;e.setState({leadId:t,data:n?i[0].opportunityResources:[],milestoneId:n&&(null===i||void 0===i||null===(l=i[0])||void 0===l?void 0:l.id)})}}))},e.state={leadId:!1,data:[],desc:{},skillId:!1,levelId:!1,resource:!1,permissons:{ADD:!0}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=(e.desc,e.data);e.leadId,e.permissions,e.milestoneId;return n.a.createElement(Rt.a,{bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:[Object(Fe.a)({title:"Title",dataIndex:"title",key:"title"},Jt("title","string")),Object(Fe.a)({title:"Skill",dataIndex:["panelSkill","label"],key:"panelSkill"},Jt("panelSkill.label","string")),Object(Fe.a)({title:"Level",dataIndex:["panelSkillStandardLevel","levelLabel"],key:"panelSkillStandardLevel"},Jt("panelSkillStandardLevel.levelLabel","string")),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return e&&W(e,!0,!0)}},Jt("startDate","Date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e){return e&&W(e,!0,!0)}},Jt("endDate","Date")),Object(Fe.a)({title:"Total Hours",dataIndex:"billableHours",key:"billableHours",render:function(e){return U(e)}},Jt("billableHours","number"))],dataSource:t,size:"small",className:"fs-small",expandable:{rowExpandable:function(e){var t;return(null===e||void 0===e||null===(t=e.opportunityResourceAllocations)||void 0===t?void 0:t.length)>0},expandedRowRender:function(e){return n.a.createElement(lr,{data:e.opportunityResourceAllocations,columns:ar,key:e.id})}}})}}]),a}(l.Component),ir=v.a.SubMenu,rr=ul.b.Item,or=el.a.TabPane,sr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){var e=l.props.match.params.proId;l.getRecord(e)},l.getRecord=function(e){var t=JSON.parse(G().permissions).OPPORTUNITIES;zi(e).then((function(a){a.success?(console.log(a.data),l.setState({data:a.data,basic:a.basic,billing:a.billing,leadId:e,infoModal:!1,lostModal:!1,renderTabs:!0,moveToProject:!1,permissions:t,calculatedValue:a.data.calculatedValue})):a.authError&&l.setState({notAuth:!0})}))},l.closeModal=function(){l.setState({infoModal:!1,moveToProject:!1,lostModal:!1})},l.handleDelete=function(e){var t=l.props.history;sl(t,"/opportunities",e).then((function(e){e.success&&l.setState({data:Object(we.a)(e.data),filterData:Object(we.a)(e.filterData)})}))},l.getCalculatedValue=function(e){var t;l.props.history;l.setState({valueSpin:!0}),(t=e,Ve.a.get("".concat(Ti,"/").concat(t,"/calculatedValue"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){if(e.success){var t=!0;console.log({data:e.data,state:l.state.data.value,condition:e.data===l.state.data.value}),t=e.data!==l.state.data.value,l.setState({calculatedValue:e.data,valueSpin:!1,valueUpdateEnabled:t})}}))},l.updateOpportunityValue=function(e){var t;l.props.history;(t=e,Ve.a.put("".concat(Ti,"/").concat(t,"/calculatedValue"),{},{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e.success&&(e.data.calculatedValue=l.state.calculatedValue,l.setState({data:e.data}))}))},l.callBack=function(){var e=l.state,t=e.leadId;e.moveToProject?l.props.history.push("/opportunities"):l.getRecord(t)},l.status=[{title:"Won",msg:"Opportunity Won?",api:"won",color:"#6fac45"},{title:"Lost",msg:"Opportunity Lost?",api:"Lost",key:"L",color:"#c00505"},{title:"Did Not Proceed",msg:"Did Not Proceed?",api:"NotProceed",key:"DNP",color:"#78abdb"},{title:"Not Bid",msg:"Not Bid On Opportunity?",api:"NotBid",key:"NB",color:"#8d8888"}],l.state={infoModal:!1,lostModal:!1,leadId:!1,data:{},basic:{},billing:{},renderTabs:!1,moveToProject:!1,permissions:{},notAuth:!1,valueUpdateEnabled:!0,valueSpin:!1,calculatedValue:0},l}return Object(d.a)(a,[{key:"render",value:function(){var e,t,a,l,i=this,r=this.state,o=r.data,c=r.infoModal,d=r.lostModal,u=r.leadId,m=r.billing,f=r.renderTabs,g=r.moveToProject,y=r.permissions,h=r.basic,E=r.notAuth,k=r.calculatedValue,S=r.valueSpin,C=r.valueUpdateEnabled,j=n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,"Opportunity Information"),n.a.createElement(b.a,null,n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{danger:!0,disabled:!(null===this||void 0===this||null===(e=this.state)||void 0===e||null===(t=e.permissions)||void 0===t?void 0:t.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return i.handleDelete(u)}},n.a.createElement("div",null," Delete "))),n.a.createElement(ir,{title:"Outcome",key:"Outcomes"},this.status.map((function(e){return n.a.createElement(v.a.Item,{key:e.title,disabled:!y.UPDATE,style:{color:e.color},className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:e.msg,onConfirm:function(){"Won"===e.title?i.setState({infoModal:!0,moveToProject:!0}):i.setState({lostModal:!0,moveToProject:e})},okText:"Yes",cancelText:"No"},n.a.createElement("div",null," ",e.title," ")))}))),n.a.createElement(v.a.Item,{onClick:function(){i.setState({infoModal:!0})},disabled:!y.UPDATE}," ","Edit"," "),1===(h&&h.type)?n.a.createElement(v.a.Item,null,n.a.createElement(s.b,{to:{pathname:"/opportunities/".concat(u,"/milestones")},className:"nav-link"},"Milestones")):n.a.createElement(v.a.Item,null,n.a.createElement(s.b,{to:{pathname:"/opportunities/".concat(u,"/milestones/").concat(null===o||void 0===o||null===(a=o.milestones)||void 0===a||null===(l=a[0])||void 0===l?void 0:l.id,"/resources")},className:"nav-link"},"Postions")))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null)))));return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:j,size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(rr,{label:"Project Name"},o.title),n.a.createElement(rr,{label:"Estimated Value"},n.a.createElement(p.a,{justify:"space-between",align:"middle"},n.a.createElement(b.a,null,_(o.value)),o.value!==k?n.a.createElement(b.a,null,n.a.createElement(Le.a,{title:"Calculated Estimated Value is: ".concat(_(k)),okText:"Update",onConfirm:function(){i.updateOpportunityValue(u)},okButtonProps:{disabled:!C},showCancel:!1,placement:"top"},n.a.createElement(Be.a,{type:"primary",size:"sm",onClick:function(){i.getCalculatedValue(u)}},n.a.createElement(qi.a,{spin:S})))):n.a.createElement(n.a.Fragment,null))),n.a.createElement(rr,{label:"Organisation"},o.organization?n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(o.organizationId,"/info")},className:"nav-link"},o.organization.name):"No Organisation"),n.a.createElement(rr,{label:"Delegate Contact"}," ",h?h.ContactName:""),n.a.createElement(rr,{label:"Start Date"},W(o.startDate,!0,!0)," "),n.a.createElement(rr,{label:"End Date"},W(o.endDate,!0,!0)),n.a.createElement(rr,{label:"Bid Date"},W(o.bidDate,!0,!0)),n.a.createElement(rr,{label:"Status"},h.status?w[h.status]:"")),f&&n.a.createElement(el.a,{type:"card",style:{marginTop:"50px"}},n.a.createElement(or,{tab:"Comments",key:"comments"},n.a.createElement(jl,{targetId:u,targetType:"WOR"})),n.a.createElement(or,{tab:"Attachments",key:"attachments"},n.a.createElement(Al,{targetId:u,targetType:"WOR"})),n.a.createElement(or,{tab:"Projected Profit & Loss",key:"profitloss"},n.a.createElement($i,{id:u,parent:"O",billing:m})),n.a.createElement(or,{tab:"Resources",key:"resources"},1===h.type?n.a.createElement(tr,{id:u,data:o}):n.a.createElement(nr,{id:u,data:o}))),c&&n.a.createElement(Mi,{visible:c,editLead:u,project:g,close:this.closeModal,callBack:this.callBack}),d&&n.a.createElement(Ji,{visible:d,editLead:u,reason:g,close:this.closeModal}),E&&n.a.createElement(wl,this.props))}}]),a}(l.Component),cr=(el.a.TabPane,function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){var e=l.props.skillId;console.log(e),e?l.fetchRes():l.skillModal()},l.fetchRes=function(){var e=l.props,t=e.levelId,a=e.editRex,n=(e.cmRate,e.ceil),i="employees/get/by-skills?psslId=".concat(t,"&workType=O");Promise.all([ht(i)]).then((function(e){var t=e[0].success?e[0].data:[],i=l.state.ResourceFields;if(a){var r={contactPersonId:a.contactPersonId,billableHours:a.billableHours,sellingRate:a.sellingRate,effortRate:a.effortRate,buyingRate:a.buyingRate};l.formRef.current.setFieldsValue({obj:r})}i[2].data=t,i[7].hint=l.ceilHint(n.short,n.long),l.setState({ResourceFields:i},(function(){(null===a||void 0===a?void 0:a.role)?l.checkRates(null===a||void 0===a?void 0:a.contactPersonId,{label:null===a||void 0===a?void 0:a.role}):l.setRates("No Active Contract","No Active Contract")}))})).catch((function(e){console.log(e)}))},l.checkRates=function(e,t){e?t.label.includes("Employee")?l.getRates("employees",e):t.label.includes("Sub Contractor")?l.getRates("sub-contractors",e):l.setRates("No Active Contract","No Active Contract"):l.setRates(void 0,void 0)},l.getRates=function(e,t){var a=l.props.cmRate;console.log(a,"cRate"),Tt(e,t,"contactPerson").then((function(e){if(e.success){var t=e.data.employeeBuyRate;l.setRates(_(t),_(t/(1-a/100)))}else l.setRates("No Active Contract","No Active Contract")}))},l.setRates=function(e,t){var a=l.state.ResourceFields;a[4].suggestion=e,a[5].suggestion=t,l.setState({ResourceFields:Object(we.a)(a)})},l.ceilHint=function(e,t){return n.a.createElement("div",null,n.a.createElement("span",{style:{float:"left"}},"ST Ceil(hourly): ",e),n.a.createElement("span",{style:{float:"right"}},"LT Ceil(hourly): ",t))},l.skillModal=function(){var e=l.props,t=e.editRex,a=e.panelId;e.leadId;kt(a).then((function(e){var a=l.state.SkillFields;if(a[3].data=e.success?e.data:[],t){var n=a[3].data.findIndex((function(e){return e.value===t.panelSkillId}));a[6].data=a[3].data?a[3].data[n].levels:[];var i={panelSkillId:t.panelSkillId,panelSkillStandardLevelId:t.panelSkillStandardLevelId,billableHours:t.billableHours,title:t.title,endDate:W(t.endDate),startDate:W(t.startDate)};l.formRef.current.setFieldsValue({obj:i})}l.setState({SkillFields:a})})).catch((function(e){console.log(e)}))},l.onFinish=function(e){l.setState({loading:!0});var t=l.props,a=t.editRex,n=t.skillId,i=e.obj;n||(i=Object(Fe.a)(Object(Fe.a)({},i),{},{startDate:W(i.startDate,!0),endDate:W(i.endDate,!0)})),a?n?l.editResource(i):l.editSkill(i):n?l.addResourse(i):l.addSkill(i)},l.addSkill=function(e){var t=l.props,a=t.leadId,n=t.callBack,i=t.crud;Ai(i,e,a).then((function(e){e.success?n(e.data):l.setState({loading:!1})}))},l.addResourse=function(e){var t=l.props,a=t.callBack,n=(t.leadId,t.skillId);(function(e,t,a){return z.b.loading({content:"Loading...",key:t}),Ve.a.post("".concat(A).concat(e,"/").concat(t,"/allocations"),a,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.data,r=l.message;return $(r),z.b.success({content:r,key:t}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),{success:n,data:i}})).catch((function(e){return Q(e,t,5)}))})(t.crud,n,e).then((function(e){e.success?a(e.data):l.setState({loading:!1})}))},l.editSkill=function(e){var t=l.props,a=t.editRex,n=(t.leadId,t.callBack),i=t.crud;e.id=a.id,console.log(e),wi(i,a.id,e).then((function(e){e.success?n(e.data):l.setState({loading:!1})}))},l.editResource=function(e){var t=l.props,a=t.editRex,n=t.callBack,i=(t.leadId,t.skillId),r=t.crud;e.id=a,function(e,t,a,l){return z.b.loading({content:"Loading...",key:a}),console.log(e),Ve.a.put("".concat(A).concat(e,"/").concat(t,"/allocations/").concat(a),l,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.data,r=l.message;return $(r),z.b.success({content:r,key:a}),n&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:n,data:i}})).catch((function(e){return Q(e,a,5)}))}(r,i,a.id,e).then((function(e){e.success?n(e.data):l.setState({loading:!1})}))},l.formRef=n.a.createRef(),l.state={editRex:!1,resourceSubmitted:!1,check:!1,loading:!1,SKILLS:[],STATES:[],ORGS:[],ResourceFields:[{Placeholder:"Resource",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Rate Of Effort",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"contactPersonId",size:"small",rules:[{required:!0,message:"Resource is Required"}],data:[],type:"Select",onChange:function(e,t){l.checkRates(e,t)}},{object:"obj",fieldCol:12,key:"effortRate",rules:[{required:!0,message:"Effort Rate is Required"}],size:"small",shape:"%",type:"InputNumber",fieldStyle:{width:"100%"},rangeMin:0,rangeMax:100},{Placeholder:"Buy Rate (Hourly)",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Sell Rate (Hourly)",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"buyingRate",shape:"$",size:"small",rules:[{required:!0,message:"Buying Rate is Required"}],type:"InputNumber",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"sellingRate",shape:"$",size:"small",rules:[{required:!0,message:"Selling Rate is Required"}],type:"InputNumber",fieldStyle:{width:"100%"}}],SkillFields:[{Placeholder:"Position Title",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Skill",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"title",size:"small",rules:[{required:!0,message:"Title is Required"}],type:"Input"},{object:"obj",fieldCol:12,key:"panelSkillId",size:"small",rules:[{required:!0,message:"Skill is Required"}],data:[],type:"Select",onChange:function(e,t){var a=l.state.SkillFields;a[6].data=t?t.levels:[];var n=l.formRef.current.getFieldsValue().obj;n.panelSkillStandardLevelId=void 0,l.formRef.current.setFieldsValue({obj:n}),l.setState({SkillFields:a})}},{Placeholder:"Skill Level",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Total Billable Hours",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"panelSkillStandardLevelId",size:"small",rules:[{required:!0,message:"Level is Required"}],data:[],type:"Select",onChange:function(e,t){l.fetchRes()}},{object:"obj",fieldCol:12,key:"billableHours",size:"small",rules:[{required:!0,message:"Billable Hours is Required"}],type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"Start Date",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"End Date",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"startDate",rules:[{required:!0,message:"Start Date is Required"}],size:"small",type:"DatePicker",fieldStyle:{width:"100%"},rangeMin:function(t){var a=l.formRef.current.getFieldValue().obj;return Z(t,null===a||void 0===a?void 0:a.endDate,"start",e.pDates)}},{object:"obj",fieldCol:12,key:"endDate",size:"small",rules:[{required:!0,message:"End Date is Required"}],type:"DatePicker",fieldStyle:{width:"100%"},rangeMax:function(t){var a=l.formRef.current.getFieldValue().obj;return Z(t,null===a||void 0===a?void 0:a.startDate,"end",e.pDates)}}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.editRex,a=e.visible,l=e.close,i=(e.resource,e.skillId),r=this.state,o=r.ResourceFields,s=r.SkillFields,c=r.loading;return n.a.createElement(wt.a,{title:i?t?"Edit Resource":"Add Resource":t?"Edit Position":"Add Position",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:c,htmlType:"submit",form:"my-form"},okText:c?n.a.createElement(Mt.a,null):"Save",onCancel:l,width:750},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,scrollToFirstError:!0,size:"small",layout:"inline",initialValues:i?{obj:{effortRate:100}}:{obj:{startDate:null}}},n.a.createElement(ft,{FormFields:i?o:s})))}}]),a}(l.Component)),dr=ul.b.Item;function ur(e){var t=Object(l.useState)(e.data),a=Object(he.a)(t,2),i=a[0],r=(a[1],Object(l.useState)(!1)),o=Object(he.a)(r,2),s=o[0],c=o[1],d=Object(l.useState)(!1),u=Object(he.a)(d,2),m=u[0],f=u[1],p=Object(l.useState)(e.data?1===e.data.length?[e.data[0].id]:-1!==e.data.findIndex((function(e){return!0===e.isMarkedAsSelected}))?[e.data[e.data.findIndex((function(e){return e.isMarkedAsSelected}))].id]:[]:[]),b=Object(he.a)(p,2),g=b[0],y=b[1],h=[{title:"Name",dataIndex:"contactPerson",key:"contactPerson",render:function(e){return e&&"".concat(e.firstName," ").concat(e.lastName)}},{title:"Buy Rate (Hourly)",dataIndex:"buyingRate",key:"buyingRate",render:function(e){return"".concat(_(e))}},{title:"Sell Rate (Hourly)",dataIndex:"sellingRate",key:"sellingRate",render:function(e){return"".concat(_(e))}},{title:"...",key:"action",align:"center",width:"1%",render:function(t,a,l){var i,r;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===e||void 0===e||null===(i=e.permissions)||void 0===i?void 0:i.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return E(a.id,l)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"update",onClick:function(){f(Object(Fe.a)(Object(Fe.a)({},a),{},{tableIndex:l})),c(!0)},disabled:!(null===e||void 0===e||null===(r=e.permissions)||void 0===r?void 0:r.UPDATE)},"Edit Resource"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],E=function(t,a){var l=e.crud,n=e.history,r=e.skill;l+="/".concat(r,"/allocations"),sl(n,l,t,a,i,!1).then((function(t){t.success&&e.callBack()}))};return n.a.createElement("div",{style:{paddingRight:20}},n.a.createElement(Rt.a,{bordered:!0,size:"small",key:e.skill,rowKey:function(e){return e.id},columns:h,dataSource:e.data,pagination:!1,className:"fs-small",rowSelection:{type:"radio",selectedRowKeys:g,onChange:function(t,a){e.leadId;var l=e.skill,n=e.crud;y(t),function(e,t,a){return Ve.a.patch("".concat(A).concat(e,"/").concat(t,"/allocations/").concat(a,"/mark-as-selected"),{},{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.message;if($(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),z.b.success({content:i,key:a}),n)return{success:n}})).catch((function(e){return z.b.error({content:e.message,key:a}),{error:"Please login again!",status:!1,message:e.message}}))}(n,l,a[0].id).then((function(e){console.log(e)}))}}}),s&&n.a.createElement(cr,{visible:s,editRex:m,cmRate:e.cmRate,skillId:e.skill,leadId:e.leadId,levelId:e.levelId,panelId:e.panelId,mileId:e.mileId,crud:e.crud,ceil:e.ceil,close:function(){c(!1)},callBack:function(t){c(!1),e.callBack()}}))}var mr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.fetchAll()},e.fetchAll=function(){var t=e.props.match.params,a=t.proId,l=t.mileId,n=e.props.match.url,i=JSON.parse(G().permissions).OPPORTUNITIES;Promise.all([zi(a),Ri(n)]).then((function(t){var r,o,s,c,d;e.setState({desc:t[0].success?t[0].data:{},mileDesc:(null===(r=t[0])||void 0===r?void 0:r.success)&&(null===(o=t[0])||void 0===o||null===(s=o.data)||void 0===s?void 0:s.milestones)?null===(c=t[0])||void 0===c||null===(d=c.data)||void 0===d?void 0:d.milestones.filter((function(e){return e.id==l}))[0]:{},editRex:!1,infoModal:!1,leadId:a,mileId:l,crud:n,data:t[1].success?t[1].data:[],filterData:t[1].success?t[1].data:[],permissions:i})})).catch((function(e){console.log(e)}))},e.getLeadSkills=function(){var t=e.state.crud;Ri(t).then((function(t){t.success&&e.setState({data:t.data,filterData:t.data,editRex:!1,infoModal:!1,skillId:!1,levelId:!1,tableIndex:!1,ceil:{}})}))},e.getSkilldEmployee=function(t,a,l,n,i,r,o){var s=e.state.mileDesc,c=s.startDate,d=s.endDate;e.setState({pDates:{startDate:c,endDate:d},infoModal:t,skillId:a,levelId:r,resource:l,editRex:n,tableIndex:i,ceil:o&&{short:o.shortTermCeil,long:o.longTermCeil}})},e.closeModal=function(){e.setState({infoModal:!1,editRex:!1,ceil:{}})},e.handleDelete=function(t,a){var l=e.state,n=l.crud,i=l.data,r=l.filterData,o=e.props.history;sl(o,n,t,a,r,i).then((function(t){t.success&&e.setState({data:Object(we.a)(t.data),filterData:Object(we.a)(t.filterData)})}))},e.callBack=function(t){var a=e.state,l=a.leadId;a.skillId,a.editRex,a.tableIndex;e.getLeadSkills(l)},e.generalFilter=function(t){var a=e.state.data;t?e.setState({filterData:a.filter((function(e){var a,l=e.panelSkill.label,n=e.panelSkillStandardLevel.levelLabel;return e.title&&e.title.toLowerCase().includes(t.toLowerCase())||"".concat(null!==l&&void 0!==l?l:"").toLowerCase().includes(t.toLowerCase())||"".concat(null!==n&&void 0!==n?n:"").toLowerCase().includes(t.toLowerCase())||e.startDate&&"".concat(W(e.startDate,!0,!0)).toLowerCase().includes(t.toLowerCase())||e.endDate&&"".concat(W(e.endDate,!0,!0)).toLowerCase().includes(t.toLowerCase())||"".concat(null!==(a=e.billableHours)&&void 0!==a?a:"").toLowerCase().includes(t.toLowerCase())}))}):e.setState({filterData:a})},e.advancefilter=function(t,a,l){var n=e.state,i=n.data,r=n.searchedColumn;if(a?r[a].value=t:r=l,r.skill.value||r.billableHours.value||r.startDate.value||r.endDate.value){var o,s,c=["2010-10-19","2010-10-25"],d=null!==(o=r.startDate.value)&&void 0!==o?o:c,u=null!==(s=r.endDate.value)&&void 0!==s?s:c;e.setState({filterData:i.filter((function(e){var t;return"".concat(null!==(t=e.billableHours.toString())&&void 0!==t?t:"").toLowerCase().includes(r.billableHours.value.toString().toLowerCase())&&(r.skill.value.length>0?r.skill.value:[{value:","}]).some((function(t){return(r.skill.value.length>0?[e.panelSkillId]:[","]).includes(t.value)}))&&T()(r.startDate.value?W(e.startDate,!0,"YYYY-MM-DD"):"2010-10-20").isBetween(d[0],d[1],void 0,"[]")&&T()(r.endDate.value?W(e.endDate,!0,"YYYY-MM-DD"):"2010-10-20").isBetween(u[0],u[1],void 0,"[]")})),searchedColumn:r,openSearch:!1})}else e.setState({searchedColumn:r,filterData:i,openSearch:!1})},e.filterModalUseEffect=function(){var t=e.state.desc;Promise.all([kt(t.panelId)]).then((function(t){var a=e.state.filterFields;a[2].data=t[0].success?t[0].data:[],e.setState({filterFields:a})})).catch((function(e){console.log(e)}))},e.columns=[Object(Fe.a)({title:"Title",dataIndex:"title",key:"title"},Jt("title","string")),Object(Fe.a)({title:"Skill",dataIndex:["panelSkill","label"],key:"panelSkill"},Jt("panelSkill.label","string")),Object(Fe.a)({title:"Level",dataIndex:["panelSkillStandardLevel","levelLabel"],key:"panelSkillStandardLevel"},Jt("panelSkillStandardLevel.levelLabel","string")),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return e&&W(e,!0,!0)}},Jt("startDate","Date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e){return e&&W(e,!0,!0)}},Jt("endDate","Date")),Object(Fe.a)({title:"Total Hours",dataIndex:"billableHours",key:"billableHours",render:function(e){return U(e)}},Jt("billableHours","number")),{title:"...",key:"action",align:"center",width:"1%",render:function(t,a,l){var i,r,o,s,c,d,u,m,f;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(e))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return e.handleDelete(a.id,l)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",onClick:function(){e.getSkilldEmployee(!0,!1,!1,a,l,a.panelSkillStandardLevelId)},disabled:!(null===(s=Object(Aa.a)(e))||void 0===s||null===(c=s.state)||void 0===c||null===(d=c.permissions)||void 0===d?void 0:d.UPDATE)},"Edit Position"),n.a.createElement(v.a.Item,{key:"add",onClick:function(){e.getSkilldEmployee(!0,a.id,!0,!1,l,a.panelSkillStandardLevelId,a.panelSkillStandardLevel)},disabled:!(null===(u=Object(Aa.a)(e))||void 0===u||null===(m=u.state)||void 0===m||null===(f=m.permissions)||void 0===f?void 0:f.ADD)},"Add Resouce"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],e.state={infoModal:!1,editRex:!1,leadId:!1,data:[],desc:{},mileDesc:{},ceil:{},skillId:!1,levelId:!1,crud:!1,mileId:!1,resource:!1,permissons:{ADD:!0},openSearch:!1,filterData:[],searchedColumn:{skill:{type:"Select",multi:!0,value:[],label:"Skill",showInColumn:!0},level:{type:"Select",multi:!0,value:[],label:"Level",showInColumn:!0},billableHours:{type:"Input",value:"",label:"Billable Hour"},startDate:{type:"Date",value:null,label:"Start Date",showInColumn:!0},endDate:{type:"Date",value:null,label:"End Date",showInColumn:!0,disabled:!0}},filterFields:[{Placeholder:"Skill",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Total Billable Hours",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,mode:"multiple",key:"skill",customValue:function(e,t){return t},size:"small",data:[],type:"Select"},{object:"obj",fieldCol:12,key:"billableHours",size:"small",type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"Start Date",fieldCol:12,size:"small",type:"Text"},{Placeholder:"End Date",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"startDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"endDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e,t=this,a=this.state,l=a.desc,i=a.filterData,r=(a.data,a.infoModal),o=a.editRex,c=a.leadId,d=(a.resource,a.skillId),u=a.levelId,m=a.permissions,f=a.mileId,g=a.crud,y=a.openSearch,h=a.filterFields,v=a.searchedColumn,E=a.mileDesc,k=a.pDates,S=a.ceil;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:"Opportunity Details",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(dr,{label:"Project Name",contentStyle:{width:"25%"}},l.title),n.a.createElement(dr,{label:"Estimated Value"},"".concat(_(l.value))),n.a.createElement(dr,{label:"Organisation",contentStyle:{width:"25%"}},l.organization?n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(l.organizationId,"/info")},className:"nav-link"},l.organization.name):"No Organisation"),n.a.createElement(dr,{label:"Delegate Contact"}," ",l.ContactName),n.a.createElement(dr,{label:"Start Date"},W(l.startDate,!0,!0)," "),n.a.createElement(dr,{label:"End Date"},W(l.endDate,!0,!0)),n.a.createElement(dr,{label:"Bid Date"},W(l.bidDate,!0,!0)),n.a.createElement(dr,{label:"Status"},l.status?w[l.status]:"")),1===l.type&&n.a.createElement(ul.b,{style:{marginTop:15},title:"Milestone Details",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(dr,{label:"Milestone Name"},E.title),n.a.createElement(dr,{label:"Start Date"},W(E.startDate,!0,!0)," "),n.a.createElement(dr,{label:"End Date"},W(E.endDate,!0,!0))),n.a.createElement(p.a,{justify:"end",span:4,gutter:[30,0]},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"default",size:"small",onClick:function(){return t.setState({openSearch:!0})}},n.a.createElement(Ft.a,null),"Filter")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){t.getSkilldEmployee(!0,!1,!1,!1,!1,!1)},disabled:m&&!m.ADD},"Add Position"))),n.a.createElement(ea,{filters:v,filterFunction:this.advancefilter}),n.a.createElement(Rt.a,{title:function(){return Qt(5,t.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:this.columns,size:"small",className:"fs-small",dataSource:i,expandable:{rowExpandable:function(e){return e.opportunityResourceAllocations.length>0},expandedRowRender:function(e){var a,i,r;return n.a.createElement(ur,{data:e.opportunityResourceAllocations,skill:e.id,levelId:e.panelSkillStandardLevelId,leadId:c,mileId:f,crud:g,cmRate:null!==(a=l.cmPercentage)&&void 0!==a?a:0,history:t.props.history,panelId:l.panelId,callBack:t.callBack,ceil:{short:null===(i=e.panelSkillStandardLevel)||void 0===i?void 0:i.shortTermCeil,long:null===(r=e.panelSkillStandardLevel)||void 0===r?void 0:r.longTermCeil},permissions:m})}}}),y&&n.a.createElement(Zt,{title:"Filter Resources",visible:y,filters:v,filterFields:h,filterFunction:this.advancefilter,effectFunction:this.filterModalUseEffect,effectRender:!0,onClose:function(){return t.setState({openSearch:!1})}}),r&&n.a.createElement(cr,{visible:r,editRex:o,skillId:d,levelId:u,leadId:c,cmRate:null!==(e=l.cmPercentage)&&void 0!==e?e:0,mileId:f,pDates:k,crud:g,panelId:l.panelId,close:this.closeModal,callBack:this.callBack,ceil:S}))}}]),a}(l.Component),fr=el.a.TabPane,pr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.fetchAll()},e.fetchAll=function(){var t=e.props.editPro;Promise.all([Et(),vt(1),pt(),ht("helpers/contact-persons?active=1&employee=1&associated=1&label=1"),t&&e.getRecord(t),St()]).then((function(t){var a=e.state,l=a.BasicFields,n=a.ManageFields;l[2].data=t[0].success?t[0].data:[],l[3].data=t[1].success?t[1].data:[],l[11].data=t[2].success?t[2].data:[],l[6].data=t[4].success?t[4].data:[],l[15].data=t[5].success?t[5].data:[],n[2].data=t[3].success?t[3].data:[],n[3].data=t[3].success?t[3].data:[],n[5].data=t[3].success?t[3].data:[],e.setState({BasicFields:l,ManageFields:n})})).catch((function(e){console.log(e)}))},e.onFinish=function(t){var a,l,n,i,r,o,s,c,d,u,m,f,p,b,g,y,h,v=t.basic,E=t.tender,k=t.dates,S=t.billing,C=t.manage,j=e.props.editPro,D={panelId:null!==(a=v.panelId)&&void 0!==a?a:null,organizationId:null!==(l=v.organizationId)&&void 0!==l?l:null,contactPersonId:null!==(n=v.contactPersonId)&&void 0!==n?n:null,title:null!==(i=v.title)&&void 0!==i?i:"",type:null!==(r=v.type)&&void 0!==r?r:"",stateId:null!==(o=v.stateId)&&void 0!==o?o:null,qualifiedOps:null!==(s=v.qualifiedOps)&&void 0!==s&&s,linkedWorkId:null!==(c=v.linkedWorkId)&&void 0!==c?c:null,tender:null!==(d=E.tender)&&void 0!==d?d:"",tenderNumber:null!==(u=E.tenderNumber)&&void 0!==u?u:"",value:null!==(m=S.value)&&void 0!==m?m:0,cmPercentage:null!==(f=S.cmPercentage)&&void 0!==f?f:0,goPercentage:null!==(p=S.goPercentage)&&void 0!==p?p:0,getPercentage:null!==(b=S.getPercentage)&&void 0!==b?b:0,accountDirectorId:null!==(g=C.accountDirectorId)&&void 0!==g?g:null,accountManagerId:null!==(y=C.accountManagerId)&&void 0!==y?y:null,projectManagerId:null!==(h=C.projectManagerId)&&void 0!==h?h:null,hoursPerDay:k.hoursPerDay,startDate:W(k.startDate,!0),endDate:W(k.endDate,!0),entryDate:W(k.entryDate,!0)};j?e.editRecord(D):e.addProject(D)},e.addProject=function(t){var a,l=e.props.callBack;e.setState({loading:!0}),(a=t,z.b.loading({content:"Loading...",key:1}),Ve.a.post(Vi,a,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return Q(e,1)}))).then((function(t){t.success?l():e.setState({loading:!1})}))},e.getRecord=function(t){e.state.ManageFields;return Yi(t).then((function(t){if(t.success){var a=t.basic,l=t.tender,n=t.billing,i=t.dates,r=t.manage,o="helpers/contact-persons?organizationId=".concat(a.organizationId,"&associated=1"),s=ht(o);return e.formRef.current.setFieldsValue({basic:a,tender:l,billing:n,dates:i,manage:r}),s}}))},e.editRecord=function(t){var a=e.props,l=a.editPro,n=a.callBack;t.id=l,e.setState({loading:!0}),function(e){return z.b.loading({content:"Loading...",key:e.id}),Ve.a.put(Vi+"/".concat(e.id),e,{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:e.id}),n&&K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n}})).catch((function(t){return Q(t,e.id,5)}))}(t).then((function(t){t.success?n():e.setState({loading:!1})}))},e.formRef=n.a.createRef(),e.state={editPro:!1,basicSubmitted:!1,check:!1,leadValue:0,SKILLS:[],STATES:[],ORGS:[],loading:!1,BasicFields:[{Placeholder:"Panel",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Organisation",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"panelId",size:"small",rules:[{required:!0,message:"Panel is Required"}],data:[],type:"Select"},{object:"basic",fieldCol:12,key:"organizationId",size:"small",rules:[{required:!0,message:"Organisation"}],data:[],type:"Select",onChange:function(t){if(t){var a="helpers/contact-persons?organizationId=".concat(t,"&associated=1");ht(a).then((function(t){if(t.success){var a=e.state.BasicFields;a[6].data=t.data,e.setState({BasicFields:a})}}))}else{var l=e.state.BasicFields;l[6].data=[];var n=e.formRef.current.getFieldsValue().basic;n.contactPersonId=void 0,e.formRef.current.setFieldsValue({basic:n}),e.setState({BasicFields:l})}}},{Placeholder:"Customer Representative",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Name",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"contactPersonId",size:"small",data:[],type:"Select"},{object:"basic",fieldCol:12,key:"title",size:"small",rules:[{required:!0,message:"Name is Required"}],type:"Input"},{Placeholder:"Type",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"State",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"type",size:"small",rules:[{required:!0,message:"Type is Required"}],data:[{label:"Milestone",value:1},{label:"Time & Materials",value:2}],type:"Select"},{object:"basic",fieldCol:12,key:"stateId",size:"small",data:[],type:"Select",itemStyle:{marginBottom:"10px"}},{Placeholder:"Qualified Ops",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Linked Project",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"qualifiedOps",size:"small",data:[{label:"True",value:!0},{label:"False",value:!1}],itemStyle:{marginBottom:1},type:"Select"},{object:"basic",fieldCol:12,key:"linkedWorkId",size:"small",data:[],itemStyle:{marginBottom:1},type:"Select"}],tenderFields:[{Placeholder:"Tender Title",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Tender Number",size:"small",fieldCol:12,type:"Text",labelAlign:"right"},{object:"tender",fieldCol:12,key:"tender",size:"small",type:"Input"},{object:"tender",fieldCol:12,key:"tenderNumber",size:"small",type:"Input"}],BillingFields:[{Placeholder:"Estimated Value",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Contribution Margin as a %",size:"small",fieldCol:12,type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"value",size:"small",shape:"$",type:"InputNumber",onChange:function(t){var a=e.formRef.current.getFieldsValue().billing;a.cm$=U(a.cmPercentage?t*a.cmPercentage/100:0),a.discount=U(a.goget?t*a.goget/100:0),a.upside=U(a.discount?t-a.discount:0),e.formRef.current.setFieldsValue({billing:a})},fieldStyle:{width:"100%"}},{object:"billing",fieldCol:12,key:"cmPercentage",size:"small",shape:"%",type:"InputNumber",rangeMin:0,rangeMax:100,fieldStyle:{width:"100%"},onChange:function(t){var a=e.formRef.current.getFieldsValue().billing;a.cm$=U(a.value?a.value*t/100:0),e.formRef.current.setFieldsValue({billing:a})}},{Placeholder:"Contribution Margin",size:"small",fieldCol:24,type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"cm$",size:"small",shape:"$",readOnly:!0,type:"InputNumber",fieldStyle:{width:"100%"}}],DatesFields:[{Placeholder:"Start Date",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"End Date",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"dates",fieldCol:12,key:"startDate",size:"small",type:"DatePicker",rules:[{required:!0,message:"Start Date is Required"}],fieldStyle:{width:"100%"},rangeMin:function(t){var a=e.formRef.current.getFieldValue().dates;return a.endDate&&t>a.endDate}},{object:"dates",fieldCol:12,key:"endDate",rules:[{required:!0,message:"End Date is Required"}],size:"small",type:"DatePicker",fieldStyle:{width:"100%"},rangeMax:function(t){var a=e.formRef.current.getFieldValue().dates;return a.startDate&&t<a.startDate}},{Placeholder:"Work Hours Per Day",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Entry Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"dates",fieldCol:12,key:"hoursPerDay",size:"small",rangeMin:0,rangeMax:24,rules:[{required:!0,message:"Dailty Hours is Required"}],type:"InputNumber",fieldStyle:{width:"100%"}},{object:"dates",fieldCol:12,key:"entryDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"}}],ManageFields:[{Placeholder:"Account Director",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Account Manager",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"manage",fieldCol:12,key:"accountDirectorId",size:"small",data:[],type:"Select"},{object:"manage",fieldCol:12,key:"accountManagerId",size:"small",data:[],type:"Select"},{Placeholder:"Project Manager",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"manage",fieldCol:12,key:"projectManagerId",size:"small",data:[],type:"Select"}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.editPro,a=e.visible,l=e.close,i=e.onHold,r=this.state,o=r.BasicFields,s=r.tenderFields,c=r.DatesFields,d=r.BillingFields,u=r.ManageFields,m=r.loading;return n.a.createElement(wt.a,{title:t?"Edit Project":"Add Project",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:m||i,htmlType:"submit",form:"my-form"},okText:m?n.a.createElement(Mt.a,null):"Save",onCancel:l,width:750},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,scrollToFirstError:!0,size:"small",layout:"inline",initialValues:{dates:{entryDate:W(new Date)}}},n.a.createElement(el.a,{type:"card"},n.a.createElement(fr,{tab:"Project Info",key:"basic",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:o})),n.a.createElement(fr,{tab:"Tender Info",key:"tender",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:s})),n.a.createElement(fr,{tab:"Key Dates",key:"dates",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:c})),n.a.createElement(fr,{tab:"Forecast",key:"billing",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:d})),n.a.createElement(fr,{tab:"Manage",key:"manage",forceRender:!0,className:"ant-form ant-form-inline ant-form-small"},n.a.createElement(ft,{FormFields:u})))))}}]),a}(l.Component),br=ve.a.Title,gr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.getList()},l.getList=function(){var e=JSON.parse(G().permissions).PROJECTS;Ve.a.get(Vi,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(t){l.setState({data:t.success?t.data:[],filterData:t.success?t.data:[],openModal:!1,editPro:{id:!1,onHold:!1},permissions:e})}))},l.handleDelete=function(e,t){var a=l.state,n=a.data,i=a.filterData,r=l.props.history;sl(r,"/projects",e,t,i,n).then((function(e){e.success&&l.setState({data:Object(we.a)(e.data),filterData:Object(we.a)(e.filterData)})}))},l.callBack=function(){l.getList()},l.closeModal=function(){l.setState({openModal:!1,editPro:{id:!1,onHold:!1}})},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){var a=t.organization.name;return"00".concat(t.id.toString()).includes(e)||t.title&&t.title.toLowerCase().includes(e.toLowerCase())||a&&a.toLowerCase().includes(e.toLowerCase())||t.value&&"".concat(_(t.value)).toLowerCase().includes(e.toLowerCase())||t.startDate&&"".concat(W(t.startDate,!0,!0)).toLowerCase().includes(e.toLowerCase())||t.endDate&&"".concat(W(t.endDate,!0,!0)).toLowerCase().includes(e.toLowerCase())||t.type&&"".concat(L[t.type]).toLowerCase().includes(e.toLowerCase())||"".concat(F[t.phase]).toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.advancefilter=function(e,t,a){var n=l.state,i=n.data,r=n.searchedColumn;if(t?r[t].value=e:r=a,r.id.value||r.title.value||r.organization.value.length>0||r.revenue.value||r.startDate.value||r.endDate.value||r.entryDate.value||r.panel.value.length>0||r.stage.value.length>0||r.phase.value||r.type.value||r.stateId.value.length>0){var o,s,c,d=["2010-10-19","2010-10-25"],u=null!==(o=r.startDate.value)&&void 0!==o?o:d,m=null!==(s=r.endDate.value)&&void 0!==s?s:d,f=null!==(c=r.entryDate.value)&&void 0!==c?c:d;l.setState({filterData:i.filter((function(e){var t,a,l,n,i,o=e.organization.id;return"00".concat(e.id.toString()).includes(r.id.value)&&"".concat(null!==(t=e.title)&&void 0!==t?t:"").toLowerCase().includes(r.title.value.toLowerCase())&&"".concat(null!==(a=e.value.toString())&&void 0!==a?a:"").toLowerCase().includes(r.revenue.value.toString().toLowerCase())&&"".concat(null!==(l=e.type)&&void 0!==l?l:"").toLowerCase().includes(r.type.value.toLowerCase())&&"".concat(null!==(n=e.phase)&&void 0!==n?n:"").toLowerCase().includes(r.phase.value.toLowerCase())&&"".concat(null!==(i=e.qualifiedOps)&&void 0!==i?i:"").toLowerCase().includes(r.qualifiedOps.value.toLowerCase())&&(r.organization.value.length>0?r.organization.value:[{value:","}]).some((function(e){return(r.organization.value.length>0?[o]:[","]).includes(e.value)}))&&(r.stateId.value.length>0?r.stateId.value:[{value:","}]).some((function(t){return(r.stateId.value.length>0?[e.stateId]:[","]).includes(t.value)}))&&(r.stage.value.length>0?r.stage.value:[{value:","}]).some((function(t){return(r.stage.value.length>0?[e.stage]:[","]).includes(t.value)}))&&(r.panel.value.length>0?r.panel.value:[{value:","}]).some((function(t){return(r.panel.value.length>0?[e.panelId]:[","]).includes(t.value)}))&&T()(r.startDate.value?W(e.startDate,!0,"YYYY-MM-DD"):"2010-10-20").isBetween(u[0],u[1],void 0,"[]")&&T()(r.endDate.value?W(e.endDate,!0,"YYYY-MM-DD"):"2010-10-20").isBetween(m[0],m[1],void 0,"[]")&&T()(r.entryDate.value?W(e.entryDate,!0,"YYYY-MM-DD"):"2010-10-20").isBetween(f[0],f[1],void 0,"[]")})),searchedColumn:r,openSearch:!1})}else l.setState({searchedColumn:r,filterData:i,openSearch:!1})},l.filterModalUseEffect=function(){Promise.all([Et(),vt(),pt()]).then((function(e){var t=l.state.filterFields;t[2].data=e[0].success?e[0].data:[],t[3].data=e[1].success?e[1].data:[],t[10].data=e[2].success?e[2].data:[],l.setState({filterFields:t})})).catch((function(e){console.log(e)}))},l.proForm=n.a.createRef(),l.columns=[Object(Fe.a)({title:"Code",dataIndex:"id",key:"id",width:"1%",render:function(e){return"00".concat(e)}},Jt("id","number",!0)),Object(Fe.a)({title:"Title",dataIndex:"title",key:"title",width:"30%",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"/projects/".concat(t.id,"/info")},className:"nav-link"}," ",e," ")}},Jt("title","string")),Object(Fe.a)({title:"Organisation Name",dataIndex:"organization",key:"organization",width:"20%",render:function(e){return e&&n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(e.id,"/info")},className:"nav-link"},e.name)}},Jt("organization.name","string")),Object(Fe.a)({title:"Revenue",dataIndex:"value",key:"value",render:function(e){return"".concat(_(e))}},Jt("value","number")),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return W(e,!0,!0)}},Jt("startDate","date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDtae",render:function(e){return W(e,!0,!0)}},Jt("endDate","date")),Object(Fe.a)({title:"Type",dataIndex:"type",key:"type",width:"1%",render:function(e){return L[e]}},Jt("type","number")),Object(Fe.a)({title:"Status",dataIndex:"phase",key:"phase",width:"1%",render:function(e){return n.a.createElement($t.a,{color:e?"green":"red"},F[e])}},Jt("phase","string")),{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){var i,r,o,c,d,u,m,f;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(l))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE)||t.phase,className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"update",onClick:function(){return l.setState({openModal:!0,editPro:{id:t.id,onHold:!1===t.phase}})},disabled:!(null===(c=Object(Aa.a)(l))||void 0===c||null===(d=c.state)||void 0===d||null===(u=d.permissions)||void 0===u?void 0:u.UPDATE)},"Edit"),n.a.createElement(v.a.Item,{key:"order"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(t.id,"/purchase-order")},className:"nav-link"},"Purchase Order")),1===t.type?n.a.createElement(v.a.Item,{key:"milestone"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(t.id,"/milestones")},className:"nav-link"},"Milestones")):n.a.createElement(v.a.Item,{key:"position"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(t.id,"/milestones/").concat(null===t||void 0===t||null===(m=t.milestones)||void 0===m||null===(f=m[0])||void 0===f?void 0:f.id,"/resources")},className:"nav-link"},"Postions")),n.a.createElement(v.a.Item,{key:"view"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(t.id,"/info")},className:"nav-link"},"View")),1===t.type?n.a.createElement(v.a.Item,{key:"schedule"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(t.id,"/schedules")},className:"nav-link"},"Schedules")):"")},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],l.state={data:[],openModal:!1,editPro:{id:!1,onHold:!1},permissions:{},filterData:[],openSearch:!1,searchedColumn:{id:{type:"Input",value:"",label:"Code",showInColumn:!0},title:{type:"Input",value:"",label:"Title",showInColumn:!0},organization:{type:"Select",multi:!0,value:[],label:"Organization",showInColumn:!0},panel:{type:"Select",multi:!0,value:[],label:"panel",showInColumn:!0},revenue:{type:"Input",value:"",label:"Revenue",showInColumn:!0},startDate:{type:"Date",value:null,label:"Start Date",showInColumn:!0},endDate:{type:"Date",value:null,label:"End Date",showInColumn:!0,disabled:!0},entryDate:{type:"Date",value:null,label:"Entry Date",showInColumn:!0,disabled:!0},stage:{type:"Select",multi:!0,value:[],label:"stage",showInColumn:!0},type:{type:"Select",value:"",label:"Type",showInColumn:!0},Action:{type:"Input",value:"",label:"",showInColumn:!0,disabled:!0},stateId:{type:"Select",multi:!0,value:[],label:"State",showInColumn:!1,disabled:!1},address:{type:"Input",value:"",label:"Address",showInColumn:!1,disabled:!1},qualifiedOps:{type:"Select",value:"",label:"Qualified Ops",showInColumn:!1,disabled:!1},phase:{type:"Select",value:"",label:"Status",showInColumn:!0}},filterFields:[{Placeholder:"Panel",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Organisation",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,mode:"multiple",key:"panel",customValue:function(e,t){return t},size:"small",data:[],type:"Select"},{object:"obj",fieldCol:12,mode:"multiple",key:"organization",customValue:function(e,t){return t},size:"small",data:[],type:"Select"},{Placeholder:"Name",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Type",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"title",size:"small",type:"Input"},{object:"obj",fieldCol:12,key:"type",size:"small",data:[{label:"Milestone",value:"1"},{label:"Time & Materials",value:"2"}],type:"Select"},{Placeholder:"State",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Qualified Ops",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,mode:"multiple",key:"stateId",customValue:function(e,t){return t},size:"small",data:[],type:"Select"},{object:"obj",fieldCol:12,key:"qualifiedOps",size:"small",data:[{label:"True",value:"True"},{label:"False",value:"False"}],type:"Select"},{Placeholder:"Estimated Value",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Start Date",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"revenue",size:"small",shape:"$",type:"InputNumber",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"startDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}},{Placeholder:"End Date",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Entry Date",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"endDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"entryDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}},{Placeholder:"Status",fieldCol:24,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"phase",size:"small",data:[{label:"Open",value:"true"},{label:"Close",value:"false"}],type:"Select"}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.data,t.openModal),l=t.editPro,i=t.permissions,r=t.filterData,o=t.searchedColumn,s=t.filterFields,c=t.openSearch;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(br,{level:4},"Projects")),n.a.createElement(b.a,{style:{textAlign:"end"},span:4},n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"default",size:"small",onClick:function(){return e.setState({openSearch:!0})}},n.a.createElement(Ft.a,null),"Filter")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){e.setState({openModal:!0,editPro:{id:!1,onHold:!1}})},disabled:!i.ADD},n.a.createElement(Nt.a,null),"Add Project")))),n.a.createElement(ea,{filters:o,filterFunction:this.advancefilter}),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:this.columns,dataSource:r,size:"small",className:"fs-small"}))),c&&n.a.createElement(Zt,{title:"Filter Projects",visible:c,filters:o,filterFields:s,filterFunction:this.advancefilter,effectFunction:this.filterModalUseEffect,effectRender:!0,onClose:function(){return e.setState({openSearch:!1})}}),a&&n.a.createElement(pr,{visible:a,editPro:null===l||void 0===l?void 0:l.id,onHold:null===l||void 0===l?void 0:l.onHold,close:this.closeModal,callBack:this.callBack}))}}]),a}(l.Component),yr=[Object(Fe.a)({title:"Title",dataIndex:"title",key:"title",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"milestones/".concat(t.id,"/resources")},className:"nav-link"},e)}},Jt("title","string")),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return e&&W(e,!0,!0)}},Jt("startDate","date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e){return e&&W(e,!0,!0)}},Jt("endDate","date")),{title:"Approved",dataIndex:"isApproved",key:"isApproved",align:"right",render:function(e){return n.a.createElement(fi,{text:null!==e&&void 0!==e?e:"CM"})}}],hr=[Object(Fe.a)({title:"Title",dataIndex:"title",key:"title"},Jt("title","string")),Object(Fe.a)({title:"Skill",dataIndex:["panelSkill","label"],key:"panelSkill"},Jt("panelSkill.label","string")),Object(Fe.a)({title:"Level",dataIndex:["panelSkillStandardLevel","levelLabel"],key:"panelSkillStandardLevel"},Jt("panelSkillStandardLevel.levelLabel","string")),Object(Fe.a)({title:"Employee Name",dataIndex:"contactPerson",key:"contactPerson",render:function(e){var t,a;return"".concat(null!==(t=null===e||void 0===e?void 0:e.firstName)&&void 0!==t?t:""," ").concat(null!==(a=null===e||void 0===e?void 0:e.lastName)&&void 0!==a?a:"")}},Jt("contactPerson.firstName","string")),Object(Fe.a)({title:"Billable Hours",dataIndex:"billableHours",key:"billableHours",render:function(e){return U(e)}},Jt("billableHours","number")),Object(Fe.a)({title:"Buy Rate (Hourly)",dataIndex:"buyingRate",key:"buyingRate",render:function(e){return e&&_(e)}},Jt("buyingRate","number")),Object(Fe.a)({title:"Sell Rate (Hourly)",dataIndex:"sellingRate",key:"sellingRate",render:function(e){return e&&_(e)}},Jt("sellingRate","number")),Object(Fe.a)({title:"CM $",dataIndex:"cm$",key:"cm$",render:function(e){return e&&_(e)}},Jt("cm$","number")),Object(Fe.a)({title:"CM %",dataIndex:"cmPercent",key:"cmPercent",render:function(e){return"".concat(U(e)," %")}},Jt("cmPercent","number"))];function vr(e){var t=e.columns,a=e.data;return n.a.createElement("div",{style:{paddingRight:20}},n.a.createElement(Rt.a,{bordered:!0,size:"small",className:"fs-small",rowKey:function(e){return e.allocationId},columns:t,dataSource:a,pagination:!1}))}var Er=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.id;_i(t).then((function(a){if(a){var l=a.success,n=a.data;console.log(n),e.setState({leadId:t,data:l?n:[]})}}))},e.state={leadId:!1,data:[],desc:{},skillId:!1,levelId:!1,resource:!1,permissons:{ADD:!0}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=(e.desc,e.data);e.leadId,e.permissions;return n.a.createElement(Rt.a,{bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:yr,dataSource:t,size:"small",className:"fs-small",expandable:{rowExpandable:function(e){var t;return(null===e||void 0===e||null===(t=e.opportunityResources)||void 0===t?void 0:t.length)>0},expandedRowRender:function(e){return n.a.createElement(vr,{data:e.opportunityResources,columns:hr,expandable:!0,checked:!1})}}})}}]),a}(l.Component),kr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.id;_i(t).then((function(a){if(a){var l,n=a.success,i=a.data;e.setState({leadId:t,data:n?i[0].opportunityResources:[],milestoneId:n&&(null===i||void 0===i||null===(l=i[0])||void 0===l?void 0:l.id)})}}))},e.state={leadId:!1,data:[],desc:{},skillId:!1,levelId:!1,resource:!1,permissons:{ADD:!0}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=(e.desc,e.data);e.leadId,e.permissions,e.milestoneId;return n.a.createElement(Rt.a,{bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:[Object(Fe.a)({title:"Title",dataIndex:"title",key:"title"},Jt("title","string")),Object(Fe.a)({title:"Skill",dataIndex:["panelSkill","label"],key:"panelSkill"},Jt("panelSkill.label","string")),Object(Fe.a)({title:"Level",dataIndex:["panelSkillStandardLevel","levelLabel"],key:"panelSkillStandardLevel"},Jt("panelSkillStandardLevel.levelLabel","string")),Object(Fe.a)({title:"Employee Name",dataIndex:"contactPerson",key:"contactPerson",render:function(e){var t,a;return"".concat(null!==(t=null===e||void 0===e?void 0:e.firstName)&&void 0!==t?t:""," ").concat(null!==(a=null===e||void 0===e?void 0:e.lastName)&&void 0!==a?a:"")}},Jt("contactPerson.firstName","string")),Object(Fe.a)({title:"Billable Hours",dataIndex:"billableHours",key:"billableHours",render:function(e){return U(e)}},Jt("billableHours","number")),Object(Fe.a)({title:"Buy Rate (Hourly)",dataIndex:"buyingRate",key:"buyingRate",render:function(e){return e&&_(e)}},Jt("buyingRate","number")),Object(Fe.a)({title:"Sell Rate (Hourly)",dataIndex:"sellingRate",key:"sellingRate",render:function(e){return e&&_(e)}},Jt("sellingRate","number")),Object(Fe.a)({title:"CM $",dataIndex:"cm$",key:"cm$",render:function(e){return e&&_(e)}},Jt("cm$","number")),Object(Fe.a)({title:"CM %",dataIndex:"cmPercent",key:"cmPercent",render:function(e){return"".concat(U(e)," %")}},Jt("cmPercent","number"))],dataSource:t,size:"small",className:"fs-small"})}}]),a}(l.Component),Sr=[Object(Fe.a)({title:"Resource",dataIndex:"fullName",key:"fullName",render:function(e,t){return e}},Jt("fullName","string")),Object(Fe.a)({title:"Total Hours",dataIndex:["total","totalHours"],key:"total",render:function(e){return e&&U(e)}},Jt("total.totalHours","number")),Object(Fe.a)({title:"Utilized Hours",dataIndex:["total","utilizedHours"],key:"utilized",render:function(e){return e&&U(e)}},Jt("total.utilizedHours","number")),Object(Fe.a)({title:"Remaining Hours",dataIndex:["total","remainingHours"],key:"remaining",render:function(e){return e&&U(e)}},Jt("total.remainingHours","number")),Object(Fe.a)({title:"Actual Revenue",dataIndex:["total","actualRevenue"],key:"actualRevenue",render:function(e){return e&&_(e)}},Jt("total.actualRevenue","number")),Object(Fe.a)({title:"Actual Cost",dataIndex:["total","actualCost"],key:"actualCost",render:function(e){return e&&_(e)}},Jt("total.actualCost","number")),Object(Fe.a)({title:"CM$",dataIndex:["total","cm$"],key:"cm$",render:function(e){return e&&_(e)}},Jt("total.cm$","number")),Object(Fe.a)({title:"CM%",dataIndex:["total","cmPercent"],key:"cmPercent",render:function(e){return"".concat(U(null!==e&&void 0!==e?e:"-")," %")}},Jt("total.cmPercent","number"))],Cr=[Object(Fe.a)({title:"Duration",dataIndex:"dateString",key:"dateString"},Jt("dateString","string")),Object(Fe.a)({title:"Working Days",dataIndex:"workDays",key:"workDays",render:function(e){return U(null!==e&&void 0!==e?e:0)},sorter:function(e,t){return e.workDays-t.workDays}},Jt("workDays","string")),Object(Fe.a)({title:"Effort Rate",dataIndex:"effortRate",key:"effortRate",render:function(e){return U(null!==e&&void 0!==e?e:0)},sorter:function(e,t){return e.effortRate-t.effortRate}},Jt("effortRate","string")),Object(Fe.a)({title:"Actual Hours",dataIndex:"actualHours",key:"actualHours",render:function(e){return U(null!==e&&void 0!==e?e:0)},sorter:function(e,t){return e.actualHours-t.actualHours}},Jt("actualHours","string")),Object(Fe.a)({title:"Actual Days",dataIndex:"actualDays",key:"actualDays",render:function(e){return U(null!==e&&void 0!==e?e:0)},sorter:function(e,t){return e.actualDays-t.actualDays}},Jt("actualDays","number")),Object(Fe.a)({title:"Actual Revenue",dataIndex:"actualRevenue",key:"actualRevenue",render:function(e){return _(null!==e&&void 0!==e?e:0)}},Jt("actualRevenue","number")),Object(Fe.a)({title:"Actual Cost",dataIndex:"actualCost",key:"actualCost",render:function(e){return _(null!==e&&void 0!==e?e:0)}},Jt("actualCost","number")),Object(Fe.a)({title:"CM $",dataIndex:"cm$",key:"cm$",render:function(e){return _(null!==e&&void 0!==e?e:0)}},Jt("cm$","number")),Object(Fe.a)({title:"CM %",dataIndex:"cmPercent",key:"cmPercent",render:function(e){return"".concat(U(null!==e&&void 0!==e?e:"-")," %")}},Jt("cmPercent","number"))];function jr(e){var t=e.columns,a=e.data;return n.a.createElement("div",{style:{paddingRight:20}},n.a.createElement(Rt.a,{bordered:!0,size:"small",className:"fs-small project-tracking-nested",rowKey:function(e){return e.allocationId},rowClassName:function(e){return e.current?"current":"forecast"},columns:t,dataSource:a,pagination:!1,summary:function(e){console.log(e);var t=0,a=0,l=0,i=0,r=0,o=0,s=0,c=0;e.forEach((function(e){var n,d,u,m,f,p,b;t+=parseFloat(null!==(n=e.workDays)&&void 0!==n?n:0),a+=parseFloat(null!==(d=e.actualHours)&&void 0!==d?d:0),l+=parseFloat(null!==(u=e.actualDays)&&void 0!==u?u:0),i+=parseFloat(null!==(m=e.actualRevenue)&&void 0!==m?m:0),r+=parseFloat(null!==(f=e.actualCost)&&void 0!==f?f:0),o+=parseFloat(null!==(p=e.cm$)&&void 0!==p?p:0),s+=parseFloat(null!==(b=e.cmPercent)&&void 0!==b?b:0),e.cmPercent&&c++}));var d=0;return s>0&&(d=s/c),n.a.createElement(Rt.a.Summary,{fixed:"bottom"},n.a.createElement(Rt.a.Summary.Row,null,n.a.createElement(Rt.a.Summary.Cell,{index:0},"Total"),n.a.createElement(Rt.a.Summary.Cell,{index:1},U(t)),n.a.createElement(Rt.a.Summary.Cell,{index:2},"-"),n.a.createElement(Rt.a.Summary.Cell,{index:3},U(a)),n.a.createElement(Rt.a.Summary.Cell,{index:4},U(l)),n.a.createElement(Rt.a.Summary.Cell,{index:5},_(i)),n.a.createElement(Rt.a.Summary.Cell,{index:6},_(r)),n.a.createElement(Rt.a.Summary.Cell,{index:7},_(o)),n.a.createElement(Rt.a.Summary.Cell,{index:8},U(d)," %")))}}))}var Dr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t,a,l=e.props.id;(t=l,a={startDate:T()().format("01-07-YYYY"),endDate:T()().add(1,"year").format("30-06-YYYY")},Ve.a.get("".concat(Vi,"/").concat(t,"/tracking"),{headers:J(),params:a}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){if(t){var a=t.success,n=t.data;console.log(n),e.setState({leadId:l,data:a?n:[]})}}))},e.state={leadId:!1,data:[],desc:{},skillId:!1,levelId:!1,resource:!1,permissons:{ADD:!0}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state,t=(e.desc,e.data);e.leadId,e.permissions;return n.a.createElement(Rt.a,{bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.employeeId},columns:Sr,dataSource:t,size:"small",className:"fs-small",expandable:{rowExpandable:function(e){var t;return(null===e||void 0===e||null===(t=e.currentYear)||void 0===t?void 0:t.length)>0},expandedRowRender:function(e){return n.a.createElement(jr,{data:e.currentYear,columns:Cr,expandable:!0,checked:!1})}},summary:function(e){console.log(e);var t=0,a=0,l=0,i=0,r=0,o=0,s=0,c=0;e.forEach((function(e){var n,d,u,m,f,p,b;t+=parseFloat(null!==(n=e.total.totalHours)&&void 0!==n?n:0),a+=parseFloat(null!==(d=e.total.utilizedHours)&&void 0!==d?d:0),l+=parseFloat(null!==(u=e.total.remainingHours)&&void 0!==u?u:0),i+=parseFloat(null!==(m=e.total.actualRevenue)&&void 0!==m?m:0),r+=parseFloat(null!==(f=e.total.actualCost)&&void 0!==f?f:0),o+=parseFloat(null!==(p=e.total.cm$)&&void 0!==p?p:0),s+=parseFloat(null!==(b=e.total.cmPercent)&&void 0!==b?b:0),e.total.cmPercent&&e.total.cmPercent>0&&c++}));var d=0;return s>0&&(d=s/c),n.a.createElement(Rt.a.Summary,{fixed:"bottom"},n.a.createElement(Rt.a.Summary.Row,null,n.a.createElement(Rt.a.Summary.Cell,{index:0},"-"),n.a.createElement(Rt.a.Summary.Cell,{index:1},"Total"),n.a.createElement(Rt.a.Summary.Cell,{index:2},U(t)),n.a.createElement(Rt.a.Summary.Cell,{index:3},U(a)),n.a.createElement(Rt.a.Summary.Cell,{index:4},U(l)),n.a.createElement(Rt.a.Summary.Cell,{index:5},_(i)),n.a.createElement(Rt.a.Summary.Cell,{index:6},_(r)),n.a.createElement(Rt.a.Summary.Cell,{index:7},_(o)),n.a.createElement(Rt.a.Summary.Cell,{index:8},U(d)," %")))}})}}]),a}(l.Component),Or=(a(522),ul.b.Item),Ir=el.a.TabPane,Pr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props.match.params.proId;e.getRecord(t)},e.getRecord=function(t){var a=JSON.parse(G().permissions).PROJECTS;Yi(t).then((function(l){l.success?e.setState({data:l.data,basic:l.basic,billing:l.billing,leadId:t,infoModal:!1,renderTabs:!0,permissions:a,calculatedValue:l.data.calculatedValue}):l.authError&&e.setState({notAuth:!0})}))},e.closeModal=function(){e.setState({infoModal:!1})},e.handleDelete=function(t){var a=e.props.history;sl(a,"/projects",t).then((function(e){e.success}))},e.callBack=function(){var t=e.state.leadId;e.getRecord(t)},e.OutcomeAction=function(t){var a,l,n=e.state,i=n.leadId,r=n.basic;(a=t,l=i,z.b.loading({content:"Loading...",key:l}),Ve.a.post(Vi+"/".concat(l,"/phase/").concat(a),{},{headers:J()}).then((function(e){var t,a=e.data,n=a.success,i=a.message,r=a.data;return $(i),z.b.success({content:i,key:l}),n&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:n,data:r}})).catch((function(e){return Q(e,l,5)}))).then((function(a){a.success&&e.setState({basic:Object(Fe.a)(Object(Fe.a)({},r),{},{phase:"open"===t})})}))},e.state={valueSpin:!1,updateEnabled:!0,calculatedValue:0,infoModal:!1,leadId:!1,data:{},basic:{},billing:{},renderTabs:!1,permissions:{},notAuth:!1},e}return Object(d.a)(a,[{key:"render",value:function(){var e,t,a=this,l=this.state,i=l.data,r=l.infoModal,o=l.leadId,c=l.billing,d=l.renderTabs,u=(l.calculatedValue,l.permissions),m=l.basic,f=l.notAuth,g=(l.valueSpin,l.updateEnabled,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,"Project Information"),n.a.createElement(b.a,null,n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===u||void 0===u?void 0:u.DELETE)||!1===m.phase,className:"pop-confirm-menu"},n.a.createElement(Le.a,{disabled:!(null===u||void 0===u?void 0:u.DELETE)||!1===m.phase,title:"Are you sure you want to delete",onConfirm:function(){return a.handleDelete(o)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.SubMenu,{title:"Outcome",key:"Outcome"},n.a.createElement(v.a.Item,{key:"Open",disabled:!u.UPDATE||!0===m.phase,style:{color:"#6fac45"},className:"pop-confirm-menu"},n.a.createElement(Le.a,{disabled:!u.UPDATE||!0===m.phase,title:"Do You Want To Open this Project?",onConfirm:function(){return a.OutcomeAction("open")},okText:"Yes",cancelText:"No"},n.a.createElement("div",null,"Open"))),n.a.createElement(v.a.Item,{key:"Close",disabled:!u.UPDATE||!1===m.phase,style:{color:"#c00505"},className:"pop-confirm-menu"},n.a.createElement(Le.a,{disabled:!u.UPDATE||!1===m.phase,title:"Do You Want To Close this Project?",onConfirm:function(){return a.OutcomeAction("close")},okText:"Yes",cancelText:"No"},n.a.createElement("div",null,"Close")))),n.a.createElement(v.a.Item,{key:"edit",onClick:function(){a.setState({infoModal:!0})},disabled:!(null===u||void 0===u?void 0:u.UPDATE)},"Edit"),n.a.createElement(v.a.Item,{key:"order"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(o,"/purchase-order")},className:"nav-link"},"Purchase Order")),1===(m&&m.type)?n.a.createElement(v.a.Item,{key:"milestone"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(o,"/milestones")},className:"nav-link"},"Milestones")):n.a.createElement(v.a.Item,{key:"position"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(o,"/milestones/").concat(null===i||void 0===i||null===(e=i.milestones)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.id,"/resources")},className:"nav-link"},"Postions")),m&&1===m.type?n.a.createElement(v.a.Item,{key:"schedule"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(o,"/schedules")},className:"nav-link"},"Schedules")):"")},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)," Option ",n.a.createElement(pe.a,null))))));return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:g,size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Or,{label:"Project Name"},i.title),n.a.createElement(Or,{label:"Contract Value"},n.a.createElement(p.a,{justify:"space-between",align:"middle"},_(i.value))),n.a.createElement(Or,{label:"Organisation"},i.organizationName?n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(i.organizationId,"/info")},className:"nav-link"},i.organizationName):"No Organisation"),n.a.createElement(Or,{label:"Delegate Contact"},m?m.ContactName:null),n.a.createElement(Or,{label:"Start Date"},W(i.startDate,!0,!0)),n.a.createElement(Or,{label:"End Date"},W(i.endDate,!0,!0)),n.a.createElement(Or,{label:"Status"},n.a.createElement($t.a,{color:m.phase?"green":"red"},F[m.phase]))),d&&n.a.createElement(el.a,{type:"card",style:{marginTop:"50px"}},n.a.createElement(Ir,{tab:"Comments",key:"comments"},n.a.createElement(jl,{targetId:o,targetType:"WOR",onHold:!1===m.phase})),n.a.createElement(Ir,{tab:"Attachments",key:"attachments"},n.a.createElement(Al,{targetId:o,targetType:"WOR",onHold:!1===m.phase})),n.a.createElement(Ir,{tab:"Projected Profit & Loss",key:"profitloss"},n.a.createElement($i,{id:o,parent:"P",billing:c,type:i.type})),n.a.createElement(Ir,{tab:"Resources",key:"resources"},1===m.type?n.a.createElement(Er,{id:o,data:i}):n.a.createElement(kr,{id:o,data:i})),n.a.createElement(Ir,{tab:"Project Tracking",key:"projectTracking"},n.a.createElement(Dr,{id:o,data:i}))),r&&n.a.createElement(pr,{visible:r,editPro:o,close:this.closeModal,callBack:this.callBack,onHold:!1===m.phase}),f&&n.a.createElement(wl,this.props))}}]),a}(l.Component),xr=(el.a.TabPane,function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.openModal()},l.checkRates=function(e,t){e?t.label.includes("Employee")?l.getRates("employees",e):t.label.includes("Sub Contractor")?l.getRates("sub-contractors",e):l.setRates("No Active Contract","No Active Contract"):l.setRates(void 0,void 0)},l.getRates=function(e,t){var a=l.props.cmRate;Tt(e,t,"contactPerson").then((function(e){if(e.success){var t=e.data.employeeBuyRate;l.setRates(_(t),_(t/(1-a/100)))}}))},l.setRates=function(e,t){var a=l.state.ResourceFields;a[16].suggestion=e,a[17].suggestion=t,l.setState({ResourceFields:Object(we.a)(a)})},l.openModal=function(){var e=l.props,t=e.editRex,a=e.panelId;kt(a).then((function(e){var a=l.state.ResourceFields;a[3].data=e.success?e.data:[],l.setState({ResourceFields:a},(function(){t&&l.getRecord(e.data)}))}))},l.onFinish=function(e){l.setState({loading:!0});var t=l.props.editRex,a=e.obj;a=Object(Fe.a)(Object(Fe.a)({},a),{},{startDate:W(a.startDate,!0),endDate:W(a.endDate,!0),isMarkedAsSelected:!0}),t?l.editRecord(a):l.addRecord(a)},l.addRecord=function(e){var t=l.props,a=t.proId,n=t.callBack;(function(e,t,a){return z.b.loading({content:"Loading...",key:a}),Ve.a.post("".concat(A).concat(e),t,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:a}),n&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:n}})).catch((function(e){return Q(e,a,5)}))})(t.crud,e,a).then((function(e){e.success?n():l.setState({loading:!1})}))},l.getRecord=function(e){var t=l.props;(function(e,t){return Ve.a.get("".concat(A).concat(e,"/").concat(t),{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;if($(n),a){var i,r,o,s,c,d,u,m,f,p,b,g,y,h,v,E={panelSkillId:l.panelSkillId,title:l.title,panelSkillStandardLevelId:l.panelSkillStandardLevelId,ltceil:null===(i=l.panelSkillStandardLevel)||void 0===i?void 0:i.longTermCeil,stceil:null===(r=l.panelSkillStandardLevel)||void 0===r?void 0:r.shortTermCeil,billableHours:l.billableHours,startDate:W(l.startDate),endDate:W(l.endDate),contactPersonId:null===l||void 0===l||null===(o=l.opportunityResourceAllocations)||void 0===o||null===(s=o[0])||void 0===s?void 0:s.contactPersonId,buyingRate:null===l||void 0===l||null===(c=l.opportunityResourceAllocations)||void 0===c||null===(d=c[0])||void 0===d?void 0:d.buyingRate,sellingRate:null===l||void 0===l||null===(u=l.opportunityResourceAllocations)||void 0===u||null===(m=u[0])||void 0===m?void 0:m.sellingRate,effortRate:null===l||void 0===l||null===(f=l.opportunityResourceAllocations)||void 0===f||null===(p=f[0])||void 0===p?void 0:p.effortRate,allocationId:null===l||void 0===l||null===(b=l.opportunityResourceAllocations)||void 0===b||null===(g=b[0])||void 0===g?void 0:g.id,role:null===(y=l.opportunityResourceAllocations)||void 0===y||null===(h=y[0])||void 0===h?void 0:h.role};return K(null===e||void 0===e||null===(v=e.headers)||void 0===v?void 0:v.authorization),{success:a,data:E}}return{success:a}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(t.crud,t.editRex).then((function(t){if(t.success){var a,n=e.findIndex((function(e){return e.value===t.data.panelSkillId})),i="employees/get/by-skills?psslId=".concat(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.panelSkillStandardLevelId,"&workType=P");ht(i).then((function(a){var i,r,o=l.state.ResourceFields;o[6].data=e[n]?e[n].levels:[],o[10].data=a.success?a.data:[],o[19].hint=l.ceilHint(null===(i=t.data)||void 0===i?void 0:i.stceil,null===(r=t.data)||void 0===r?void 0:r.ltceil),l.formRef.current.setFieldsValue({obj:t.data}),l.setState({ResourceFields:o,allocationId:t.data.allocationId},(function(){var e,a;(null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.role)?l.checkRates(t.data.contactPersonId,{label:null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.role}):l.setRates("No Active Contract","No Active Contract")}))}))}}))},l.editRecord=function(e){var t=l.props,a=t.editRex,n=t.crud,i=t.callBack;e.id=a,function(e,t,a){return z.b.loading({content:"Loading...",key:t}),Ve.a.put("".concat(A).concat(e,"/").concat(t),a,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.data,r=l.message;return $(r),z.b.success({content:r,key:t}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),{success:n,data:i[0]}})).catch((function(e){return Q(e,t,5)}))}(n,a,e).then((function(e){e.success?i():l.setState({loading:!1})}))},l.ceilHint=function(e,t){return n.a.createElement("div",null,n.a.createElement("span",{style:{float:"left"}},"ST Ceil(hourly): ",e),n.a.createElement("span",{style:{float:"right"}},"LT Ceil(hourly): ",t))},l.formRef=n.a.createRef(),l.state={editRex:!1,resourceSubmitted:!1,check:!1,loading:!1,SKILLS:[],STATES:[],ORGS:[],data:{},ResourceFields:[{Placeholder:"Position Title",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Skill",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"title",size:"small",type:"Input"},{object:"obj",fieldCol:12,key:"panelSkillId",disabled:e.editRex,size:"small",rules:[{required:!0,message:"Skill is Required"}],data:[],type:"Select",onChange:function(e,t){var a=l.state.ResourceFields;a[6].data=t?t.levels:[];var n=l.formRef.current.getFieldsValue().obj;n.panelSkillStandardLevelId=void 0,n.contactPersonId=void 0,delete a[19].hint,l.formRef.current.setFieldsValue({obj:n}),l.setState({ResourceFields:a})}},{Placeholder:"Level",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{Placeholder:"Total Billable Hours",fieldCol:12,size:"small",type:"Text",rangeMin:!0,labelAlign:"right"},{object:"obj",fieldCol:12,key:"panelSkillStandardLevelId",disabled:e.editRex,size:"small",rules:[{required:!0,message:"Level is Required"}],data:[],type:"Select",onChange:function(){var e=Object(La.a)(Ma.a.mark((function e(t,a){var n,i,r,o,s,c,d;return Ma.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.state.ResourceFields,!t){e.next=12;break}return i="employees/get/by-skills?psslId=".concat(t,"&workType=P"),e.next=5,ht(i);case 5:r=e.sent,o=r.success,s=r.data,n[10].data=o?s:[],n[19].hint=l.ceilHint(a.stceil,a.ltceil),e.next=13;break;case 12:delete n[19].hint;case 13:c=l.formRef.current.getFieldsValue(),(d=c.obj).contactPersonId=void 0,l.formRef.current.setFieldsValue({obj:d}),l.setState({ResourceFields:n});case 17:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()},{object:"obj",fieldCol:12,key:"billableHours",size:"small",rules:[{required:!0,message:"Work Hour is Required"}],type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"Resource",fieldCol:12,rangeMin:!0,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Start Date",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"contactPersonId",disabled:e.editRex,size:"small",rules:[{required:!0,message:"Resource is Required"}],data:[],type:"Select",onChange:function(e,t){l.checkRates(e,t)}},{object:"obj",fieldCol:12,key:"startDate",size:"small",rules:[{required:!0,message:"Start Date is Required"}],type:"DatePicker",fieldStyle:{width:"100%"},rangeMin:function(t){var a=l.formRef.current.getFieldValue().obj;return te(t,null===a||void 0===a?void 0:a.endDate,e.pDates)}},{Placeholder:"End Date",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{Placeholder:"Effort Rate",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"endDate",size:"small",rules:[{required:!0,message:"End Date is Required"}],type:"DatePicker",fieldStyle:{width:"100%"},rangeMax:function(t){var a=l.formRef.current.getFieldValue().obj;return ae(t,null===a||void 0===a?void 0:a.startDate,e.pDates)}},{object:"obj",fieldCol:12,key:"effortRate",rules:[{required:!0,message:"Effort Rate is Required"}],shape:"%",size:"small",type:"InputNumber",fieldStyle:{width:"100%"},rangeMin:0,rangeMax:100},{Placeholder:"Buy Rate (Hourly)",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{Placeholder:"Sell Rate (Hourly)",fieldCol:12,rangeMin:!0,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"buyingRate",shape:"$",size:"small",rules:[{required:!0,message:"Buying Rate is Required"}],type:"InputNumber",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"sellingRate",shape:"$",size:"small",rules:[{required:!0,message:"Selling Rate is Required"}],type:"InputNumber",fieldStyle:{width:"100%"}}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.editRex,a=e.visible,l=e.close,i=e.onHold,r=this.state,o=r.ResourceFields,s=r.loading;return n.a.createElement(wt.a,{title:t?"Edit Resource":"Add Resource",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:s||i,htmlType:"submit",form:"my-form"},okText:s?n.a.createElement(Mt.a,null):"Save",onCancel:l,width:900},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,scrollToFirstError:!0,size:"small",layout:"inline",initialValues:{obj:{effortRate:100}}},n.a.createElement(ft,{FormFields:o})))}}]),a}(l.Component)),Tr="".concat(A,"/milestones"),zr=function(e){return Ve.a.get("".concat(A).concat(e),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Ar=function(e,t){return Ve.a.get("".concat(A,"/").concat(e),{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;if($(n),a){var i,r={id:l.id,panelId:l.panelId,organizationId:l.organizationId,organizationName:l.organization&&l.organization.name,ContactName:l.contactPerson&&"".concat(l.contactPerson.firstName,"  ").concat(l.contactPerson.lastName," - ").concat(l.contactPerson.phoneNumber),contactPersonId:l.contactPersonId,qualifiedOps:l.qualifiedOps,type:l.type,title:l.title,stateId:l.stateId},o={tender:l.tender,tenderNumber:l.tenderNumber},s={cmPercentage:l.cmPercentage?l.cmPercentage:0,cm$:l.value*l.cmPercentage/100,getPercentage:l.getPercentage?l.getPercentage:0,goPercentage:l.goPercentage?l.goPercentage:0,totalMonths:l.startDate&&l.endDate?Math.ceil(W(l.endDate).diff(W(l.startDate),"months",!0)):0,endDate:W(l.endDate),startDate:W(l.startDate),value:l.value?l.value:0};s.goget=s.getPercentage*s.goPercentage/100,s.discount=l.value*s.goget/100,s.upside=l.value-s.discount;var c={entryDate:W(l.entryDate),startDate:W(l.startDate),hoursPerDay:l.hoursPerDay,endDate:W(l.endDate),bidDate:W(l.bidDate)},d={accountDirectorId:l.accountDirectorId,accountManagerId:l.accountManagerId,opportunityManagerId:l.opportunityManagerId,projectManagerId:l.projectManagerId};return l.ContactName=l.contactPerson&&l.contactPerson.firstName+" "+l.contactPerson.lastName,l.organizationName=l.organization&&l.organization.name,K(null===e||void 0===e||null===(i=e.headers)||void 0===i?void 0:i.authorization),{success:a,data:l,basic:r,tender:o,billing:s,dates:c,manage:d}}return{success:a}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))},Rr=function(e){return z.b.loading({content:"Loading...",key:1}),Ve.a.get("".concat(Tr,"/approvals").concat(e?"?projectId="+e:""),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),z.b.destroy(1),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return Q(e,1,5)}))},wr=function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.patch("".concat(Tr).concat(e),t,{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.data,r=l.message;return $(r),z.b.success({content:r,key:e}),K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n,data:i}})).catch((function(e){return Q(e,1,5)}))},Fr=ul.b.Item,Nr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.fetchAll()},l.fetchAll=function(e){var t=JSON.parse(G().permissions).PROJECTS,a=l.props.match.url,n=l.props.match.params,i=n.proId,r=n.mileId;Promise.all([Yi(i),Hi(a)]).then((function(e){var n,o,s,c,d,u,m,f,p;l.setState({proDesc:(null===(n=e[0])||void 0===n?void 0:n.success)?e[0].data:{},mileDesc:(null===(o=e[0])||void 0===o?void 0:o.success)&&(null===(s=e[0])||void 0===s||null===(c=s.data)||void 0===c?void 0:c.milestones)?null===(d=e[0])||void 0===d||null===(u=d.data)||void 0===u?void 0:u.milestones.filter((function(e){return e.id==r}))[0]:{},editRex:!1,proId:i,crud:a,mileId:r,infoModal:!1,data:(null===(m=e[1])||void 0===m?void 0:m.success)?e[1].data:[],filterData:(null===(f=e[1])||void 0===f?void 0:f.success)?e[1].data:[],permissions:t,notAuth:null===e||void 0===e||null===(p=e[1])||void 0===p?void 0:p.authError})})).catch((function(e){console.log(e)}))},l.getLeadSkills=function(e){var t=l.state.crud;Hi(t).then((function(e){e.success&&l.setState({data:e.success?e.data:[],filterData:e.success?e.data:[],editRex:!1,infoModal:!1})}))},l.openModal=function(e){var t=l.state.mileDesc,a=t.startDate,n=t.endDate;l.setState({editRex:e,pDates:{startDate:a,endDate:n},infoModal:!0})},l.closeModal=function(){l.setState({infoModal:!1,editRex:!1})},l.handleDelete=function(e,t){var a=l.state,n=a.crud,i=a.data,r=a.filterData,o=l.props.history;sl(o,n,e,t,r,i).then((function(a){console.log(e,t),a.success&&l.setState({data:Object(we.a)(a.data),filterData:Object(we.a)(a.filterData)})}))},l.callBack=function(){var e=l.state.proId;l.getLeadSkills(e)},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){var a,l,n=t.opportunityResourceAllocations&&(null===(a=t.opportunityResourceAllocations[0])||void 0===a?void 0:a.contactPerson),i=n.firstName,r=n.lastName,o=t.opportunityResourceAllocations&&t.opportunityResourceAllocations[0],s=o.buyingRate,c=o.sellingRate,d=t.panelSkill.label,u=t.panelSkillStandardLevel.levelLabel;return t.title&&t.title.toLowerCase().includes(e.toLowerCase())||"".concat(null!==i&&void 0!==i?i:""," ").concat(null!==r&&void 0!==r?r:"").toLowerCase().includes(e.toLowerCase())||"".concat(null!==d&&void 0!==d?d:"").toLowerCase().includes(e.toLowerCase())||"".concat(null!==u&&void 0!==u?u:"").toLowerCase().includes(e.toLowerCase())||"".concat(null!==(l=t.billableHours)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())||s&&_(s).toLowerCase().includes(e.toLowerCase())||c&&_(c).toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.advancefilter=function(e,t,a){var n=l.state,i=n.data,r=n.searchedColumn;if(t?r[t].value=e:r=a,r.skill.value||r.billableHours.value||r.startDate.value||r.endDate.value||r.buyingRate.value||r.sellingRate.value||r.effortRate.value){var o,s,c=null!==(o=r.startDate.value)&&void 0!==o?o:[null,null],d=null!==(s=r.endDate.value)&&void 0!==s?s:[null,null];l.setState({filterData:i.filter((function(e){var t,a,l,n,i,o,s,u,m=e.opportunityResourceAllocations&&e.opportunityResourceAllocations[0],f=m.buyingRate,p=m.sellingRate,b=m.effortRate;return"".concat(null!==(t=e.billableHours.toString())&&void 0!==t?t:"").toLowerCase().includes(r.billableHours.value.toString().toLowerCase())&&(null!==(a=_(f))&&void 0!==a?a:"").toLowerCase().includes(r.buyingRate.value.toString().toLowerCase())&&(null!==(l=_(p))&&void 0!==l?l:"").toLowerCase().includes(r.sellingRate.value.toString().toLowerCase())&&(null!==(n=_(b))&&void 0!==n?n:"").toLowerCase().includes(r.effortRate.value.toString().toLowerCase())&&(r.skill.value.length>0?r.skill.value:[{value:","}]).some((function(t){return(r.skill.value.length>0?[e.panelSkillId]:[","]).includes(t.value)}))&&T()(r.startDate.value?T()(e.startDate).format("YYYY-MM-DD"):"2010-10-20").isBetween(null!==(i=c[0])&&void 0!==i?i:"2010-10-19",null!==(o=c[1])&&void 0!==o?o:"2010-10-25",void 0,"[]")&&T()(r.endDate.value?T()(e.endDate).format("YYYY-MM-DD"):"2010-10-20").isBetween(null!==(s=d[0])&&void 0!==s?s:"2010-10-19",null!==(u=d[1])&&void 0!==u?u:"2010-10-25",void 0,"[]")})),searchedColumn:r,openSearch:!1})}else l.setState({searchedColumn:r,filterData:i,openSearch:!1})},l.filterModalUseEffect=function(){var e=l.state.proDesc;Promise.all([kt(e.panelId)]).then((function(e){var t=l.state.filterFields;t[2].data=e[0].success?e[0].data:[],l.setState({filterFields:t})})).catch((function(e){console.log(e)}))},l.columns=[Object(Fe.a)({title:"Title",dataIndex:"title",key:"title"},Jt("title","string")),Object(Fe.a)({title:"Skill",dataIndex:["panelSkill","label"],key:"panelSkill"},Jt("panelSkill.label","string")),Object(Fe.a)({title:"Level",dataIndex:["panelSkillStandardLevel","levelLabel"],key:"panelSkillStandardLevel"},Jt("panelSkillStandardLevel.levelLabel","string")),Object(Fe.a)({title:"Employee Name",dataIndex:["opportunityResourceAllocations","0","contactPerson"],key:"contactPerson",render:function(e){var t,a;return"".concat(null!==(t=null===e||void 0===e?void 0:e.firstName)&&void 0!==t?t:""," ").concat(null!==(a=null===e||void 0===e?void 0:e.lastName)&&void 0!==a?a:"")}},Jt("opportunityResourceAllocations.0.contactPerson","string")),Object(Fe.a)({title:"Billable Hours",dataIndex:"billableHours",key:"billableHours",render:function(e){return U(e)}},Jt("billableHours","number")),Object(Fe.a)({title:"Buy Rate (Hourly)",dataIndex:["opportunityResourceAllocations","0","buyingRate"],key:"opportunityResourceAllocations",render:function(e){return e&&_(e)}},Jt("opportunityResourceAllocations.0.buyingRate","number")),Object(Fe.a)({title:"Sell Rate (Hourly)",dataIndex:["opportunityResourceAllocations","0","sellingRate"],key:"opportunityResourceAllocations",render:function(e){return e&&_(e)}},Jt("opportunityResourceAllocations.0.sellingRate","number")),Object(Fe.a)({title:"CM $",dataIndex:["opportunityResourceAllocations","0","cm$"],key:"opportunityResourceAllocations$",render:function(e){return e&&_(e)}},Jt("opportunityResourceAllocations.0.cm$","number")),Object(Fe.a)({title:"CM %",dataIndex:["opportunityResourceAllocations","0","cmPercent"],key:"opportunityResourceAllocationsPercent",render:function(e){return"".concat(U(e)," %")}},Jt("opportunityResourceAllocations.0.cmPercent","number")),{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){var i,r,o,s,c,d;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(l))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"update",onClick:function(){return l.openModal(t.id)},disabled:!(null===(s=Object(Aa.a)(l))||void 0===s||null===(c=s.state)||void 0===c||null===(d=c.permissions)||void 0===d?void 0:d.UPDATE)},"Edit Resource"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],l.state={infoModal:!1,editRex:!1,proId:!1,mileId:!1,crud:!1,proDesc:{},mileDesc:{},permissions:{},openSearch:!1,filterData:[],searchedColumn:{skill:{type:"Select",multi:!0,value:[],label:"Skill",showInColumn:!0},level:{type:"Select",multi:!0,value:[],label:"Level",showInColumn:!0},name:{type:"Input",value:"",label:"Name",showInColumn:!0},billableHours:{type:"Input",value:"",label:"Billable Hour"},buyingRate:{type:"Input",value:"",label:"Buy Rate"},sellingRate:{type:"Input",value:"",label:"Sell Rate"},effortRate:{type:"Input",value:"",label:"Effort Rate"},startDate:{type:"Date",value:null,label:"Start Date",showInColumn:!0},endDate:{type:"Date",value:null,label:"End Date",showInColumn:!0,disabled:!0}},filterFields:[{Placeholder:"Skill",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Total Billable Hours",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,mode:"multiple",key:"skill",customValue:function(e,t){return t},size:"small",data:[],type:"Select"},{object:"obj",fieldCol:12,key:"billableHours",size:"small",type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"Start Date",fieldCol:12,size:"small",type:"Text"},{Placeholder:"End Date",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"startDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"endDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}},{Placeholder:"Effort Rate",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Buy Rate (Hourly)",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"effortRate",shape:"%",size:"small",type:"InputNumber",fieldStyle:{width:"100%"},rangeMax:100},{object:"obj",fieldCol:12,key:"buyingRate",shape:"$",size:"small",type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"Sell Rate (Hourly)",fieldCol:24,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"sellingRate",shape:"$",size:"small",type:"InputNumber",fieldStyle:{width:"100%"}}],notAuth:!1},l}return Object(d.a)(a,[{key:"render",value:function(){var e,t,a=this,l=this.state,i=l.proDesc,r=(l.data,l.infoModal),o=l.editRex,c=l.proId,d=l.permissions,u=l.crud,m=l.mileId,f=l.filterData,g=l.openSearch,y=l.searchedColumn,h=l.filterFields,v=l.pDates,E=l.notAuth,k=l.mileDesc;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:"Project Details",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Fr,{label:"Project Name"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(i.id,"/info")},className:"nav-link"},i.title)),n.a.createElement(Fr,{label:"Estimated Value"},_(null!==(e=i.value)&&void 0!==e?e:0)),n.a.createElement(Fr,{label:"Organisation"},i.organization?n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(i.organizationId,"/info")},className:"nav-link"},i.organization.name):"No Organisation"),n.a.createElement(Fr,{label:"Start Date"},W(i.startDate,!0,!0)," "),n.a.createElement(Fr,{label:"End Date"},W(i.endDate,!0,!0))),1===i.type&&n.a.createElement(ul.b,{style:{marginTop:15},title:"Milestone Details",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Fr,{label:"Milestone Name"},k.title),n.a.createElement(Fr,{label:"Start Date"},W(k.startDate,!0,!0)," "),n.a.createElement(Fr,{label:"End Date"},W(k.endDate,!0,!0)),n.a.createElement(Fr,{label:"Progress"},k.progress," %"),n.a.createElement(Fr,{label:"Approved"},n.a.createElement(fi,{text:null!==(t=k.isApproved)&&void 0!==t?t:"CM"}))),n.a.createElement(p.a,{justify:"end",span:4,gutter:[30,0]},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"default",size:"small",onClick:function(){return a.setState({openSearch:!0})}},n.a.createElement(Ft.a,null),"Filter")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){return a.openModal(!1)},disabled:!d.ADD||!1===i.phase},n.a.createElement(Nt.a,null)," Add Resource"))),n.a.createElement(ea,{filters:y,filterFunction:this.advancefilter}),n.a.createElement(Rt.a,{title:function(){return Qt(5,a.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:this.columns,dataSource:f,size:"small",className:"fs-small"}),g&&n.a.createElement(Zt,{title:"Filter Resources",visible:g,filters:y,filterFields:h,filterFunction:this.advancefilter,effectFunction:this.filterModalUseEffect,effectRender:!0,onClose:function(){return a.setState({openSearch:!1})}}),r&&n.a.createElement(xr,{visible:r,editRex:o,proId:c,pDates:v,crud:u,cmRate:i.cmPercentage,mileId:m,panelId:i.panelId,onHold:!1===i.phase,close:this.closeModal,callBack:this.callBack}),E&&n.a.createElement(wl,this.props))}}]),a}(l.Component),Mr=(a(523),ve.a.Text),Lr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){console.log(l.props.accountedAmount()),l.props.editMile&&l.getSubmittedData()},l.setHours=function(e,t,a){var n=l.state,i=n.data,r=n.amountEntry;i[a].amount=t,r[e.key]=t,l.setState({data:Object(we.a)(i),amountEntry:Object(Fe.a)({},r)})},l.getDateArray=function(e,t,a){var n=l.state,i=n.BasicFields,r=n.data,o=n.amountEntry;i[3].disabled=!1;var s=l.formRef.current.getFieldValue().dates;if(a){var c=new Array;r=a.map((function(e){var t=T()(e.startDate).format("MMM-YYYY");return o[t]="".concat(e.amount),{key:t,month:t,amount:o[t]}}))}else if(e&&t){c=new Array;for(var d=T()(t.endOf("month")).diff(e.startOf("month"),"months")+1,u=parseFloat(U(s.amount/d));e.isSameOrBefore(t);){var m=e.format("MMM-YYYY");o[m]=u,c.push({key:m,month:m,amount:o[m]}),e=T()(e).add(1,"M")}r=c}else if(e){var f=e.format("MMM-YYYY");o[f]=s.amount,r=[{key:f,month:f,amount:o[f]}]}else l.formRef.current.setFieldsValue({dates:{startDate:null,endDate:null}}),i[3].disabled=!0,o={},r=[];l.setState({BasicFields:Object(we.a)(i),data:Object(we.a)(r),amountEntry:Object(Fe.a)({},o)}),l.formRef.current.setFieldsValue({amount:o})},l.getSubmittedData=function(){var e=l.props;(function(e,t){return Ve.a.get(Vi+"/".concat(e,"/schedules/").concat(t),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l?(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}):{success:l}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(e.proId,e.editMile.id).then((function(e){if(null===e||void 0===e?void 0:e.success){var t,a,n=e.data,i=n.id,r=n.notes,o=n.amount,s=n.startDate,c=n.endDate,d=n.segments,u=void 0===d?[]:d,m={id:i,notes:r,amount:o,startDate:null===(t=W(s))||void 0===t?void 0:t.startOf("month"),endDate:null===(a=W(c))||void 0===a?void 0:a.endOf("month")};l.getDateArray(m.startDate,m.endDate,u),l.formRef.current.setFieldsValue({dates:m})}})).catch((function(e){console.log(e)}))},l.getFormValues=function(e){var t,a;l.setState({loading:!0});var n=e.dates,i=l.props,r=i.editMile,o=i.callBack,s=i.proId,c=i.pDates,d=l.state,u=d.data,m=(d.fileIds,{startDate:n.startDate.isSame(c.startDate,"month")?W(c.startDate,!0):W(n.startDate,!0),endDate:n.endDate?n.endDate.isSame(c.endDate,"month")?W(c.endDate,!0):W(n.endDate,!0):n.startDate.isSame(c.startDate,"month")?W(c.startDate,!0):W(null===(t=n.startDate)||void 0===t?void 0:t.endOf("month"),!0),amount:n.amount,notes:null!==(a=n.notes)&&void 0!==a?a:"",segments:u.map((function(e){return{startDate:W(T()(e.month,"MMM/YYYY").startOf("month"),!0),endDate:W(T()(e.month,"MMM/YYYY").endOf("month"),!0),amount:e.amount}}))});r?function(e,t,a){return z.b.loading({content:"Loading...",key:t}),Ve.a.put(Vi+"/".concat(e,"/schedules/").concat(t),a,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message,r=l.data;return $(i),z.b.success({content:i,key:t}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),{success:n,data:r}})).catch((function(e){return Q(e,t,5)}))}(s,r.id,m).then((function(e){l.setState({loading:!1}),e.success&&o(e.data)})):function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.post(Vi+"/".concat(e,"/schedules"),t,{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.message,r=l.data;return $(i),z.b.success({content:i,key:e}),n&&K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n,data:r}})).catch((function(t){return Q(t,e,5)}))}(s,m).then((function(e){l.setState({loading:!1}),e.success&&o(e.data)}))},l.getTableSummary=function(e){var t,a,i,r,o=0,s="",c=(null!==(t=null===(a=l.formRef)||void 0===a||null===(i=a.current)||void 0===i?void 0:i.getFieldValue())&&void 0!==t?t:{}).dates,d=void 0===c?{}:c;return e.forEach((function(e){var t=e.amount;o+=parseFloat(null!==t&&void 0!==t?t:0)})),(null!==(r=d.amount)&&void 0!==r?r:0)<o&&(s="danger"),n.a.createElement(Rt.a.Summary,{fixed:"top"},n.a.createElement(Rt.a.Summary.Row,null,n.a.createElement(Rt.a.Summary.Cell,{index:0},"Total"),n.a.createElement(Rt.a.Summary.Cell,{index:1},n.a.createElement(Mr,{type:s},_(o)))))},l.accountedSegAmount=function(){var e=l.formRef.current.getFieldValue(),t=e.dates,a=e.amount;t&&a&&console.log(t,a)},l.formRef=n.a.createRef(),l.attachRef=n.a.createRef(),l.state={data:[],amountEntry:{},loading:!1,disabled:!1,BasicFields:[{Placeholder:"Start Date",rangeMin:!0,fieldCol:8,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:"10px"}},{object:"dates",fieldCol:16,key:"startDate",size:"small",mode:"month",type:"DatePicker",rules:[{required:!0,message:"Start Date is Required"}],onChange:function(e){var t=l.formRef.current.getFieldsValue().dates,a=t.startDate;t.endDate;l.formRef.current.setFieldsValue({dates:Object(Fe.a)(Object(Fe.a)({},t),{},{endDate:null,startDate:e&&a.startOf("month")})}),l.getDateArray(a)},rangeMin:function(t){var a=l.formRef.current.getFieldsValue().dates.endDate;return Z(t,a,"start",e.pDates)}},{Placeholder:"End Date",fieldCol:8,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:"10px"}},{object:"dates",fieldCol:16,key:"endDate",size:"small",mode:"month",type:"DatePicker",disabled:!0,onChange:function(e){var t=l.formRef.current.getFieldValue().dates,a=t.endDate,n=t.startDate;e&&l.formRef.current.setFieldsValue({dates:Object(Fe.a)(Object(Fe.a)({},t),{},{endDate:a.endOf("month")})}),l.getDateArray(n,a)},rangeMax:function(t){var a=l.formRef.current.getFieldValue().dates.startDate;return Z(t,T()(a),"end",e.pDates)}},{Placeholder:"Amount",rangeMin:!0,fieldCol:8,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:"10px"}},{object:"dates",fieldCol:16,key:"amount",size:"small",type:"InputNumber",rangeMin:0,rangeMax:e.accountedAmount(),shape:"$",rules:[{required:!0,message:"Amount is Required"}],disabled:!1,onBlur:function(){var e=l.formRef.current.getFieldValue().dates,t=void 0===e?{}:e,a=t.endDate,n=t.startDate;l.getDateArray(n,a)}},{Placeholder:"Description",fieldCol:8,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:"10px"}},{object:"dates",fieldCol:24,key:"notes",size:"small",type:"Textarea",mode:{minRows:2,maxRows:3},fieldStyle:{height:"10vh"}}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.visible,l=t.close,i=t.editMile,r=t.onHold,o=this.state,s=o.BasicFields,c=o.data,d=o.loading,u=o.disabled,m=[{title:"Month",dataIndex:"month",key:"month",render:function(e,t){return n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null," ",e," "))}},{title:"Amount",dataIndex:"amount",key:"amount",render:function(t,a,l){return n.a.createElement(Me.a.Item,{noStyle:!0,name:["amount",a.key]},n.a.createElement(Xe.a,{min:0,placeholder:"amount",formatter:function(e){return ut(e,"$")},parser:function(e){return mt(e,"$")},style:{width:"100%"},size:"small",disabled:a.disabled,onChange:function(t){e.setHours(a,t,l)}}))}}];return n.a.createElement(wt.a,{title:i?"Edit Schedule":"New Schedule",maskClosable:!0,destroyOnClose:!0,visible:a,okButtonProps:{htmlType:"submit",form:"my-form",disabled:r||u,loading:d},okText:"Submit",onCancel:function(){z.b.destroy(),l()},width:1e3},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,size:"small",layout:"inline",onFinish:this.getFormValues},n.a.createElement(p.a,{className:"moz-width"},n.a.createElement(b.a,{span:12},n.a.createElement(p.a,null,n.a.createElement(ft,{FormFields:s}))),n.a.createElement(b.a,{span:12},n.a.createElement(Rt.a,{sticky:!0,style:{maxHeight:"40vh",overflowY:"scroll",position:"relative"},pagination:!1,rowKey:function(e){return e.key},columns:m,dataSource:c,size:"small",summary:function(t){return e.getTableSummary(t)}})))))}}]),a}(l.Component),Br=ul.b.Item,qr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){var e=l.props.match.params.proId;l.fetchAll(e)},l.fetchAll=function(e){var t=l.props.match.params.proId,a=JSON.parse(G().permissions),n=a.PROJECTS,i=(a.OPPORTUNITIES,l.props.match.url);i=i.split("/"),i="".concat(i[1],"/").concat(i[2]),Promise.all([Ar(i),Ki(t)]).then((function(t){var a=l.state.columns;l.setState({desc:t[0].success&&t[0].data,data:t[1].success&&t[1].data,columns:Object(we.a)(a),proId:e,permissions:n})})).catch((function(e){console.log(e)}))},l.openModal=function(e){var t=l.state.desc,a=t.startDate,n=t.endDate;l.setState({pDates:{startDate:a,endDate:n},editMile:e,infoModal:!0})},l.closeModal=function(){l.setState({infoModal:!1,editMile:!1})},l.handleDelete=function(e,t){var a=l.state,n=a.data,i=a.proId,r=l.props.history,o="/projects/".concat(i,"/schedules");sl(r,o,e,t,n,!1).then((function(e){e.success&&l.setState({data:Object(we.a)(e.filterData)})}))},l.callBack=function(e){var t=l.state,a=t.editMile,n=t.data;a?n[a.rowIndex]=e:n.push(e),console.log(n),l.setState({data:Object(we.a)(n),infoModal:!1,editMile:!1})},l.state={infoModal:!1,editMile:!1,pDates:{},proId:!1,desc:{title:"",organization:{name:""},value:"",startDate:"",endDate:""},permissions:{},columns:[Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return W(e,!0,!0)}},Jt("startDate","date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e){return W(e,!0,!0)}},Jt("endDate","date")),{title:"Amount",dataIndex:"amount",key:"amount",align:"center",render:function(e){return e}},{title:"Notes",dataIndex:"notes",key:"notes",align:"right",render:function(e){return n.a.createElement($e.a,{placement:"top",title:e,destroyTooltipOnHide:!0},"".concat(e.substr(0,20)).concat(e.length>30?"\u2026":""))}},{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){var i,r,o;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(l))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",onClick:function(){l.openModal(Object(Fe.a)(Object(Fe.a)({},t),{},{rowIndex:a}))},disabled:l.state&&!l.state.permissions.UPDATE},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.desc,l=t.data,i=t.infoModal,r=t.editMile,o=t.proId,c=t.permissions,d=t.columns,u=t.pDates;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:"Project Details",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Br,{label:"Title"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(a.id,"/info")},className:"nav-link"},a.title)),n.a.createElement(Br,{label:"Value"},_(a.value)),n.a.createElement(Br,{label:"Start Date"},W(a.startDate,!0,!0)),n.a.createElement(Br,{label:"End Date"},W(a.endDate,!0,!0)),n.a.createElement(Br,{label:"Status"},n.a.createElement(fi,{text:a.phase,objName:"O_PHASE",colorName:"O_PHASE_COLORS"}))),n.a.createElement(p.a,{justify:"end"},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){return e.openModal(!1)},disabled:!c.ADD||!1===(null===a||void 0===a?void 0:a.phase)},"Add Schedule"))),n.a.createElement(Rt.a,{bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:d,dataSource:l,size:"small",className:"fs-small"}),i&&n.a.createElement(Lr,{visible:i,editMile:r,accountedAmount:function(){var e=parseFloat(a.value);return l.forEach((function(t){console.log(t.amount),e-=parseFloat(t.amount)})),console.log(e),e},onHold:!1===(null===a||void 0===a?void 0:a.phase),pDates:u,proId:o,close:this.closeModal,callBack:this.callBack}))}}]),a}(l.Component),Vr=(el.a.TabPane,function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){var t=e.props,a=t.editRex,l=t.panelId;console.log({editRex:a},{panelId:l}),e.openModal()},e.openModal=function(){var t=e.props,a=t.editRex,l=t.panelId;kt(l).then((function(t){var l=e.state.ResourceFields;l.fields[2].data=t.success?t.data:[],e.setState({ResourceFields:l},(function(){a&&e.getRecord(t.data)}))}))},e.submit=function(){e.resourceRef.current&&e.resourceRef.current.refs.resource_form.submit()},e.ResourceCall=function(t){var a=e.props.editRex,l=t.obj;l=Object(Fe.a)(Object(Fe.a)({},l),{},{s_date:W(l.s_date,!0),e_date:W(l.e_date,!0)}),a?e.editRecord(l):e.addRecord(l)},e.addRecord=function(t){e.setState({loading:!0});var a=e.props,l=a.proId,n=a.callBack;console.log(l),Ai(l,t).then((function(e){e.success&&n()}))},e.getRecord=function(t){var a=e.props,l=a.proId;a.editRex;Ri(l).then((function(a){if(console.log(a.data),a.success){var l=t.findIndex((function(e){return e.value===a.data.panelSkillId}));yt().then((function(n){var i=e.state.ResourceFields;i.fields[3].data=t[l]?t[l].levels:[],i.fields[6].data=n.success?n.data:[],e.resourceRef.current.refs.resource_form.setFieldsValue({obj:a.data}),e.setState({ResourceFields:i})}))}}))},e.editRecord=function(t){e.setState({loading:!0});var a=e.props,l=a.editRex,n=a.proId,i=a.callBack;t.id=l,wi(l,n,t).then((function(e){e.success&&i()}))},e.resourceRef=n.a.createRef(),e.state={editRex:!1,resourceSubmitted:!1,check:!1,loading:!1,SKILLS:[],STATES:[],ORGS:[],ResourceFields:{formId:"resource_form",FormCol:24,FieldSpace:24,justifyField:"center",FormLayout:"inline",size:"middle",fields:[{Placeholder:"Bill Hours",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Buy Rate (Hourly)",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"billableHours",size:"small",type:"InputNumber",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"buyingRate",size:"small",type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"Sell Rate (Hourly)",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Start Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"sellingRate",size:"small",type:"InputNumber",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"s_date",size:"small",type:"DatePicker",fieldStyle:{width:"100%"}},{Placeholder:"End Date",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"e_date",size:"small",type:"DatePicker",fieldStyle:{width:"100%"}}]}},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.editRex,l=t.visible,i=t.close,r=this.state,o=r.ResourceFields,s=r.loading;return n.a.createElement(wt.a,{title:a?"Edit opportunity":"Add Resource",maskClosable:!1,centered:!0,visible:l,onOk:function(){e.submit()},okButtonProps:{disabled:s},okText:s?n.a.createElement(Mt.a,null):"Save",onCancel:i,width:900},n.a.createElement(Kt,{ref:this.resourceRef,Callback:this.ResourceCall,FormFields:o}))}}]),a}(l.Component)),Yr=ul.b.Item,Hr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){var e=l.props.match.params,t=e.proId,a=e.id;l.fetchAll(t,a)},l.fetchAll=function(e,t){Promise.all([zi(t),Ri(t)]).then((function(a){l.setState({desc:a[0].success?a[0].data:{},editRex:!1,ProId:e,resId:t,data:a[1].success?a[1].data:[]})})).catch((function(e){console.log(e)}))},l.getLeadSkills=function(e){Ri(e).then((function(e){e.success&&l.setState({desc:e.data,editRex:!1})}))},l.closeModal=function(){l.setState({infoModal:!1,editRex:!1})},l.handleDelete=function(e){var t,a,n=l.props.match.params.id;(t=n,a=e,console.log(t,a),Ve.a.delete(Ti+"/".concat(t,"/resources/").concat(a),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e.success}))},l.callBack=function(){var e=l.state.ProId;l.getLeadSkills(e)},console.log(l.props),l.columns=[{title:"Billable Hours",dataIndex:"billableHours",key:"billableHours"},{title:"Buy Rate",dataIndex:"buyingRate",key:"buyingRate"},{title:"Sell Rate",dataIndex:"sellingRate",key:"sellingRate"},{title:"Start Date",dataIndex:"startDate",key:"startDate"},{title:"End Date",dataIndex:"endDate",key:"endDate"},{title:"...",key:"action",align:"center",width:"1%",render:function(e){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(e.id)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",onClick:function(){console.log(e.id),l.setState({infoModal:!0,editRex:e.id})}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],l.state={infoModal:!1,editRex:!1,ProId:!1,data:[{billableHours:6,buyingRate:20,sellingRate:21,startDate:"Mon Nov 20 2020",endDate:"Fri Dec 20 2020"},{billableHours:6,buyingRate:20,sellingRate:22,startDate:"Mon Dec 22 2020",endDate:"Mon Jan 20 2021"},{billableHours:6,buyingRate:21,sellingRate:25,startDate:"Tue Jan 21 2021",endDate:"Tue Fri 10 2021"}],desc:{}},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.desc,l=t.data,i=t.infoModal,r=t.editRex,o=t.ProId;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Yr,{label:"First Name"},"Talha"),n.a.createElement(Yr,{label:"Last Name"},"Ahmed"),n.a.createElement(Yr,{label:"Skill"},"Andriod Developer"),n.a.createElement(Yr,{label:"Level"},"Senior")),n.a.createElement(p.a,{justify:"end"},n.a.createElement(b.a,null," ",n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){e.setState({infoModal:!0,editRex:!1})}},"Add New")," ")),n.a.createElement(Rt.a,{bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:this.columns,dataSource:l,size:"small",className:"fs-small"}),i&&n.a.createElement(Vr,{visible:i,editRex:r,ProId:o,panelId:a.panelId,close:this.closeModal,callBack:this.callBack}))}}]),a}(l.Component),_r=(el.a.TabPane,function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.getRecord()},e.OrderCall=function(t){var a=e.props.editRex,l=t.obj;l=Object(Fe.a)(Object(Fe.a)({},l),{},{fileId:e.state.fileIds,issueDate:W(l.issueDate,!0),expiryDate:W(l.expiryDate,!0)}),a?e.editRecord(l):e.addRecord(l)},e.addRecord=function(t){e.setState({loading:!0});var a=e.props,l=a.ProId,n=a.callBack;console.log(l,t),function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.post(Vi+"/".concat(e,"/purchaseOrders"),t,{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.message,r=l.data;return $(i),z.b.success({content:i,key:e}),n&&K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n,data:r}})).catch((function(t){return Q(t,e,5)}))}(l,t).then((function(e){e.success&&n(e.data)}))},e.getRecord=function(){var t,a,l=e.props,n=l.ProId,i=l.editRex;i&&(t=n,a=i,Ve.a.get(Vi+"/".concat(t,"/purchaseOrders/").concat(a),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l?(n=Object(Fe.a)(Object(Fe.a)({},n),{},{issueDate:W(n.issueDate),expiryDate:W(n.expiryDate),file:n.fileId?[{id:n.file.id,createdAt:n.file.createdAt,fileId:n.file.id,uid:n.file.uniqueName,name:n.file.originalName,type:n.file.type,url:"".concat(A,"/files/").concat(n.file.uniqueName),thumbUrl:X(n.file.type)}]:[]}),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}):{success:l}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))).then((function(t){var a=t.success,l=t.data;a&&(e.formRef.current.setFieldsValue({obj:l}),e.setState({fileIds:a?l.fileId:null,fileList:a?l.file:[]}))}))},e.editRecord=function(t){e.setState({loading:!0});var a=e.props,l=a.editRex,n=a.ProId,i=a.callBack;t.id=l,function(e,t,a){return z.b.loading({content:"Loading...",key:t}),Ve.a.put(Vi+"/".concat(e,"/purchaseOrders/").concat(t),a,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message,r=l.data;return $(i),z.b.success({content:i,key:t}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),{success:n,data:r}})).catch((function(e){return Q(e,t,5)}))}(n,l,t).then((function(e){e.success&&i(e.data)}))},e.handleUpload=function(){var t=Object(La.a)(Ma.a.mark((function t(a){var l,n,i,r,o;return Ma.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=a.onSuccess,n=a.onError,i=a.file,r=a.onProgress,o=new FormData,{headers:{"content-type":"multipart/form-data"},onUploadProgress:function(t){var a=Math.floor(t.loaded/t.total*100);e.setState({progress:a}),100===a&&setTimeout((function(){return e.setState({progres:0})}),1e3),r({percent:t.loaded/t.total*100})}},o.append("files",i),vl(o).then((function(t,a){if(t.success)l("Ok"),e.setState({fileList:[t.file],fileIds:t.file.fileId});else{console.log("Eroor: ",a);new Error("Some error");n({err:a})}}));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onRemove=function(t){e.setState({fileIds:null,fileList:[]})},e.formRef=n.a.createRef(),e.state={editRex:!1,orderSubmitted:!1,check:!1,loading:!1,SKILLS:[],STATES:[],ORGS:[],fileList:[],fileIds:null,OrderFields:[{Placeholder:"Order Number",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{Placeholder:"Issue Date",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"orderNo",size:"small",rules:[{required:!0,message:"Order Number is Required"}],type:"Input"},{object:"obj",fieldCol:12,key:"issueDate",size:"small",rules:[{required:!0,message:"Issue Date is Required"}],type:"DatePicker",fieldStyle:{width:"100%"}},{Placeholder:"Expiry Date",fieldCol:12,rangeMin:!0,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Value",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"expiryDate",size:"small",rules:[{required:!0,message:"Expiry Date is Required"}],type:"DatePicker",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"value",size:"small",rules:[{required:!0,message:"Value is Required"}],shape:"$",type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"Expense",fieldCol:24,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"expense",size:"small",rules:[{required:!0,message:"Expense is Required"}],shape:"$",type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"Description",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"description",size:"small",type:"Textarea",itemStyle:{marginBottom:1}},{Placeholder:"Comments",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"comment",size:"small",type:"Textarea",itemStyle:{marginBottom:1}}]},e}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.editRex,a=e.visible,l=e.close,i=e.onHold,r=this.state,o=r.OrderFields,s=r.loading,c=r.fileList;return n.a.createElement(wt.a,{title:t?"Edit Purchase Order":"Add Purchase Order",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:s||i,htmlType:"submit",form:"my-form"},okText:s?n.a.createElement(Mt.a,null):"Save",onCancel:l,width:900},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.OrderCall,scrollToFirstError:!0,size:"small",layout:"inline"},n.a.createElement(ft,{FormFields:o})),n.a.createElement("p",{style:{marginTop:10,marginBottom:2}},"Signed Contract"),n.a.createElement(We.a,{customRequest:this.handleUpload,listType:"picture-card",maxCount:1,fileList:c,onRemove:this.onRemove},c.length<1&&n.a.createElement("div",{style:{marginTop:10}},n.a.createElement(Ll.a,null),n.a.createElement("div",{style:{marginTop:8}},"Upload"))))}}]),a}(l.Component)),Ur=(ve.a.Title,ul.b.Item),Wr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){var e=l.props.match.params.proId;l.fetchAll(e)},l.fetchAll=function(e){var t=JSON.parse(G().permissions).PROJECTS;Promise.all([Yi(e),Ui(e)]).then((function(a){l.setState({desc:a[0].success?a[0].data:{},editRex:!1,ProId:e,openModal:!1,data:a[1].success?a[1].data:[],filterData:a[1].success?a[1].data:[],permissions:t})})).catch((function(e){console.log(e)}))},l.getRecords=function(e){Ui(e).then((function(e){e.success&&l.setState({data:e.success?e.data:[],filterData:e.success?e.data:[],editRex:!1,openModal:!1})}))},l.openModal=function(e,t,a){l.setState({openModal:e,editRex:t,tableIndex:a})},l.closeModal=function(){l.setState({openModal:!1,editRex:!1,tableIndex:!1})},l.handleDelete=function(e,t){var a=l.state,n=a.ProId,i=a.data,r=a.filterData,o=l.props.history,s="/projects/".concat(n,"/purchaseOrders");console.log(e,t),sl(o,s,e,t,r,i).then((function(e){e.success&&l.setState({data:Object(we.a)(e.data),filterData:Object(we.a)(e.filterData)})}))},l.callBack=function(e){var t=l.state,a=t.tableIndex,n=t.data;!1!==a?n[a]=e:n.push(e),l.setState({data:n,filterData:Object(we.a)(n),openModal:!1,editRex:!1,tableIndex:!1})},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){return"00".concat(t.id.toString()).includes(e)||t.value&&_(t.value).toLowerCase().includes(e.toLowerCase())||t.expense&&_(t.expense).toLowerCase().includes(e.toLowerCase())||t.issueDate&&"".concat(W(t.issueDate,!0,!0)).toLowerCase().includes(e.toLowerCase())||t.expiryDate&&"".concat(W(t.expiryDate,!0,!0)).toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.advancefilter=function(e,t,a){var n=l.state,i=n.data,r=n.searchedColumn;if(t?r[t].value=e:r=a,r.issueDate.value||r.expiryDate.value||r.value1.value||r.value2.value||r.expense1.value||r.expense2.value||r.comment.value||r.description.value){var o,s,c=null!==(o=r.issueDate.value)&&void 0!==o?o:["2010-10-19","2010-10-25"],d=null!==(s=r.expiryDate.value)&&void 0!==s?s:["2010-10-19","2010-10-25"];l.setState({filterData:i.filter((function(e){var t,a;return T()(r.issueDate.value?W(e.issueDate,!0,"YYYY-MM-DD"):"2010-10-20").isBetween(c[0],c[1],void 0,"[]")&&T()(r.expiryDate.value?W(e.expiryDate,!0,"YYYY-MM-DD"):"2010-10-20").isBetween(d[0],d[1],void 0,"[]")&&"".concat(null!==(t=e.comment)&&void 0!==t?t:"").toLowerCase().includes(r.comment.value.toLowerCase())&&"".concat(null!==(a=e.description)&&void 0!==a?a:"").toLowerCase().includes(r.description.value.toLowerCase())})),searchedColumn:r,openSearch:!1})}else l.setState({searchedColumn:r,filterData:i,openSearch:!1})};e.match.params.proId;return l.columns=[Object(Fe.a)({title:"Order Number",dataIndex:"orderNo",key:"orderNo"},Jt("orderNo","string",!0)),Object(Fe.a)({title:"Issue Date",dataIndex:"issueDate",key:"issueDate",render:function(e){return W(e,!0,!0)}},Jt("issueDate","date")),Object(Fe.a)({title:"Expiry Date",dataIndex:"expiryDate",key:"expiryDate",render:function(e){return W(e,!0,!0)}},Jt("expiryDate","date")),Object(Fe.a)({title:"Value",dataIndex:"value",key:"value",render:function(e){return"".concat(_(e))}},Jt("value","number")),Object(Fe.a)({title:"Expense",dataIndex:"expense",key:"expense",render:function(e){return"".concat(_(e))}},Jt("expense","number")),{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){var i,r,o,s,c,d;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(l))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",onClick:function(){l.openModal(!0,t.id,a)},disabled:!(null===(s=Object(Aa.a)(l))||void 0===s||null===(c=s.state)||void 0===c||null===(d=c.permissions)||void 0===d?void 0:d.UPDATE)},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],l.state={openModal:!1,editRex:!1,ProId:!1,tableIndex:!1,openSearch:!1,desc:{title:"Service",organization:{name:"PSO"},value:"1000.00",startDate:"12 10 2020",endDate:"12 4 2021"},searchedColumn:{id:{type:"Input",value:"",label:"Code",showInColumn:!0},value1:{type:"Input",value:null,label:"Value <",showInColumn:!0},value2:{type:"Input",value:"",label:"Value >",showInColumn:!0},expense1:{type:"Input",value:"",label:"Expense <",showInColumn:!0},expense2:{type:"Input",value:"",label:"Expense >",showInColumn:!0},issueDate:{type:"Date",value:null,label:"Issue Date",showInColumn:!0},expiryDate:{type:"Date",value:null,label:"Expiry Date",showInColumn:!0,disabled:!0},description:{type:"Input",value:"",label:"Expiry Date",showInColumn:!0,disabled:!0},comment:{type:"Input",value:"",label:"Expiry Date",showInColumn:!0,disabled:!0}},filterFields:[{Placeholder:"Issue Date",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Expiry Date",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"issueDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"expiryDate",size:"small",type:"RangePicker",fieldStyle:{width:"100%"}},{Placeholder:"Value",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Expense",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:5,key:"value1",size:"small",shape:"$",type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"<",fieldCol:1,size:"small",type:"Text",fieldStyle:{textAlign:"center"}},{object:"obj",fieldCol:5,key:"value2",size:"small",shape:"$",type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:".",fieldCol:1,size:"small",type:"Text",fieldStyle:{textAlign:"center"}},{object:"obj",fieldCol:5,key:"expense1",size:"small",shape:"$",type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"<",fieldCol:1,size:"small",type:"Text"},{object:"obj",fieldCol:5,key:"expense2",size:"small",shape:"$",type:"InputNumber",fieldStyle:{width:"100%"}},{Placeholder:"Description",fieldCol:24,size:"small",type:"Text"},{object:"obj",fieldCol:24,key:"description",size:"small",type:"Textarea"},{Placeholder:"Comments",fieldCol:24,size:"small",type:"Text"},{object:"obj",fieldCol:24,key:"comment",size:"small",type:"Textarea"}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.desc,l=t.filterData,i=t.openModal,r=t.editRex,o=t.ProId,c=t.permissions,d=t.searchedColumn,u=t.openSearch,m=t.filterFields;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:"Purchase Orders",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Ur,{label:"Project Name"},a.title),n.a.createElement(Ur,{label:"Estimated Value"},"".concat(_(a.value))),n.a.createElement(Ur,{label:"Organisation"},a.organization?n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(a.organizationId,"/info")},className:"nav-link"},a.organization.name):"No Organisation"),n.a.createElement(Ur,{label:"Delegate Contact"}," ",a.ContactName),n.a.createElement(Ur,{label:"Start Date"},W(a.startDate,!0,!0)," "),n.a.createElement(Ur,{label:"End Date"},W(a.endDate,!0,!0)),n.a.createElement(Ur,{label:"Bid Date"},W(a.bidDate,!0,!0)),n.a.createElement(Ur,{label:"Status"},a.status?w[a.status]:"")),n.a.createElement(p.a,{justify:"end",gutter:"20"},n.a.createElement(b.a,null," ",n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){e.openModal(!0,!1,!1)},disabled:c&&!c.ADD||!1===a.phase}," ",n.a.createElement(Nt.a,null)," Add Purchase Order")," ")),n.a.createElement(ea,{filters:d,filterFunction:this.advancefilter}),n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:this.columns,dataSource:l,size:"small",className:"fs-small"}),i&&n.a.createElement(_r,{onHold:!1===a.phase,visible:i,editRex:r,ProId:o,close:this.closeModal,callBack:this.callBack}),u&&n.a.createElement(Zt,{title:"Purchase Order - filter",visible:u,filters:d,filterFields:m,filterFunction:this.advancefilter,onClose:function(){return e.setState({openSearch:!1})}}))}}]),a}(l.Component),Kr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.openModal()},l.checkRates=function(e,t){e?t.label.includes("Employee")?l.getRates("employees",e):t.label.includes("Sub Contractor")?l.getRates("sub-contractors",e):l.setRates("No Active Contract","No Active Contract"):l.setRates(void 0,void 0)},l.setRates=function(e,t){var a=l.state.ExpenseFields;a[16].suggestion=e,a[17].suggestion=t,l.setState({ExpenseFields:Object(we.a)(a)})},l.openModal=function(){var e=l.props.editRex;Ka().then((function(t){var a=l.state.ExpenseFields;a[1].data=t.success?t.data:[],l.setState({ExpenseFields:a},(function(){e&&l.getRecord(t.data)}))}))},l.onFinish=function(e){l.setState({loading:!0});var t=l.props.editRex,a=e.obj;t?l.editRecord(a):l.addRecord(a)},l.addRecord=function(e){var t=l.props,a=t.proId,n=t.callBack;(function(e,t,a){return z.b.loading({content:"Loading...",key:a}),Ve.a.post("".concat(A).concat(e),t,{headers:J()}).then((function(e){var t,l=e.data,n=l.success,i=l.message;return $(i),z.b.success({content:i,key:a}),n&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:n}})).catch((function(e){return Q(e,a,5)}))})(t.crud,e,a).then((function(e){e.success?n():l.setState({loading:!1})}))},l.getRecord=function(e){var t=l.props;(function(e,t){return Ve.a.get("".concat(A).concat(e,"/").concat(t),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l?(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}):{success:l}})).catch((function(e){return{error:"Please login again!",status:!1,message:e.message}}))})(t.crud,t.editRex).then((function(t){if(t.success){e.findIndex((function(e){return e.value===t.data.panelSkillId}));l.formRef.current.setFieldsValue({obj:t.data})}}))},l.editRecord=function(e){var t=l.props,a=t.editRex,n=t.crud,i=t.callBack;e.id=a,function(e,t,a){return z.b.loading({content:"Loading...",key:t}),Ve.a.put("".concat(A).concat(e,"/").concat(t),a,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.data,r=l.message;return $(r),z.b.success({content:r,key:t}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),{success:n,data:i[0]}})).catch((function(e){return Q(e,t,5)}))}(n,a,e).then((function(e){e.success?i():l.setState({loading:!1})}))},l.formRef=n.a.createRef(),l.state={editRex:!1,check:!1,loading:!1,SKILLS:[],STATES:[],ORGS:[],data:{},ExpenseFields:[{Placeholder:"Expense",fieldCol:24,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"expenseId",size:"small",rules:[{required:!0,message:"Expense is Required"}],data:[],type:"Select",fieldStyle:{width:"50%"}},{Placeholder:"Buy Rate",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{Placeholder:"Sell Rate",fieldCol:12,rangeMin:!0,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"buyingRate",shape:"$",size:"small",rules:[{required:!0,message:"Buying Rate is Required"}],type:"InputNumber",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"sellingRate",shape:"$",size:"small",rules:[{required:!0,message:"Selling Rate is Required"}],type:"InputNumber",fieldStyle:{width:"100%"}}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.editRex,a=e.visible,l=e.close,i=e.onHold,r=this.state,o=r.ExpenseFields,s=r.loading;return n.a.createElement(wt.a,{title:t?"Edit Expense":"Add Expense",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:s||i,htmlType:"submit",form:"my-form"},okText:s?n.a.createElement(Mt.a,null):"Save",onCancel:l,width:900},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,scrollToFirstError:!0,size:"small",layout:"inline",initialValues:{obj:{effortRate:100}}},n.a.createElement(ft,{FormFields:o})))}}]),a}(l.Component),Gr=ul.b.Item,$r=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.fetchAll()},l.fetchAll=function(){var e=Object(La.a)(Ma.a.mark((function e(t){var a,n,i,r,o,s;return Ma.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=JSON.parse(G().permissions),n=a.OPPORTUNITIES,i=(i=l.props.match.url).replace("projects","opportunities"),console.log(i),r=l.props.match.params,o=r.proId,s=r.mileId,Promise.all([Yi(o),Wi(i)]).then((function(e){var t,a,r,c,d,u,m,f,p;l.setState({proDesc:(null===(t=e[0])||void 0===t?void 0:t.success)?e[0].data:{},mileDesc:(null===(a=e[0])||void 0===a?void 0:a.success)&&(null===(r=e[0])||void 0===r||null===(c=r.data)||void 0===c?void 0:c.milestones)?null===(d=e[0])||void 0===d||null===(u=d.data)||void 0===u?void 0:u.milestones.filter((function(e){return e.id==s}))[0]:{},editRex:!1,proId:o,crud:i,mileId:s,infoModal:!1,data:(null===(m=e[1])||void 0===m?void 0:m.success)?e[1].data:[],filterData:(null===(f=e[1])||void 0===f?void 0:f.success)?e[1].data:[],permissions:n,notAuth:null===e||void 0===e||null===(p=e[1])||void 0===p?void 0:p.authError})})).catch((function(e){console.log(e)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l.getMilestoneExpenses=function(e){var t=l.state.crud;Wi(t).then((function(e){e.success&&l.setState({data:e.success?e.data:[],filterData:e.success?e.data:[],editRex:!1,infoModal:!1})}))},l.openModal=function(e){var t=l.state.mileDesc,a=t.startDate,n=t.endDate;l.setState({editRex:e,pDates:{startDate:a,endDate:n},infoModal:!0})},l.closeModal=function(){l.setState({infoModal:!1,editRex:!1})},l.handleDelete=function(e,t){var a=l.state,n=a.crud,i=a.data,r=a.filterData,o=l.props.history;sl(o,n,e,t,r,i).then((function(a){console.log(e,t),a.success&&l.setState({data:Object(we.a)(a.data),filterData:Object(we.a)(a.filterData)})}))},l.callBack=function(){var e=l.state.proId;l.getMilestoneExpenses(e)},l.generalFilter=function(e){var t=l.state.data;e?l.setState({filterData:t.filter((function(t){var a=t.expenseType.label;return"".concat(null!==a&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())||t.buyingRate&&_(t.buyingRate).toLowerCase().includes(e.toLowerCase())||t.sellingRate&&_(t.sellingRate).toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.advancefilter=function(e,t,a){var n=l.state,i=n.data,r=n.searchedColumn;t?r[t].value=e:r=a,r.label.value||r.buyingRate.value||r.sellingRate.value?l.setState({filterData:i.filter((function(e){var t,a;return console.log("HELLLLLOOO",{label:e.expenseType.id,value:r.label.value}),(null!==(t=_(e.buyingRate))&&void 0!==t?t:"").toLowerCase().includes(r.buyingRate.value.toString().toLowerCase())&&(null!==(a=_(e.sellingRate))&&void 0!==a?a:"").toLowerCase().includes(r.sellingRate.value.toString().toLowerCase())&&(r.label.value.length>0?r.label.value:[{value:","}]).some((function(t){return(r.label.value.length>0?[e.expenseType.id]:[","]).includes(t.value)}))})),searchedColumn:r,openSearch:!1}):l.setState({searchedColumn:r,filterData:i,openSearch:!1})},l.filterModalUseEffect=function(){Promise.all([Ka()]).then((function(e){var t=l.state.filterFields;t[1].data=e[0].success?e[0].data:[],l.setState({filterFields:t})})).catch((function(e){console.log(e)}))},l.columns=[Object(Fe.a)({title:"Expense",dataIndex:["expenseType","label"],key:"label"},Jt("label","string")),Object(Fe.a)({title:"Buy Rate",dataIndex:"buyingRate",key:"buyingRate",render:function(e){return e&&_(e)}},Jt("buyingRate","number")),Object(Fe.a)({title:"Sell Rate",dataIndex:"sellingRate",key:"sellingRate",render:function(e){return e&&_(e)}},Jt("sellingRate","number")),{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){var i,r,o,s,c,d;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(l))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"update",onClick:function(){return l.openModal(t.id)},disabled:!(null===(s=Object(Aa.a)(l))||void 0===s||null===(c=s.state)||void 0===c||null===(d=c.permissions)||void 0===d?void 0:d.UPDATE)},"Edit Expense"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],l.state={infoModal:!1,editRex:!1,proId:!1,mileId:!1,crud:!1,proDesc:{},mileDesc:{},permissions:{},openSearch:!1,filterData:[],searchedColumn:{label:{type:"Select",multi:!0,value:[],label:"Expense",showInColumn:!0},buyingRate:{type:"Input",value:"",label:"Buy Rate"},sellingRate:{type:"Input",value:"",label:"Sell Rate"}},filterFields:[{Placeholder:"Expense",fieldCol:24,size:"small",type:"Text"},{object:"obj",fieldCol:24,mode:"multiple",key:"label",customValue:function(e,t){return t},size:"small",data:[],type:"Select",fieldStyle:{width:"50%"}},{Placeholder:"Buy Rate",fieldCol:12,size:"small",type:"Text"},{Placeholder:"Sell Rate",fieldCol:12,size:"small",type:"Text"},{object:"obj",fieldCol:12,key:"buyingRate",shape:"$",size:"small",type:"InputNumber",fieldStyle:{width:"100%"}},{object:"obj",fieldCol:12,key:"sellingRate",shape:"$",size:"small",type:"InputNumber",fieldStyle:{width:"100%"}}],notAuth:!1},l}return Object(d.a)(a,[{key:"render",value:function(){var e,t,a=this,l=this.state,i=l.proDesc,r=(l.data,l.infoModal),o=l.editRex,c=l.proId,d=l.permissions,u=l.crud,m=l.mileId,f=l.filterData,g=l.openSearch,y=l.searchedColumn,h=l.filterFields,v=(l.pDates,l.notAuth),E=l.mileDesc;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:"Project Details",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Gr,{label:"Project Name"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(i.id,"/info")},className:"nav-link"},i.title)),n.a.createElement(Gr,{label:"Estimated Value"},_(null!==(e=i.value)&&void 0!==e?e:0)),n.a.createElement(Gr,{label:"Organisation"},i.organization?n.a.createElement(s.b,{to:{pathname:"/organisations/".concat(i.organizationId,"/info")},className:"nav-link"},i.organization.name):"No Organisation"),n.a.createElement(Gr,{label:"Start Date"},W(i.startDate,!0,!0)," "),n.a.createElement(Gr,{label:"End Date"},W(i.endDate,!0,!0))),1===i.type&&n.a.createElement(ul.b,{style:{marginTop:15},title:"Milestone Details",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(Gr,{label:"Milestone Name"},E.title),n.a.createElement(Gr,{label:"Start Date"},W(E.startDate,!0,!0)," "),n.a.createElement(Gr,{label:"End Date"},W(E.endDate,!0,!0)),n.a.createElement(Gr,{label:"Progress"},E.progress," %"),n.a.createElement(Gr,{label:"Approved"},n.a.createElement(fi,{text:null!==(t=E.isApproved)&&void 0!==t?t:"CM"}))),n.a.createElement(p.a,{justify:"end",span:4,gutter:[30,0]},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"default",size:"small",onClick:function(){return a.setState({openSearch:!0})}},n.a.createElement(Ft.a,null),"Filter")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){return a.openModal(!1)},disabled:!d.ADD||!1===i.phase},n.a.createElement(Nt.a,null)," Add Expense"))),n.a.createElement(ea,{filters:y,filterFunction:this.advancefilter}),n.a.createElement(Rt.a,{title:function(){return Qt(5,a.generalFilter)},bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:this.columns,dataSource:f,size:"small",className:"fs-small"}),g&&n.a.createElement(Zt,{title:"Filter Expenses",visible:g,filters:y,filterFields:h,filterFunction:this.advancefilter,effectFunction:this.filterModalUseEffect,effectRender:!0,onClose:function(){return a.setState({openSearch:!1})}}),r&&n.a.createElement(Kr,{visible:r,editRex:o,proId:c,crud:u,cmRate:i.cmPercentage,mileId:m,onHold:!1===i.phase,close:this.closeModal,callBack:this.callBack}),v&&n.a.createElement(wl,this.props))}}]),a}(l.Component),Jr=(a(524),ve.a.Text),Xr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.props.approval?l.getApprovingData():l.getSubmittedData()},l.setHours=function(e,t,a){var n=l.state,i=n.data,r=n.hoursEntry;i[a].hours=t,r[e.key]=t,l.setState({data:Object(we.a)(i),hoursEntry:Object(Fe.a)({},r)})},l.getLeaveDetail=function(e,t,a){return{Placeholder:n.a.createElement("div",null,n.a.createElement("div",null,"Current Balance: ",e),n.a.createElement("div",null,"Required Balance: ",a),n.a.createElement("div",null,"Overdraw Allowances: ",t)),fieldCol:24,note:!0,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:"10px",border:"1px black solid",paddingLeft:"10px"}}},l.getDateArray=function(e,t,a,n){var i,r=l.props,o=r.showDetails,s=r.readOnly,c=l.state,d=c.BasicFields,u=c.contractDetails,m=c.holidays,f=c.data,p=c.hoursEntry,b=null!==a&&void 0!==a?a:{},g=b.include_off_days,y=b.balance,h=void 0===y?-1:y,v=b.minimum_balance,E=b.minimum_balance_required,k=b.id,S=null!==(i=null===u||void 0===u?void 0:u.hoursPerDay)&&void 0!==i?i:0;if(n){var C=new Array;f=n.map((function(e){var t=e.date,a=e.hours;t=W(t);var l=!g&&("Sun"===t.format("ddd")||"Sat"===t.format("ddd")?"Weekend":m[t.format("M/D/YYYY")]);return o&&(h+=a),p[t.format("M/D/YYYY")]="".concat(a),{key:t.format("M/D/YYYY"),date:t.format("YYYY-MM-DD"),hours:l?0:"".concat(a),disabled:l}})),d[d[2].note?8:7].disabled=s}else if(e&&t){for(C=new Array;e.isSameOrBefore(t);){var j,D,O=!g&&("Sun"===e.format("ddd")||"Sat"===e.format("ddd")?"Weekend":m[e.format("M/D/YYYY")]),I=e.format("M/D/YYYY"),P=O?0:null!==(j=p[I])&&void 0!==j?j:S;p[I]=O?0:null!==(D=p[I])&&void 0!==D?D:S,C.push({key:I,date:e.format("YYYY-MM-DD"),hours:P,disabled:O}),e=T()(e).add(1,"d")}f=C,d[d[2].note?8:7].disabled=!1}else if(e){var x,z,A=!g&&("Sun"===e.format("ddd")||"Sat"===e.format("ddd")?"Weekend":m[e.format("M/D/YYYY")]),R=e.format("M/D/YYYY"),w=A?0:null!==(x=p[R])&&void 0!==x?x:S;p[R]=A?0:null!==(z=p[R])&&void 0!==z?z:S,f=[{key:R,date:e.format("YYYY-MM-DD"),hours:A?0:w,disabled:A}],d[d[2].note?8:7].disabled=!1}else l.formRef.current.setFieldsValue({dates:{startDate:null,endDate:null}}),d[d[2].note?8:7].disabled=!0,p={},f=[];k&&h>=0&&o?d[2].note?d[2]=l.getLeaveDetail(h,v,E):d.splice(2,0,l.getLeaveDetail(h,v,E)):d[2].note&&d.splice(2,1),l.setState({BasicFields:Object(we.a)(d),data:f,LeaveRequestType:a,hoursEntry:p}),l.formRef.current.setFieldsValue({hours:p})},l.getApprovingData=function(){var e=l.state.BasicFields,t=l.props.edit;Ql(t).then((function(a){if(a.success){var n=a.data.employeeId;Promise.all([Ct(n,"O",0),Pt()]).then((function(n){var i,r;console.log(n);var o=n[1],s=o.success,c=o.contractDetails,d=o.holidays,u=o.LeaveRequestTypes;o.fileList,o.fileIds;if(e[3].data=n[0].success?n[0].data:[],e[1].data=s?u:[],e.map((function(e){return"Text"!==e.type&&(e.disabled=!0),e})),l.setState({BasicFields:e,holidays:s&&null!==d&&void 0!==d?d:{},contractDetails:s&&null!==c&&void 0!==c?c:{},fileList:null!==(i=a.fileList)&&void 0!==i?i:[],fileIds:null!==(r=a.fileIds)&&void 0!==r?r:[]}),t&&(null===a||void 0===a?void 0:a.success)){var m=a.entries,f=a.data,p=u.find((function(e){var t;return e.id===(null!==(t=f.typeId)&&void 0!==t?t:0)})),b=Object(Fe.a)(Object(Fe.a)({},f),{},{description:f.desc,typeId:null===p||void 0===p?void 0:p.id,startDate:W(m[0].date),endDate:W(m[m.length-1].date)});l.getDateArray(b.startDate,b.endDate,p,m),l.formRef.current.setFieldsValue({dates:b})}})).catch((function(e){console.log(e)}))}}))},l.getSubmittedData=function(){var e=l.state.BasicFields,t=l.props,a=t.edit,n=t.readOnly,i=G().id;Promise.all([Ct(i,"O",0),Pt(),a&&Ql(a)]).then((function(t){var i,r,o;console.log(t);var s=t[1],c=s.success,d=s.contractDetails,u=s.holidays,m=s.LeaveRequestTypes;s.fileList,s.fileIds;if(e[3].data=t[0].success?t[0].data:[],e[1].data=c?m:[],e.map((function(e){return"Text"!==e.type&&(e.disabled=n),"typeId"===e.key&&t[2]&&(e.disabled=!0),e})),l.setState({BasicFields:e,holidays:c&&null!==u&&void 0!==u?u:{},contractDetails:c&&null!==d&&void 0!==d?d:{},fileList:null!==(i=t[2].fileList)&&void 0!==i?i:[],fileIds:null!==(r=t[2].fileIds)&&void 0!==r?r:[]}),a&&(null===(o=t[2])||void 0===o?void 0:o.success)){var f=t[2],p=f.entries,b=f.data,g=m.find((function(e){var t;return e.id===(null!==(t=b.typeId)&&void 0!==t?t:0)})),y=Object(Fe.a)(Object(Fe.a)({},b),{},{description:b.desc,typeId:null===g||void 0===g?void 0:g.id,startDate:W(p[0].date),endDate:W(p[p.length-1].date)});l.getDateArray(y.startDate,y.endDate,g,p),l.formRef.current.setFieldsValue({dates:y})}})).catch((function(e){console.log(e)}))},l.getFormValues=function(e){var t;l.setState({loading:!0});var a=e.dates,n=l.props,i=n.edit,r=n.callBack,o=l.state,s=o.data,c=o.fileIds,d={description:null!==(t=a.description)&&void 0!==t?t:"",typeId:a.typeId||0,workId:a.workId,entries:s,attachments:null!==c&&void 0!==c?c:[]};console.log("newVal---\x3e",d),i?function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.patch("".concat(Xl,"/").concat(e),t,{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.message,r=l.data;return $(i),z.b.success({content:i,key:e}),n&&K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n,data:r}})).catch((function(t){return Q(t,e,120,{marginTop:"15vh"})}))}(i,d).then((function(e){l.setState({loading:!1}),e.success&&r()})):function(e){return z.b.loading({content:"Loading...",key:1}),Ve.a.post(Xl,e,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),z.b.success({content:"Success!",key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l}})).catch((function(e){return Q(e,1,120,{marginTop:"15vh"})}))}(d).then((function(e){l.setState({loading:!1}),e.success&&r()}))},l.getTableSummary=function(e){var t=0;return e.forEach((function(e){var a=e.hours;t+=parseFloat(null!==a&&void 0!==a?a:0)})),n.a.createElement(Rt.a.Summary,{fixed:"top"},n.a.createElement(Rt.a.Summary.Row,null,n.a.createElement(Rt.a.Summary.Cell,{index:0},"Total"),n.a.createElement(Rt.a.Summary.Cell,{index:1},U(t))))},l.handleUpload=function(){var e=Object(La.a)(Ma.a.mark((function e(t){var a,n,i,r,o;return Ma.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.onSuccess,n=t.onError,i=t.file,r=t.onProgress,o=new FormData,{headers:{"content-type":"multipart/form-data"},onUploadProgress:function(e){var t=Math.floor(e.loaded/e.total*100);l.setState({progress:t}),100===t&&setTimeout((function(){return l.setState({progres:0})}),1e3),r({percent:e.loaded/e.total*100})}},o.append("files",i),vl(o).then((function(e,t){if(e.success)a("Ok"),l.setState({fileList:[].concat(Object(we.a)(l.state.fileList),[e.file]),fileIds:[].concat(Object(we.a)(l.state.fileIds),[e.file.fileId])});else{console.log("Eroor: ",t);new Error("Some error");n({err:t})}}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l.onRemove=function(e){l.setState((function(t){var a=t.fileList.indexOf(e),l=t.fileList.slice(),n=t.fileIds;return l.splice(a,1),n.splice(a,1),{fileIds:n,fileList:l}}))},l.formRef=n.a.createRef(),l.attachRef=n.a.createRef(),l.columns=[{title:"Date",dataIndex:"date",key:"date",render:function(e,t){return n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null," ",W(e,!0,!0)," "),n.a.createElement(b.a,{style:{marginLeft:"auto",color:"red"}},t.disabled))}},{title:"Hours",dataIndex:"hours",key:"hours",render:function(t,a,i){return n.a.createElement(Me.a.Item,{noStyle:!0,name:["hours",W(a.date,!0,"M/D/YYYY")]},n.a.createElement(Xe.a,{placeholder:"Hours",size:"small",disabled:e.readOnly,onChange:function(e){l.setHours(a,e,i)}}))}}],l.state={data:[],reRender:!1,hoursEntry:{},loading:!1,fileList:[],fileIds:[],holidays:{},contractDetails:{},LeaveRequestType:{},BasicFields:[{Placeholder:"Leave Type",rangeMin:!0,fieldCol:8,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:"10px"}},{object:"dates",fieldCol:16,key:"typeId",size:"small",rules:[{required:!0,message:"Leave Type is Required"}],data:[],fieldNames:{label:"name",value:"id"},type:"Select",onChange:function(e,t){var a=l.formRef.current.getFieldsValue().dates,n=a.startDate,i=a.endDate;l.getDateArray(n,i,null!==t&&void 0!==t?t:{})}},{Placeholder:"Project Name",fieldCol:8,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:"10px"}},{object:"dates",fieldCol:16,key:"workId",size:"small",data:[],type:"Select"},{Placeholder:"Start Date",rangeMin:!0,fieldCol:8,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:"10px"}},{object:"dates",fieldCol:16,key:"startDate",size:"small",type:"DatePicker",rules:[{required:!0,message:"Start Date is Required"}],fieldStyle:{width:"100%"},onChange:function(e){var t=l.formRef.current.getFieldsValue().dates,a=t.startDate,n=t.endDate,i=l.state.LeaveRequestType;l.getDateArray(a,n,i)},rangeMin:function(e){var t=l.formRef.current.getFieldsValue().dates.endDate;return t&&e>t}},{Placeholder:"End Date",fieldCol:8,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:"10px"}},{object:"dates",fieldCol:16,key:"endDate",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},disabled:!0,onChange:function(e){var t=l.formRef.current.getFieldsValue().dates,a=t.endDate,n=t.startDate,i=l.state.LeaveRequestType;l.getDateArray(n,a,i)},rangeMax:function(e){var t=l.formRef.current.getFieldsValue().dates.startDate;return t&&e<t}},{Placeholder:"Description",fieldCol:8,size:"small",type:"Text",labelAlign:"right",itemStyle:{marginBottom:"10px"}},{object:"dates",fieldCol:24,key:"description",size:"small",type:"Textarea",mode:{minRows:2,maxRows:3},fieldStyle:{height:"10vh"}}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.visible,l=t.close,i=t.edit,r=t.readOnly,o=this.state,s=o.BasicFields,c=o.fileList,d=o.data,u=(o.fileIds,o.loading),m=o.contractDetails,f=[{title:"Date",dataIndex:"date",key:"date",render:function(e,t){return n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null," ",W(e,!0,!0)," "),n.a.createElement(b.a,{style:{marginLeft:"auto",color:"red"}},t.disabled))}},{title:"Hours",dataIndex:"hours",key:"hours",render:function(t,a,l){var i;return n.a.createElement(Me.a.Item,{noStyle:!0,name:["hours",W(a.date,!0,"M/D/YYYY")]},n.a.createElement(Xe.a,{max:null!==(i=null===m||void 0===m?void 0:m.hoursPerDay)&&void 0!==i&&i,min:0,placeholder:"Hours",size:"small",disabled:a.disabled||r,onChange:function(t){e.setHours(a,t,l)}}))}}];return n.a.createElement(wt.a,{title:r?"View Request":i?"Edit Leave Request":"New Leave Request",maskClosable:!0,destroyOnClose:!0,visible:a,okButtonProps:{htmlType:"submit",form:"my-form",disabled:r,loading:u},okText:"Submit",onCancel:function(){z.b.destroy(),l()},width:1e3},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,size:"small",layout:"inline",onFinish:this.getFormValues},n.a.createElement(p.a,{className:"moz-width"},n.a.createElement(b.a,{span:12},n.a.createElement(p.a,null,n.a.createElement(ft,{FormFields:s})),n.a.createElement(Jr,{style:{marginTop:10,marginBottom:2}},"Attachments"),n.a.createElement(We.a,{customRequest:this.handleUpload,listType:"picture-card",maxCount:4,fileList:c,onRemove:this.onRemove,disabled:r},c.length<4&&n.a.createElement("div",{style:{marginTop:10}},n.a.createElement(Ll.a,null),n.a.createElement("div",{style:{marginTop:8}},"Upload")))),n.a.createElement(b.a,{span:12},n.a.createElement(Rt.a,{sticky:!0,style:{maxHeight:"40vh",overflowY:"scroll",position:"relative"},pagination:!1,rowKey:function(e){return e.key},columns:f,dataSource:d,size:"small",summary:function(t){return e.getTableSummary(t)}})))))}}]),a}(l.Component),Qr=ve.a.Title,Zr=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.getData()},l.getData=function(){var e=G().permissions,t=JSON.parse(e).LEAVE_REQUESTS;Ve.a.get(Xl,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){var t,a,l=null===e||void 0===e||null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message;return"Leave Requests not found"!==l&&z.b.error({content:l,key:1}),{error:"Please login again!",success:!1,message:e.message}})).then((function(e){l.setState({openModal:!1,readOnly:!1,editRequest:!1,reload:!1,request:(null===e||void 0===e?void 0:e.success)?e.data:[],permissions:t},(function(){return l.setState({reload:!0})}))}))},l.closeModal=function(){l.setState({openModal:!1,editRequest:!1,readOnly:!1})},l.handleDelete=function(e,t){var a=l.state.request,n=l.props.history;sl(n,"/leave-requests",e,t,a,!1).then((function(e){e.success&&l.setState({request:Object(we.a)(e.filterData)})}))},l.callBack=function(e){l.getData()},l.typeColumns=[{title:"Type",dataIndex:"name",key:"name"},{title:"Accrued",dataIndex:"carryForward",key:"carryForward",render:function(e){return U(e)}},{title:"Earned YTD",dataIndex:"earned",key:"earned",render:function(e,t){return U(t.balanceHours-t.carryForward+t.used)}},{title:"Used YTD",dataIndex:"used",key:"used",render:function(e){return U(e)}},{title:"Balance",dataIndex:"balanceHours",key:"balanceHours",render:function(e){return U(e)}}],l.requestColumns=[{title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e,t){return e&&W(e,!0,!0)}},{title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e,t){return e&&W(e,!0,!0)}},{title:"Leave Type",dataIndex:"leaveRequestName",key:"leaveRequestName"},{title:"Project",dataIndex:"project",key:"project"},{title:"Hours",dataIndex:"totalHours",key:"totalHours",render:function(e){return U(e)}},{title:"Status",dataIndex:"status",key:"status",render:function(e,t){return n.a.createElement(ce.b,{align:"end"},n.a.createElement(fi,{text:e}),n.a.createElement($e.a,{placement:"top",title:t.note,destroyTooltipOnHide:!0},t.note&&n.a.createElement(Zn.a,{style:{fontSize:"large"}})))}},{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){var i,r,o,s,c,d;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(l))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE)||"AP"===t.status,className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"update",disabled:!(null===(s=Object(Aa.a)(l))||void 0===s||null===(c=s.state)||void 0===c||null===(d=c.permissions)||void 0===d?void 0:d.UPDATE),onClick:function(){l.setState({openModal:!0,editRequest:t.id,readOnly:t.status})}},"AP"===t.status?"View":"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],l.state={request:[],readOnly:!1,editRequest:!1,permissions:{},type:[],reload:!0,openModal:!1},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.request,l=t.openModal,i=t.editRequest,r=t.permissions,o=t.readOnly,s=t.reload;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Qr,{level:4},"Leave Requests")),n.a.createElement(b.a,{style:{marginLeft:"auto"}},n.a.createElement(Be.a,{type:"primary",size:"small",disabled:!r.ADD,onClick:function(){e.setState({openModal:!0,readOnly:!1})}},n.a.createElement(Nt.a,null),"Add Request")),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{bordered:!0,style:{maxHeight:"40vh",overflowY:"scroll"},pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:this.requestColumns,dataSource:a,size:"small",className:"fs-small"}))),n.a.createElement(p.a,{style:{marginTop:"20px"},justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Qr,{level:4},"Leave Balance")),n.a.createElement(b.a,{span:24},s&&n.a.createElement(on,{editable:!1,style:{maxHeight:"30vh",overflowY:"scroll"}}))),l&&n.a.createElement(Xr,{visible:l,close:this.closeModal,edit:i,callBack:this.getData,readOnly:"AP"===o,showDetails:!o||"SB"===o||"RJ"===o}))}}]),a}(l.Component),eo=ve.a.Title,to=ve.a.Text,ao="",lo=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.fetchAll()},l.fetchAll=function(){var e=l.state.queryRequest,t=e.startDate,a=e.endDate,n=e.workId,i=e.userId,r={startDate:W(t,!0,"DD-MM-YYYY"),endDate:W(a,!0,"DD-MM-YYYY"),workId:n,userId:i},o=G(),s=o.id,c=o.permissions,d=parseInt(s),u=JSON.parse(c).LEAVE_REQUESTS,m="startDate=".concat(null===r||void 0===r?void 0:r.startDate,"&endDate=").concat(null===r||void 0===r?void 0:r.endDate,"&userId=").concat(null===r||void 0===r?void 0:r.userId,"&workId=").concat(null===r||void 0===r?void 0:r.workId);Promise.all([xt("LEAVE_REQUESTS"),Zl(m),Ve.a.get("".concat(A,"/auth/users"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:le(n,"label")}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))]).then((function(e){l.setState({WORKS:e[0].success?e[0].data:[],loginId:d,permissions:u,request:e[1].success?e[1].data:[],filterRequest:e[1].success?e[1].data:[],USERS:e[2].success?e[2].data:[],readRequest:!1})})).catch((function(e){console.log(e)}))},l.getData=function(){var e,t,a=l.state.queryRequest,n=a.startDate,i=a.endDate,r=a.workId,o=a.userId,s={startDate:null!==(e=W(n,!0,"DD-MM-YYYY"))&&void 0!==e?e:void 0,endDate:null!==(t=W(i,!0,"DD-MM-YYYY"))&&void 0!==t?t:void 0,workId:r,userId:o},c="";c=s.startDate?"startDate=".concat(null===s||void 0===s?void 0:s.startDate,"&endDate=").concat(null===s||void 0===s?void 0:s.endDate,"&userId=").concat(null===s||void 0===s?void 0:s.userId,"&workId=").concat(null===s||void 0===s?void 0:s.workId):"userId=".concat(null===s||void 0===s?void 0:s.userId,"&workId=").concat(null===s||void 0===s?void 0:s.workId),Zl(c).then((function(e){e.success&&l.setState({request:e.data,filterRequest:e.data,readRequest:!1,sRequest:{request:[],keys:[]}})}))},l.requestSelect=function(e,t){var a=!0,n=!0,i=!0;t.forEach((function(e){"SB"===e.status&&(a=!1),"SB"===e.status&&(n=!1),"AP"===e.status&&(i=!1)})),l.setState({sRequest:{request:t,keys:e,cantApprove:a,cantReject:n,cantUnapprove:i}})},l.onActionFinished=function(e,t){(function(e,t){return Ve.a.post("".concat(Xl,"/").concat(e),t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data;if(K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),l)return{success:l,data:n}})).catch((function(e){var t,a,l=null===e||void 0===e||null===(t=e.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message;return z.b.error({content:l,key:1}),{error:"Please login again!",success:!1,message:e.message}}))})(t,{leaveRequests:l.state.sRequest.keys,note:e}).then((function(e){e.success&&l.getData(),ao.destroy()}))},l.multiAction=function(e){var t=n.a.createElement(p.a,null,n.a.createElement(b.a,{span:"24"},n.a.createElement(eo,{level:5},"Notes")),n.a.createElement(b.a,{span:"24"},n.a.createElement(Me.a,{id:"my-form",onFinish:function(t){return l.onActionFinished(t.notes,e)}},n.a.createElement(Me.a.Item,{noStyle:!0,name:"notes"},n.a.createElement(Je.a.TextArea,{placeholder:"Enter Your Notes....",autoSize:{minRows:3,maxRows:10},allowClear:!0})))));ao=wt.a.confirm({title:"leaveRequestsReject"===e?"Reject Leave Requests":"Approve Leave Requests",icon:"leaveRequestsReject"===e?n.a.createElement(Jn.a,{style:{color:"red"}}):n.a.createElement(S.a,{style:{color:"green"}}),content:t,okButtonProps:{htmlType:"submit",form:"my-form"},okText:"Okay",cancelText:"Cancel"})},l.closeModal=function(){l.setState({openModal:!1,readRequest:!1})},l.generalFilter=function(e){var t=l.state.request;e?l.setState({filterRequest:t.filter((function(t){var a,l,n,i,r,o;return"".concat(null!==(a=t.employeeName)&&void 0!==a?a:"").toLowerCase().includes(e.toLowerCase())||"".concat(null!==(l=t.project)&&void 0!==l?l:"").toLowerCase().includes(e.toLowerCase())||"".concat(null!==(n=t.leaveRequestName)&&void 0!==n?n:"").toLowerCase().includes(e.toLowerCase())||"".concat(null!==(i=W(t.startDate,!0,!0))&&void 0!==i?i:"").toLowerCase().includes(e.toLowerCase())||"".concat(null!==(r=W(t.endDate,!0,!0))&&void 0!==r?r:"").toLowerCase().includes(e.toLowerCase())||"".concat(null!==(o=W(t.submittedAt,!0,!0))&&void 0!==o?o:"").toLowerCase().includes(e.toLowerCase())||"".concat(N[t.status]).toLowerCase().includes(e.toLowerCase())}))}):l.setState({filterData:t})},l.requestColumns=[Object(Fe.a)({title:"Resource",dataIndex:"employeeName",key:"employeeName"},Jt("employeeName","string")),Object(Fe.a)({title:"Project",dataIndex:"project",key:"project"},Jt("project","string")),Object(Fe.a)({title:"Leave Type",dataIndex:"leaveRequestName",key:"leaveRequestName"},Jt("leaveRequestName","string")),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e,t){return e&&W(e,!0,!0)}},Jt("startDate","date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e,t){return e&&W(e,!0,!0)}},Jt("endDate","date")),Object(Fe.a)({title:"Submit Date",dataIndex:"submittedAt",key:"submittedAt",render:function(e,t){return e&&W(e,!0,!0)}},Jt("submittedAt","date")),Object(Fe.a)(Object(Fe.a)({title:"Status",dataIndex:"status",key:"status"},Jt("status","string")),{},{render:function(e,t){return n.a.createElement(ce.b,{align:"end"},n.a.createElement(fi,{text:e}),n.a.createElement($e.a,{placement:"top",title:t.note,destroyTooltipOnHide:!0},t.note&&n.a.createElement(Zn.a,{style:{fontSize:"large"}})))}}),Object(Fe.a)({title:"Total Hours",dataIndex:"totalHours",key:"totalHours",align:"center",render:function(e,t){return e&&n.a.createElement(to,{strong:!0},U(e))}},Jt("totalHours","number")),{title:"...",key:"action",align:"center",width:"1%",render:function(e){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{onClick:function(){l.setState({openModal:!0,readRequest:e.id})}},"View"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}],l.state={request:[],filterRequest:[],readRequest:!1,canApprove:!1,loginId:{},permissions:{},sRequest:{request:[],keys:[]},WORKS:[],USERS:[],queryRequest:{startDate:W(new Date).startOf("month"),endDate:W(new Date).endOf("month"),workId:null,userId:null}},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.request,t.filterRequest),l=t.sRequest,i=t.openModal,r=t.readRequest,o=t.queryRequest,s=t.WORKS,c=t.USERS,d=t.permissions,u=o.startDate,m=(o.endDate,o.workId),f=o.userId;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(eo,{level:4},"Approve Requests")),n.a.createElement(b.a,null,n.a.createElement(Qe.a,{placeholder:"Select Project",style:{width:250},options:s,value:m,allowClear:!0,showSearch:!0,optionFilterProp:["label","value"],filterOption:function(e,t){var a=t.label.toLowerCase().indexOf(e.toLowerCase())>=0,l=t.value.toString().toLowerCase().indexOf(e.toLowerCase())>=0;return a||l},onChange:function(t,a){e.setState({queryRequest:Object(Fe.a)(Object(Fe.a)({},o),{},{workId:t})},(function(){e.getData()}))}})),n.a.createElement(b.a,null,n.a.createElement(Qe.a,{allowClear:!0,placeholder:"Select User",options:c,value:f,style:{width:250},showSearch:!0,optionFilterProp:["label","value"],filterOption:function(e,t){var a=t.label.toLowerCase().indexOf(e.toLowerCase())>=0,l=t.value.toString().toLowerCase().indexOf(e.toLowerCase())>=0;return a||l},onChange:function(t,a){e.setState({queryRequest:Object(Fe.a)(Object(Fe.a)({},o),{},{userId:t})},(function(){e.getData()}))}})),n.a.createElement(b.a,null,n.a.createElement(Ke.a,{mode:"month",picker:"month",format:"MMM-YYYY",value:u,onChange:function(t){e.setState({queryRequest:Object(Fe.a)(Object(Fe.a)({},o),{},{startDate:t&&W(t).startOf("month"),endDate:t&&W(t).endOf("month")})},(function(){e.getData()}))}})),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,e.generalFilter)},rowSelection:{selectedRowKeys:l.keys,onChange:function(t,a){e.requestSelect(t,a)},getCheckboxProps:function(e){return{disabled:"SV"===e.status||"RJ"===e.status||"NC"===e.status||!d.UNAPPROVAL&&"AP"===e.status}}},scroll:{x:"'max-content'"},pagination:{pageSize:G().pageSize},bordered:!0,rowKey:function(e){return e.id},columns:this.requestColumns,dataSource:a,size:"small",className:"fs-small"}))),n.a.createElement(p.a,{justify:"end",gutter:[20,200]},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",danger:!0,disabled:l.keys.length<1||!d.APPROVAL||l.cantReject,onClick:function(){return e.multiAction("leaveRequestsReject")}},"Reject")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{className:"success",disabled:l.keys.length<1||!d.APPROVAL||l.cantApprove,onClick:function(){return e.multiAction("leaveRequestsApprove")}},"Approve")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{className:"not-success",disabled:l.keys.length<1||!d.UNAPPROVAL||l.cantUnapprove,onClick:function(){return e.multiAction("leaveRequestsUnapprove")}},"Unapprove"))),i&&n.a.createElement(Xr,{visible:i,close:this.closeModal,edit:r,callBack:this.getData,readOnly:!0,approval:!0}))}}]),a}(l.Component),no=a(301),io=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){console.log(l.props.crud),l.openModal()},l.openModal=function(){var e=l.props.editMile;e&&l.getRecord(e)},l.onFinish=function(e){var t=l.props.editMile;l.setState({loading:!0});var a=e.obj;a=Object(Fe.a)(Object(Fe.a)({},a),{},{startDate:W(a.startDate,!0),endDate:W(a.endDate,!0)}),t?l.editRecord(a):l.addRecord(a)},l.addRecord=function(e){var t=l.props,a=t.proId,n=t.callBack,i=t.crud;e.projectId=a,function(e,t){return z.b.loading({content:"Loading...",key:1}),console.log(e),Ve.a.post("".concat(A).concat(e),t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message,i=a.data;return $(n),z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:i}})).catch((function(e){return Q(e,1,5)}))}(i,e).then((function(e){e.success?n(e.data):l.setState({loading:!1})}))},l.getRecord=function(){var e=l.props.editMile;e.startDate=W(e.startDate),e.endDate=W(e.endDate),l.formRef.current.setFieldsValue({obj:e})},l.editRecord=function(e){var t=l.props,a=t.editMile,n=t.callBack;(function(e,t,a){return z.b.loading({content:"Loading...",key:t}),Ve.a.put("".concat(A).concat(e,"/").concat(t),a,{headers:J()}).then((function(e){var a,l=e.data,n=l.success,i=l.message,r=l.data;return $(i),z.b.success({content:i,key:t}),n&&K(null===e||void 0===e||null===(a=e.headers)||void 0===a?void 0:a.authorization),{success:n,data:r[0]}})).catch((function(e){return Q(e,t,5)}))})(t.crud,a.id,e).then((function(e){e.success?n(e.data):l.setState({loading:!1})}))},l.formRef=n.a.createRef(),l.state={editMile:!1,resourceSubmitted:!1,check:!1,loading:!1,SKILLS:[],STATES:[],ORGS:[],data:{},PMileFields:[{Placeholder:"Title",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{Placeholder:"Progress",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"title",size:"small",rules:[{required:!0,message:"title is Required"}],type:"Input"},{object:"obj",fieldCol:12,key:"progress",shape:"%",size:"small",type:"InputNumber",fieldStyle:{width:"100%"},rangeMin:0,rangeMax:100},{Placeholder:"Start Date",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{Placeholder:"End Date",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"startDate",size:"small",rules:[{required:!0,message:"Start Date is Required"}],type:"DatePicker",fieldStyle:{width:"100%"},rangeMin:function(t){var a=l.formRef.current.getFieldValue().obj;return te(t,a.endDate,e.pDates)}},{object:"obj",fieldCol:12,key:"endDate",size:"small",rules:[{required:!0,message:"End Date is Required"}],type:"DatePicker",fieldStyle:{width:"100%"},rangeMax:function(t){var a=l.formRef.current.getFieldValue().obj;return ae(t,a.startDate,e.pDates)}},{Placeholder:"Description",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"description",size:"small",type:"Textarea"}],LMileFields:[{Placeholder:"Title",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{Placeholder:"Start Date",fieldCol:12,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"title",size:"small",rules:[{required:!0,message:"title is Required"}],type:"Input"},{object:"obj",fieldCol:12,key:"startDate",size:"small",rules:[{required:!0,message:"Start Date is Required"}],type:"DatePicker",fieldStyle:{width:"100%"},rangeMin:function(t){var a=l.formRef.current.getFieldValue().obj;return te(t,a.endDate,e.pDates)}},{Placeholder:"End Date",fieldCol:24,size:"small",rangeMin:!0,type:"Text",labelAlign:"right"},{object:"obj",fieldCol:12,key:"endDate",size:"small",rules:[{required:!0,message:"End Date is Required"}],type:"DatePicker",fieldStyle:{width:"100%"},rangeMax:function(t){var a=l.formRef.current.getFieldValue().obj;return ae(t,a.startDate,e.pDates)}},{Placeholder:"Description",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"obj",fieldCol:24,key:"description",size:"small",type:"Textarea"}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this.props,t=e.editMile,a=e.visible,l=e.close,i=e.work,r=e.onHold,o=this.state,s=o.PMileFields,c=o.LMileFields,d=o.loading;return n.a.createElement(wt.a,{title:t?"Edit Milestone":"Add Milestone",maskClosable:!1,centered:!0,visible:a,okButtonProps:{disabled:d||r||"AP"===t.isApproved||"SB"===t.isApproved,htmlType:"submit",form:"my-form"},okText:d?n.a.createElement(Mt.a,null):"Save",onCancel:l,width:900},n.a.createElement(Me.a,{id:"my-form",ref:this.formRef,onFinish:this.onFinish,scrollToFirstError:!0,size:"small",layout:"inline",initialValues:{obj:{progress:0}}},n.a.createElement(ft,{FormFields:"opportunities"===i?c:s})))}}]),a}(l.Component),ro=ul.b.Item,oo=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){var e=l.props.match.params.proId;l.fetchAll(e)},l.resRoute=function(e){var t=l.props.match.url;return t=t.split("/"),"/".concat(t[1],"/").concat(t[2],"/").concat(t[3],"/").concat(e,"/resources")},l.fetchAll=function(e){var t=JSON.parse(G().permissions),a=t.PROJECTS,n=t.OPPORTUNITIES,i=l.props.match.url,r=l.props.match.url,o=(r=r.split("/"))[1];r="".concat(r[1],"/").concat(r[2]),Promise.all([Ar(r),zr(i)]).then((function(t){var r=l.state.columns;"opportunities"===o&&r.splice(3,2),l.setState({desc:t[0].success&&t[0].data,data:t[1].success&&t[1].data,columns:Object(we.a)(r),proId:e,customUrl:i,work:o,permissions:"opportunities"===o?n:a})})).catch((function(e){console.log(e)}))},l.openModal=function(e){var t=l.state.desc,a=t.startDate,n=t.endDate;l.setState({pDates:{startDate:a,endDate:n},editMile:e,infoModal:!0})},l.closeModal=function(){l.setState({infoModal:!1,editMile:!1})},l.handleDelete=function(e,t){var a=l.state,n=a.customUrl,i=a.data,r=l.props.history;sl(r,n,e,t,i,!1).then((function(e){e.success&&l.setState({data:Object(we.a)(e.filterData)})}))},l.callBack=function(e){var t=l.state,a=(t.proId,t.editMile),n=t.data;a?n[a.rowIndex]=e:n.push(e),l.setState({data:Object(we.a)(n),infoModal:!1})},l.state={infoModal:!1,editMile:!1,pDates:{},proId:!1,desc:{title:"",organization:{name:""},value:"",startDate:"",endDate:""},permissions:{},customUrl:"opportunity",columns:[Object(Fe.a)({title:"Title",dataIndex:"title",key:"title",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"milestones/".concat(t.id,"/resources")},className:"nav-link"},e)}},Jt("title","string")),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",render:function(e){return W(e,!0,!0)}},Jt("startDate","date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",render:function(e){return W(e,!0,!0)}},Jt("endDate","date")),{title:"Progress",dataIndex:"progress",key:"progress",align:"center",render:function(e){return n.a.createElement(no.a,{percent:e,size:"small"})}},{title:"Approved",dataIndex:"isApproved",key:"isApproved",align:"right",render:function(e){var t=null!==e&&void 0!==e?e:"CM";return n.a.createElement(fi,{text:t})}},{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){var i,r,o;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:!(null===(i=Object(Aa.a)(l))||void 0===i||null===(r=i.state)||void 0===r||null===(o=r.permissions)||void 0===o?void 0:o.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{title:"Are you sure you want to delete",onConfirm:function(){return l.handleDelete(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",onClick:function(){l.openModal(Object(Fe.a)(Object(Fe.a)({},t),{},{rowIndex:a}))},disabled:l.state&&!l.state.permissions.UPDATE},"Edit Milestone"),n.a.createElement(v.a.Item,{key:"position"},n.a.createElement(s.b,{to:{pathname:"milestones/".concat(t.id,"/resources")},className:"nav-link"},"Positions")),n.a.createElement(v.a.Item,{key:"expense"},n.a.createElement(s.b,{to:{pathname:"milestones/".concat(t.id,"/expenses")},className:"nav-link"},"Expenses")))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=t.desc,l=t.data,i=t.infoModal,r=t.editMile,o=t.proId,c=t.permissions,d=t.columns,u=t.customUrl,m=t.pDates,f=t.work;return n.a.createElement(n.a.Fragment,null,n.a.createElement(ul.b,{title:"Project Details",size:"small",bordered:!0,layout:"horizontal"},n.a.createElement(ro,{label:"Title"},n.a.createElement(s.b,{to:{pathname:"/projects/".concat(a.id,"/info")},className:"nav-link"},a.title)),n.a.createElement(ro,{label:"Value"},_(a.value)),n.a.createElement(ro,{label:"Start Date"},W(a.startDate,!0,!0)," "),n.a.createElement(ro,{label:"End Date"},W(a.endDate,!0,!0)),n.a.createElement(ro,{label:"Bid Date"},W(a.bidDate,!0,!0))),n.a.createElement(p.a,{justify:"end"},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){return e.openModal(!1)},disabled:!c.ADD||!1===(null===a||void 0===a?void 0:a.phase)},"Add Milestone"))),n.a.createElement(Rt.a,{bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:d,dataSource:l,size:"small",className:"fs-small"}),i&&n.a.createElement(io,{visible:i,editMile:r,onHold:!1===(null===a||void 0===a?void 0:a.phase),pDates:m,proId:o,crud:u,work:f,close:this.closeModal,callBack:this.callBack}))}}]),a}(l.Component),so=ul.b.Item,co=function(e){var t,a=Object(l.useState)([]),i=Object(he.a)(a,2),r=i[0],o=i[1],s=Object(l.useRef)();Object(l.useEffect)((function(){var t="/".concat(e.mileId,"/export");wr(t).then((function(t){t.success&&(o(t.data),c(),e.close())}))}),[]);var c=Object(ci.useReactToPrint)({content:function(){return s.current},documentTitle:"Certificate",removeAfterPrint:!0});return n.a.createElement("div",{style:{display:"none"}},n.a.createElement("div",{ref:s,style:{margin:"2mm 10mm 0mm 10mm",size:"A4"}},n.a.createElement(p.a,{justify:"space-around"},"                                ",n.a.createElement(b.a,{span:24,className:"txt-center mb-40 mt-10"},n.a.createElement("img",{src:"/z-cp-logo.png",width:"32%"})),n.a.createElement(b.a,{span:24,className:"txt-center"},n.a.createElement(ve.a.Title,{level:4},"MILESTONE ACCEPTANCE CERTIFICATE")),n.a.createElement(b.a,{span:22},n.a.createElement(ul.b,{column:1,bordered:!0,className:"certficate-describe right small"},n.a.createElement(so,{label:"Task"},null===r||void 0===r?void 0:r.projectName),n.a.createElement(so,{label:"Purchase Order Number"},null!==(t=null===r||void 0===r?void 0:r.purchaseOrderNo)&&void 0!==t?t:"--"),n.a.createElement(so,{label:"Purchase Order Date"},(null===r||void 0===r?void 0:r.purchaseOrderDate)?W(null===r||void 0===r?void 0:r.purchaseOrderDate,!0,!0):"--"),n.a.createElement(so,{label:"Milestone Name"},null===r||void 0===r?void 0:r.milestoneName),n.a.createElement(so,{label:"Deliverable/s",span:6,className:"paragraph"},n.a.createElement(ve.a.Paragraph,{ellipsis:{rows:6,expandable:!1}},null===r||void 0===r?void 0:r.milestoneDesc)))),n.a.createElement(b.a,{span:24,className:"txt-center"},n.a.createElement(ve.a.Title,{level:4},"ACCEPTANCE")),n.a.createElement(b.a,{span:11},n.a.createElement(ve.a.Title,{level:5},"This Deliverable is offered to the Commonwealth:"),n.a.createElement(ul.b,{column:1,bordered:!0,className:"certficate-describe large"},n.a.createElement(so,{label:"Signature"}," "),n.a.createElement(so,{label:"Date"}))),n.a.createElement(b.a,{span:11},n.a.createElement(ve.a.Title,{level:5},"This deliverable is accepted on behalf of the ____________________"),n.a.createElement(ul.b,{column:1,bordered:!0,className:"certficate-describe large"},n.a.createElement(so,{label:"Signature"}),n.a.createElement(so,{label:"Date"}))),n.a.createElement(b.a,{span:11},"                 ",n.a.createElement(ve.a.Title,{level:5},"Timewize Representative:"),n.a.createElement(ul.b,{column:1,bordered:!0,className:"certficate-describe representative small"},n.a.createElement(so,{label:"Title and Name:"}," "),n.a.createElement(so,{label:"Task Position:"}),n.a.createElement(so,{label:"Telephone:"}),n.a.createElement(so,{label:"Mobile:"}))),n.a.createElement(b.a,{span:11},n.a.createElement(ve.a.Title,{level:5},"______________ Representative:"),n.a.createElement(ul.b,{column:1,bordered:!0,className:"certficate-describe representative small"},n.a.createElement(so,{label:"Rank and Name:"}," "),n.a.createElement(so,{label:"Position:"}),n.a.createElement(so,{label:"Organisation:"}),n.a.createElement(so,{label:"Address:"}),n.a.createElement(so,{label:"Telephone:"}),n.a.createElement(so,{label:"Email:"}))))))},uo=(a(525),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this,e)).componentDidMount=function(){l.fetchAll()},l.fetchAll=function(){Promise.all([xt("PROJECTS"),Rr()]).then((function(e){var t=G().permissions,a=JSON.parse(t).TIMESHEETS;l.setState({PROJECTS:e[0].success?e[0].data:[],data:e[1].success?e[1].data:[],permissions:null!==a&&void 0!==a?a:{}})})).catch((function(e){console.log(e)}))},l.getProjects=function(e){Rr(e).then((function(e){e.success&&l.setState({data:e.data,sTMilestones:{milestones:[],keys:[]}})}))},l.uploading=function(){var e=l.state,t=e.sMile,a=e.data,n=e.sIndex,i=e.fileList;(function(e,t){return z.b.loading({content:"Loading...",key:1}),Ve.a.put("".concat(Tr,"/").concat(e,"/upload"),t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message,i=a.data;return $(n),z.b.success({content:n,key:1}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:i}})).catch((function(e){return Q(e,1,5)}))})(t,{fileId:i[0].fileId}).then((function(e){console.log(i[0],i[0].uniqueName),e.success&&(a[n].fileName=i[0].uid,l.setState({data:Object(we.a)(a),infoModal:!1,sMile:!1,sIndex:!1,fileList:[]}))}))},l.OutcomeAction=function(e,t){if("delete-certificate"===e)(function(e){return z.b.loading({content:"Loading...",key:e}),Ve.a.delete("".concat(Tr,"/").concat(e,"/delete-certificate"),{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.data,r=l.message;return $(r),z.b.success({content:r,key:e}),K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n,data:i}})).catch((function(e){return Q(e,1,5)}))})(t).then((function(e){e.success&&l.getProjects()}));else{var a=l.state,n=(a.data,{milestones:a.sTMilestones.keys});wr("/".concat(e),n).then((function(e){e.success&&l.getProjects()}))}},l.handleUpload=function(e){var t=e.file;l.setState({loading:!0});var a=new FormData;a.append("files",t),vl(a).then((function(e,t){if(e.success)l.setState({fileList:[e.file],loading:!1});else{l.setState({loading:!1}),console.log("Eroor: ",t);new Error("Some error")}}))},l.multiAction=function(e){var t,a=l.state.sTMilestones.milestones,i=a.length,r=n.a.createElement("div",null,a.map((function(e,t){var a=e.projectName,l=e.milestoneName;e.projectType;return n.a.createElement("div",{key:t},a," (".concat(l,")"),i-1>t&&",")}))),o=wt.a.confirm({title:"Do you wish to ".concat(e," Certificate").concat(i>1?"s":""," for"),icon:"unapprove"===e?n.a.createElement(Jn.a,null):n.a.createElement(S.a,null),content:r,okButtonProps:{danger:null===(t="unapprove"===e)||void 0===t||t},okText:"Okay",cancelText:"Cancel",onOk:function(){l.OutcomeAction(e),o.destroy()}})},l.milestoneSelect=function(e,t){var a=!1,n=!1,i=!1;t.forEach((function(e){""!==e.isApproved&&(n=!0),"SB"!==e.isApproved&&(a=!0),"AP"!==e.isApproved&&(i=!0)})),l.setState({sTMilestones:{milestones:t,keys:e,cantApprove:a,cantSubmit:n,cantUnapprove:i}})},l.state={infoModal:!1,data:[{project:"dummy",milestoneId:0}],sMile:!1,sIndex:!1,desc:{title:"",organization:{name:""},value:"",startDate:"",endDate:""},permissions:{},loading:!1,fileList:[],printing:!1,PROJECTS:[],sTMilestones:{milestones:[],keys:[]},columns:[Object(Fe.a)({title:"Project",dataIndex:"projectName",key:"projectName",className:"project-column",render:function(e,t,a){var i=l.state.permissions;return n.a.createElement(p.a,{gutter:[0,5],style:{minHeight:45.84}},n.a.createElement(b.a,{span:22},n.a.createElement(s.b,{to:{pathname:"projects/".concat(t.projectId,"/info")},className:"nav-link"},e)),t.fileName&&n.a.createElement(b.a,{span:12},n.a.createElement(p.a,{gutter:10},n.a.createElement(b.a,null,n.a.createElement("a",{href:"".concat(A,"/files/").concat(t.fileName),download:t.fileName,target:"_blank",rel:"noopener noreferrer"},n.a.createElement(qa.a,null),"Certificate")),n.a.createElement(b.a,null,n.a.createElement(Le.a,{title:"Do You Want To Delete Certificate?",onConfirm:function(){return l.OutcomeAction("delete-certificate",t.milestoneId)},okText:"Yes",cancelText:"No"},n.a.createElement(gl.a,{className:"milestone-delete",disabled:"AP"===t.isApproved||!i.APPROVAL||!0===!t.phase}))))))}},Jt("projectName","string")),Object(Fe.a)({title:"Miletsone",dataIndex:"milestoneName",key:"milestoneName",align:"center",render:function(e,t){return n.a.createElement(s.b,{to:{pathname:"projects/".concat(t.projectId,"/milestones/").concat(t.milestoneId,"/resources")},className:"nav-link"},e)}},Jt("milestoneName","string")),Object(Fe.a)({title:"Start Date",dataIndex:"startDate",key:"startDate",align:"center",render:function(e){return W(e,!0,!0)}},Jt("startDate","date")),Object(Fe.a)({title:"End Date",dataIndex:"endDate",key:"endDate",align:"center",render:function(e){return W(e,!0,!0)}},Jt("endDate","date")),Object(Fe.a)({title:"Status",dataIndex:"isApproved",key:"isApproved",align:"center",render:function(e){var t=""===e?"CM":e;return n.a.createElement(fi,{text:t})}},Jt("isApproved","string",!0)),{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){var i=l.state;i.permissions,i.basic;return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"Export",onClick:function(){return l.setState({printing:!0,sMile:t.milestoneId,sIndex:a})}},"Export"),n.a.createElement(v.a.Item,{key:"Upload",disabled:"SB"!==t.isApproved||!0===!t.phase,onClick:function(){return l.setState({infoModal:!0,sMile:t.milestoneId,sIndex:a})}},"Upload"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this,t=this.state,a=(t.desc,t.infoModal),l=t.data,i=t.sMile,r=t.permissions,o=t.loading,s=t.columns,c=t.fileList,d=t.printing,u=t.PROJECTS,m=t.sTMilestones;return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,null,n.a.createElement(b.a,null,n.a.createElement(ve.a.Title,{level:4},"Milestone Approval")),n.a.createElement(b.a,{offset:5},n.a.createElement(Qe.a,{placeholder:"Select Project",style:{width:300},allowClear:!0,options:u,showSearch:!0,optionFilterProp:["label","value"],filterOption:function(e,t){var a=t.label.toLowerCase().indexOf(e.toLowerCase())>=0,l=t.value.toString().toLowerCase().indexOf(e.toLowerCase())>=0;return a||l},onChange:function(t,a){e.getProjects(t)}}))),n.a.createElement(Rt.a,{bordered:!0,pagination:{pageSize:G().pageSize},rowKey:function(e){return e.milestoneId},rowSelection:{selectedRowKeys:m.keys,onChange:function(t,a){e.milestoneSelect(t,a)},getCheckboxProps:function(e){return{disabled:!r.UNAPPROVAL&&"AP"===e.isApproved||!1===e.phase}}},columns:s,dataSource:l,size:"small",className:"fs-small"}),n.a.createElement(p.a,{justify:"end",gutter:[20,200]},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",disabled:!r.UPDATE||m.keys.length<1||m.cantSubmit,onClick:function(){return e.multiAction("Submit")}},"Submit")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{className:"success",disabled:!r.APPROVAL||m.keys.length<1||m.cantApprove,onClick:function(){return e.multiAction("approve")}},"Approve")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{className:"not-success",disabled:!r.UNAPPROVAL||m.keys.length<1||m.cantUnapprove,onClick:function(){return e.multiAction("unapprove")}},"Unapprove"))),n.a.createElement(wt.a,{title:"Upload Certifiate",maskClosable:!1,centered:!0,visible:a,onOk:this.uploading,okButtonProps:{disabled:0===c.length},okText:"Upload",onCancel:function(){return e.setState({infoModal:!1,sMile:!1,sIndex:!1,loading:!1,fileList:[]})},width:540,confirmLoading:o,destroyOnClose:!0},n.a.createElement("div",null,n.a.createElement(We.a.Dragger,{name:"file",multiple:!1,maxCount:1,listType:"picture",className:"upload-list-inline",customRequest:this.handleUpload,onRemove:function(){return e.setState({fileList:[]})},fileList:c},n.a.createElement(Ba.a,{image:c.length>0?Ba.a.PRESENTED_IMAGE_DEFAULT:Ba.a.PRESENTED_IMAGE_SIMPLE,description:n.a.createElement("p",{className:"import-empty"},"Click or drag file to this area to upload")})))),d&&n.a.createElement(co,{mileId:i,close:function(){return e.setState({printing:!1,sMile:!1})}}))}}]),a}(l.Component)),mo=a(298),fo=a(577),po=a(581),bo=(a(526),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(c.a)(this,a);for(var l=arguments.length,i=new Array(l),r=0;r<l;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).getListData=function(e){var t;switch(e.date()){case 8:t=[{type:"warning",content:"This is warning event.",dec:"Description: This is warning event."},{type:"success",content:"This is usual event.",dec:"Description: This is warning event."}];break;case 10:t=[{type:"warning",content:"This is warning event.",dec:"Description: This is warning event."},{type:"success",content:"This is usual event.",dec:"Description: This is usual event."},{type:"error",content:"This is error event.",dec:"Description: TThis is error event."}];break;case 15:t=[{type:"warning",content:"This is warning event",dec:"Description: TThis is error event."},{type:"success",content:"This is very long usual event\u3002\u3002....",dec:"ou can\u2019t write good content for a website without knowing why you\u2019re writing it.Is the website content selling a product? Is it meant to attract new clients? Is it building traffic to support advertising and sponsorships? Once you know the main goal of the website content you\u2019re producing, you\u2019ll be better positioned to write copy that will help achieve that goal.But before you even write one word of content for a website, know who you\u2019re writing it for."},{type:"error",content:"This is error event 1.",dec:"Description: This is error event 1."},{type:"error",content:"This is error event 2.",dec:"Description: This is error event 2."},{type:"error",content:"This is error event 3.",dec:"Description: TThis is error event 3."},{type:"error",content:"This is error event 4.",dec:"Description: TThis is error event 4."}]}return t||[]},e.popover=function(e){return n.a.createElement("div",null,n.a.createElement("p",null,n.a.createElement("b",null,"Detail: "),e.content),n.a.createElement("p",null,n.a.createElement("b",null,"Description: "),e.dec))},e.dateCellRender=function(t){var a=e.getListData(t);return n.a.createElement("ul",{className:"events"},a.map((function(t){return n.a.createElement("li",{key:t.content},n.a.createElement(mo.a,{content:e.popover(t),title:t.type},n.a.createElement("span",null,n.a.createElement(fo.a,{status:t.type,text:t.content}))))})))},e.getMonthData=function(e){if(8===e.month())return 1394},e.monthCellRender=function(t){var a=e.getMonthData(t);return a?n.a.createElement("div",{className:"notes-month"},n.a.createElement("section",null,a),n.a.createElement("span",null,"Backlog number")):null},e}return Object(d.a)(a,[{key:"render",value:function(){return n.a.createElement(po.a,{dateCellRender:this.dateCellRender,monthCellRender:this.monthCellRender})}}]),a}(l.Component)),go="".concat(A,"/auth"),yo=function(e){return Ve.a.post("".concat(A,"/login"),e).then((function(e){localStorage.clear();var t=e.data,a=t.success,l=t.data,n=t.message;if(z.b.success({content:n,key:"logout"},5),a){var i={};l.role.permissions.map((function(e){i[e.resource]||(i[e.resource]={}),i[e.resource][e.action]||(i[e.resource][e.action]={}),i[e.resource][e.action][e.grant]=!0})),l.permissions=JSON.stringify(i),delete l.role.permissions,l.role=JSON.stringify(l.role);for(var r=Object.keys(l),o=r.length-1;o>=0;o--){var s=r[o];localStorage.setItem(s,l[s])}return{success:a,data:l}}})).catch((function(e){return z.b.error({content:e.message,key:"logout"},5),{error:"Please login again!",status:!1,message:e.message}}))},ho=function(){var e=Object(La.a)(Ma.a.mark((function e(t){return Ma.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ve.a.post("".concat(A,"/forgotPassword"),t).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;if(a)return z.b.success({content:n,key:"logout"},5),{success:a,data:l}})).catch((function(e){return z.b.error({content:e.message,key:"logout"},5),{error:"Something went wrong!",status:!1,message:e.message}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),vo=function(){var e=Object(La.a)(Ma.a.mark((function e(t,a){return Ma.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ve.a.post("".concat(A,"/resetPassword/").concat(t),a).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;if(a)return z.b.success({content:n,key:"logout"},5),{success:a,data:l}})).catch((function(e){var t;return z.b.error({content:null!==(t=e.response.data.message)&&void 0!==t?t:e.message,key:"logout"},5),{error:"Something went wrong!",status:!1,message:e.message}})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Eo=function(){var e=localStorage.getItem("accessToken"),t=localStorage.getItem("jwtExpired");return e&&t?"jwtExpired":!!e},ko=function(e){var t=Me.a.useForm(),a=Object(he.a)(t,1)[0],i=Object(l.useState)(!0),r=Object(he.a)(i,2),o=r[0],s=r[1],c=Object(l.useState)([{fieldCol:12,size:"small",Placeholder:"Contact person Code",rangeMin:!0,type:"Text",labelAlign:"left"},{Placeholder:"Date Of Birth",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:12,key:"cpCode",size:"small",readOnly:!0,rules:[{required:!0,message:"Select Contact Person !!"}],type:"Input",labelAlign:"left",itemStyle:{marginBottom:20}},{object:"basic",disabled:!0,fieldCol:12,key:"dateOfBirth",size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:20}},{fieldCol:12,size:"small",Placeholder:"First Name",disabled:!1,type:"Text",labelAlign:"left"},{Placeholder:"Last Name",fieldCol:12,size:"small",disabled:!1,type:"Text",labelAlign:"left"},{object:"basic",readOnly:!0,fieldCol:12,key:"firstName",size:"small",type:"Input",labelAlign:"left",disabled:!1,itemStyle:{marginBottom:20}},{object:"basic",readOnly:!0,fieldCol:12,key:"lastName",size:"small",type:"Input",labelAlign:"left",disabled:!1,itemStyle:{marginBottom:20}},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{fieldCol:12,size:"small",Placeholder:"Email",disabled:!1,type:"Text",labelAlign:"left"},{object:"basic",readOnly:!0,fieldCol:12,key:"phoneNumber",size:"small",type:"input",itemStyle:{marginBottom:20}},{object:"basic",readOnly:!0,fieldCol:12,key:"email",size:"small",type:"Input",disabled:!1,itemStyle:{marginBottom:20}},{Placeholder:"Gender",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"State For Payroll Tax Purpose",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"basic",readOnly:!0,fieldCol:12,key:"gender",size:"small",data:[{label:"Male",value:"M"},{label:"Female",value:"F"},{label:"Other",value:"O"}],itemStyle:{marginBottom:20},type:"Select",disabled:!0},{object:"basic",readOnly:!0,fieldCol:12,key:"stateId",size:"small",type:"Select",disabled:!0,data:[],itemStyle:{marginBottom:20}},{Placeholder:"Address",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"basic",fieldCol:24,key:"address",size:"small",type:"Input",itemStyle:{marginBottom:30},onChange:function(){s(!1)}}]),d=Object(he.a)(c,2),u=d[0],m=d[1];Object(l.useEffect)((function(){f(),a.setFieldsValue({basic:e.data})}),[]);var f=function(){pt().then((function(e){if(e.success){var t=u.map((function(t){return"stateId"===t.key?Object(Fe.a)(Object(Fe.a)({},t),{},{data:e.data}):t}));m(t)}}))};return n.a.createElement(Me.a,{id:"my-form",form:a,scrollToFirstError:!0,size:"small",layout:"inline",style:{padding:50,paddingTop:20},onFinish:function(e){var t,a=e.basic;(t={address:a.address},Ve.a.patch("".concat(go,"/address"),t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),z.b.success({content:i,key:"logout"}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return z.b.error({content:e.message,key:"logout"}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e.success&&s(!0)}))}},n.a.createElement(ft,{FormFields:u}),n.a.createElement(Be.a,{type:"primary",disabled:o,htmlType:"submit",style:{margin:"0 15px 0 auto"}}," Edit Address "))},So=function(e){var t=Me.a.useForm(),a=Object(he.a)(t,1)[0],i=Object(l.useState)([{Placeholder:"Employment Status",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Payslip Email",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,disabled:!0,key:"type",size:"small",data:[{label:"Casual",value:1},{label:"Part Time",value:2},{label:"Full Time",value:3}],type:"Select",rules:[{required:!0,message:"Status is Required"}],itemStyle:{marginBottom:1}},{object:"billing",fieldCol:12,key:"payslipEmail",disabled:!0,size:"small",type:"input",itemStyle:{marginBottom:1}},{Placeholder:"Work Hours In A Week",rangeMin:!0,fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Work Days In A Week",rangeMin:!0,fieldCol:6,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Contract Start Date",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:6,key:"noOfHours",disabled:!0,size:"small",type:"InputNumber",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Work Hours is Required"}],itemStyle:{marginBottom:1}},{object:"billing",fieldCol:6,key:"noOfDays",disabled:!0,size:"small",type:"InputNumber",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Work Days are Required"}],itemStyle:{marginBottom:10}},{object:"billing",fieldCol:12,key:"startDate",disabled:!0,size:"small",type:"DatePicker",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Start Date is Required"}],itemStyle:{marginBottom:1}},{Placeholder:"Contract End Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Annual Base Salary",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"endDate",disabled:!0,size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:1}},{object:"billing",fieldCol:12,key:"remunerationAmount",disabled:!0,size:"small",type:"InputNumber",shape:"$",fieldStyle:{width:"100%"},rules:[{required:!0,message:"Salary is Required"}],itemStyle:{marginBottom:1}},{Placeholder:"Pay Frequence",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Leave Policy",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:12,key:"payFrequency",disabled:!0,size:"small",data:[{label:"Hourly",value:1},{label:"Daily",value:2},{label:"Weekly",value:3},{label:"Fortnightly",value:4},{label:"Monthly",value:5}],type:"Select",rules:[{required:!0,message:"Payment Frequncy is required"}],itemStyle:{marginBottom:1}},{object:"billing",fieldCol:12,key:"leaveRequestPolicyId",disabled:!0,size:"small",data:[],type:"Select",rules:[{required:!0,message:"Policy is required"}],itemStyle:{marginBottom:10}},{Placeholder:"Comments",fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"billing",fieldCol:24,key:"comments",disabled:!0,size:"small",type:"Textarea",itemStyle:{marginBottom:1}}]),r=Object(he.a)(i,2),o=r[0],s=r[1];Object(l.useEffect)((function(){c(),a.setFieldsValue({billing:e.data})}),[]);var c=function(){It().then((function(t){if(t.success){var a=o,l=e.data.type;a[17].data=t.data,a[11].Placeholder=1===l?"Hourly Base Salary":"Annual Base Salary",s(Object(we.a)(a))}}))};return n.a.createElement(Me.a,{id:"my-form",form:a,scrollToFirstError:!0,size:"small",layout:"inline",style:{padding:50,paddingTop:20}},n.a.createElement(ft,{FormFields:o}))},Co=Je.a.Password,jo=ve.a.Title,Do=function(e){var t=Object(l.useState)(!1),a=Object(he.a)(t,2),i=a[0],r=a[1];return n.a.createElement(p.a,{style:{padding:50,paddingTop:20}},n.a.createElement(b.a,{span:6},n.a.createElement(jo,{level:2},"Password"),n.a.createElement(jo,{level:5},"After a successful password update, you will be redirected to the login page where you can log in with your new password.")),n.a.createElement(b.a,{span:12},n.a.createElement(Me.a,{id:"sdsda",scrollToFirstError:!0,size:"small",layout:"vertical",wrapperCol:{span:16},onFinish:function(e){var t;console.log(e),(t=e,Ve.a.patch("".concat(go,"/password"),t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),z.b.success({content:i,key:"logout"},5),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){var t,a=null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data.message;return z.b.error({content:a||e.message,key:"logout"}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e.success&&(localStorage.clear(),r(!0))}))}},n.a.createElement(Me.a.Item,{name:"oldPassword",label:"Current Password",rules:[{required:!0,message:"Please input your current password!"}]},n.a.createElement(Co,{autoComplete:"new-password"})),n.a.createElement(Me.a.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please input your New password!"},{min:6,message:"New Password Should have atleast 6 Character"}],hasFeedback:!0},n.a.createElement(Co,{autoComplete:"new-password"})),n.a.createElement(Me.a.Item,{name:"confirm",label:"Confirm Password",dependencies:["newPassword"],hasFeedback:!0,rules:[{required:!0,message:"Please confirm your password!"},function(e){var t=e.getFieldValue;return{validator:function(e,a){return a&&t("newPassword")!==a?Promise.reject(new Error("Passwords do not match!")):Promise.resolve()}}}]},n.a.createElement(Co,{autoComplete:"new-password"})),n.a.createElement(Me.a.Item,null,n.a.createElement(Be.a,{type:"primary",htmlType:"submit"}," Reset Password ")))),i&&n.a.createElement(o.a,{to:{pathname:"/"}}))};var Oo=function(e){var t=Me.a.useForm(),a=Object(he.a)(t,1)[0],i=Object(l.useState)([{Placeholder:"Superannuation",fieldCol:24,size:"small",type:"Title",mode:3,labelAlign:"right"},{Placeholder:"Superannuation Fund/ SMSF Name",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Account type",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"detail",fieldCol:12,key:"superannuationName",size:"small",type:"Input",itemStyle:{marginBottom:20}},{object:"detail",fieldCol:12,key:"superannuationType",size:"small",data:[{label:"Public",value:"P"},{label:"SMSF",value:"S"}],type:"Select",itemStyle:{marginBottom:20},onChange:function(e){E(e)}}]),r=Object(he.a)(i,2),o=r[0],s=r[1],c=Object(l.useState)([{Placeholder:"Next Of Kin",fieldCol:24,size:"small",type:"Title",mode:3,labelAlign:"right"},{Placeholder:"Name",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Phone",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"kin",fieldCol:12,key:"nextOfKinName",size:"small",type:"input",itemStyle:{marginBottom:20}},{object:"kin",fieldCol:12,key:"nextOfKinPhoneNumber",size:"small",type:"input",itemStyle:{marginBottom:20}},{Placeholder:"Email",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Relationship to Employee",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"kin",fieldCol:12,key:"nextOfKinEmail",size:"small",type:"input",itemStyle:{marginBottom:20}},{object:"kin",fieldCol:12,key:"nextOfKinRelation",size:"small",data:[{label:"Spouse",value:"Spouse"},{label:"Partner",value:"Partner"},{label:"Sibling",value:"Sibling"},{label:"Parent",value:"Parent"},{label:"Child",value:"Child"},{label:"Friend",value:"Friend"}],type:"Select"}]),d=Object(he.a)(c,2),u=d[0],m=(d[1],Object(l.useState)([{Placeholder:"Bank Details",fieldCol:24,size:"small",type:"Title",mode:3,labelAlign:"right"},{Placeholder:"Bank Account Name",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Bank Account Number",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"bank",fieldCol:12,key:"bankName",size:"small",type:"Input",onChange:function(e){k(e)},itemStyle:{marginBottom:20}},{object:"bank",fieldCol:12,key:"bankAccountNo",size:"small",type:"Input",onChange:function(e){k(e)},itemStyle:{marginBottom:20}},{Placeholder:"BSB Number",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Tax File Number",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"bank",fieldCol:12,key:"bankBsb",size:"small",type:"Input",onChange:function(e){k(e)},itemStyle:{marginBottom:20}},{object:"bank",fieldCol:12,key:"tfn",size:"small",type:"Input",onChange:function(e){k(e)},itemStyle:{marginBottom:20}},{Placeholder:"Tax-free Threshold",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"HELP (HECS)",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"bank",fieldCol:12,key:"taxFreeThreshold",size:"small",data:[{label:"Yes",value:!0},{label:"No",value:!1}],type:"Select",itemStyle:{marginBottom:20}},{object:"bank",fieldCol:12,key:"helpHECS",size:"small",data:[{label:"Yes",value:!0},{label:"No",value:!1}],type:"Select",itemStyle:{marginBottom:20}}])),f=Object(he.a)(m,2),p=f[0],g=f[1],y=Object(l.useState)({}),h=Object(he.a)(y,2),v=(h[0],h[1]);Object(l.useEffect)((function(){var t=e.data,l=t.train,n=t.bank,i=t.kin,r=t.detail;a.setFieldsValue({train:l,bank:n,kin:i,detail:r}),E(),k()}),[]);var E=function(e){var t=a.getFieldsValue().detail,l=t.superAnnuationName,n=t.superannuationType,i=o;"P"===n?(i.splice(5,i.length),i=i.concat([{Placeholder:"Membership / Account",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"USI Number",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"detail",fieldCol:12,key:"superannuationBankAccountOrMembershipNumber",size:"small",type:"Input",rules:[{required:!0,message:"Membership / Account is required"}],itemStyle:{marginBottom:20}},{object:"detail",fieldCol:12,key:"superannuationAbnOrUsi",size:"small",type:"Input",rules:[{required:!0,message:"USI Number is required"}],itemStyle:{marginBottom:20}}])):"S"===n?(i.splice(5,i.length),i=i.concat([{Placeholder:"SMSF ABN",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"ESA Address",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"detail",fieldCol:12,key:"superannuationAbnOrUsi",size:"small",type:"Input",rules:[{required:!0,message:"SMSF ABN is required"}],itemStyle:{marginBottom:20}},{object:"detail",fieldCol:12,key:"superannuationAddress",size:"small",type:"Input",rules:[{required:!0,message:"ESA Address is required"}],itemStyle:{marginBottom:20}},{Placeholder:"Bank Account Name",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"BSB Number",rangeMin:!0,fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"detail",fieldCol:12,key:"superannuationBankName",size:"small",type:"Input",rules:[{required:!0,message:"Account Name is required"}],itemStyle:{marginBottom:20}},{object:"detail",fieldCol:12,key:"superannuationBankBsb",size:"small",type:"Input",rules:[{required:!0,message:"BSB Number is required"}],itemStyle:{marginBottom:20}},{Placeholder:"Bank Account Number",rangeMin:!0,fieldCol:24,size:"small",type:"Text",labelAlign:"right"},{object:"detail",fieldCol:12,key:"superannuationBankAccountOrMembershipNumber",size:"small",type:"Input",rules:[{required:!0,message:"Account Number is required"}],itemStyle:{marginBottom:"20px"}}])):i.splice(5,i.length);var r={superAnnuationName:l,superannuationType:n};a.setFieldsValue({detail:r}),s(i)},k=function(){var e=JSON.parse(G().permissions).PROFILE,t=a.getFieldsValue().bank,l=t.bankAccountNo,n=t.bankBsb,i=t.bankName,r=t.tfn,o=p;l||n||i||r?(o[1].rangeMin=!0,o[2].rangeMin=!0,o[5].rangeMin=!0,o[6].rangeMin=!0,o[3].rules=[{required:!0,message:"Account Name is required"}],o[4].rules=[{required:!0,message:"Account Number is required"}],o[7].rules=[{required:!0,message:"BSB Number is required"}],o[8].rules=[{required:!0,message:"Tax File Number is required"}]):(o[1].rangeMin=!1,o[2].rangeMin=!1,o[5].rangeMin=!1,o[6].rangeMin=!1,o[3].rules=[{required:!1,message:""}],o[4].rules=[{required:!1,message:""}],o[7].rules=[{required:!1,message:""}],o[8].rules=[{required:!1,message:""}]),g(Object(we.a)(o)),v(e)};return n.a.createElement(Me.a,{id:"my-form",form:a,scrollToFirstError:!0,size:"small",layout:"inline",style:{padding:50,paddingTop:20},onFinish:function(e){var t,a=Object(Fe.a)(Object(Fe.a)(Object(Fe.a)({},e.detail),e.kin),e.bank);(t=a,Ve.a.patch("".concat(go,"/settings"),t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),z.b.success({content:i,key:"logout"}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return z.b.error({content:e.message,key:"logout"}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e.success}))}},n.a.createElement(ft,{FormFields:o}),n.a.createElement(ft,{FormFields:u}),n.a.createElement(ft,{FormFields:p}),n.a.createElement(b.a,{span:24,style:{padding:20}},n.a.createElement(Be.a,{htmlType:"submit",type:"primary",size:"middle",style:{float:"right"}}," Save ")))},Io=function(e){var t=Me.a.useForm(),a=Object(he.a)(t,1)[0],i=Object(l.useState)([{Placeholder:"Clearance Level",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Date Granted",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"security",fieldCol:12,key:"clearanceLevel",disabled:!0,size:"small",data:[{label:"BV - Baseline Vetting",value:"BV"},{label:"NV1 - Negative Vetting 1",value:"NV1"},{label:"NV2 - Negative Vetting 2",value:"NV2"},{label:"PV - Positive Vetting",value:"PV"},{label:"No clearance",value:"NC"}],type:"Select",itemStyle:{marginBottom:10}},{object:"security",fieldCol:12,key:"clearanceGrantedDate",disabled:!0,size:"small",type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10}},{Placeholder:"Expiry Date",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{Placeholder:"Current Sponsor",fieldCol:12,size:"small",type:"Text",labelAlign:"right"},{object:"security",fieldCol:12,key:"clearanceExpiryDate",size:"small",disabled:!0,type:"DatePicker",fieldStyle:{width:"100%"},itemStyle:{marginBottom:10}},{object:"security",fieldCol:12,key:"clearanceSponsorId",disabled:!0,size:"small",type:"Select",labelAlign:"right",itemStyle:{marginBottom:10}}]),r=Object(he.a)(i,2),o=r[0],s=r[1];return Object(l.useEffect)((function(){vt().then((function(e){if(e.success){var t=Object(we.a)(o);t[7].data=e.data,s(Object(we.a)(t))}})),a.setFieldsValue({security:e.data})}),[]),n.a.createElement(Me.a,{id:"my-form",form:a,scrollToFirstError:!0,size:"small",layout:"inline",style:{padding:50,paddingTop:20}},n.a.createElement(ft,{FormFields:o}))},Po=function(e){var t=Me.a.useForm(),a=Object(he.a)(t,1)[0],i=Object(l.useState)([]),r=Object(he.a)(i,2),o=r[0],s=r[1],c=Object(l.useState)({}),d=Object(he.a)(c,2),u=d[0],m=d[1],f=Object(l.useState)({}),p=Object(he.a)(f,2),g=p[0],y=p[1],h=Object(l.useState)(0),v=Object(he.a)(h,2),E=v[0],k=v[1],S=Object(l.useState)(!0),C=Object(he.a)(S,2),j=C[0],D=C[1];Object(l.useEffect)((function(){gt().then((function(t){if(t.success){s(t.data);var l={};t.data.forEach((function(e){l[e.value]=null===e||void 0===e?void 0:e.levels})),m(l),k(e.data.length),a.setFieldsValue({resource:e.data})}}))}),[]);var O=function(e){if(!isNaN(e)){var t,l=a.getFieldsValue().resource,n=null===l||void 0===l||null===(t=l[e])||void 0===t?void 0:t.standardSkillId;return isNaN(n)?[]:u[n]}return[]};return n.a.createElement(Me.a,{id:"my-form",form:a,scrollToFirstError:!0,size:"small",layout:"inline",onFieldsChange:function(){return D(!1)},style:{padding:50,paddingTop:20,textAlign:"center"},onFinish:function(e){var t,a,l=null!==(t=null===e||void 0===e?void 0:e.resource)&&void 0!==t?t:{},n=[];Object.entries(l).forEach((function(e){var t=Object(he.a)(e,2),a=(t[0],t[1]);!a.standardLevelId&&a.id&&n.push(a.id)})),(a={standardSkillStandardLevelIds:n},Ve.a.post("".concat(go,"/addSkill"),a,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),z.b.success({content:i,key:"logout"}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return z.b.error({content:e.message,key:"logout"}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e.success&&(k(e.data.length),D(!0))}))}},n.a.createElement(Me.a.List,{name:"resource"},(function(e,t){var a=t.add,l=t.remove;return n.a.createElement(n.a.Fragment,null,n.a.createElement(Me.a.Item,{style:{margin:"0px 20px 10px auto"}},n.a.createElement(Be.a,{size:"small",onClick:function(){return a()},type:"primary"}," ",n.a.createElement(qn.a,null)," Insert Skill")),e.map((function(e,t){return n.a.createElement("span",{className:"ant-row",key:e.key,style:{width:"100%",marginBottom:10}},n.a.createElement(b.a,{span:11},n.a.createElement(Me.a.Item,Object.assign({},e,{label:"Skill",name:[e.name,"standardSkillId"]}),n.a.createElement(Qe.a,{style:{width:"100%"},size:"small",options:o,onChange:function(){return y(!g)},disabled:e.name<E}))),n.a.createElement(b.a,{span:11},n.a.createElement(Me.a.Item,Object.assign({},e,{label:"Level",name:[e.name,"id"]}),n.a.createElement(Qe.a,{style:{width:"100%"},size:"small",disabled:e.name<E,options:O(e.name)}))),n.a.createElement(b.a,{span:"auto"},n.a.createElement(fa.a,{style:{color:"".concat(e.name<E?"grey":"red"),margin:"auto"},onClick:function(){e.name>E-1&&l(e.name)}})))})),n.a.createElement(Me.a.Item,{style:{marginTop:8}},n.a.createElement(Be.a,{size:"small",type:"primary",htmlType:"submit",disabled:j}," Save  ")))})))},xo=el.a.TabPane,To=function(){var e=Object(l.useState)(!1),t=Object(he.a)(e,2),a=t[0],i=t[1],r=Object(l.useState)(!1),o=Object(he.a)(r,2),s=o[0],c=o[1],d=Object(l.useState)(!1),u=Object(he.a)(d,2),m=u[0],f=u[1],p=Object(l.useState)(!1),b=Object(he.a)(p,2),g=b[0],y=b[1],h=Object(l.useState)(!1),v=Object(he.a)(h,2),E=v[0],k=v[1],S=JSON.parse(G().role).type;Object(l.useEffect)((function(){C()}),[]);var C=function(){Ve.a.get("".concat(go,"/settings"),{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;if($(n),a){var i,r,o=l.contactPersonOrganization?l.contactPersonOrganization.contactPerson:{},s={cpCode:"Emp-00".concat(o.id),firstName:o.firstName,lastName:o.lastName,gender:o.gender,dateOfBirth:W(o.dateOfBirth),phoneNumber:o.phoneNumber,email:o.email,address:o.address,stateId:o.stateId,username:l.username},c={superannuationName:l.superannuationName,superannuationBankName:l.superannuationBankName,superannuationBankAccountOrMembershipNumber:l.superannuationBankAccountOrMembershipNumber,superannuationAbnOrUsi:l.superannuationAbnOrUsi,superannuationBankBsb:l.superannuationBankBsb,superannuationAddress:l.superannuationAddress,superannuationType:l.superannuationType},d={nextOfKinDateOfBirth:W(l.nextOfKinDateOfBirth),nextOfKinEmail:l.nextOfKinEmail,nextOfKinGender:l.nextOfKinGender,nextOfKinName:l.nextOfKinName,nextOfKinPhoneNumber:l.nextOfKinPhoneNumber,nextOfKinRelation:l.nextOfKinRelation},u=l.bankAccounts.length>0?l.bankAccounts[0]:{},m={bankName:u.name,bankAccountNo:u.accountNo,bankBsb:u.bsb,tfn:l.tfn,taxFreeThreshold:l.taxFreeThreshold,helpHECS:l.helpHECS},f=l.employmentContracts&&l.employmentContracts.length>0?l.employmentContracts[0]:{},p={employeeId:null===f||void 0===f?void 0:f.employeeId,payslipEmail:null===f||void 0===f?void 0:f.payslipEmail,membershipAccountNo:null===f||void 0===f?void 0:f.membershipAccountNo,payFrequency:null===f||void 0===f?void 0:f.payFrequency,startDate:W(null===f||void 0===f?void 0:f.startDate),endDate:W(null===f||void 0===f?void 0:f.endDate),type:null===f||void 0===f?void 0:f.type,noOfHours:null===f||void 0===f?void 0:f.noOfHours,noOfDays:null===f||void 0===f?void 0:f.noOfDays,noOfHoursPer:null===f||void 0===f?void 0:f.noOfHoursPer,remunerationAmount:null===f||void 0===f?void 0:f.remunerationAmount,remunerationAmountPer:null===f||void 0===f?void 0:f.remunerationAmountPer,comments:null===f||void 0===f?void 0:f.comments,leaveRequestPolicyId:null!==(i=null===f||void 0===f?void 0:f.leaveRequestPolicyId)&&void 0!==i?i:0},b={clearanceLevel:o.clearanceLevel,clearanceGrantedDate:W(o.clearanceGrantedDate),clearanceExpiryDate:W(o.clearanceExpiryDate),clearanceSponsorId:o.clearanceSponsorId},g=o.standardSkillStandardLevels;return K(null===e||void 0===e||null===(r=e.headers)||void 0===r?void 0:r.authorization),{success:a,data:l,basic:s,detail:c,kin:d,bank:m,billing:p,sClearance:b,resourceSkill:g}}return{success:a}})).catch((function(e){return console.log("err",e),{error:"Please login again!",status:!1,message:e.message}})).then((function(e){e&&e.success&&(i(e.basic),c(e.billing),f({kin:e.kin,detail:e.detail,bank:e.bank}),y(e.sClearance),k(e.resourceSkill))}))};return n.a.createElement(el.a,{type:"card",defaultActiveKey:"personal"},n.a.createElement(xo,{tab:"Personal Details",key:"personal"},a&&n.a.createElement(ko,{data:a})),"Employee"===S&&n.a.createElement(xo,{tab:"Contract",key:"contract"},s&&n.a.createElement(So,{data:s})),n.a.createElement(xo,{tab:"Other Details",key:"others"}," ",m&&n.a.createElement(Oo,{data:m})," "),n.a.createElement(xo,{tab:"Security Clearance",key:"security"}," ",m&&n.a.createElement(Io,{data:g})," "),n.a.createElement(xo,{tab:"Password",key:"password "}," ",n.a.createElement(Do,null)," "),n.a.createElement(xo,{tab:"Skills",key:"skills"}," ",n.a.createElement(Po,{data:E})," "),n.a.createElement(xo,{tab:"Attachments",key:"attachments"}," ",n.a.createElement(Al,{targetType:"emp",targetId:G().id})," "))},zo=ve.a.Title,Ao=function(){var e=Me.a.useForm(),t=Object(he.a)(e,1)[0];Object(l.useEffect)((function(){Ve.a.get("".concat(A,"/auth/training"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return z.b.error({content:e.message,key:"logout"}),{error:"Please login again!",status:!1,message:e.message}})).then((function(e){e.success&&t.setFieldsValue({notes:e.data})}))}),[]);return n.a.createElement(p.a,null,n.a.createElement(b.a,{span:"24"},n.a.createElement(zo,{level:3},"Training")),n.a.createElement(b.a,{span:"24"},n.a.createElement(Me.a,{id:"my-form",onFinish:function(e){var t;(t={training:e.notes},Ve.a.patch("".concat(A,"/auth/training"),t,{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.data,i=a.message;return $(i),z.b.success({content:i,key:"logout"}),l&&K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization),{success:l,data:n}})).catch((function(e){return z.b.error({content:e.message,key:"logout"}),{error:"Please login again!",status:!1,message:e.message}}))).then((function(e){e.success}))},form:t},n.a.createElement(Me.a.Item,{noStyle:!0,name:"notes"},n.a.createElement(Je.a.TextArea,{placeholder:"Enter Your Notes....",autoSize:{minRows:10,maxRows:20},allowClear:!0})),n.a.createElement(Be.a,{type:"primary",htmlType:"submit",style:{margin:"10px 15px 0px 0px"}}," Submit "))))},Ro="".concat(A,"/expenses"),wo=function(e,t){return Ve.a.get("".concat(Ro).concat(e?"/available":"").concat(t?"?sheetId=".concat(t):""),{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;return $(n),K(e.headers&&e.headers.authorization),{success:a,data:l}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))},Fo=ve.a.Text,No=function(e){var t=e.visible,a=e.close,i=e.callBack,r=["AP","SB"].includes(t.status),o=Object(l.useState)([]),s=Object(he.a)(o,2),c=s[0],d=s[1],u=Object(l.useState)(),m=Object(he.a)(u,2),f=(m[0],m[1]),p=Object(l.useState)({}),b=Object(he.a)(p,2),g=b[0],y=b[1],h=Me.a.useForm(),v=Object(he.a)(h,1)[0],E=Object(l.useState)([{Placeholder:"Expense Type",rangeMin:!0,fieldCol:12,size:"small",type:"Text"},{Placeholder:"Project",fieldCol:12,size:"small",type:"Text"},{object:"basic",fieldCol:12,key:"expenseTypeId",disabled:r,size:"small",rules:[{required:!0,message:"type is Required"}],data:[],type:"Select"},{object:"basic",fieldCol:12,key:"projectId",disabled:t.isInSheet,size:"small",initialValue:null,data:[],type:"Select"},{Placeholder:"Date",rangeMin:!0,fieldCol:12,size:"small",type:"Text"},{Placeholder:"Amount",rangeMin:!0,fieldCol:12,size:"small",type:"Text"},{object:"basic",fieldCol:12,key:"date",disabled:r,size:"small",rules:[{required:!0,message:"Date is Required"}],data:[],type:"DatePicker",fieldStyle:{width:"100%"}},{object:"basic",fieldCol:12,key:"amount",disabled:r,size:"small",shape:"$",rules:[{required:!0,message:"Amount is Required"}],type:"InputNumber"},{object:"basic",fieldCol:1,key:"isReimbursed",disabled:r,size:"small",initialValue:!1,type:"Checkbox",valuePropName:"checked",itemStyle:{margin:"10px 0px"}},{Placeholder:"Reimbursable",fieldCol:10,size:"small",type:"Text",itemStyle:{margin:"10px 0px"}},{Placeholder:"Notes",fieldCol:24,size:"small",type:"Text"},{object:"basic",fieldCol:24,key:"notes",initialValue:null,disabled:r,size:"small",type:"Textarea",rows:5,placeholder:"Note"}]),k=Object(he.a)(E,2),S=k[0],C=k[1];Object(l.useEffect)((function(){D(),j(),!0!==t&&(t.date=W(t.date),v.setFieldsValue({basic:t}))}),[]);var j=function(){var e=G(),t=(e.id,e.permissions),a=void 0===t?"":t,l=JSON.parse(a).EXPENSES;y(void 0===l?{}:l)},D=function(){var e=G(),a=e.id,l=e.permissions,n=void 0===l?"":l,i=JSON.parse(n).EXPENSES;y(void 0===i?{}:i),Promise.all([Ct(a,"O",0),Ka(),!0!==t&&kl("EXP",t.id)]).then((function(e){var t,a=S;a[3].data=e[0].success?e[0].data:[],a[2].data=e[1].success?e[1].data:[],C(Object(we.a)(a)),d((null===(t=e[2])||void 0===t?void 0:t.success)?e[2].fileList:[])}))},O=function(){var e=Object(La.a)(Ma.a.mark((function e(t){var a,l,n,i,r;return Ma.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.onSuccess,l=t.onError,n=t.file,i=t.onProgress,r=new FormData,{headers:{"content-type":"multipart/form-data"},onUploadProgress:function(e){var t=Math.floor(e.loaded/e.total*100);f(t),100===t&&setTimeout((function(){return f(0)}),1e3),i({percent:e.loaded/e.total*100})}},r.append("files",n),vl(r).then((function(e,t){if(e.success)a("Ok"),d([].concat(Object(we.a)(c),[e.file]));else{console.log("Eroor: ",t);new Error("Some error");l({err:t})}}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return n.a.createElement(wt.a,{title:!0!==t?"Edit Expense":"Add Expense",visible:t,width:650,onCancel:a,okText:"Save",okButtonProps:{htmlType:"submit",form:"my-form",disabled:r||!g.UPDATE||!g.ADD}},n.a.createElement(Me.a,{id:"my-form",form:v,onFinish:function(e){var a,l=e.basic;l=Object(Fe.a)(Object(Fe.a)({},l),{},{isBillable:!1,projectId:null!==(a=l.projectId)&&void 0!==a?a:null,attachments:c.map((function(e,t){return e.fileId}))}),!0===t?function(e){return console.log("data",e),z.b.loading({content:"Loading...",key:1},5),Ve.a.post(Ro,e,{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.message,n=t.data;return $(l),z.b.success({content:l,key:1},5),K(e.headers&&e.headers.authorization),{success:a,data:n}})).catch((function(e){return z.b.error({content:"Error!",key:1},5),{error:"Please login again!",status:!1,message:e.message}}))}(l).then((function(e){e.success?i(e.data):console.log("err",e)})):function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.put(Ro+"/".concat(e),t,{headers:J()}).then((function(t){var a=t.data,l=a.success,n=a.message,i=a.data;return $(n),z.b.success({content:n,key:e},5),K(t.headers&&t.headers.authorization),{success:l,data:i}})).catch((function(t){return Q(t,e,5)}))}(t.id,l).then((function(e){e.success?i(e.data,null===t||void 0===t?void 0:t.index):console.log("err",e)}))},scrollToFirstError:!0,size:"small",layout:"inline"},n.a.createElement(ft,{FormFields:S}),n.a.createElement(Fo,{style:{marginTop:10,marginBottom:2}},"Attachments"),n.a.createElement(We.a,{customRequest:O,listType:"picture-card",maxCount:4,fileList:c,onRemove:function(e){var t=c.indexOf(e);c.splice(t,1),d(Object(we.a)(c))},disabled:r},c.length<4&&n.a.createElement("div",{style:{marginTop:10}},n.a.createElement(Ll.a,null),n.a.createElement("div",{style:{marginTop:8}},"Upload")))))},Mo=(ve.a.Text,ve.a.Title),Lo=function(e){var t,a=Object(l.useState)(!1),i=Object(he.a)(a,2),r=i[0],o=i[1],s=Object(l.useState)({data:[],filtered:[]}),c=Object(he.a)(s,2),d=c[0],u=c[1],m=Object(l.useState)({}),f=Object(he.a)(m,2),g=f[0],y=f[1],h=[Object(Fe.a)({title:"Code",dataIndex:"id",render:function(e){return"00".concat(e)}},Jt("id","number",!0)),Object(Fe.a)({title:"Type",dataIndex:"expenseTypeName"},Jt("expenseTypeName","string")),Object(Fe.a)({title:"Project",dataIndex:"projectName"},Jt("projectName","string")),Object(Fe.a)({title:"Date",dataIndex:"date",render:function(e){return W(e,!0,!0)},align:"center"},Jt("date","date")),Object(Fe.a)({title:"Amount",dataIndex:"amount",align:"center",render:function(e){return _(e)}},Jt("amount","number")),Object(Fe.a)({title:"Reimbursable",dataIndex:"isReimbursed",align:"center",width:"1%",render:function(e){return n.a.createElement(tt.a,{defaultChecked:!1,checked:e})}},Jt("isReimbursed","string")),{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:t.isInSheet||!(null===g||void 0===g?void 0:g.DELETE),className:"pop-confirm-menu"},n.a.createElement(Le.a,{disabled:t.isInSheet,title:"Are you sure you want to delete",onConfirm:function(){return S(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",onClick:function(){return o(Object(Fe.a)(Object(Fe.a)({},t),{},{index:a}))}},"AP"===t.status||"SB"===t.status?"View":"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}];Object(l.useEffect)((function(){E(),k()}),[]);var E=function(){wo().then((function(e){var t,a;(null===e||void 0===e?void 0:e.success)&&u({data:null!==(t=null===e||void 0===e?void 0:e.data)&&void 0!==t?t:[],filtered:null!==(a=null===e||void 0===e?void 0:e.data)&&void 0!==a?a:[]})}))},k=function(){var e=G(),t=(e.id,e.permissions),a=void 0===t?"":t,l=JSON.parse(a).EXPENSES;y(void 0===l?{}:l)},S=function(t,a){var l=d.data,n=d.filtered,i=e.history;sl(i,"/expenses",t,a,n,l).then((function(e){e.success&&u({filtered:Object(we.a)(e.filterData),data:Object(we.a)(e.data)})}))},C=function(e){e?(e=e.replace(/\s+/g,"").toLowerCase(),u((function(t){return Object(Fe.a)(Object(Fe.a)({},t),{},{filtered:t.data.filter((function(t){return"00".concat(t.id.toString().replace(/\s+/g,"")).includes(e)||t.expenseTypeName&&t.expenseTypeName.toLowerCase().replace(/\s+/g,"").includes(e)||t.projectName&&t.projectName.toLowerCase().replace(/\s+/g,"").includes(e)||t.amount&&"".concat(_(t.amount)).toLowerCase().replace(/\s+/g,"").includes(e)||t.date&&"".concat(W(t.date,!0,!0)).toLowerCase().replace(/\s+/g,"").includes(e)}))})}))):u((function(e){return Object(Fe.a)(Object(Fe.a)({},e),{},{filtered:e.data})}))};return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Mo,{level:4},"Expenses")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){o(!0)},disabled:!g.ADD},n.a.createElement(Nt.a,null)," Add Expense")),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,C)},size:"small",bordered:!0,className:"fs-small",pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},columns:h,dataSource:null!==(t=null===d||void 0===d?void 0:d.filtered)&&void 0!==t?t:[]}))),r&&n.a.createElement(No,{visible:r,close:function(){o(!1)},callBack:function(e,t){var a=d.data,l=d.filtered;if(t>=0){var n=a.findIndex((function(t){return t.id===e.id})),i=l.findIndex((function(t){return t.id===e.id}));a[n]=e,l[i]=e}else a=[].concat(Object(we.a)(a),[e]),l=[].concat(Object(we.a)(l),[e]);u({data:Object(we.a)(a),filtered:Object(we.a)(l)}),o(!1)}}))},Bo="".concat(A,"/expense-sheets"),qo=function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.post("".concat(Bo).concat(e),t,{headers:J()}).then((function(t){var a,l=t.data,n=l.success,i=l.data,r=l.message;return $(r),z.b.success({content:r,key:e}),K(null===t||void 0===t||null===(a=t.headers)||void 0===a?void 0:a.authorization),{success:n,data:i}})).catch((function(e){return Q(e,1,5)}))},Vo=ve.a.Text,Yo=(ve.a.Title,function(e){var t=e.visible,a=e.close,i=e.expenses,r=e.callBack,o=e.adminView,s=["AP","SB"].includes(t.status),c=Me.a.useForm(),d=Object(he.a)(c,1)[0],u=Object(l.useState)([]),m=Object(he.a)(u,2),f=m[0],g=m[1],y=Object(l.useState)([]),h=Object(he.a)(y,2),v=h[0],E=h[1],k=Object(l.useState)(),S=Object(he.a)(k,2),C=(S[0],S[1]),j=Object(l.useState)({}),D=Object(he.a)(j,2),O=D[0],I=D[1],P=Object(l.useState)([]),x=Object(he.a)(P,2),T=x[0],A=x[1],R=Object(l.useState)([{Placeholder:"Title",rangeMin:!0,fieldCol:12,size:"small",type:"Text"},{Placeholder:"Project",fieldCol:12,size:"small",type:"Text"},{disabled:o||s,object:"basic",fieldCol:12,key:"label",size:"small",rules:[{required:!0,message:"Title is Required"}],type:"Input"},{disabled:o||s,object:"basic",fieldCol:12,key:o?"projectName":"projectId",size:"small",initialValue:null,data:[],type:o?"Input":"Select",onChange:function(e){B(e)}},{disabled:null===(null===t||void 0===t?void 0:t.projectId),object:"basic",fieldCol:1,key:"isBillable",size:"small",initialValue:void 0,type:"Checkbox",valuePropName:"checked",itemStyle:{marginTop:"10px",display:null!==o&&void 0!==o?o:"none"}},{Placeholder:"Billable",fieldCol:5,size:"small",type:"Text",itemStyle:{marginTop:"10px",display:null!==o&&void 0!==o?o:"none"}}]),w=Object(he.a)(R,2),F=w[0],N=w[1],M=[Object(Fe.a)({title:"Code",dataIndex:"id",render:function(e){return"00".concat(e)}},Jt("id","number")),Object(Fe.a)({title:"Type",dataIndex:"expenseTypeName"},Jt("expenseTypeName","string")),Object(Fe.a)({title:"Date",dataIndex:"date",render:function(e){return W(e,!0,!0)}},Jt("date","date")),Object(Fe.a)({title:"Project",dataIndex:"projectName"},Jt("projectName","string")),Object(Fe.a)({title:"Amount",dataIndex:"amount",render:function(e){return _(e)}},Jt("amount","number")),{title:"Reimbursable",dataIndex:"isReimbursed",ellipsis:!0,render:function(e){return n.a.createElement(tt.a,{defaultChecked:!1,checked:e})}}];Object(l.useEffect)((function(){!0!==t&&d.setFieldsValue({basic:t}),L()}),[]);var L=function(){var e=G(),a=e.id,l=e.permissions,n=void 0===l?"":l,i=JSON.parse(n).EXPENSES;I(void 0===i?{}:i),Promise.all([!o&&Ct(a,"O",0),!0!==t&&kl("ESH",t.id)]).then((function(e){var a,l,n=F;n[3].data=(null===(a=e[0])||void 0===a?void 0:a.success)?e[0].data:[],N(Object(we.a)(n)),A((null===(l=e[1])||void 0===l?void 0:l.success)?e[1].fileList:[]),o?(g(null===t||void 0===t?void 0:t.expenseSheetExpenses),E(null===t||void 0===t?void 0:t.expenseSheetExpensesIds)):B(null===t||void 0===t?void 0:t.projectId)}))},B=function(e){var a,l=e,n=null!==(a=null===t||void 0===t?void 0:t.expenseSheetExpensesIds)&&void 0!==a?a:[],r=i;e&&(r=null===i||void 0===i?void 0:i.filter((function(e){return e.projectId==l}))),g(Object(we.a)(r)),E(n)},q={selectedRowKeys:v,onChange:function(e){E(e)},preserveSelectedRowKeys:!1,getCheckboxProps:function(){return{disabled:s}}},V=function(e){(function(e){return z.b.loading({content:"Loading...",key:1},5),Ve.a.post(Bo,e,{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.message,n=t.data;return $(l),z.b.success({content:l,key:1},5),K(e.headers&&e.headers.authorization),{success:a,data:n}})).catch((function(e){return z.b.error({content:"Error!",key:1},5),{error:"Please login again!",status:!1,message:e.message}}))})(e).then((function(e){e.success?r(e.data):console.log("err",e)}))},Y=function(e,a){if(o){var l=d.getFieldsValue().basic;t.isBillable=l.isBillable,function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.put(Bo+"/".concat(e,"/isBillable"),t,{headers:J()}).then((function(t){var a=t.data,l=a.success,n=a.message,i=a.data;return $(n),z.b.success({content:n,key:e},5),K(t.headers&&t.headers.authorization),{success:l,data:i}})).catch((function(t){return Q(t,e,5)}))}(t.id,a).then((function(e){e.success?r(t,null===t||void 0===t?void 0:t.index):console.log("err",e)}))}else(function(e,t){return z.b.loading({content:"Loading...",key:e}),Ve.a.put(Bo+"/".concat(e),t,{headers:J()}).then((function(t){var a=t.data,l=a.success,n=a.message,i=a.data;return $(n),z.b.success({content:n,key:e},5),K(t.headers&&t.headers.authorization),{success:l,data:i}})).catch((function(t){return Q(t,e,5)}))})(t.id,a).then((function(e){e.success?r(e.data,null===t||void 0===t?void 0:t.index):console.log("err",e)}))},H=function(){var e=Object(La.a)(Ma.a.mark((function e(t){var a,l,n,i,r;return Ma.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.onSuccess,l=t.onError,n=t.file,i=t.onProgress,r=new FormData,{headers:{"content-type":"multipart/form-data"},onUploadProgress:function(e){var t=Math.floor(e.loaded/e.total*100);C(t),100===t&&setTimeout((function(){return C(0)}),1e3),i({percent:e.loaded/e.total*100})}},r.append("files",n),vl(r).then((function(e,t){if(e.success)a("Ok"),A([].concat(Object(we.a)(T),[e.file]));else{console.log("Eroor: ",t);new Error("Some error");l({err:t})}}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return n.a.createElement(wt.a,{title:"".concat(o?"Approve":!0===t?"Add":"Edit"," Expense Sheet"),visible:t,width:900,onCancel:a,okText:"Save",okButtonProps:{htmlType:"submit",form:"my-form",disabled:null===(null===t||void 0===t?void 0:t.projectId)&&o||!o&&(v.length<1||s||t&&!O.UPDATE||!t&&!O.ADD)}},n.a.createElement(Me.a,{id:"my-form",form:d,onFinish:function(e){var a,l=e.basic;l=Object(Fe.a)(Object(Fe.a)({},l),{},{projectId:null!==(a=l.projectId)&&void 0!==a?a:null,expenseSheetExpenses:v,attachments:T.map((function(e,t){return e.fileId}))}),(null===t||void 0===t?void 0:t.id)?Y(t.id,l):V(l)},scrollToFirstError:!0,size:"small",layout:"inline"},n.a.createElement(p.a,{gutter:[0,20]},n.a.createElement(b.a,{span:24,style:{display:"flex",flexWrap:"wrap"}},n.a.createElement(ft,{FormFields:F})),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{size:"small",bordered:!0,className:"fs-small",pagination:!1,rowKey:function(e){return e.id},scroll:{y:250},rowSelection:!t.adminView&&q,columns:M,dataSource:f,summary:function(e){var a=0,l=0;return e.forEach((function(e){var n,i,r;if(!t.adminView&&v.includes(e.id))a+=parseFloat(null!==(n=e.amount)&&void 0!==n?n:0),e.isBillable?parseFloat(null!==(i=e.amount)&&void 0!==i?i:0):0,l+=e.isReimbursed?parseFloat(null!==(r=e.amount)&&void 0!==r?r:0):0;else if(t.adminView){var o,s,c;a+=parseFloat(null!==(o=e.amount)&&void 0!==o?o:0),e.isBillable?parseFloat(null!==(s=e.amount)&&void 0!==s?s:0):0,l+=e.isReimbursed?parseFloat(null!==(c=e.amount)&&void 0!==c?c:0):0}})),n.a.createElement(Rt.a.Summary,{fixed:"bottom"},n.a.createElement(Rt.a.Summary.Row,null,n.a.createElement(Rt.a.Summary.Cell,{index:0}),n.a.createElement(Rt.a.Summary.Cell,{index:1},"Total:"),n.a.createElement(Rt.a.Summary.Cell,{index:2},_(a)),n.a.createElement(Rt.a.Summary.Cell,{index:3,colSpan:2},"Total Reimbursable:"),n.a.createElement(Rt.a.Summary.Cell,{index:4},_(l)),n.a.createElement(Rt.a.Summary.Cell,{index:5})))}})),n.a.createElement(b.a,{span:24},n.a.createElement(Vo,{style:{marginTop:10,marginBottom:2}},"Attachments"),n.a.createElement(We.a,{disabled:o||s,customRequest:H,listType:"picture-card",maxCount:4,fileList:T,onRemove:function(e){var t=T.indexOf(e);T.splice(t,1),A(Object(we.a)(T))}},T.length<4&&n.a.createElement("div",{style:{marginTop:10}},n.a.createElement(Ll.a,null),n.a.createElement("div",{style:{marginTop:8}},"Upload")))))))}),Ho=ve.a.Title,_o=Ke.a.RangePicker,Uo="",Wo=function(){var e,t,a,i=Object(l.useState)([]),r=Object(he.a)(i,2),o=r[0],s=r[1],c=Object(l.useState)({keys:[],data:[]}),d=Object(he.a)(c,2),u=d[0],m=d[1],f=Object(l.useState)(),g=Object(he.a)(f,2),y=g[0],h=g[1],E=Object(l.useState)(!1),k=Object(he.a)(E,2),C=k[0],j=k[1],D=Object(l.useState)({}),O=Object(he.a)(D,2),I=O[0],P=O[1],x=Object(l.useState)({filterSatrtDate:W(new Date).startOf("month"),filterEndDate:W(new Date).endOf("month"),filterProject:null}),T=Object(he.a)(x,2),z=T[0],A=T[1],R=z.filterSatrtDate,w=z.filterEndDate,F=(z.filterProject,[Object(Fe.a)({title:"Code",dataIndex:"id",render:function(e){return"00".concat(e)}},Jt("id","number")),Object(Fe.a)({title:"Title",dataIndex:"label"},Jt("label","string")),Object(Fe.a)({title:"Project",dataIndex:"projectName"},Jt("projectName","string")),Object(Fe.a)({title:"Amount",dataIndex:"amount",align:"center",render:function(e){return _(e)}},Jt("amount","number")),Object(Fe.a)({title:"Status",dataIndex:"status",align:"center",render:function(e,t){return n.a.createElement("span",null,n.a.createElement(fi,{text:e})," ",t.notes&&n.a.createElement($e.a,{title:t.notes,placement:"top",destroyTooltipOnHide:!0},n.a.createElement(Zn.a,null)))}},Xt("status","string",!0,"SB")),Object(Fe.a)({title:"Submitted At",dataIndex:"submittedAt",align:"center",render:function(e){return W(e,!0,!0)}},Jt("submittedAt","date")),Object(Fe.a)({title:"Submitted By",dataIndex:"submittedBy",align:"center"},Jt("submittedBy","string")),{title:"Billable",dataIndex:"isBillable",align:"center",render:function(e){return n.a.createElement(tt.a,{defaultChecked:!1,checked:e})}},{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"edit",onClick:function(){return j(Object(Fe.a)(Object(Fe.a)({},t),{},{index:a,adminView:!0}))}},"View"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}]);Object(l.useEffect)((function(){M()}),[]),Object(l.useEffect)((function(){L(z)}),[z]);var N={selectedRowKeys:u.keys,onChange:function(e,t){var a=!1,l=!1,n=!1;t.forEach((function(e){"SB"===e.status&&(l=!0),"AP"===e.status&&(n=!0,a=!0),"RJ"!==e.status&&"SV"!==e.status||(l=!0,n=!0,a=!0)})),m({keys:e,data:t,cantReject:n,cantApprove:a,cantUnapprove:l})},getCheckboxProps:function(e){return{disabled:["RJ","SV"].includes(e.status)}}},M=function(){var e=G(),t=e.id,a=e.permissions,l=JSON.parse(a).EXPENSES;P(void 0===l?{}:l),Ct(t,"M",0).then((function(e){e.success&&(e.data.unshift({value:0,label:"No Project"}),s(e.data))}))},L=function(e){(function(e){var t=null!==e&&void 0!==e?e:{},a=t.filterSatrtDate,l=t.filterEndDate,n=t.filterProject,i="".concat(Bo,"/approvalExpenseSheets?").concat(a?"startDate=".concat(W(a,!0,"DD/MM/YYYY")):"").concat(l?"&endDate=".concat(W(l,!0,"DD/MM/YYYY")):"","&projectId=").concat(null!==n&&void 0!==n?n:null);return Ve.a.get(i,{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;return $(n),K(e.headers&&e.headers.authorization),{success:a,data:l}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))})(e).then((function(e){e.success&&h(e.data)}))},B=function(e){var t,a=u.data,l=void 0===a?[]:a,i=l.length,r=n.a.createElement("div",null,l.map((function(e,t){var a=e.label;e.projectName,e.projectType;return n.a.createElement("div",{key:t},a,i-1>t&&",")})),n.a.createElement("div",{style:{margin:10}},n.a.createElement(Me.a,{id:"my-form",onFinish:function(t){return q(t,e)}},n.a.createElement(Me.a.Item,{noStyle:!0,name:"notes"},n.a.createElement(Je.a.TextArea,{placeholder:"Enter Your Notes....",autoSize:{minRows:3,maxRows:10},allowClear:!0})))));Uo=wt.a.confirm({title:"Do you wish to ".concat(e," listed sheet").concat(i>1?"s":""),icon:n.a.createElement(S.a,null),content:r,okText:"Okay",cancelText:"Cancel",okButtonProps:{danger:null===(t="reject"===e)||void 0===t||t,htmlType:"submit",form:"my-form"}})},q=function(e,t){var a=e.notes;V(t,a),Uo.destroy()},V=function(e,t){var a=u.keys,l={sheets:void 0===a?[]:a,notes:t};qo("/".concat(e,"Many"),l).then((function(e){e.success&&(m({keys:[],data:[]}),L())}))};return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Ho,{level:4},"Expense Approval")),n.a.createElement(b.a,null,n.a.createElement(Qe.a,{placeholder:"Select Project",style:{width:300},allowClear:!0,options:o,showSearch:!0,optionFilterProp:["label","value"],filterOption:function(e,t){var a=t.label.toLowerCase().indexOf(e.toLowerCase())>=0,l=t.value.toString().toLowerCase().indexOf(e.toLowerCase())>=0;return a||l},onChange:function(e){A((function(t){return Object(Fe.a)(Object(Fe.a)({},t),{},{filterProject:e})}))}})),n.a.createElement(b.a,null,n.a.createElement(_o,{format:"ddd DD MMM yyyy",value:[R,w],size:"small",onChange:function(e){A((function(t){var a,l;return Object(Fe.a)(Object(Fe.a)({},t),{},{filterSatrtDate:null!==(a=null===e||void 0===e?void 0:e[0])&&void 0!==a?a:null,filterEndDate:null!==(l=null===e||void 0===e?void 0:e[1])&&void 0!==l?l:null})}))}})),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{size:"small",bordered:!0,className:"fs-small",pagination:{pageSize:G().pageSize,hideOnSinglePage:!0,responsive:!0,size:"small"},rowKey:function(e){return e.id},rowSelection:N,columns:F,dataSource:y})),n.a.createElement(b.a,{span:24},n.a.createElement(p.a,{justify:"end",gutter:[20,200]},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",danger:!0,disabled:(null===u||void 0===u?void 0:u.cantReject)||!(null===I||void 0===I?void 0:I.APPROVAL)||(null===(e=u.keys)||void 0===e?void 0:e.length)<1,onClick:function(){return B("reject")}},"Reject")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{className:"success",disabled:(null===u||void 0===u?void 0:u.cantApprove)||!(null===I||void 0===I?void 0:I.APPROVAL)||(null===(t=u.keys)||void 0===t?void 0:t.length)<1,onClick:function(){return B("approve")}},"Approve")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{className:"not-success",disabled:(null===u||void 0===u?void 0:u.cantUnapprove)||!(null===I||void 0===I?void 0:I.UNAPPROVAL)||(null===(a=u.keys)||void 0===a?void 0:a.length)<1,onClick:function(){return B("unapprove")}},"Unapprove"))))),C&&n.a.createElement(Yo,{visible:C,close:function(){j(!1)},adminView:!0,callBack:function(e,t){var a=y;t>=0&&(a[t]=e),h(Object(we.a)(a)),j(!1)}}))},Ko=(new Date,new Date,new Date,new Date,new Date,new Date,ve.a.Title),Go=function(e){var t,a,i=Object(l.useState)({keys:[],data:[]}),r=Object(he.a)(i,2),o=r[0],s=r[1],c=Object(l.useState)(!1),d=Object(he.a)(c,2),u=d[0],m=d[1],f=Object(l.useState)({data:[],filtered:[]}),g=Object(he.a)(f,2),y=g[0],h=g[1],E=Object(l.useState)([]),k=Object(he.a)(E,2),C=k[0],j=k[1],D=Object(l.useState)({}),O=Object(he.a)(D,2),I=O[0],P=O[1],x=[Object(Fe.a)({title:"Code",dataIndex:"id",render:function(e){return"00".concat(e)}},Jt("id","number")),Object(Fe.a)({title:"Title",dataIndex:"label"},Jt("label","string")),Object(Fe.a)({title:"Project",dataIndex:"projectName"},Jt("projectName","string")),Object(Fe.a)({title:"Employee Name",dataIndex:"createdBy"},Jt("createdBy","string")),Object(Fe.a)({title:"Amount",dataIndex:"amount",align:"center",render:function(e){return _(e)}},Jt("amount","number")),Object(Fe.a)({title:"Status",dataIndex:"status",align:"center",render:function(e,t){return n.a.createElement("div",null,n.a.createElement(fi,{text:e})," ",t.notes&&n.a.createElement($e.a,{title:t.notes,placement:"top",destroyTooltipOnHide:!0},n.a.createElement(Zn.a,null)))}},Xt("status","string",!0,"SB")),Object(Fe.a)({title:"Submited At",dataIndex:"submittedAt",align:"center",render:function(e){return W(e,!0,!0)}},Jt("date","date")),{title:"...",key:"action",align:"center",width:"1%",render:function(e,t,a){return n.a.createElement(se.a,{overlay:n.a.createElement(v.a,null,n.a.createElement(v.a.Item,{key:"delete",danger:!0,disabled:["AP","SB"].includes(t.status)||!I.DELETE,className:"pop-confirm-menu"},n.a.createElement(Le.a,{disabled:["AP","SB"].includes(t.status),title:"Are you sure you want to delete",onConfirm:function(){return A(t.id,a)}},n.a.createElement("div",null," Delete "))),n.a.createElement(v.a.Item,{key:"edit",onClick:function(){return w(Object(Fe.a)(Object(Fe.a)({},t),{},{index:a}))}},"Edit"))},n.a.createElement(Be.a,{size:"small"},n.a.createElement(fe.a,null)))}}];Object(l.useEffect)((function(){T(),z()}),[]);var T=function(){(function(e){var t=null!==e&&void 0!==e?e:{},a=t.filterSatrtDate,l=t.filterEndDate,n=t.filterProject,i="".concat(Bo,"?").concat(a?"startDate=".concat(W(a,!0,"DD/MM/YYYY")):"").concat(l?"&endDate=".concat(W(l,!0,"DD/MM/YYYY")):"","&projectId=").concat(null!==n&&void 0!==n?n:null);return Ve.a.get(i,{headers:J()}).then((function(e){var t=e.data,a=t.success,l=t.data,n=t.message;return $(n),K(e.headers&&e.headers.authorization),{success:a,data:l}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}}))})().then((function(e){var t,a;e.success&&h({data:null!==(t=null===e||void 0===e?void 0:e.data)&&void 0!==t?t:[],filtered:null!==(a=null===e||void 0===e?void 0:e.data)&&void 0!==a?a:[]})}))},z=function(){var e=G(),t=(e.id,e.permissions),a=JSON.parse(t).EXPENSES;P(void 0===a?{}:a)},A=function(t,a){var l=y.data,n=y.filtered,i=e.history;sl(i,"/expense-sheets",t,a,n,l).then((function(e){e.success&&h({filtered:Object(we.a)(e.filterData),data:Object(we.a)(e.data)})}))},R={selectedRowKeys:o.keys,onChange:function(e,t){var a=!1;t.forEach((function(e){"SV"!==e.status&&"RJ"!==e.status&&(a=!0)})),s({keys:e,data:t,checkDisable:a})},getCheckboxProps:function(e){return{disabled:["AP","SB"].includes(e.status)}}},w=function(e){wo(!0,null===e||void 0===e?void 0:e.id).then((function(t){t.success&&j(t.data),m(e)}))},F=function(){var e=o.keys;qo("/submitMany",{sheets:void 0===e?[]:e}).then((function(e){e.success&&(s({keys:[],data:[]}),T())}))},M=function(e){e?(e=e.replace(/\s+/g,"").toLowerCase(),h((function(t){return Object(Fe.a)(Object(Fe.a)({},t),{},{filtered:t.data.filter((function(t){return"00".concat(t.id.toString().replace(/\s+/g,"")).includes(e)||t.label&&t.label.toLowerCase().replace(/\s+/g,"").includes(e)||t.projectName&&t.projectName.toLowerCase().replace(/\s+/g,"").includes(e)||t.createdBy&&t.createdBy.toLowerCase().replace(/\s+/g,"").includes(e)||"SV"!==t.status&&N[t.status].toLowerCase().replace(/\s+/g,"").includes(e)||t.amount&&"".concat(_(t.amount)).toLowerCase().replace(/\s+/g,"").includes(e)||t.submittedAt&&"".concat(W(t.submittedAt,!0,!0)).toLowerCase().replace(/\s+/g,"").includes(e)}))})}))):h((function(e){return Object(Fe.a)(Object(Fe.a)({},e),{},{filtered:e.data})}))};return n.a.createElement(n.a.Fragment,null,n.a.createElement(p.a,{justify:"space-between"},n.a.createElement(b.a,null,n.a.createElement(Ko,{level:4},"Expenses Sheets")),n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",size:"small",onClick:function(){w(!0)}},n.a.createElement(Nt.a,null)," Add Expense Sheet")),n.a.createElement(b.a,{span:24},n.a.createElement(Rt.a,{title:function(){return Qt(5,M)},size:"small",bordered:!0,className:"fs-small",pagination:{pageSize:G().pageSize},rowKey:function(e){return e.id},rowSelection:R,columns:x,dataSource:null!==(t=y.filtered)&&void 0!==t?t:[]})),n.a.createElement(b.a,{span:24},n.a.createElement(p.a,{justify:"end"},n.a.createElement(b.a,null,n.a.createElement(Be.a,{type:"primary",className:"success",disabled:o.checkDisable||!I.ADD||(null===(a=o.keys)||void 0===a?void 0:a.length)<1,onClick:function(){return function(){var e=o.data,t=void 0===e?[]:e,a=t.length,l=n.a.createElement("div",null,t.map((function(e,t){var l=e.label;e.projectName,e.projectType;return n.a.createElement("div",{key:t},l,a-1>t&&",")}))),i=wt.a.confirm({title:"Do you wish to submit sheet".concat(a>1?"s":""," for"),icon:n.a.createElement(S.a,null),content:l,okText:"Okay",cancelText:"Cancel",onOk:function(){F(),i.destroy()}})}()}},"Submit"))))),u&&n.a.createElement(Yo,{visible:u,close:function(){m(!1)},callBack:function(e,t){var a=y.data,l=y.filtered;if(t>=0){var n=a.findIndex((function(t){return t.id===e.id})),i=l.findIndex((function(t){return t.id===e.id}));a[n]=e,l[i]=e}else a=[].concat(Object(we.a)(a),[e]),l=[].concat(Object(we.a)(l),[e]);h({data:Object(we.a)(a),filtered:Object(we.a)(l)}),m(!1)},expenses:C}))},$o=(f.a.Content,[{component:Ee,link:"/dashboard",key:"DASHBOARD",permission:"ALLOWED"},{component:To,link:"/profile",key:"PROFILE",permission:"ALLOWED"},{component:bo,link:"/calender"},{component:Za,link:"/admin/global-settings",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/tax-rates",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/calendars/holidays/:id",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/calendars",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/holiday-types",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/leave-categories",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/leave-policies",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/roles",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/standard-levels",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/skills",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/panels",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/expense-types",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/panels/skills/:id",key:"ADMIN_OPTIONS",permission:"READ"},{component:Za,link:"/admin/import-export",key:"ADMIN_OPTIONS",permission:"READ"},{component:dl,link:"/organisations",key:"ORGANIZATIONS",permission:"READ"},{component:Ml,link:"/organisations/:id/info",key:"ORGANIZATIONS",permission:"READ"},{component:_n,link:"/contacts",key:"CONTACT_PERSONS",permission:"READ"},{component:Kn,link:"/contacts/:id/info",key:"CONTACT_PERSONS",permission:"READ"},{component:Kl,link:"/Employees",key:"USERS",permission:"READ"},{component:mn,link:"/Employees/:id/info",key:"USERS",permission:"READ"},{component:yn,link:"/Employee/:id/contracts",key:"USERS",permission:"READ"},{component:Cn,link:"/Employee/:id/novated-lease",key:"USERS",permission:"READ"},{component:xn,link:"/sub-contractors",key:"USERS",permission:"READ"},{component:wn,link:"/sub-contractors/:id/info",key:"USERS",permission:"READ"},{component:Bn,link:"/sub-contractors/:id/contracts",key:"USERS",permission:"READ"},{component:Bi,link:"/opportunities",key:"OPPORTUNITIES",permission:"READ"},{component:sr,link:"/opportunities/:proId/info",key:"OPPORTUNITIES",permission:"READ"},{component:oo,link:"/opportunities/:proId/milestones",key:"OPPORTUNITIES",permission:"READ"},{component:$r,link:"/opportunities/:proId/milestones/:mileId/expenses",key:"OPPORTUNITIES",permission:"READ"},{component:mr,link:"/opportunities/:proId/milestones/:mileId/resources",key:"OPPORTUNITIES",permission:"READ"},{component:gr,link:"/projects",key:"PROJECTS",permission:"READ"},{component:Pr,link:"/projects/:proId/info",key:"PROJECTS",permission:"READ"},{component:Wr,link:"/projects/:proId/purchase-order",key:"PROJECTS",permission:"READ"},{component:oo,link:"/projects/:proId/milestones",key:"PROJECTS",permission:"READ"},{component:qr,link:"/projects/:proId/schedules",key:"PROJECTS",permission:"READ"},{component:uo,link:"/milestones-certificate",key:"PROJECTS",permission:"READ"},{component:$r,link:"/projects/:proId/milestones/:mileId/expenses",key:"PROJECTS",permission:"READ"},{component:Nr,link:"/projects/:proId/milestones/:mileId/resources",key:"PROJECTS",permission:"READ"},{component:Hr,link:"/projects/:proId/resources/rates/:id",key:"PROJECTS",permission:"READ"},{component:Oi,link:"/time-sheet",key:"TIMESHEETS",permission:"READ"},{component:yi,link:"/time-sheet-approval",key:"TIMESHEETS",permission:"APPROVAL,UNAPPROVAL"},{component:xi,link:"/time-off"},{component:Zr,link:"/leave-request",key:"LEAVE_REQUESTS",permission:"READ"},{component:lo,link:"/approve-request",key:"LEAVE_REQUESTS",permission:"APPROVAL,UNAPPROVAL"},{component:Ao,link:"/training",permission:"ALLOWED"},{component:Go,link:"/expense-sheets",key:"EXPENSES",permission:"READ"},{component:Lo,link:"/expense",key:"EXPENSES",permission:"READ"},{component:Wo,link:"/expense-sheet-approval",key:"EXPENSES",permission:"APPROVAL,UNAPPROVAL"}]),Jo=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var l;return Object(c.a)(this,a),(l=t.call(this)).getPageLink=function(){var e=G().permissions,t=void 0===e?"{}":e;t=JSON.parse(t);var a=l.state.allowedRoutes;return $o.forEach((function(e){var l;if("ALLOWED"===e.permission)a.push(e);else if(null===(l=t)||void 0===l?void 0:l[e.key]){var n,i=e.permission.split(","),r=Object(h.a)(i);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(t[e.key][o]){a.push(e);break}}}catch(s){r.e(s)}finally{r.f()}}})),0===a.length&&l.setState({allowedRoutes:a}),a},l.state={allowedRoutes:[]},l}return Object(d.a)(a,[{key:"render",value:function(){var e=this.state.allowedRoutes;return n.a.createElement(o.d,null,(e.length>0?e:this.getPageLink()).map((function(e,t){return n.a.createElement(o.b,{exact:!0,path:e.link,component:e.component,key:t})})),n.a.createElement(o.a,{to:"/dashboard"}))}}]),a}(l.Component),Xo=a(573).a.Countdown;var Qo=function(e){var t=Object(l.useState)(!1),a=Object(he.a)(t,2),i=a[0],r=a[1],s=36e5-((new Date).getTime()-parseInt(localStorage.getItem("jwtTimer")));return n.a.createElement("div",null,n.a.createElement(wt.a,{destroyOnClose:!0,closable:!1,keyboard:!1,maskClosable:!1,centered:!0,visible:e.visible,okText:"Refresh",onOk:function(){return e.refresh()},cancelText:"Logout Now",onCancel:function(){return z.b.loading({content:"Loading...",key:"logout"}),localStorage.clear(),z.b.info({content:"Logout successfully!",key:"logout"}),void r(!0)}},n.a.createElement(Jn.a,null)," Logging out in",n.a.createElement(Xo,{onFinish:function(){localStorage.setItem("jwtExpired",!0),e.timeOut()},value:Date.now()+s,format:"mm:ss",style:{textAlign:"center"},valueStyle:{color:"red"}})),i&&n.a.createElement(o.a,{to:{pathname:"/"}}))},Zo=ve.a.Title,es=Je.a.Password;var ts=function(e){var t=Object(l.useState)(!1),a=Object(he.a)(t,2),i=a[0],r=a[1],s=Object(l.useState)(!1),c=Object(he.a)(s,2),d=(c[0],c[1],Me.a.useForm()),u=Object(he.a)(d,1)[0];return n.a.createElement("div",null,n.a.createElement(wt.a,{destroyOnClose:!0,closable:!1,keyboard:!1,maskClosable:!1,centered:!0,visible:e.visible,okText:"Login",okButtonProps:{htmlType:"submit",form:"my-form"},cancelText:"Cancel",onCancel:function(){r(!0),localStorage.clear()}},n.a.createElement(Zo,{level:4,style:{textAlign:"center"}},"Login"),n.a.createElement(Me.a,{id:"my-form",form:u,onFinish:function(t){yo(t).then((function(t){(null===t||void 0===t?void 0:t.success)&&(u.resetFields(),e.close())}))},layout:"vertical"},n.a.createElement(Me.a.Item,{label:"Username",name:"email",rules:[{required:!0,message:"Please input your username!"}]},n.a.createElement(Je.a,null)),n.a.createElement(Me.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},n.a.createElement(es,null)))),i&&n.a.createElement(o.a,{to:{pathname:"/"}}))},as=(a(538),f.a.Content);var ls=function(e){var t=Object(l.useState)(!1),a=Object(he.a)(t,2),i=a[0],r=a[1],s=Object(l.useState)(!1),c=Object(he.a)(s,2),d=(c[0],c[1]),u=Object(l.useState)(!1),m=Object(he.a)(u,2),f=m[0],p=m[1];Object(l.useEffect)((function(){var e=localStorage.getItem("jwtTimer");(new Date).getTime()-parseInt(e)>36e5?(localStorage.setItem("jwtExpired",!0),p(!0)):setInterval((function(){var e=localStorage.getItem("jwtTimer");(new Date).getTime()-parseInt(e)>33e5&&"jwtExpired"!==Eo()&&r(!0)}),6e4)}));var b=function(){Ve.a.get("".concat(A,"/helpers/refresh-token"),{headers:J()}).then((function(e){var t,a=e.data,l=a.success,n=a.message;return $(n),l&&(z.b.success({content:"Token Refresh Successfully"},5),K(null===e||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.authorization)),{success:l}})).catch((function(e){return{error:"Please login again!",success:!1,message:e.message}})).then((function(e){e.success?r(!1):(localStorage.clear(),d(!0),p(!1),d(!1))}))};return n.a.createElement("div",{className:"site-layour-frame"},n.a.createElement(as,{className:"site-layout-background layout-content-custom"},"jwtExpired"===Eo()||!0===Eo()?n.a.createElement(Jo,null):n.a.createElement(o.a,{to:{pathname:"/"}}),i&&n.a.createElement(Qo,{visible:i,refresh:function(){return b()},timeOut:function(){return d(!0),r(!1),p(!1),void d(!1)}})," ",n.a.createElement(ts,{visible:"jwtExpired"===Eo()||f,close:function(){localStorage.removeItem("jwtExpired"),d(!0),p(!1),d(!1)}})))},ns=f.a.Header,is=f.a.Sider,rs=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).toggle=function(){e.setState({collapsed:!e.state.collapsed})},e.state={collapsed:!0},e}return Object(d.a)(a,[{key:"render",value:function(){var e,t,a=this,l=this.state.collapsed;return n.a.createElement(f.a,{className:"setMinWidth"},n.a.createElement(is,{trigger:null,collapsible:!0,collapsed:l,theme:"light",breakpoint:"lg"},n.a.createElement("div",{className:"logo"},n.a.createElement(s.b,{to:"/dashboard"},l?n.a.createElement("div",{style:{height:"64px",padding:"12%"}},n.a.createElement("img",{src:"/z-s-avatar.png",alt:"Logo",style:{height:"42px"}})):n.a.createElement("div",{style:{height:"64px"}},n.a.createElement("img",{src:"/z-logo.png",alt:"Logo",width:"100%",style:{height:"64px"}})))),n.a.createElement(oe,{activatePath:null===(e=this.props)||void 0===e||null===(t=e.location)||void 0===t?void 0:t.pathname})),n.a.createElement(f.a,{className:"site-layout"},n.a.createElement(ns,{className:"site-layout-background",style:{padding:0}},n.a.createElement(p.a,{justify:"start"},n.a.createElement("span",{className:"trigger",onClick:function(){a.toggle()}},l?n.a.createElement(g.a,null):n.a.createElement(y.a,null)),n.a.createElement(b.a,{flex:"auto"},n.a.createElement(ye,null)," "))),n.a.createElement(ls,null)," "))}}]),a}(l.Component),os=a(109),ss=a.n(os),cs=(ve.a.Title,Je.a.Password);var ds=function(e){var t=(Object(o.g)().state||{from:{pathname:"/dashboard"}}).from,a=Object(l.useState)(!1),i=Object(he.a)(a,2),r=i[0],c=i[1];Object(l.useEffect)((function(){d()}),[]);var d=function(){!0===Eo()&&c(!0)};return n.a.createElement(p.a,{justify:"center",align:"middle",className:"app-login app-login-background",style:{backgroundImage:"url(".concat("/Z-avatar.svg",")")}},n.a.createElement(b.a,{span:8},n.a.createElement(p.a,{justify:"center",align:"middle",gutter:[24,10],className:"form-row"},n.a.createElement(b.a,{span:24,style:{backgroundImage:"url(".concat("/z-logo.png",")")},className:"app-title-image"}),n.a.createElement(b.a,{span:16,className:"txt-center"},n.a.createElement(Me.a,{wrapperCol:24,initialValues:{remember:!0},onFinish:function(e){yo(e).then((function(e){e&&e.success&&_e().then((function(e){e.success&&localStorage.setItem("pageSize",e.data.recordsPerPage),window.location.href="/dashboard"}))}))},layout:"vertical"},n.a.createElement(Me.a.Item,{label:"Username",name:"email",rules:[{required:!0,message:"Please input your username!"}]},n.a.createElement(Je.a,null)),n.a.createElement(Me.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},n.a.createElement(cs,null)),n.a.createElement(Me.a.Item,null,n.a.createElement(Be.a,{type:"primary",htmlType:"submit"},"Login")),n.a.createElement(Me.a.Item,null,n.a.createElement(ss.a,{type:"secondary"},n.a.createElement(s.b,{to:"/forgot-password"}," Forgot Password "))),n.a.createElement(Me.a.Item,{noStyle:!0},n.a.createElement(ss.a,{type:"danger"},"If you are experiencing any problems, please contact support@timewize.com.au")))))),r&&n.a.createElement(o.a,{to:t}))};ve.a.Title,Je.a.Password;var us=function(e){var t=(Object(o.g)().state||{from:{pathname:"/dashboard"}}).from,a=Object(l.useState)(!1),i=Object(he.a)(a,2),r=i[0],c=i[1];Object(l.useEffect)((function(){d()}),[]);var d=function(){!0===Eo()&&c(!0)};return n.a.createElement(p.a,{justify:"center",align:"middle",className:"app-login app-login-background",style:{backgroundImage:"url(".concat("/Z-avatar.svg",")")}},n.a.createElement(b.a,{span:8},n.a.createElement(p.a,{justify:"center",align:"middle",gutter:[24,10],className:"form-row"},n.a.createElement(b.a,{span:24,style:{backgroundImage:"url(".concat("/Z-logo.png",")")},className:"app-title-image"}),n.a.createElement(b.a,{span:16,className:"txt-center"},n.a.createElement(Me.a,{wrapperCol:24,initialValues:{remember:!0},onFinish:function(e){ho(e).then((function(e){e&&e.success&&(console.log(e),window.location.href="/login")}))},layout:"vertical"},n.a.createElement(Me.a.Item,{label:"Username",name:"email",rules:[{required:!0,message:"Please input your username!"}]},n.a.createElement(Je.a,null)),n.a.createElement(Me.a.Item,null,n.a.createElement(Be.a,{type:"primary",htmlType:"submit"},"Request Reset")),n.a.createElement(Me.a.Item,null,n.a.createElement(ss.a,{type:"secondary"},n.a.createElement(s.b,{to:"/login"}," Login "))),n.a.createElement(Me.a.Item,{noStyle:!0},n.a.createElement(ss.a,{type:"danger"},"If you are experiencing any problems, please contact support@timewize.com.au")))))),r&&n.a.createElement(o.a,{to:t}))},ms=(ve.a.Title,Je.a.Password);var fs=function(e){var t=Object(o.g)().state,a=(t||{from:{pathname:"/dashboard"}}).from,i=Object(l.useState)(!1),r=Object(he.a)(i,2),s=r[0],c=r[1],d=Object(l.useState)(Object(o.h)().token),u=Object(he.a)(d,1)[0];Object(l.useEffect)((function(){m(),console.log(t)}),[]);var m=function(){!0===Eo()&&c(!0)};return n.a.createElement(p.a,{justify:"center",align:"middle",className:"app-login app-login-background",style:{backgroundImage:"url(".concat("/Z-avatar.svg",")")}},n.a.createElement(b.a,{span:8},n.a.createElement(p.a,{justify:"center",align:"middle",gutter:[24,10],className:"form-row"},n.a.createElement(b.a,{span:24,style:{backgroundImage:"url(".concat("/Z-logo.png",")")},className:"app-title-image"}),n.a.createElement(b.a,{span:16,className:"txt-center"},n.a.createElement(Me.a,{wrapperCol:24,initialValues:{remember:!0},onFinish:function(e){vo(u,e).then((function(e){e&&e.success&&(console.log(e),window.location.href="/login")}))},layout:"vertical"},n.a.createElement(Me.a.Item,{label:"New Password",name:"password",rules:[{required:!0,message:"Please Enter your new password!"}]},n.a.createElement(ms,null)),n.a.createElement(Me.a.Item,{label:"Confirm New Password",name:"confirmPassword",dependencies:["password"],rules:[{required:!0,message:"Please Enter your new password!"},function(e){var t=e.getFieldValue;return{validator:function(e,a){return a&&t("password")!==a?Promise.reject(new Error("Passwords do not match!")):Promise.resolve()}}}]},n.a.createElement(ms,null)),n.a.createElement(Me.a.Item,null,n.a.createElement(Be.a,{type:"primary",htmlType:"submit"},"Reset")),n.a.createElement(Me.a.Item,{noStyle:!0},n.a.createElement(ss.a,{type:"danger"},"If you are experiencing any problems, please contact support@timewize.com.au")))))),s&&n.a.createElement(o.a,{to:a}))};a(558),a(559);var ps=function(){var e=[{name:"Login",path:"/",component:n.a.createElement(ds,null)},{name:"Forgot Password",path:"/forgot-password",component:n.a.createElement(us,null)},{name:"Login",path:"/reset-password/:token",component:n.a.createElement(fs,null)}].map((function(e,t){return n.a.createElement(o.b,{exact:!0,path:e.path,key:t},e.component)}));return n.a.createElement(s.a,null,n.a.createElement(o.d,null,e,n.a.createElement(rs,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(ps,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[314,1,2]]]);
//# sourceMappingURL=main.5bde8e38.chunk.js.map